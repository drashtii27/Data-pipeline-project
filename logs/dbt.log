[0m16:37:52.716370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dabaa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110937bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110937830>]}


============================== 16:37:52.717895 | 8a92fe72-b77d-4b72-b6be-8885e5f0fb9d ==============================
[0m16:37:52.717895 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:37:52.718175 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'use_colors': 'True', 'partial_parse': 'True', 'no_print': 'None', 'use_experimental_parser': 'False', 'static_parser': 'True', 'fail_fast': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'empty': 'False', 'target_path': 'None', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'write_json': 'True', 'quiet': 'False', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'log_cache_events': 'False', 'log_format': 'default', 'version_check': 'True'}
[0m16:37:52.719669 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'dw_project'
[0m16:37:52.720925 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.02813225, "process_user_time": 0.503628, "process_kernel_time": 0.109843, "process_mem_max_rss": "105857024", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:37:52.721186 [debug] [MainThread]: Command `dbt run` failed at 16:37:52.721146 after 0.03 seconds
[0m16:37:52.721339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110937a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110937cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110395d30>]}
[0m16:37:52.721473 [debug] [MainThread]: Flushing usage events
[0m16:41:31.163450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d32930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10966bb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10966b890>]}


============================== 16:41:31.164866 | d14d6c63-45fe-4acc-be19-4434022f79a2 ==============================
[0m16:41:31.164866 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:41:31.165143 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'use_colors': 'True', 'log_format': 'default', 'indirect_selection': 'eager', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'printer_width': '80', 'no_print': 'None', 'cache_selected_only': 'False', 'quiet': 'False', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'use_experimental_parser': 'False', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'target_path': 'None', 'debug': 'False', 'static_parser': 'True', 'warn_error': 'None', 'write_json': 'True', 'empty': 'False', 'invocation_command': 'dbt run'}
[0m16:41:32.048102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd14d6c63-45fe-4acc-be19-4434022f79a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1282a57c0>]}
[0m16:41:32.064844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd14d6c63-45fe-4acc-be19-4434022f79a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1278cfe60>]}
[0m16:41:32.065330 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m16:41:32.100336 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:41:32.100811 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:41:32.100966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd14d6c63-45fe-4acc-be19-4434022f79a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10954f0e0>]}
[0m16:41:32.515006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd14d6c63-45fe-4acc-be19-4434022f79a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128a57c80>]}
[0m16:41:32.548963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd14d6c63-45fe-4acc-be19-4434022f79a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12854b110>]}
[0m16:41:32.549183 [info ] [MainThread]: Found 2 models, 3 sources, 459 macros
[0m16:41:32.549317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd14d6c63-45fe-4acc-be19-4434022f79a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1284e5370>]}
[0m16:41:32.549938 [info ] [MainThread]: 
[0m16:41:32.550171 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:41:32.551923 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m16:41:32.556633 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m16:41:32.556768 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m16:41:32.556868 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:41:33.741648 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.184 seconds
[0m16:41:33.745524 [debug] [ThreadPool]: On list_lab2: Close
[0m16:41:33.955334 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m16:41:33.969832 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m16:41:33.970300 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m16:41:33.970614 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:41:34.800203 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.829 seconds
[0m16:41:34.804066 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m16:41:35.011932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd14d6c63-45fe-4acc-be19-4434022f79a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127093500>]}
[0m16:41:35.013124 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m16:41:35.013579 [info ] [MainThread]: 
[0m16:41:35.018414 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_historical
[0m16:41:35.019091 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics.bitcoin_historical ....................... [RUN]
[0m16:41:35.019545 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now model.dw_project.bitcoin_historical)
[0m16:41:35.019864 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_historical
[0m16:41:35.026929 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_historical"
[0m16:41:35.027777 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_historical
[0m16:41:35.046080 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_historical"
[0m16:41:35.046906 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_historical"
[0m16:41:35.047117 [debug] [Thread-1 (]: On model.dw_project.bitcoin_historical: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_historical"} */
create or replace   view lab2.analytics.bitcoin_historical
  
   as (
    SELECT 
    time_period_start,
    time_period_end,
    time_open,
    time_close,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_historical
WHERE time_period_start IS NOT NULL
  );
[0m16:41:35.047300 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:41:36.168786 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.121 seconds
[0m16:41:36.188621 [debug] [Thread-1 (]: On model.dw_project.bitcoin_historical: Close
[0m16:41:36.379198 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd14d6c63-45fe-4acc-be19-4434022f79a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128230b90>]}
[0m16:41:36.380981 [info ] [Thread-1 (]: 1 of 2 OK created sql view model analytics.bitcoin_historical .................. [[32mSUCCESS 1[0m in 1.36s]
[0m16:41:36.382141 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_historical
[0m16:41:36.382929 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_realtime
[0m16:41:36.383857 [info ] [Thread-1 (]: 2 of 2 START sql view model analytics.bitcoin_realtime ......................... [RUN]
[0m16:41:36.384580 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_historical, now model.dw_project.bitcoin_realtime)
[0m16:41:36.385026 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_realtime
[0m16:41:36.389750 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_realtime"
[0m16:41:36.390919 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_realtime
[0m16:41:36.394286 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_realtime"
[0m16:41:36.395814 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_realtime"
[0m16:41:36.396252 [debug] [Thread-1 (]: On model.dw_project.bitcoin_realtime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_realtime"} */
create or replace   view lab2.analytics.bitcoin_realtime
  
   as (
    SELECT 
    time_open AS time_open_v1,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_realtime
WHERE price_close IS NOT NULL
  );
[0m16:41:36.396571 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:41:37.502349 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.105 seconds
[0m16:41:37.506647 [debug] [Thread-1 (]: On model.dw_project.bitcoin_realtime: Close
[0m16:41:37.714318 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd14d6c63-45fe-4acc-be19-4434022f79a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128d485f0>]}
[0m16:41:37.716087 [info ] [Thread-1 (]: 2 of 2 OK created sql view model analytics.bitcoin_realtime .................... [[32mSUCCESS 1[0m in 1.33s]
[0m16:41:37.717158 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_realtime
[0m16:41:37.719359 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:41:37.719890 [debug] [MainThread]: Connection 'model.dw_project.bitcoin_realtime' was properly closed.
[0m16:41:37.720463 [info ] [MainThread]: 
[0m16:41:37.720918 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 5.17 seconds (5.17s).
[0m16:41:37.722026 [debug] [MainThread]: Command end result
[0m16:41:37.749178 [info ] [MainThread]: 
[0m16:41:37.749519 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:41:37.749718 [info ] [MainThread]: 
[0m16:41:37.749925 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:41:37.752055 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.610024, "process_user_time": 3.339576, "process_kernel_time": 1.397688, "process_mem_max_rss": "207945728", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:41:37.752427 [debug] [MainThread]: Command `dbt run` succeeded at 16:41:37.752365 after 6.61 seconds
[0m16:41:37.752660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109130170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128d485f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128983140>]}
[0m16:41:37.752878 [debug] [MainThread]: Flushing usage events
[0m16:45:16.796382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10840ee70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e2b260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e77b00>]}


============================== 16:45:16.798311 | 88f989f2-7ee8-4b6b-920f-2bf0d4b408e2 ==============================
[0m16:45:16.798311 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:45:16.798638 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'debug': 'False', 'target_path': 'None', 'log_format': 'default', 'quiet': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'indirect_selection': 'eager', 'printer_width': '80', 'use_experimental_parser': 'False', 'empty': 'False', 'no_print': 'None', 'introspect': 'True', 'write_json': 'True', 'version_check': 'True', 'static_parser': 'True', 'use_colors': 'True', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'log_cache_events': 'False', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run'}
[0m16:45:17.541052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '88f989f2-7ee8-4b6b-920f-2bf0d4b408e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15f192c00>]}
[0m16:45:17.557416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '88f989f2-7ee8-4b6b-920f-2bf0d4b408e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e4a510>]}
[0m16:45:17.557877 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m16:45:17.566566 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:45:17.605876 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:45:17.606146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '88f989f2-7ee8-4b6b-920f-2bf0d4b408e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15f4e2780>]}
[0m16:45:18.029536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '88f989f2-7ee8-4b6b-920f-2bf0d4b408e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15f47a900>]}
[0m16:45:18.061531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '88f989f2-7ee8-4b6b-920f-2bf0d4b408e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e4be90>]}
[0m16:45:18.061742 [info ] [MainThread]: Found 3 models, 3 sources, 459 macros
[0m16:45:18.061883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88f989f2-7ee8-4b6b-920f-2bf0d4b408e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15f2bf3e0>]}
[0m16:45:18.062504 [info ] [MainThread]: 
[0m16:45:18.062731 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:45:18.063098 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2_analytics'
[0m16:45:18.068739 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m16:45:18.068881 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m16:45:18.068986 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:45:18.912375 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.841 seconds
[0m16:45:18.917066 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m16:45:19.176347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88f989f2-7ee8-4b6b-920f-2bf0d4b408e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15f68b680>]}
[0m16:45:19.177516 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m16:45:19.178099 [info ] [MainThread]: 
[0m16:45:19.183621 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_historical
[0m16:45:19.184480 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now model.dw_project.bitcoin_historical)
[0m16:45:19.185032 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_historical
[0m16:45:19.193981 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_historical"
[0m16:45:19.195280 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_historical
[0m16:45:19.195681 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_realtime
[0m16:45:19.196095 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_historical, now model.dw_project.bitcoin_realtime)
[0m16:45:19.196423 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_realtime
[0m16:45:19.198435 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_realtime"
[0m16:45:19.199056 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_realtime
[0m16:45:19.199956 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:45:19.200167 [debug] [MainThread]: Connection 'model.dw_project.bitcoin_realtime' was properly closed.
[0m16:45:19.200376 [info ] [MainThread]: 
[0m16:45:19.200605 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.14 seconds (1.14s).
[0m16:45:19.200942 [debug] [MainThread]: Command end result
[0m16:45:19.219174 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.447782, "process_user_time": 3.107056, "process_kernel_time": 1.362877, "process_mem_max_rss": "207241216", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:45:19.219538 [debug] [MainThread]: Command `dbt run` succeeded at 16:45:19.219479 after 2.45 seconds
[0m16:45:19.219750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15f4e3ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108580da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15f3eb2c0>]}
[0m16:45:19.219940 [debug] [MainThread]: Flushing usage events
[0m16:46:01.946110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041ec950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d01310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d00380>]}


============================== 16:46:01.947305 | 05c010e4-f4fb-4422-a9cd-e5108710fa76 ==============================
[0m16:46:01.947305 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:46:01.947569 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'log_format': 'default', 'empty': 'False', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'cache_selected_only': 'False', 'printer_width': '80', 'partial_parse': 'True', 'use_colors': 'True', 'static_parser': 'True', 'quiet': 'False', 'target_path': 'None', 'invocation_command': 'dbt run', 'write_json': 'True', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'no_print': 'None', 'log_cache_events': 'False', 'fail_fast': 'False', 'introspect': 'True'}
[0m16:46:02.404856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '05c010e4-f4fb-4422-a9cd-e5108710fa76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a5f9e0>]}
[0m16:46:02.421799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '05c010e4-f4fb-4422-a9cd-e5108710fa76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x169119eb0>]}
[0m16:46:02.423078 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m16:46:02.432073 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:46:02.481737 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:46:02.482017 [debug] [MainThread]: Partial parsing: updated file: dw_project://models/output/bitcoin_summary.sql
[0m16:46:02.559689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '05c010e4-f4fb-4422-a9cd-e5108710fa76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16bad8230>]}
[0m16:46:02.591163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '05c010e4-f4fb-4422-a9cd-e5108710fa76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16b8aad20>]}
[0m16:46:02.591364 [info ] [MainThread]: Found 3 models, 3 sources, 459 macros
[0m16:46:02.591506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05c010e4-f4fb-4422-a9cd-e5108710fa76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16b9976b0>]}
[0m16:46:02.592142 [info ] [MainThread]: 
[0m16:46:02.592367 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:46:02.592707 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m16:46:02.597411 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m16:46:02.597540 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m16:46:02.597645 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:46:03.437290 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.839 seconds
[0m16:46:03.441395 [debug] [ThreadPool]: On list_lab2: Close
[0m16:46:03.666523 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m16:46:03.680782 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m16:46:03.681304 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m16:46:03.681654 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:46:04.350979 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.669 seconds
[0m16:46:04.354999 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m16:46:04.538437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05c010e4-f4fb-4422-a9cd-e5108710fa76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16b5d7320>]}
[0m16:46:04.539599 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m16:46:04.540066 [info ] [MainThread]: 
[0m16:46:04.544100 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_historical
[0m16:46:04.544798 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now model.dw_project.bitcoin_historical)
[0m16:46:04.545200 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_historical
[0m16:46:04.602294 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_historical"
[0m16:46:04.602918 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_historical
[0m16:46:04.603108 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_realtime
[0m16:46:04.603353 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_historical, now model.dw_project.bitcoin_realtime)
[0m16:46:04.603630 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_realtime
[0m16:46:04.604755 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_realtime"
[0m16:46:04.605163 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_realtime
[0m16:46:04.605489 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_summary
[0m16:46:04.605684 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.bitcoin_summary ......................... [RUN]
[0m16:46:04.605974 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_realtime, now model.dw_project.bitcoin_summary)
[0m16:46:04.606110 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_summary
[0m16:46:04.608823 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_summary"
[0m16:46:04.609152 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_summary
[0m16:46:04.620690 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_summary"
[0m16:46:04.621488 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_summary"
[0m16:46:04.621648 [debug] [Thread-1 (]: On model.dw_project.bitcoin_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_summary"} */
create or replace transient table lab2.analytics.bitcoin_summary
         as
        (WITH  __dbt__cte__bitcoin_historical as (
SELECT 
    time_period_start,
    time_period_end,
    time_open,
    time_close,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_historical
WHERE time_period_start IS NOT NULL
),  __dbt__cte__bitcoin_realtime as (
SELECT 
    time_open AS time_open_v1,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_realtime
WHERE price_close IS NOT NULL
), historical AS (
    SELECT * 
    FROM __dbt__cte__bitcoin_historical
),
realtime AS (
    SELECT * 
    FROM __dbt__cte__bitcoin_realtime
)
SELECT
    h.time_period_start AS timestamp,
    h.price_open AS historical_open,
    h.price_close AS historical_close,
    r.price_open AS realtime_open,
    r.price_close AS realtime_close
FROM historical h
LEFT JOIN realtime r 
    ON DATE_TRUNC('HOUR', h.time_period_start) = DATE_TRUNC('HOUR', r.time_open_v1)
        );
[0m16:46:04.621799 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:46:07.635447 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.013 seconds
[0m16:46:07.663479 [debug] [Thread-1 (]: On model.dw_project.bitcoin_summary: Close
[0m16:46:07.844135 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05c010e4-f4fb-4422-a9cd-e5108710fa76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10434dd00>]}
[0m16:46:07.845682 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics.bitcoin_summary .................... [[32mSUCCESS 1[0m in 3.24s]
[0m16:46:07.846756 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_summary
[0m16:46:07.848191 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:46:07.848559 [debug] [MainThread]: Connection 'model.dw_project.bitcoin_summary' was properly closed.
[0m16:46:07.848886 [info ] [MainThread]: 
[0m16:46:07.849220 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.26 seconds (5.26s).
[0m16:46:07.849928 [debug] [MainThread]: Command end result
[0m16:46:07.872287 [info ] [MainThread]: 
[0m16:46:07.872593 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:46:07.872770 [info ] [MainThread]: 
[0m16:46:07.872960 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:46:07.874919 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.9491296, "process_user_time": 1.583308, "process_kernel_time": 2.624383, "process_mem_max_rss": "207847424", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:46:07.875246 [debug] [MainThread]: Command `dbt run` succeeded at 16:46:07.875188 after 5.95 seconds
[0m16:46:07.875455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10483c170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x168088770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1685c7830>]}
[0m16:46:07.875654 [debug] [MainThread]: Flushing usage events
[0m16:54:23.904035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10698efc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c2b410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c77a10>]}


============================== 16:54:23.905468 | 3d53c471-af3f-4b2a-b528-3a8cdf12b740 ==============================
[0m16:54:23.905468 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:54:23.905733 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'write_json': 'True', 'no_print': 'None', 'target_path': 'None', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'debug': 'False', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'version_check': 'True', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'printer_width': '80', 'log_cache_events': 'False', 'introspect': 'True', 'fail_fast': 'False', 'warn_error': 'None', 'static_parser': 'True', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run'}
[0m16:54:24.828887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d53c471-af3f-4b2a-b528-3a8cdf12b740', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159d8b3b0>]}
[0m16:54:24.846397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3d53c471-af3f-4b2a-b528-3a8cdf12b740', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051843e0>]}
[0m16:54:24.846905 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m16:54:24.858648 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:54:24.914153 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:54:24.914349 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:54:24.925284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3d53c471-af3f-4b2a-b528-3a8cdf12b740', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b659f40>]}
[0m16:54:24.959004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3d53c471-af3f-4b2a-b528-3a8cdf12b740', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b7ad8b0>]}
[0m16:54:24.959231 [info ] [MainThread]: Found 3 models, 3 sources, 459 macros
[0m16:54:24.959367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d53c471-af3f-4b2a-b528-3a8cdf12b740', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b74f5f0>]}
[0m16:54:24.960039 [info ] [MainThread]: 
[0m16:54:24.960288 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:54:24.960639 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m16:54:24.966248 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m16:54:24.966388 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m16:54:24.966488 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:54:25.808557 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.842 seconds
[0m16:54:25.811300 [debug] [ThreadPool]: On list_lab2: Close
[0m16:54:26.015575 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m16:54:26.029653 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m16:54:26.030178 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m16:54:26.030494 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:54:26.720216 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.689 seconds
[0m16:54:26.727018 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m16:54:26.913838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d53c471-af3f-4b2a-b528-3a8cdf12b740', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b859460>]}
[0m16:54:26.914912 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m16:54:26.915285 [info ] [MainThread]: 
[0m16:54:26.918990 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_historical
[0m16:54:26.919659 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now model.dw_project.bitcoin_historical)
[0m16:54:26.920052 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_historical
[0m16:54:26.927519 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_historical"
[0m16:54:26.929012 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_historical
[0m16:54:26.929328 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_realtime
[0m16:54:26.929663 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_historical, now model.dw_project.bitcoin_realtime)
[0m16:54:26.929896 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_realtime
[0m16:54:26.931739 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_realtime"
[0m16:54:26.932834 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_realtime
[0m16:54:26.933395 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_summary
[0m16:54:26.933771 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.bitcoin_summary ......................... [RUN]
[0m16:54:26.934053 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_realtime, now model.dw_project.bitcoin_summary)
[0m16:54:26.934266 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_summary
[0m16:54:26.938715 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_summary"
[0m16:54:26.939271 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_summary
[0m16:54:26.955570 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_summary"
[0m16:54:26.956635 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_summary"
[0m16:54:26.956835 [debug] [Thread-1 (]: On model.dw_project.bitcoin_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_summary"} */
create or replace transient table lab2.analytics.bitcoin_summary
         as
        (WITH  __dbt__cte__bitcoin_historical as (
SELECT 
    time_period_start,
    time_period_end,
    time_open,
    time_close,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_historical
WHERE time_period_start IS NOT NULL
),  __dbt__cte__bitcoin_realtime as (
SELECT 
    time_open AS time_open_v1,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_realtime
WHERE price_close IS NOT NULL
), historical AS (
    SELECT * 
    FROM __dbt__cte__bitcoin_historical
),
realtime AS (
    SELECT * 
    FROM __dbt__cte__bitcoin_realtime
)
SELECT
    h.time_period_start AS timestamp,
    h.price_open AS historical_open,
    h.price_close AS historical_close,
    r.price_open AS realtime_open,
    r.price_close AS realtime_close
FROM historical h
LEFT JOIN realtime r 
    ON DATE_TRUNC('HOUR', h.time_period_start) = DATE_TRUNC('HOUR', r.time_open_v1)
        );
[0m16:54:26.957012 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:54:29.913207 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.956 seconds
[0m16:54:29.938123 [debug] [Thread-1 (]: On model.dw_project.bitcoin_summary: Close
[0m16:54:30.133146 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d53c471-af3f-4b2a-b528-3a8cdf12b740', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060a9f40>]}
[0m16:54:30.134520 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics.bitcoin_summary .................... [[32mSUCCESS 1[0m in 3.20s]
[0m16:54:30.135625 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_summary
[0m16:54:30.137184 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:54:30.137540 [debug] [MainThread]: Connection 'model.dw_project.bitcoin_summary' was properly closed.
[0m16:54:30.137862 [info ] [MainThread]: 
[0m16:54:30.138204 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.18 seconds (5.18s).
[0m16:54:30.138876 [debug] [MainThread]: Command end result
[0m16:54:30.161526 [info ] [MainThread]: 
[0m16:54:30.161784 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:54:30.161953 [info ] [MainThread]: 
[0m16:54:30.162135 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:54:30.164149 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.285052, "process_user_time": 2.938858, "process_kernel_time": 1.339686, "process_mem_max_rss": "203751424", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:54:30.164546 [debug] [MainThread]: Command `dbt run` succeeded at 16:54:30.164487 after 6.29 seconds
[0m16:54:30.164770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10658c170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065eefc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b3946e0>]}
[0m16:54:30.164961 [debug] [MainThread]: Flushing usage events
[0m16:59:08.965841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104af2330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106259490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106259520>]}


============================== 16:59:08.967646 | dd353b86-e8d6-4d50-b4d4-83e4fc8ab64b ==============================
[0m16:59:08.967646 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:59:08.967943 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'indirect_selection': 'eager', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'partial_parse': 'True', 'introspect': 'True', 'quiet': 'False', 'use_colors': 'True', 'fail_fast': 'False', 'warn_error': 'None', 'printer_width': '80', 'static_parser': 'True', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'target_path': 'None', 'use_experimental_parser': 'False', 'empty': 'False', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'debug': 'False', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'invocation_command': 'dbt run'}
[0m16:59:10.035435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd353b86-e8d6-4d50-b4d4-83e4fc8ab64b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15a447860>]}
[0m16:59:10.051914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dd353b86-e8d6-4d50-b4d4-83e4fc8ab64b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061e6b10>]}
[0m16:59:10.052372 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m16:59:10.061120 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:59:10.114677 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:59:10.114982 [debug] [MainThread]: Partial parsing: updated file: dw_project://models/output/bitcoin_summary.sql
[0m16:59:10.198638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dd353b86-e8d6-4d50-b4d4-83e4fc8ab64b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d82750>]}
[0m16:59:10.231795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dd353b86-e8d6-4d50-b4d4-83e4fc8ab64b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15e9b70e0>]}
[0m16:59:10.232003 [info ] [MainThread]: Found 3 models, 3 sources, 459 macros
[0m16:59:10.232147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd353b86-e8d6-4d50-b4d4-83e4fc8ab64b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d32ff0>]}
[0m16:59:10.232807 [info ] [MainThread]: 
[0m16:59:10.233053 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:59:10.233405 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m16:59:10.238083 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m16:59:10.238216 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m16:59:10.238324 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:59:11.309724 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.071 seconds
[0m16:59:11.314528 [debug] [ThreadPool]: On list_lab2: Close
[0m16:59:11.494291 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m16:59:11.506101 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m16:59:11.506631 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m16:59:11.506908 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:59:12.276750 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.769 seconds
[0m16:59:12.280919 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m16:59:12.484671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd353b86-e8d6-4d50-b4d4-83e4fc8ab64b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15e9ca990>]}
[0m16:59:12.485683 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m16:59:12.486124 [info ] [MainThread]: 
[0m16:59:12.490808 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_historical
[0m16:59:12.491631 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now model.dw_project.bitcoin_historical)
[0m16:59:12.492000 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_historical
[0m16:59:12.547852 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_historical"
[0m16:59:12.548545 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_historical
[0m16:59:12.548754 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_realtime
[0m16:59:12.548962 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_historical, now model.dw_project.bitcoin_realtime)
[0m16:59:12.549167 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_realtime
[0m16:59:12.550179 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_realtime"
[0m16:59:12.550872 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_realtime
[0m16:59:12.551225 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_summary
[0m16:59:12.551512 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.bitcoin_summary ......................... [RUN]
[0m16:59:12.551799 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_realtime, now model.dw_project.bitcoin_summary)
[0m16:59:12.551945 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_summary
[0m16:59:12.554721 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_summary"
[0m16:59:12.555002 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_summary
[0m16:59:12.566619 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_summary"
[0m16:59:12.567361 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_summary"
[0m16:59:12.567527 [debug] [Thread-1 (]: On model.dw_project.bitcoin_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_summary"} */
create or replace transient table lab2.analytics.bitcoin_summary
         as
        (WITH  __dbt__cte__bitcoin_historical as (
SELECT 
    time_period_start,
    time_period_end,
    time_open,
    time_close,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_historical
WHERE time_period_start IS NOT NULL
),  __dbt__cte__bitcoin_realtime as (
SELECT 
    time_open AS time_open_v1,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_realtime
WHERE price_close IS NOT NULL
), historical AS (
    SELECT * 
    FROM __dbt__cte__bitcoin_historical
),
realtime AS (
    SELECT * 
    FROM __dbt__cte__bitcoin_realtime
)
SELECT
    h.time_period_start AS timestamp,
    h.price_open AS historical_open,
    h.price_close AS historical_close,
    r.price_open AS realtime_open,
    r.price_close AS realtime_close
FROM historical h
LEFT JOIN realtime r 
    ON DATE_TRUNC('HOUR', h.time_period_start) = DATE_TRUNC('HOUR', r.time_open)
        );
[0m16:59:12.567682 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:59:12.989002 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b898bb-0003-60e9-0003-437a000dc172
[0m16:59:12.989967 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 44 at position 68
invalid identifier 'R.TIME_OPEN'
[0m16:59:12.990654 [debug] [Thread-1 (]: On model.dw_project.bitcoin_summary: Close
[0m16:59:13.195412 [debug] [Thread-1 (]: Database Error in model bitcoin_summary (models/output/bitcoin_summary.sql)
  000904 (42000): SQL compilation error: error line 44 at position 68
  invalid identifier 'R.TIME_OPEN'
  compiled code at target/run/dw_project/models/output/bitcoin_summary.sql
[0m16:59:13.197087 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd353b86-e8d6-4d50-b4d4-83e4fc8ab64b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068a9e50>]}
[0m16:59:13.197666 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model analytics.bitcoin_summary ................ [[31mERROR[0m in 0.64s]
[0m16:59:13.198130 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_summary
[0m16:59:13.199215 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:59:13.199468 [debug] [MainThread]: Connection 'model.dw_project.bitcoin_summary' was properly closed.
[0m16:59:13.199694 [info ] [MainThread]: 
[0m16:59:13.199944 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.97 seconds (2.97s).
[0m16:59:13.200424 [debug] [MainThread]: Command end result
[0m16:59:13.219657 [info ] [MainThread]: 
[0m16:59:13.219905 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:59:13.220062 [info ] [MainThread]: 
[0m16:59:13.220249 [error] [MainThread]:   Database Error in model bitcoin_summary (models/output/bitcoin_summary.sql)
  000904 (42000): SQL compilation error: error line 44 at position 68
  invalid identifier 'R.TIME_OPEN'
  compiled code at target/run/dw_project/models/output/bitcoin_summary.sql
[0m16:59:13.220403 [info ] [MainThread]: 
[0m16:59:13.220563 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:59:13.222310 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.2848196, "process_user_time": 2.07848, "process_kernel_time": 2.464214, "process_mem_max_rss": "206798848", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:59:13.222594 [debug] [MainThread]: Command `dbt run` failed at 16:59:13.222546 after 4.29 seconds
[0m16:59:13.222782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10652c5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15e92c260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15d782990>]}
[0m16:59:13.222958 [debug] [MainThread]: Flushing usage events
[0m16:59:36.332437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106775640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065ed460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065ed3d0>]}


============================== 16:59:36.333586 | e1b0acc3-d648-4058-bf63-c429b737bc7b ==============================
[0m16:59:36.333586 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:59:36.333848 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'log_format': 'default', 'fail_fast': 'False', 'version_check': 'True', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'static_parser': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'use_colors': 'True', 'printer_width': '80', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'debug': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt run', 'log_cache_events': 'False', 'write_json': 'True', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'empty': 'False', 'quiet': 'False'}
[0m16:59:36.783547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e1b0acc3-d648-4058-bf63-c429b737bc7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fd5c3e0>]}
[0m16:59:36.800191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e1b0acc3-d648-4058-bf63-c429b737bc7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10731f3b0>]}
[0m16:59:36.801333 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m16:59:36.809787 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:59:36.862643 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:59:36.862916 [debug] [MainThread]: Partial parsing: updated file: dw_project://models/input/bitcoin_realtime.sql
[0m16:59:36.941072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e1b0acc3-d648-4058-bf63-c429b737bc7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13bed06b0>]}
[0m16:59:36.972366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e1b0acc3-d648-4058-bf63-c429b737bc7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13bebb050>]}
[0m16:59:36.972566 [info ] [MainThread]: Found 3 models, 3 sources, 459 macros
[0m16:59:36.972715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1b0acc3-d648-4058-bf63-c429b737bc7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13becb8c0>]}
[0m16:59:36.973356 [info ] [MainThread]: 
[0m16:59:36.973596 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:59:36.973937 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m16:59:36.978628 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m16:59:36.978771 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m16:59:36.978872 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:59:37.700921 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.722 seconds
[0m16:59:37.702988 [debug] [ThreadPool]: On list_lab2: Close
[0m16:59:37.881694 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m16:59:37.890995 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m16:59:37.891318 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m16:59:37.891477 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:59:38.473544 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.582 seconds
[0m16:59:38.475925 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m16:59:38.660024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1b0acc3-d648-4058-bf63-c429b737bc7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12bf83dd0>]}
[0m16:59:38.661350 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m16:59:38.661916 [info ] [MainThread]: 
[0m16:59:38.665821 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_historical
[0m16:59:38.666430 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now model.dw_project.bitcoin_historical)
[0m16:59:38.666858 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_historical
[0m16:59:38.722150 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_historical"
[0m16:59:38.722896 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_historical
[0m16:59:38.723119 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_realtime
[0m16:59:38.723361 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_historical, now model.dw_project.bitcoin_realtime)
[0m16:59:38.723600 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_realtime
[0m16:59:38.724874 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_realtime"
[0m16:59:38.725353 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_realtime
[0m16:59:38.725759 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_summary
[0m16:59:38.726045 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.bitcoin_summary ......................... [RUN]
[0m16:59:38.726341 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_realtime, now model.dw_project.bitcoin_summary)
[0m16:59:38.726494 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_summary
[0m16:59:38.729397 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_summary"
[0m16:59:38.729681 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_summary
[0m16:59:38.741882 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_summary"
[0m16:59:38.742642 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_summary"
[0m16:59:38.742809 [debug] [Thread-1 (]: On model.dw_project.bitcoin_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_summary"} */
create or replace transient table lab2.analytics.bitcoin_summary
         as
        (WITH  __dbt__cte__bitcoin_historical as (
SELECT 
    time_period_start,
    time_period_end,
    time_open,
    time_close,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_historical
WHERE time_period_start IS NOT NULL
),  __dbt__cte__bitcoin_realtime as (
SELECT 
    time_open,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_realtime
WHERE price_close IS NOT NULL
), historical AS (
    SELECT * 
    FROM __dbt__cte__bitcoin_historical
),
realtime AS (
    SELECT * 
    FROM __dbt__cte__bitcoin_realtime
)
SELECT
    h.time_period_start AS timestamp,
    h.price_open AS historical_open,
    h.price_close AS historical_close,
    r.price_open AS realtime_open,
    r.price_close AS realtime_close
FROM historical h
LEFT JOIN realtime r 
    ON DATE_TRUNC('HOUR', h.time_period_start) = DATE_TRUNC('HOUR', r.time_open)
        );
[0m16:59:38.742961 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:59:41.187798 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.444 seconds
[0m16:59:41.228083 [debug] [Thread-1 (]: On model.dw_project.bitcoin_summary: Close
[0m16:59:41.407238 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1b0acc3-d648-4058-bf63-c429b737bc7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c39c10>]}
[0m16:59:41.409065 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics.bitcoin_summary .................... [[32mSUCCESS 1[0m in 2.68s]
[0m16:59:41.410291 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_summary
[0m16:59:41.412348 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:59:41.412788 [debug] [MainThread]: Connection 'model.dw_project.bitcoin_summary' was properly closed.
[0m16:59:41.413203 [info ] [MainThread]: 
[0m16:59:41.413620 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.44 seconds (4.44s).
[0m16:59:41.414419 [debug] [MainThread]: Command end result
[0m16:59:41.441811 [info ] [MainThread]: 
[0m16:59:41.442139 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:59:41.442329 [info ] [MainThread]: 
[0m16:59:41.442517 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:59:41.445241 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.1329417, "process_user_time": 1.647478, "process_kernel_time": 2.627849, "process_mem_max_rss": "208142336", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:59:41.445643 [debug] [MainThread]: Command `dbt run` succeeded at 16:59:41.445582 after 5.13 seconds
[0m16:59:41.445874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107198170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1385cbe30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10684ff80>]}
[0m16:59:41.446081 [debug] [MainThread]: Flushing usage events
[0m17:03:13.027400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c5b4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041154c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041153d0>]}


============================== 17:03:13.029079 | 07968ddc-1206-407b-a87c-e687e6deb310 ==============================
[0m17:03:13.029079 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:03:13.029411 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'debug': 'False', 'static_parser': 'True', 'target_path': 'None', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'indirect_selection': 'eager', 'version_check': 'True', 'log_cache_events': 'False', 'introspect': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'printer_width': '80', 'quiet': 'False', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'partial_parse': 'True', 'write_json': 'True', 'fail_fast': 'False', 'use_colors': 'True'}
[0m17:03:14.102564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '07968ddc-1206-407b-a87c-e687e6deb310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b99a840>]}
[0m17:03:14.119442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '07968ddc-1206-407b-a87c-e687e6deb310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15baa3650>]}
[0m17:03:14.119925 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:03:14.128892 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:03:14.181551 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:03:14.181834 [debug] [MainThread]: Partial parsing: updated file: dw_project://models/output/bitcoin_summary.sql
[0m17:03:14.262102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '07968ddc-1206-407b-a87c-e687e6deb310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a6ba40>]}
[0m17:03:14.295215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '07968ddc-1206-407b-a87c-e687e6deb310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15bfbaf60>]}
[0m17:03:14.295427 [info ] [MainThread]: Found 3 models, 3 sources, 459 macros
[0m17:03:14.295576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07968ddc-1206-407b-a87c-e687e6deb310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15bbaa7b0>]}
[0m17:03:14.296240 [info ] [MainThread]: 
[0m17:03:14.296483 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:03:14.296830 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m17:03:14.301589 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m17:03:14.301727 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m17:03:14.301831 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:03:15.130343 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.828 seconds
[0m17:03:15.133096 [debug] [ThreadPool]: On list_lab2: Close
[0m17:03:15.336225 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m17:03:15.348857 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m17:03:15.349658 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m17:03:15.350015 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:03:16.117880 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.767 seconds
[0m17:03:16.124589 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m17:03:16.764169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07968ddc-1206-407b-a87c-e687e6deb310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b9bbb60>]}
[0m17:03:16.765722 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m17:03:16.766322 [info ] [MainThread]: 
[0m17:03:16.771484 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_historical
[0m17:03:16.772186 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now model.dw_project.bitcoin_historical)
[0m17:03:16.772602 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_historical
[0m17:03:16.828996 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_historical"
[0m17:03:16.829715 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_historical
[0m17:03:16.829921 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_realtime
[0m17:03:16.830137 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_historical, now model.dw_project.bitcoin_realtime)
[0m17:03:16.830325 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_realtime
[0m17:03:16.831444 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_realtime"
[0m17:03:16.832245 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_realtime
[0m17:03:16.832444 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_summary
[0m17:03:16.832648 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.bitcoin_summary ......................... [RUN]
[0m17:03:16.832898 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_realtime, now model.dw_project.bitcoin_summary)
[0m17:03:16.833071 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_summary
[0m17:03:16.833725 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_summary"
[0m17:03:16.834000 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_summary
[0m17:03:16.845804 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_summary"
[0m17:03:16.846427 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_summary"
[0m17:03:16.846590 [debug] [Thread-1 (]: On model.dw_project.bitcoin_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_summary"} */
create or replace transient table lab2.analytics.bitcoin_summary
         as
        (WITH historical AS (
    SELECT time_period_start, price_open, price_close 
    FROM bitcoin_historical
),
realtime AS (
    SELECT time_open, price_open, price_close 
    FROM bitcoin_realtime
)
SELECT
    h.time_period_start AS timestamp,
    h.price_open AS historical_open,
    h.price_close AS historical_close,
    r.price_open AS realtime_open,
    r.price_close AS realtime_close
FROM historical h
LEFT JOIN realtime r 
    ON DATE_TRUNC('HOUR', h.time_period_start) = DATE_TRUNC('HOUR', r.time_open)
LIMIT 10;
[0m17:03:16.846731 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:03:17.428681 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b898bf-0003-6135-0003-437a000e314a
[0m17:03:17.429444 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 20 at position 8 unexpected ';'.
[0m17:03:17.430127 [debug] [Thread-1 (]: On model.dw_project.bitcoin_summary: Close
[0m17:03:17.633927 [debug] [Thread-1 (]: Database Error in model bitcoin_summary (models/output/bitcoin_summary.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 8 unexpected ';'.
  compiled code at target/run/dw_project/models/output/bitcoin_summary.sql
[0m17:03:17.637142 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07968ddc-1206-407b-a87c-e687e6deb310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15c01e960>]}
[0m17:03:17.638156 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model analytics.bitcoin_summary ................ [[31mERROR[0m in 0.80s]
[0m17:03:17.638917 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_summary
[0m17:03:17.640658 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:03:17.641072 [debug] [MainThread]: Connection 'model.dw_project.bitcoin_summary' was properly closed.
[0m17:03:17.641404 [info ] [MainThread]: 
[0m17:03:17.641757 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.34 seconds (3.34s).
[0m17:03:17.642482 [debug] [MainThread]: Command end result
[0m17:03:17.668446 [info ] [MainThread]: 
[0m17:03:17.668781 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:03:17.668959 [info ] [MainThread]: 
[0m17:03:17.669176 [error] [MainThread]:   Database Error in model bitcoin_summary (models/output/bitcoin_summary.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 8 unexpected ';'.
  compiled code at target/run/dw_project/models/output/bitcoin_summary.sql
[0m17:03:17.669351 [info ] [MainThread]: 
[0m17:03:17.669525 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:03:17.671398 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.670898, "process_user_time": 2.04278, "process_kernel_time": 2.612628, "process_mem_max_rss": "207765504", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:03:17.671697 [debug] [MainThread]: Command `dbt run` failed at 17:03:17.671645 after 4.67 seconds
[0m17:03:17.671906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15bfdf740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15c0a1160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c3e5a0>]}
[0m17:03:17.672103 [debug] [MainThread]: Flushing usage events
[0m17:03:33.210655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055634a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e86600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a3b9b0>]}


============================== 17:03:33.212094 | 45602ac1-4880-40d4-872d-d178a1b9d0a5 ==============================
[0m17:03:33.212094 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:03:33.212379 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'empty': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'static_parser': 'True', 'debug': 'False', 'target_path': 'None', 'use_colors': 'True', 'log_cache_events': 'False', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'log_format': 'default', 'printer_width': '80', 'write_json': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'introspect': 'True', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs'}
[0m17:03:33.780129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '45602ac1-4880-40d4-872d-d178a1b9d0a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054aef90>]}
[0m17:03:33.796740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '45602ac1-4880-40d4-872d-d178a1b9d0a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1251c6510>]}
[0m17:03:33.797185 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:03:33.806217 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:03:33.855806 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:03:33.856082 [debug] [MainThread]: Partial parsing: updated file: dw_project://models/output/bitcoin_summary.sql
[0m17:03:33.934246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '45602ac1-4880-40d4-872d-d178a1b9d0a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1313f3f50>]}
[0m17:03:33.967834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '45602ac1-4880-40d4-872d-d178a1b9d0a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1310a8110>]}
[0m17:03:33.968083 [info ] [MainThread]: Found 3 models, 3 sources, 459 macros
[0m17:03:33.968234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45602ac1-4880-40d4-872d-d178a1b9d0a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1311a3620>]}
[0m17:03:33.968891 [info ] [MainThread]: 
[0m17:03:33.969130 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:03:33.969490 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m17:03:33.974128 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m17:03:33.974257 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m17:03:33.974356 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:03:34.952124 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.977 seconds
[0m17:03:34.958271 [debug] [ThreadPool]: On list_lab2: Close
[0m17:03:35.156856 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m17:03:35.170616 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m17:03:35.171326 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m17:03:35.171805 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:03:35.894962 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.723 seconds
[0m17:03:35.898323 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m17:03:36.079061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45602ac1-4880-40d4-872d-d178a1b9d0a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1313925d0>]}
[0m17:03:36.079591 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m17:03:36.079857 [info ] [MainThread]: 
[0m17:03:36.082406 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_historical
[0m17:03:36.083048 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now model.dw_project.bitcoin_historical)
[0m17:03:36.083558 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_historical
[0m17:03:36.129844 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_historical"
[0m17:03:36.130566 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_historical
[0m17:03:36.130771 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_realtime
[0m17:03:36.130995 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_historical, now model.dw_project.bitcoin_realtime)
[0m17:03:36.131188 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_realtime
[0m17:03:36.132266 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_realtime"
[0m17:03:36.132743 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_realtime
[0m17:03:36.132917 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_summary
[0m17:03:36.133109 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.bitcoin_summary ......................... [RUN]
[0m17:03:36.133374 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_realtime, now model.dw_project.bitcoin_summary)
[0m17:03:36.133555 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_summary
[0m17:03:36.134215 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_summary"
[0m17:03:36.134493 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_summary
[0m17:03:36.145913 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_summary"
[0m17:03:36.146549 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_summary"
[0m17:03:36.146709 [debug] [Thread-1 (]: On model.dw_project.bitcoin_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_summary"} */
create or replace transient table lab2.analytics.bitcoin_summary
         as
        (WITH historical AS (
    SELECT time_period_start, price_open, price_close 
    FROM bitcoin_historical
),
realtime AS (
    SELECT time_open, price_open, price_close 
    FROM bitcoin_realtime
)
SELECT
    h.time_period_start AS timestamp,
    h.price_open AS historical_open,
    h.price_close AS historical_close,
    r.price_open AS realtime_open,
    r.price_close AS realtime_close
FROM historical h
LEFT JOIN realtime r 
    ON DATE_TRUNC('HOUR', h.time_period_start) = DATE_TRUNC('HOUR', r.time_open)
LIMIT 10
        );
[0m17:03:36.146849 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:03:36.684372 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b898bf-0003-6075-0003-437a000e115a
[0m17:03:36.684965 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'BITCOIN_HISTORICAL' does not exist or not authorized.
[0m17:03:36.685475 [debug] [Thread-1 (]: On model.dw_project.bitcoin_summary: Close
[0m17:03:36.867950 [debug] [Thread-1 (]: Database Error in model bitcoin_summary (models/output/bitcoin_summary.sql)
  002003 (42S02): SQL compilation error:
  Object 'BITCOIN_HISTORICAL' does not exist or not authorized.
  compiled code at target/run/dw_project/models/output/bitcoin_summary.sql
[0m17:03:36.870190 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45602ac1-4880-40d4-872d-d178a1b9d0a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1315cacf0>]}
[0m17:03:36.870912 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model analytics.bitcoin_summary ................ [[31mERROR[0m in 0.74s]
[0m17:03:36.871563 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_summary
[0m17:03:36.872687 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:03:36.873030 [debug] [MainThread]: Connection 'model.dw_project.bitcoin_summary' was properly closed.
[0m17:03:36.873352 [info ] [MainThread]: 
[0m17:03:36.873694 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.90 seconds (2.90s).
[0m17:03:36.874307 [debug] [MainThread]: Command end result
[0m17:03:36.888086 [info ] [MainThread]: 
[0m17:03:36.888376 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:03:36.888520 [info ] [MainThread]: 
[0m17:03:36.888686 [error] [MainThread]:   Database Error in model bitcoin_summary (models/output/bitcoin_summary.sql)
  002003 (42S02): SQL compilation error:
  Object 'BITCOIN_HISTORICAL' does not exist or not authorized.
  compiled code at target/run/dw_project/models/output/bitcoin_summary.sql
[0m17:03:36.888812 [info ] [MainThread]: 
[0m17:03:36.888940 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:03:36.890515 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.7023056, "process_user_time": 2.689927, "process_kernel_time": 1.527259, "process_mem_max_rss": "208945152", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:03:36.890741 [debug] [MainThread]: Command `dbt run` failed at 17:03:36.890703 after 3.70 seconds
[0m17:03:36.890912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1313b5940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c9c950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1310f0290>]}
[0m17:03:36.891051 [debug] [MainThread]: Flushing usage events
[0m17:04:15.397488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104902d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bebce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104beb980>]}


============================== 17:04:15.398597 | d20be1a0-8e0f-482a-8e13-681af998a0b6 ==============================
[0m17:04:15.398597 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:04:15.398857 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'partial_parse': 'True', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'use_colors': 'True', 'write_json': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'no_print': 'None', 'static_parser': 'True', 'debug': 'False', 'use_experimental_parser': 'False', 'warn_error': 'None', 'version_check': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'empty': 'False', 'cache_selected_only': 'False'}
[0m17:04:15.852637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd20be1a0-8e0f-482a-8e13-681af998a0b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bccf50>]}
[0m17:04:15.869487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd20be1a0-8e0f-482a-8e13-681af998a0b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104902db0>]}
[0m17:04:15.869977 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:04:15.877755 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:04:15.928537 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:04:15.928817 [debug] [MainThread]: Partial parsing: updated file: dw_project://models/output/bitcoin_summary.sql
[0m17:04:16.007594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd20be1a0-8e0f-482a-8e13-681af998a0b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140cf7fb0>]}
[0m17:04:16.039593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd20be1a0-8e0f-482a-8e13-681af998a0b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137fe3440>]}
[0m17:04:16.039803 [info ] [MainThread]: Found 3 models, 3 sources, 459 macros
[0m17:04:16.039955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd20be1a0-8e0f-482a-8e13-681af998a0b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1409dcda0>]}
[0m17:04:16.040605 [info ] [MainThread]: 
[0m17:04:16.040844 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:04:16.041199 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m17:04:16.046261 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m17:04:16.046406 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m17:04:16.046515 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:04:16.750929 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.704 seconds
[0m17:04:16.753487 [debug] [ThreadPool]: On list_lab2: Close
[0m17:04:16.932927 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m17:04:16.941367 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m17:04:16.941668 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m17:04:16.941895 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:04:17.524212 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.582 seconds
[0m17:04:17.527925 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m17:04:17.700479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd20be1a0-8e0f-482a-8e13-681af998a0b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bb4da0>]}
[0m17:04:17.701869 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m17:04:17.702531 [info ] [MainThread]: 
[0m17:04:17.708494 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_historical
[0m17:04:17.709358 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now model.dw_project.bitcoin_historical)
[0m17:04:17.709907 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_historical
[0m17:04:17.772966 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_historical"
[0m17:04:17.773757 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_historical
[0m17:04:17.773964 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_realtime
[0m17:04:17.774196 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_historical, now model.dw_project.bitcoin_realtime)
[0m17:04:17.774395 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_realtime
[0m17:04:17.775543 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_realtime"
[0m17:04:17.776048 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_realtime
[0m17:04:17.776217 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_summary
[0m17:04:17.776466 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.bitcoin_summary ......................... [RUN]
[0m17:04:17.776700 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_realtime, now model.dw_project.bitcoin_summary)
[0m17:04:17.776848 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_summary
[0m17:04:17.777498 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_summary"
[0m17:04:17.777755 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_summary
[0m17:04:17.789404 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_summary"
[0m17:04:17.789983 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_summary"
[0m17:04:17.790145 [debug] [Thread-1 (]: On model.dw_project.bitcoin_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_summary"} */
create or replace transient table lab2.analytics.bitcoin_summary
         as
        (WITH historical AS (
    SELECT time_period_start, price_open, price_close 
    FROM raw_data.bitcoin_historical
),
realtime AS (
    SELECT time_open, price_open, price_close 
    FROM raw_data.bitcoin_realtime
)
SELECT
    h.time_period_start AS timestamp,
    h.price_open AS historical_open,
    h.price_close AS historical_close,
    r.price_open AS realtime_open,
    r.price_close AS realtime_close
FROM historical h
LEFT JOIN realtime r 
    ON DATE_TRUNC('HOUR', h.time_period_start) = DATE_TRUNC('HOUR', r.time_open)
LIMIT 10
        );
[0m17:04:17.790282 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:04:20.351893 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.561 seconds
[0m17:04:20.382705 [debug] [Thread-1 (]: On model.dw_project.bitcoin_summary: Close
[0m17:04:20.568353 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd20be1a0-8e0f-482a-8e13-681af998a0b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140ee1580>]}
[0m17:04:20.570229 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics.bitcoin_summary .................... [[32mSUCCESS 1[0m in 2.79s]
[0m17:04:20.571211 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_summary
[0m17:04:20.572798 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:04:20.573199 [debug] [MainThread]: Connection 'model.dw_project.bitcoin_summary' was properly closed.
[0m17:04:20.573496 [info ] [MainThread]: 
[0m17:04:20.573861 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.53 seconds (4.53s).
[0m17:04:20.574672 [debug] [MainThread]: Command end result
[0m17:04:20.600761 [info ] [MainThread]: 
[0m17:04:20.601165 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:04:20.601357 [info ] [MainThread]: 
[0m17:04:20.601553 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:04:20.603877 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.226819, "process_user_time": 2.046897, "process_kernel_time": 2.218991, "process_mem_max_rss": "206913536", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:04:20.604284 [debug] [MainThread]: Command `dbt run` succeeded at 17:04:20.604214 after 5.23 seconds
[0m17:04:20.604536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bcc920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10465ede0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140a7f050>]}
[0m17:04:20.604753 [debug] [MainThread]: Flushing usage events
[0m17:05:44.427029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077279e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10715d3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10715d430>]}


============================== 17:05:44.428424 | 814c78bf-e601-45c3-934b-e7d5a50af546 ==============================
[0m17:05:44.428424 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:05:44.428695 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'empty': 'False', 'version_check': 'True', 'write_json': 'True', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_colors': 'True', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'partial_parse': 'True', 'quiet': 'False', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'no_print': 'None', 'indirect_selection': 'eager', 'printer_width': '80', 'warn_error': 'None', 'introspect': 'True'}
[0m17:05:45.326794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '814c78bf-e601-45c3-934b-e7d5a50af546', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14605dc40>]}
[0m17:05:45.344393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '814c78bf-e601-45c3-934b-e7d5a50af546', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145ab83b0>]}
[0m17:05:45.344972 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:05:45.354009 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:05:45.410368 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:05:45.410690 [debug] [MainThread]: Partial parsing: updated file: dw_project://models/output/bitcoin_summary.sql
[0m17:05:45.498468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '814c78bf-e601-45c3-934b-e7d5a50af546', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1466d8320>]}
[0m17:05:45.534047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '814c78bf-e601-45c3-934b-e7d5a50af546', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1466b6ed0>]}
[0m17:05:45.534315 [info ] [MainThread]: Found 3 models, 3 sources, 459 macros
[0m17:05:45.534465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '814c78bf-e601-45c3-934b-e7d5a50af546', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1463e9dc0>]}
[0m17:05:45.535156 [info ] [MainThread]: 
[0m17:05:45.535408 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:05:45.535774 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m17:05:45.540845 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m17:05:45.541007 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m17:05:45.541119 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:05:46.263092 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.721 seconds
[0m17:05:46.265286 [debug] [ThreadPool]: On list_lab2: Close
[0m17:05:46.444532 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m17:05:46.457128 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m17:05:46.457628 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m17:05:46.457870 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:05:47.042106 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.584 seconds
[0m17:05:47.044363 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m17:05:47.218637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '814c78bf-e601-45c3-934b-e7d5a50af546', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107575160>]}
[0m17:05:47.219802 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m17:05:47.220398 [info ] [MainThread]: 
[0m17:05:47.225487 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_historical
[0m17:05:47.226113 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now model.dw_project.bitcoin_historical)
[0m17:05:47.226562 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_historical
[0m17:05:47.280915 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_historical"
[0m17:05:47.281740 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_historical
[0m17:05:47.281967 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_realtime
[0m17:05:47.282239 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_historical, now model.dw_project.bitcoin_realtime)
[0m17:05:47.282545 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_realtime
[0m17:05:47.283786 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_realtime"
[0m17:05:47.284531 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_realtime
[0m17:05:47.284933 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_summary
[0m17:05:47.285159 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.bitcoin_summary ......................... [RUN]
[0m17:05:47.285455 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_realtime, now model.dw_project.bitcoin_summary)
[0m17:05:47.285607 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_summary
[0m17:05:47.289168 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_summary"
[0m17:05:47.289454 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_summary
[0m17:05:47.301557 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_summary"
[0m17:05:47.302373 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_summary"
[0m17:05:47.302540 [debug] [Thread-1 (]: On model.dw_project.bitcoin_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_summary"} */
create or replace transient table lab2.analytics.bitcoin_summary
         as
        (WITH  __dbt__cte__bitcoin_historical as (
SELECT 
    time_period_start,
    time_period_end,
    time_open,
    time_close,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_historical
WHERE time_period_start IS NOT NULL
),  __dbt__cte__bitcoin_realtime as (
SELECT 
    time_open,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_realtime
WHERE price_close IS NOT NULL
), historical AS (
    SELECT 
        DATE_TRUNC('HOUR', time_period_start) AS truncated_hour,
        price_open AS historical_open,
        price_close AS historical_close
    FROM __dbt__cte__bitcoin_historical
),
realtime AS (
    SELECT 
        DATE_TRUNC('HOUR', time_open) AS truncated_hour,
        price_open AS realtime_open,
        price_close AS realtime_close
    FROM __dbt__cte__bitcoin_realtime
)
SELECT
    h.truncated_hour AS timestamp,
    h.historical_open,
    h.historical_close,
    r.realtime_open,
    r.realtime_close
FROM historical h
LEFT JOIN realtime r 
    ON h.truncated_hour = r.truncated_hour;
[0m17:05:47.302693 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:05:48.120170 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b898c1-0003-60f2-0003-437a000e2172
[0m17:05:48.120967 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 50 at position 42 unexpected ';'.
[0m17:05:48.121558 [debug] [Thread-1 (]: On model.dw_project.bitcoin_summary: Close
[0m17:05:48.310634 [debug] [Thread-1 (]: Database Error in model bitcoin_summary (models/output/bitcoin_summary.sql)
  001003 (42000): SQL compilation error:
  syntax error line 50 at position 42 unexpected ';'.
  compiled code at target/run/dw_project/models/output/bitcoin_summary.sql
[0m17:05:48.313082 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '814c78bf-e601-45c3-934b-e7d5a50af546', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1471c4590>]}
[0m17:05:48.313920 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model analytics.bitcoin_summary ................ [[31mERROR[0m in 1.03s]
[0m17:05:48.314663 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_summary
[0m17:05:48.315920 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:05:48.316347 [debug] [MainThread]: Connection 'model.dw_project.bitcoin_summary' was properly closed.
[0m17:05:48.316702 [info ] [MainThread]: 
[0m17:05:48.317124 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.78 seconds (2.78s).
[0m17:05:48.317808 [debug] [MainThread]: Command end result
[0m17:05:48.332616 [info ] [MainThread]: 
[0m17:05:48.332918 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:05:48.333070 [info ] [MainThread]: 
[0m17:05:48.333230 [error] [MainThread]:   Database Error in model bitcoin_summary (models/output/bitcoin_summary.sql)
  001003 (42000): SQL compilation error:
  syntax error line 50 at position 42 unexpected ';'.
  compiled code at target/run/dw_project/models/output/bitcoin_summary.sql
[0m17:05:48.333349 [info ] [MainThread]: 
[0m17:05:48.333485 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:05:48.335179 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.9326322, "process_user_time": 3.208562, "process_kernel_time": 1.086522, "process_mem_max_rss": "207519744", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:05:48.335526 [debug] [MainThread]: Command `dbt run` failed at 17:05:48.335479 after 3.93 seconds
[0m17:05:48.335711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105428770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1466db560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107deaf90>]}
[0m17:05:48.335871 [debug] [MainThread]: Flushing usage events
[0m17:06:00.668478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111aaf1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112553a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111255490>]}


============================== 17:06:00.669922 | cdc35b4f-5db7-450b-9c0b-1e133fac20e5 ==============================
[0m17:06:00.669922 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:06:00.670213 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'quiet': 'False', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'empty': 'False', 'debug': 'False', 'warn_error': 'None', 'static_parser': 'True', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'introspect': 'True', 'write_json': 'True', 'printer_width': '80', 'version_check': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'use_colors': 'True', 'no_print': 'None', 'partial_parse': 'True'}
[0m17:06:01.388851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cdc35b4f-5db7-450b-9c0b-1e133fac20e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15d91c0b0>]}
[0m17:06:01.406388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cdc35b4f-5db7-450b-9c0b-1e133fac20e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b074aa0>]}
[0m17:06:01.406904 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:06:01.415487 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:06:01.467429 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:06:01.467718 [debug] [MainThread]: Partial parsing: updated file: dw_project://models/output/bitcoin_summary.sql
[0m17:06:01.546039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cdc35b4f-5db7-450b-9c0b-1e133fac20e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15dde06e0>]}
[0m17:06:01.577260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cdc35b4f-5db7-450b-9c0b-1e133fac20e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15ddb2f30>]}
[0m17:06:01.577468 [info ] [MainThread]: Found 3 models, 3 sources, 459 macros
[0m17:06:01.577619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cdc35b4f-5db7-450b-9c0b-1e133fac20e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15ddca570>]}
[0m17:06:01.578268 [info ] [MainThread]: 
[0m17:06:01.578503 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:06:01.578848 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m17:06:01.583572 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m17:06:01.583704 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m17:06:01.583805 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:06:02.310406 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.726 seconds
[0m17:06:02.314771 [debug] [ThreadPool]: On list_lab2: Close
[0m17:06:02.524348 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m17:06:02.536155 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m17:06:02.536632 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m17:06:02.536921 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:06:03.949311 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.412 seconds
[0m17:06:03.954048 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m17:06:04.196047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cdc35b4f-5db7-450b-9c0b-1e133fac20e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112456d20>]}
[0m17:06:04.197617 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m17:06:04.198428 [info ] [MainThread]: 
[0m17:06:04.203620 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_historical
[0m17:06:04.204534 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now model.dw_project.bitcoin_historical)
[0m17:06:04.205126 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_historical
[0m17:06:04.264716 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_historical"
[0m17:06:04.265371 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_historical
[0m17:06:04.265572 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_realtime
[0m17:06:04.265807 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_historical, now model.dw_project.bitcoin_realtime)
[0m17:06:04.266073 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_realtime
[0m17:06:04.267202 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_realtime"
[0m17:06:04.267610 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_realtime
[0m17:06:04.267937 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_summary
[0m17:06:04.268212 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.bitcoin_summary ......................... [RUN]
[0m17:06:04.268544 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_realtime, now model.dw_project.bitcoin_summary)
[0m17:06:04.268703 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_summary
[0m17:06:04.271963 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_summary"
[0m17:06:04.272258 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_summary
[0m17:06:04.283887 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_summary"
[0m17:06:04.284685 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_summary"
[0m17:06:04.284855 [debug] [Thread-1 (]: On model.dw_project.bitcoin_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_summary"} */
create or replace transient table lab2.analytics.bitcoin_summary
         as
        (WITH  __dbt__cte__bitcoin_historical as (
SELECT 
    time_period_start,
    time_period_end,
    time_open,
    time_close,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_historical
WHERE time_period_start IS NOT NULL
),  __dbt__cte__bitcoin_realtime as (
SELECT 
    time_open,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_realtime
WHERE price_close IS NOT NULL
), historical AS (
    SELECT 
        DATE_TRUNC('HOUR', time_period_start) AS truncated_hour,
        price_open AS historical_open,
        price_close AS historical_close
    FROM __dbt__cte__bitcoin_historical
),
realtime AS (
    SELECT 
        DATE_TRUNC('HOUR', time_open) AS truncated_hour,
        price_open AS realtime_open,
        price_close AS realtime_close
    FROM __dbt__cte__bitcoin_realtime
)
SELECT
    h.truncated_hour AS timestamp,
    h.historical_open,
    h.historical_close,
    r.realtime_open,
    r.realtime_close
FROM historical h
LEFT JOIN realtime r 
    ON h.truncated_hour = r.truncated_hour
        );
[0m17:06:04.285003 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:06.746851 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.461 seconds
[0m17:06:06.771454 [debug] [Thread-1 (]: On model.dw_project.bitcoin_summary: Close
[0m17:06:06.957942 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdc35b4f-5db7-450b-9c0b-1e133fac20e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15f0982f0>]}
[0m17:06:06.959201 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics.bitcoin_summary .................... [[32mSUCCESS 1[0m in 2.69s]
[0m17:06:06.960241 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_summary
[0m17:06:06.961560 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:06:06.961938 [debug] [MainThread]: Connection 'model.dw_project.bitcoin_summary' was properly closed.
[0m17:06:06.962275 [info ] [MainThread]: 
[0m17:06:06.962595 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.38 seconds (5.38s).
[0m17:06:06.963243 [debug] [MainThread]: Command end result
[0m17:06:06.984556 [info ] [MainThread]: 
[0m17:06:06.984822 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:06:06.984998 [info ] [MainThread]: 
[0m17:06:06.985177 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:06:06.987097 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.341312, "process_user_time": 3.340361, "process_kernel_time": 0.95666, "process_mem_max_rss": "206454784", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:06:06.987405 [debug] [MainThread]: Command `dbt run` succeeded at 17:06:06.987352 after 6.34 seconds
[0m17:06:06.987612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122b6900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111eea240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b49e9c0>]}
[0m17:06:06.987798 [debug] [MainThread]: Flushing usage events
[0m17:16:43.782568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088c8fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108689310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086893a0>]}


============================== 17:16:43.784062 | db686aa1-8a82-4a3c-9a1e-381ea6d0c9f7 ==============================
[0m17:16:43.784062 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:16:43.784346 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'log_cache_events': 'False', 'introspect': 'True', 'printer_width': '80', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'indirect_selection': 'eager', 'log_format': 'default', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'empty': 'False', 'static_parser': 'True', 'invocation_command': 'dbt run', 'quiet': 'False', 'target_path': 'None', 'fail_fast': 'False', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_colors': 'True', 'warn_error': 'None', 'no_print': 'None', 'partial_parse': 'True', 'use_experimental_parser': 'False'}
[0m17:16:44.697160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'db686aa1-8a82-4a3c-9a1e-381ea6d0c9f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15fe985f0>]}
[0m17:16:44.713633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'db686aa1-8a82-4a3c-9a1e-381ea6d0c9f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15fdb9910>]}
[0m17:16:44.714105 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:16:44.722820 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:16:44.776329 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:16:44.776601 [debug] [MainThread]: Partial parsing: updated file: dw_project://models/output/bitcoin_summary.sql
[0m17:16:44.830781 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dw_project.bitcoin_summary' (models/output/bitcoin_summary.sql) depends on a source named 'raw_data.BITCOIN_HISTORICAL' which was not found
[0m17:16:44.832665 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.0739449, "process_user_time": 2.324942, "process_kernel_time": 1.580083, "process_mem_max_rss": "197853184", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:16:44.832962 [debug] [MainThread]: Command `dbt run` failed at 17:16:44.832910 after 1.07 seconds
[0m17:16:44.833137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a437410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8677d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x160958410>]}
[0m17:16:44.833303 [debug] [MainThread]: Flushing usage events
[0m17:19:02.234042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cbb680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f73b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f73890>]}


============================== 17:19:02.235687 | b76f4629-8122-4769-8203-9657b6fa3b3b ==============================
[0m17:19:02.235687 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:19:02.235968 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'warn_error': 'None', 'invocation_command': 'dbt run', 'fail_fast': 'False', 'write_json': 'True', 'target_path': 'None', 'no_print': 'None', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'empty': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'use_colors': 'True', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'log_format': 'default', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'quiet': 'False', 'version_check': 'True'}
[0m17:19:03.088104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b76f4629-8122-4769-8203-9657b6fa3b3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145215ac0>]}
[0m17:19:03.104701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b76f4629-8122-4769-8203-9657b6fa3b3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fa1b80>]}
[0m17:19:03.105173 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:19:03.113806 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:19:03.167849 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:19:03.168126 [debug] [MainThread]: Partial parsing: updated file: dw_project://models/output/bitcoin_summary.sql
[0m17:19:03.247132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b76f4629-8122-4769-8203-9657b6fa3b3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147cdc980>]}
[0m17:19:03.280242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b76f4629-8122-4769-8203-9657b6fa3b3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1456127b0>]}
[0m17:19:03.280449 [info ] [MainThread]: Found 3 models, 3 sources, 459 macros
[0m17:19:03.280588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b76f4629-8122-4769-8203-9657b6fa3b3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1457eaf30>]}
[0m17:19:03.281255 [info ] [MainThread]: 
[0m17:19:03.281487 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:19:03.281833 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m17:19:03.286543 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m17:19:03.286678 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m17:19:03.286780 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:19:04.195090 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.908 seconds
[0m17:19:04.199195 [debug] [ThreadPool]: On list_lab2: Close
[0m17:19:04.379374 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m17:19:04.392882 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m17:19:04.393346 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m17:19:04.393659 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:19:05.058037 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.664 seconds
[0m17:19:05.062261 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m17:19:05.236788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b76f4629-8122-4769-8203-9657b6fa3b3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147ccaff0>]}
[0m17:19:05.237966 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m17:19:05.238532 [info ] [MainThread]: 
[0m17:19:05.243120 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_historical
[0m17:19:05.243810 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now model.dw_project.bitcoin_historical)
[0m17:19:05.244206 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_historical
[0m17:19:05.300950 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_historical"
[0m17:19:05.303153 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_historical
[0m17:19:05.303395 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_realtime
[0m17:19:05.303632 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_historical, now model.dw_project.bitcoin_realtime)
[0m17:19:05.303833 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_realtime
[0m17:19:05.304973 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_realtime"
[0m17:19:05.305698 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_realtime
[0m17:19:05.305905 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_summary
[0m17:19:05.306106 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.bitcoin_summary ......................... [RUN]
[0m17:19:05.306315 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_realtime, now model.dw_project.bitcoin_summary)
[0m17:19:05.306457 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_summary
[0m17:19:05.307566 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_summary"
[0m17:19:05.307819 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_summary
[0m17:19:05.319367 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_summary"
[0m17:19:05.320014 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_summary"
[0m17:19:05.320171 [debug] [Thread-1 (]: On model.dw_project.bitcoin_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_summary"} */
create or replace transient table lab2.analytics.bitcoin_summary
         as
        (WITH historical_data AS (
    SELECT
        TIME_PERIOD_START AS timestamp,
        PRICE_OPEN AS historical_open,
        PRICE_CLOSE AS historical_close
    FROM lab2.raw_data.bitcoin_historical
    WHERE TIME_PERIOD_START IS NOT NULL
),
realtime_data AS (
    SELECT
        TIME_OPEN AS timestamp,
        PRICE_OPEN AS realtime_open,
        PRICE_CLOSE AS realtime_close
    FROM lab2.raw_data.bitcoin_realtime
    WHERE TIME_OPEN IS NOT NULL
)

SELECT
    COALESCE(h.timestamp, r.timestamp) AS timestamp,
    h.historical_open,
    h.historical_close,
    r.realtime_open,
    r.realtime_close
FROM historical_data h
FULL OUTER JOIN realtime_data r
    ON DATE_TRUNC('HOUR', h.timestamp) = DATE_TRUNC('HOUR', r.timestamp)
ORDER BY timestamp;
[0m17:19:05.320311 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:19:06.125165 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b898cf-0003-606b-0003-437a000db222
[0m17:19:06.125747 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 29 at position 18 unexpected ';'.
[0m17:19:06.126281 [debug] [Thread-1 (]: On model.dw_project.bitcoin_summary: Close
[0m17:19:06.333967 [debug] [Thread-1 (]: Database Error in model bitcoin_summary (models/output/bitcoin_summary.sql)
  001003 (42000): SQL compilation error:
  syntax error line 29 at position 18 unexpected ';'.
  compiled code at target/run/dw_project/models/output/bitcoin_summary.sql
[0m17:19:06.336647 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b76f4629-8122-4769-8203-9657b6fa3b3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147e42390>]}
[0m17:19:06.337577 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model analytics.bitcoin_summary ................ [[31mERROR[0m in 1.03s]
[0m17:19:06.338332 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_summary
[0m17:19:06.339905 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:19:06.340252 [debug] [MainThread]: Connection 'model.dw_project.bitcoin_summary' was properly closed.
[0m17:19:06.340570 [info ] [MainThread]: 
[0m17:19:06.340904 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.06 seconds (3.06s).
[0m17:19:06.341618 [debug] [MainThread]: Command end result
[0m17:19:06.365490 [info ] [MainThread]: 
[0m17:19:06.365900 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:19:06.366119 [info ] [MainThread]: 
[0m17:19:06.366364 [error] [MainThread]:   Database Error in model bitcoin_summary (models/output/bitcoin_summary.sql)
  001003 (42000): SQL compilation error:
  syntax error line 29 at position 18 unexpected ';'.
  compiled code at target/run/dw_project/models/output/bitcoin_summary.sql
[0m17:19:06.366544 [info ] [MainThread]: 
[0m17:19:06.366727 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:19:06.368693 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.1578503, "process_user_time": 3.190811, "process_kernel_time": 1.151302, "process_mem_max_rss": "207634432", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:19:06.369009 [debug] [MainThread]: Command `dbt run` failed at 17:19:06.368956 after 4.16 seconds
[0m17:19:06.369228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14575f290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14577ade0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14577ad80>]}
[0m17:19:06.369427 [debug] [MainThread]: Flushing usage events
[0m17:19:17.823034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10762dfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126f7800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112873980>]}


============================== 17:19:17.824128 | 9da418ce-fd5e-470a-a225-addeaddc627c ==============================
[0m17:19:17.824128 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:19:17.824393 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'use_experimental_parser': 'False', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'fail_fast': 'False', 'log_cache_events': 'False', 'invocation_command': 'dbt run', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'debug': 'False', 'quiet': 'False', 'no_print': 'None', 'write_json': 'True', 'warn_error': 'None', 'target_path': 'None', 'log_format': 'default', 'partial_parse': 'True', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'empty': 'False'}
[0m17:19:18.324114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9da418ce-fd5e-470a-a225-addeaddc627c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1141ea870>]}
[0m17:19:18.340518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9da418ce-fd5e-470a-a225-addeaddc627c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15e1b4560>]}
[0m17:19:18.341014 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:19:18.349366 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:19:18.399377 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:19:18.399647 [debug] [MainThread]: Partial parsing: updated file: dw_project://models/output/bitcoin_summary.sql
[0m17:19:18.478129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9da418ce-fd5e-470a-a225-addeaddc627c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15f6e9c10>]}
[0m17:19:18.509749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9da418ce-fd5e-470a-a225-addeaddc627c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15f7bb080>]}
[0m17:19:18.509956 [info ] [MainThread]: Found 3 models, 3 sources, 459 macros
[0m17:19:18.510111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9da418ce-fd5e-470a-a225-addeaddc627c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15f537260>]}
[0m17:19:18.510800 [info ] [MainThread]: 
[0m17:19:18.511028 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:19:18.511388 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m17:19:18.516021 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m17:19:18.516153 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m17:19:18.516254 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:19:19.259640 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.743 seconds
[0m17:19:19.264809 [debug] [ThreadPool]: On list_lab2: Close
[0m17:19:19.469696 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m17:19:19.483983 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m17:19:19.484535 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m17:19:19.484862 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:19:20.129925 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.645 seconds
[0m17:19:20.134314 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m17:19:20.315876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9da418ce-fd5e-470a-a225-addeaddc627c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15f7dadb0>]}
[0m17:19:20.317356 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m17:19:20.318008 [info ] [MainThread]: 
[0m17:19:20.322450 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_historical
[0m17:19:20.323108 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now model.dw_project.bitcoin_historical)
[0m17:19:20.323569 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_historical
[0m17:19:20.385428 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_historical"
[0m17:19:20.386186 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_historical
[0m17:19:20.386387 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_realtime
[0m17:19:20.386623 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_historical, now model.dw_project.bitcoin_realtime)
[0m17:19:20.386828 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_realtime
[0m17:19:20.387960 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_realtime"
[0m17:19:20.388487 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_realtime
[0m17:19:20.388665 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_summary
[0m17:19:20.388881 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.bitcoin_summary ......................... [RUN]
[0m17:19:20.389058 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_realtime, now model.dw_project.bitcoin_summary)
[0m17:19:20.389192 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_summary
[0m17:19:20.390306 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_summary"
[0m17:19:20.390562 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_summary
[0m17:19:20.402258 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_summary"
[0m17:19:20.402910 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_summary"
[0m17:19:20.403065 [debug] [Thread-1 (]: On model.dw_project.bitcoin_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_summary"} */
create or replace transient table lab2.analytics.bitcoin_summary
         as
        (WITH historical_data AS (
    SELECT
        TIME_PERIOD_START AS timestamp,
        PRICE_OPEN AS historical_open,
        PRICE_CLOSE AS historical_close
    FROM lab2.raw_data.bitcoin_historical
    WHERE TIME_PERIOD_START IS NOT NULL
),
realtime_data AS (
    SELECT
        TIME_OPEN AS timestamp,
        PRICE_OPEN AS realtime_open,
        PRICE_CLOSE AS realtime_close
    FROM lab2.raw_data.bitcoin_realtime
    WHERE TIME_OPEN IS NOT NULL
)

SELECT
    COALESCE(h.timestamp, r.timestamp) AS timestamp,
    h.historical_open,
    h.historical_close,
    r.realtime_open,
    r.realtime_close
FROM historical_data h
FULL OUTER JOIN realtime_data r
    ON DATE_TRUNC('HOUR', h.timestamp) = DATE_TRUNC('HOUR', r.timestamp)
ORDER BY timestamp
        );
[0m17:19:20.403205 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:19:22.707738 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.304 seconds
[0m17:19:22.731007 [debug] [Thread-1 (]: On model.dw_project.bitcoin_summary: Close
[0m17:19:22.976247 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9da418ce-fd5e-470a-a225-addeaddc627c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15f7dadb0>]}
[0m17:19:22.977926 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics.bitcoin_summary .................... [[32mSUCCESS 1[0m in 2.58s]
[0m17:19:22.979018 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_summary
[0m17:19:22.981327 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:19:22.981882 [debug] [MainThread]: Connection 'model.dw_project.bitcoin_summary' was properly closed.
[0m17:19:22.982391 [info ] [MainThread]: 
[0m17:19:22.982905 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.47 seconds (4.47s).
[0m17:19:22.983921 [debug] [MainThread]: Command end result
[0m17:19:23.010887 [info ] [MainThread]: 
[0m17:19:23.011205 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:19:23.011388 [info ] [MainThread]: 
[0m17:19:23.011580 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:19:23.013586 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.2110534, "process_user_time": 1.674901, "process_kernel_time": 2.572789, "process_mem_max_rss": "209190912", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:19:23.013967 [debug] [MainThread]: Command `dbt run` succeeded at 17:19:23.013899 after 5.21 seconds
[0m17:19:23.014198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10762dfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112f56a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15f683d70>]}
[0m17:19:23.014407 [debug] [MainThread]: Flushing usage events
[0m17:20:55.833832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078db0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068f1370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068f0740>]}


============================== 17:20:55.835436 | 54fbec06-49d9-430c-9d2e-35224f537b9e ==============================
[0m17:20:55.835436 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:20:55.835722 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'invocation_command': 'dbt run', 'use_colors': 'True', 'use_experimental_parser': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'introspect': 'True', 'target_path': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'static_parser': 'True', 'partial_parse': 'True', 'warn_error': 'None', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'debug': 'False', 'version_check': 'True', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default'}
[0m17:20:56.744642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '54fbec06-49d9-430c-9d2e-35224f537b9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126643800>]}
[0m17:20:56.761287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '54fbec06-49d9-430c-9d2e-35224f537b9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1261954c0>]}
[0m17:20:56.761824 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:20:56.770901 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:20:56.824135 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m17:20:56.824401 [debug] [MainThread]: Partial parsing: added file: dw_project://models/output/bitcoin_daily_summary.sql
[0m17:20:56.824523 [debug] [MainThread]: Partial parsing: deleted file: dw_project://models/output/bitcoin_summary.sql
[0m17:20:56.906831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '54fbec06-49d9-430c-9d2e-35224f537b9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1266ca6f0>]}
[0m17:20:56.939585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '54fbec06-49d9-430c-9d2e-35224f537b9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1269ff080>]}
[0m17:20:56.939802 [info ] [MainThread]: Found 3 models, 3 sources, 459 macros
[0m17:20:56.939945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54fbec06-49d9-430c-9d2e-35224f537b9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1269ea660>]}
[0m17:20:56.940587 [info ] [MainThread]: 
[0m17:20:56.940817 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:20:56.941174 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m17:20:56.945908 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m17:20:56.946041 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m17:20:56.946143 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:20:58.286604 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.339 seconds
[0m17:20:58.290586 [debug] [ThreadPool]: On list_lab2: Close
[0m17:20:58.784798 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m17:20:58.798959 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m17:20:58.799588 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m17:20:58.799918 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:20:59.832777 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.032 seconds
[0m17:20:59.836706 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m17:21:00.042152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54fbec06-49d9-430c-9d2e-35224f537b9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126ac13a0>]}
[0m17:21:00.043219 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m17:21:00.043679 [info ] [MainThread]: 
[0m17:21:00.047805 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_daily_summary
[0m17:21:00.048549 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.bitcoin_daily_summary ................... [RUN]
[0m17:21:00.049084 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now model.dw_project.bitcoin_daily_summary)
[0m17:21:00.049452 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_daily_summary
[0m17:21:00.108769 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_daily_summary"
[0m17:21:00.109320 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_daily_summary
[0m17:21:00.120891 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_daily_summary"
[0m17:21:00.121622 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_daily_summary"
[0m17:21:00.121801 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_daily_summary"} */
create or replace transient table lab2.analytics.bitcoin_daily_summary
         as
        (WITH historical_data AS (
    SELECT
        TIME_PERIOD_START::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_historical
),
realtime_data AS (
    SELECT
        TIME_OPEN::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    date,
    AVG(PRICE_OPEN) AS avg_open,
    AVG(PRICE_HIGH) AS avg_high,
    AVG(PRICE_LOW) AS avg_low,
    AVG(PRICE_CLOSE) AS avg_close,
    SUM(VOLUME_TRADED) AS total_volume,
    SUM(TRADES_COUNT) AS total_trades
FROM (
    SELECT * FROM historical_data
    UNION ALL
    SELECT * FROM realtime_data
) AS combined_data
GROUP BY date
ORDER BY date;
[0m17:21:00.121948 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:21:00.750788 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b898d1-0003-6147-0003-437a000d928e
[0m17:21:00.751388 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 40 at position 13 unexpected ';'.
[0m17:21:00.751892 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: Close
[0m17:21:01.008580 [debug] [Thread-1 (]: Database Error in model bitcoin_daily_summary (models/output/bitcoin_daily_summary.sql)
  001003 (42000): SQL compilation error:
  syntax error line 40 at position 13 unexpected ';'.
  compiled code at target/run/dw_project/models/output/bitcoin_daily_summary.sql
[0m17:21:01.011673 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54fbec06-49d9-430c-9d2e-35224f537b9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1268bd3d0>]}
[0m17:21:01.012625 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model analytics.bitcoin_daily_summary .......... [[31mERROR[0m in 0.96s]
[0m17:21:01.013350 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_daily_summary
[0m17:21:01.013867 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_historical
[0m17:21:01.014476 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_daily_summary, now model.dw_project.bitcoin_historical)
[0m17:21:01.014821 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_historical
[0m17:21:01.019001 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_historical"
[0m17:21:01.020534 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_historical
[0m17:21:01.020995 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_realtime
[0m17:21:01.021423 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_historical, now model.dw_project.bitcoin_realtime)
[0m17:21:01.021741 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_realtime
[0m17:21:01.024172 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_realtime"
[0m17:21:01.025119 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_realtime
[0m17:21:01.026149 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:21:01.026371 [debug] [MainThread]: Connection 'model.dw_project.bitcoin_realtime' was properly closed.
[0m17:21:01.026589 [info ] [MainThread]: 
[0m17:21:01.026836 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.09 seconds (4.09s).
[0m17:21:01.027286 [debug] [MainThread]: Command end result
[0m17:21:01.045704 [info ] [MainThread]: 
[0m17:21:01.045976 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:21:01.046144 [info ] [MainThread]: 
[0m17:21:01.046339 [error] [MainThread]:   Database Error in model bitcoin_daily_summary (models/output/bitcoin_daily_summary.sql)
  001003 (42000): SQL compilation error:
  syntax error line 40 at position 13 unexpected ';'.
  compiled code at target/run/dw_project/models/output/bitcoin_daily_summary.sql
[0m17:21:01.046497 [info ] [MainThread]: 
[0m17:21:01.046660 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:21:01.048419 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.2416306, "process_user_time": 2.971801, "process_kernel_time": 1.385836, "process_mem_max_rss": "209043456", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:21:01.048700 [debug] [MainThread]: Command `dbt run` failed at 17:21:01.048651 after 5.24 seconds
[0m17:21:01.048893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107656ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068f1370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126640ce0>]}
[0m17:21:01.049074 [debug] [MainThread]: Flushing usage events
[0m17:21:11.434959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11258ef90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112873da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112873b30>]}


============================== 17:21:11.436295 | b943549c-1683-4dae-872c-71cabc5683f5 ==============================
[0m17:21:11.436295 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:21:11.436564 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'use_experimental_parser': 'False', 'log_format': 'default', 'debug': 'False', 'use_colors': 'True', 'static_parser': 'True', 'partial_parse': 'True', 'version_check': 'True', 'printer_width': '80', 'log_cache_events': 'False', 'warn_error': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'empty': 'False', 'write_json': 'True', 'no_print': 'None', 'introspect': 'True', 'indirect_selection': 'eager', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'send_anonymous_usage_stats': 'True', 'quiet': 'False'}
[0m17:21:12.205656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b943549c-1683-4dae-872c-71cabc5683f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16b96c440>]}
[0m17:21:12.225892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b943549c-1683-4dae-872c-71cabc5683f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121a48c0>]}
[0m17:21:12.226504 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:21:12.237219 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:21:12.290352 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:21:12.290670 [debug] [MainThread]: Partial parsing: updated file: dw_project://models/output/bitcoin_daily_summary.sql
[0m17:21:12.371540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b943549c-1683-4dae-872c-71cabc5683f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128a5fd0>]}
[0m17:21:12.402543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b943549c-1683-4dae-872c-71cabc5683f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16f6228a0>]}
[0m17:21:12.402747 [info ] [MainThread]: Found 3 models, 3 sources, 459 macros
[0m17:21:12.402892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b943549c-1683-4dae-872c-71cabc5683f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16f5d6a80>]}
[0m17:21:12.403552 [info ] [MainThread]: 
[0m17:21:12.403789 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:21:12.404187 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m17:21:12.408882 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m17:21:12.409022 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m17:21:12.409125 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:21:13.206806 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.797 seconds
[0m17:21:13.209869 [debug] [ThreadPool]: On list_lab2: Close
[0m17:21:13.439247 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m17:21:13.449514 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m17:21:13.449939 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m17:21:13.450204 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:21:14.276818 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.826 seconds
[0m17:21:14.281812 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m17:21:14.454923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b943549c-1683-4dae-872c-71cabc5683f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11282b8f0>]}
[0m17:21:14.456176 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m17:21:14.456932 [info ] [MainThread]: 
[0m17:21:14.461150 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_daily_summary
[0m17:21:14.462002 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.bitcoin_daily_summary ................... [RUN]
[0m17:21:14.462589 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now model.dw_project.bitcoin_daily_summary)
[0m17:21:14.463019 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_daily_summary
[0m17:21:14.515418 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_daily_summary"
[0m17:21:14.515981 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_daily_summary
[0m17:21:14.528697 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_daily_summary"
[0m17:21:14.529473 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_daily_summary"
[0m17:21:14.529652 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_daily_summary"} */
create or replace transient table lab2.analytics.bitcoin_daily_summary
         as
        (WITH historical_data AS (
    SELECT
        TIME_PERIOD_START::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_historical
),
realtime_data AS (
    SELECT
        TIME_OPEN::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    date,
    AVG(PRICE_OPEN) AS avg_open,
    AVG(PRICE_HIGH) AS avg_high,
    AVG(PRICE_LOW) AS avg_low,
    AVG(PRICE_CLOSE) AS avg_close,
    SUM(VOLUME_TRADED) AS total_volume,
    SUM(TRADES_COUNT) AS total_trades
FROM (
    SELECT * FROM historical_data
    UNION ALL
    SELECT * FROM realtime_data
) AS combined_data
GROUP BY date
ORDER BY date
        );
[0m17:21:14.529810 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:21:16.678886 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.149 seconds
[0m17:21:16.701314 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: Close
[0m17:21:16.891912 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b943549c-1683-4dae-872c-71cabc5683f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16d148110>]}
[0m17:21:16.893136 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics.bitcoin_daily_summary .............. [[32mSUCCESS 1[0m in 2.43s]
[0m17:21:16.894129 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_daily_summary
[0m17:21:16.894802 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_historical
[0m17:21:16.895521 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_daily_summary, now model.dw_project.bitcoin_historical)
[0m17:21:16.896113 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_historical
[0m17:21:16.899642 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_historical"
[0m17:21:16.900665 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_historical
[0m17:21:16.901095 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_realtime
[0m17:21:16.901547 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_historical, now model.dw_project.bitcoin_realtime)
[0m17:21:16.902186 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_realtime
[0m17:21:16.904344 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_realtime"
[0m17:21:16.905109 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_realtime
[0m17:21:16.905988 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:21:16.906248 [debug] [MainThread]: Connection 'model.dw_project.bitcoin_realtime' was properly closed.
[0m17:21:16.906383 [info ] [MainThread]: 
[0m17:21:16.906525 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.50 seconds (4.50s).
[0m17:21:16.906814 [debug] [MainThread]: Command end result
[0m17:21:16.917829 [info ] [MainThread]: 
[0m17:21:16.918029 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:21:16.918144 [info ] [MainThread]: 
[0m17:21:16.918267 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:21:16.919813 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.506417, "process_user_time": 2.61169, "process_kernel_time": 1.752823, "process_mem_max_rss": "209485824", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:21:16.920099 [debug] [MainThread]: Command `dbt run` succeeded at 17:21:16.920053 after 5.51 seconds
[0m17:21:16.920261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111cd8170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117bff80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11258ea80>]}
[0m17:21:16.920395 [debug] [MainThread]: Flushing usage events
[0m17:25:57.868623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104de1fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f97dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f97b60>]}


============================== 17:25:57.870076 | d4d51780-2b04-420f-a53d-f90182171771 ==============================
[0m17:25:57.870076 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:25:57.870358 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'debug': 'False', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'quiet': 'False', 'printer_width': '80', 'partial_parse': 'True', 'write_json': 'True', 'target_path': 'None', 'warn_error': 'None', 'empty': 'False', 'no_print': 'None', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'version_check': 'True'}
[0m17:25:58.788609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd4d51780-2b04-420f-a53d-f90182171771', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ac63740>]}
[0m17:25:58.805285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd4d51780-2b04-420f-a53d-f90182171771', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ad6ed50>]}
[0m17:25:58.805748 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:25:58.814543 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:25:58.869288 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m17:25:58.869561 [debug] [MainThread]: Partial parsing: added file: dw_project://models/output/precentage_change.sql
[0m17:25:58.953417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd4d51780-2b04-420f-a53d-f90182171771', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13afcefc0>]}
[0m17:25:58.987892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd4d51780-2b04-420f-a53d-f90182171771', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b9b2ea0>]}
[0m17:25:58.988130 [info ] [MainThread]: Found 4 models, 3 sources, 459 macros
[0m17:25:58.988289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4d51780-2b04-420f-a53d-f90182171771', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b9c7080>]}
[0m17:25:58.989039 [info ] [MainThread]: 
[0m17:25:58.989306 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:25:58.990903 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m17:25:58.995710 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m17:25:58.995845 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m17:25:58.995948 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:25:59.765499 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.768 seconds
[0m17:25:59.769151 [debug] [ThreadPool]: On list_lab2: Close
[0m17:25:59.956775 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m17:25:59.968873 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m17:25:59.969334 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m17:25:59.969608 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:26:00.685479 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.715 seconds
[0m17:26:00.689460 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m17:26:01.354628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4d51780-2b04-420f-a53d-f90182171771', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b9c6de0>]}
[0m17:26:01.355771 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m17:26:01.356412 [info ] [MainThread]: 
[0m17:26:01.361329 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_daily_summary
[0m17:26:01.362057 [info ] [Thread-1 (]: 1 of 2 START sql table model analytics.bitcoin_daily_summary ................... [RUN]
[0m17:26:01.362907 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now model.dw_project.bitcoin_daily_summary)
[0m17:26:01.363415 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_daily_summary
[0m17:26:01.416921 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_daily_summary"
[0m17:26:01.418727 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_daily_summary
[0m17:26:01.431355 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_daily_summary"
[0m17:26:01.432142 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_daily_summary"
[0m17:26:01.432324 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_daily_summary"} */
create or replace transient table lab2.analytics.bitcoin_daily_summary
         as
        (WITH historical_data AS (
    SELECT
        TIME_PERIOD_START::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_historical
),
realtime_data AS (
    SELECT
        TIME_OPEN::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    date,
    AVG(PRICE_OPEN) AS avg_open,
    AVG(PRICE_HIGH) AS avg_high,
    AVG(PRICE_LOW) AS avg_low,
    AVG(PRICE_CLOSE) AS avg_close,
    SUM(VOLUME_TRADED) AS total_volume,
    SUM(TRADES_COUNT) AS total_trades
FROM (
    SELECT * FROM historical_data
    UNION ALL
    SELECT * FROM realtime_data
) AS combined_data
GROUP BY date
ORDER BY date
        );
[0m17:26:01.432483 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:26:04.325777 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.893 seconds
[0m17:26:04.349038 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: Close
[0m17:26:04.535238 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4d51780-2b04-420f-a53d-f90182171771', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13bb3efc0>]}
[0m17:26:04.536892 [info ] [Thread-1 (]: 1 of 2 OK created sql table model analytics.bitcoin_daily_summary .............. [[32mSUCCESS 1[0m in 3.17s]
[0m17:26:04.537836 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_daily_summary
[0m17:26:04.538467 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_historical
[0m17:26:04.539184 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_daily_summary, now model.dw_project.bitcoin_historical)
[0m17:26:04.539654 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_historical
[0m17:26:04.544182 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_historical"
[0m17:26:04.545681 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_historical
[0m17:26:04.546171 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_realtime
[0m17:26:04.546738 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_historical, now model.dw_project.bitcoin_realtime)
[0m17:26:04.547635 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_realtime
[0m17:26:04.550333 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_realtime"
[0m17:26:04.551355 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_realtime
[0m17:26:04.551708 [debug] [Thread-1 (]: Began running node model.dw_project.precentage_change
[0m17:26:04.552151 [info ] [Thread-1 (]: 2 of 2 START sql table model analytics.precentage_change ....................... [RUN]
[0m17:26:04.552511 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_realtime, now model.dw_project.precentage_change)
[0m17:26:04.552793 [debug] [Thread-1 (]: Began compiling node model.dw_project.precentage_change
[0m17:26:04.555324 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.precentage_change"
[0m17:26:04.555875 [debug] [Thread-1 (]: Began executing node model.dw_project.precentage_change
[0m17:26:04.557650 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.precentage_change"
[0m17:26:04.558759 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.precentage_change"
[0m17:26:04.559058 [debug] [Thread-1 (]: On model.dw_project.precentage_change: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.precentage_change"} */
create or replace transient table lab2.analytics.precentage_change
         as
        (WITH historical AS (
    SELECT 
        time_period_start,
        price_close
    FROM lab2.raw_data.bitcoin_historical
),
realtime AS (
    SELECT 
        time_open_v1 AS time_period_start,
        price_close
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    h.time_period_start,
    h.price_close AS historical_close,
    r.price_close AS realtime_close,
    CASE 
        WHEN h.price_close = 0 THEN NULL
        ELSE (r.price_close - h.price_close) / h.price_close * 100 
    END AS price_change_percentage
FROM historical h
JOIN realtime r
    ON DATE_TRUNC('HOUR', h.time_period_start) = DATE_TRUNC('HOUR', r.time_period_start)
ORDER BY h.time_period_start
        );
[0m17:26:04.559330 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:26:04.993051 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b898d6-0003-62c7-0003-437a000e71b2
[0m17:26:04.993911 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 11 at position 8
invalid identifier 'TIME_OPEN_V1'
[0m17:26:04.994573 [debug] [Thread-1 (]: On model.dw_project.precentage_change: Close
[0m17:26:05.176177 [debug] [Thread-1 (]: Database Error in model precentage_change (models/output/precentage_change.sql)
  000904 (42000): SQL compilation error: error line 11 at position 8
  invalid identifier 'TIME_OPEN_V1'
  compiled code at target/run/dw_project/models/output/precentage_change.sql
[0m17:26:05.176832 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4d51780-2b04-420f-a53d-f90182171771', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ad962a0>]}
[0m17:26:05.177537 [error] [Thread-1 (]: 2 of 2 ERROR creating sql table model analytics.precentage_change .............. [[31mERROR[0m in 0.62s]
[0m17:26:05.178147 [debug] [Thread-1 (]: Finished running node model.dw_project.precentage_change
[0m17:26:05.179473 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:26:05.179774 [debug] [MainThread]: Connection 'model.dw_project.precentage_change' was properly closed.
[0m17:26:05.180101 [info ] [MainThread]: 
[0m17:26:05.180393 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 6.19 seconds (6.19s).
[0m17:26:05.181090 [debug] [MainThread]: Command end result
[0m17:26:05.202250 [info ] [MainThread]: 
[0m17:26:05.202500 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:26:05.202668 [info ] [MainThread]: 
[0m17:26:05.202866 [error] [MainThread]:   Database Error in model precentage_change (models/output/precentage_change.sql)
  000904 (42000): SQL compilation error: error line 11 at position 8
  invalid identifier 'TIME_OPEN_V1'
  compiled code at target/run/dw_project/models/output/precentage_change.sql
[0m17:26:05.203032 [info ] [MainThread]: 
[0m17:26:05.203204 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m17:26:05.205019 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 7.360958, "process_user_time": 3.147575, "process_kernel_time": 1.308953, "process_mem_max_rss": "208732160", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:26:05.205314 [debug] [MainThread]: Command `dbt run` failed at 17:26:05.205263 after 7.36 seconds
[0m17:26:05.205501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106caede0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061dbfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b6e870>]}
[0m17:26:05.205677 [debug] [MainThread]: Flushing usage events
[0m17:26:30.734847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048fd100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106077ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106077a40>]}


============================== 17:26:30.736386 | 20a0cb9f-c6e4-42c1-ae80-4a5355c44a4c ==============================
[0m17:26:30.736386 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:26:30.736664 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'log_cache_events': 'False', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'static_parser': 'True', 'target_path': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'quiet': 'False', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'write_json': 'True', 'use_colors': 'True', 'empty': 'False', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'version_check': 'True', 'invocation_command': 'dbt run', 'printer_width': '80', 'no_print': 'None', 'fail_fast': 'False', 'debug': 'False', 'send_anonymous_usage_stats': 'True'}
[0m17:26:31.505300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '20a0cb9f-c6e4-42c1-ae80-4a5355c44a4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16b637e90>]}
[0m17:26:31.522468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '20a0cb9f-c6e4-42c1-ae80-4a5355c44a4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1695be1e0>]}
[0m17:26:31.522958 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:26:31.531723 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:26:31.586403 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:26:31.586734 [debug] [MainThread]: Partial parsing: updated file: dw_project://models/output/precentage_change.sql
[0m17:26:31.666853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '20a0cb9f-c6e4-42c1-ae80-4a5355c44a4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16b897020>]}
[0m17:26:31.698989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '20a0cb9f-c6e4-42c1-ae80-4a5355c44a4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16bcbb1a0>]}
[0m17:26:31.699209 [info ] [MainThread]: Found 4 models, 3 sources, 459 macros
[0m17:26:31.699350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20a0cb9f-c6e4-42c1-ae80-4a5355c44a4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16b8e5a30>]}
[0m17:26:31.700042 [info ] [MainThread]: 
[0m17:26:31.700280 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:26:31.701845 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m17:26:31.706560 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m17:26:31.706703 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m17:26:31.706808 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:26:32.526069 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.818 seconds
[0m17:26:32.529809 [debug] [ThreadPool]: On list_lab2: Close
[0m17:26:32.700927 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m17:26:32.713213 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m17:26:32.713693 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m17:26:32.713971 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:26:33.302111 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.588 seconds
[0m17:26:33.306019 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m17:26:33.480589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20a0cb9f-c6e4-42c1-ae80-4a5355c44a4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16bce0560>]}
[0m17:26:33.481889 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m17:26:33.482527 [info ] [MainThread]: 
[0m17:26:33.488025 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_daily_summary
[0m17:26:33.488845 [info ] [Thread-1 (]: 1 of 2 START sql table model analytics.bitcoin_daily_summary ................... [RUN]
[0m17:26:33.489467 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now model.dw_project.bitcoin_daily_summary)
[0m17:26:33.489981 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_daily_summary
[0m17:26:33.548030 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_daily_summary"
[0m17:26:33.548569 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_daily_summary
[0m17:26:33.560804 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_daily_summary"
[0m17:26:33.561549 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_daily_summary"
[0m17:26:33.561734 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_daily_summary"} */
create or replace transient table lab2.analytics.bitcoin_daily_summary
         as
        (WITH historical_data AS (
    SELECT
        TIME_PERIOD_START::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_historical
),
realtime_data AS (
    SELECT
        TIME_OPEN::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    date,
    AVG(PRICE_OPEN) AS avg_open,
    AVG(PRICE_HIGH) AS avg_high,
    AVG(PRICE_LOW) AS avg_low,
    AVG(PRICE_CLOSE) AS avg_close,
    SUM(VOLUME_TRADED) AS total_volume,
    SUM(TRADES_COUNT) AS total_trades
FROM (
    SELECT * FROM historical_data
    UNION ALL
    SELECT * FROM realtime_data
) AS combined_data
GROUP BY date
ORDER BY date
        );
[0m17:26:33.561893 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:26:35.555834 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.994 seconds
[0m17:26:35.579651 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: Close
[0m17:26:35.759998 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20a0cb9f-c6e4-42c1-ae80-4a5355c44a4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16bf5c380>]}
[0m17:26:35.761339 [info ] [Thread-1 (]: 1 of 2 OK created sql table model analytics.bitcoin_daily_summary .............. [[32mSUCCESS 1[0m in 2.27s]
[0m17:26:35.762354 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_daily_summary
[0m17:26:35.762986 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_historical
[0m17:26:35.763568 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_daily_summary, now model.dw_project.bitcoin_historical)
[0m17:26:35.763980 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_historical
[0m17:26:35.766680 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_historical"
[0m17:26:35.768602 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_historical
[0m17:26:35.768949 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_realtime
[0m17:26:35.769376 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_historical, now model.dw_project.bitcoin_realtime)
[0m17:26:35.770096 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_realtime
[0m17:26:35.772296 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_realtime"
[0m17:26:35.773366 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_realtime
[0m17:26:35.773666 [debug] [Thread-1 (]: Began running node model.dw_project.precentage_change
[0m17:26:35.774040 [info ] [Thread-1 (]: 2 of 2 START sql table model analytics.precentage_change ....................... [RUN]
[0m17:26:35.774379 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_realtime, now model.dw_project.precentage_change)
[0m17:26:35.774636 [debug] [Thread-1 (]: Began compiling node model.dw_project.precentage_change
[0m17:26:35.776777 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.precentage_change"
[0m17:26:35.778188 [debug] [Thread-1 (]: Began executing node model.dw_project.precentage_change
[0m17:26:35.779744 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.precentage_change"
[0m17:26:35.780722 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.precentage_change"
[0m17:26:35.780984 [debug] [Thread-1 (]: On model.dw_project.precentage_change: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.precentage_change"} */
create or replace transient table lab2.analytics.precentage_change
         as
        (WITH historical AS (
    SELECT 
        time_period_start,
        price_close
    FROM lab2.raw_data.bitcoin_historical
),
realtime AS (
    SELECT 
        time_open AS time_period_start,
        price_close
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    h.time_period_start,
    h.price_close AS historical_close,
    r.price_close AS realtime_close,
    CASE 
        WHEN h.price_close = 0 THEN NULL
        ELSE (r.price_close - h.price_close) / h.price_close * 100 
    END AS price_change_percentage
FROM historical h
JOIN realtime r
    ON DATE_TRUNC('HOUR', h.time_period_start) = DATE_TRUNC('HOUR', r.time_period_start)
ORDER BY h.time_period_start
        );
[0m17:26:35.781231 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:26:36.886908 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.105 seconds
[0m17:26:36.891265 [debug] [Thread-1 (]: On model.dw_project.precentage_change: Close
[0m17:26:37.071246 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20a0cb9f-c6e4-42c1-ae80-4a5355c44a4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16bb9c6e0>]}
[0m17:26:37.073008 [info ] [Thread-1 (]: 2 of 2 OK created sql table model analytics.precentage_change .................. [[32mSUCCESS 1[0m in 1.30s]
[0m17:26:37.074377 [debug] [Thread-1 (]: Finished running node model.dw_project.precentage_change
[0m17:26:37.076648 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:26:37.077101 [debug] [MainThread]: Connection 'model.dw_project.precentage_change' was properly closed.
[0m17:26:37.077591 [info ] [MainThread]: 
[0m17:26:37.078212 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 5.38 seconds (5.38s).
[0m17:26:37.079207 [debug] [MainThread]: Command end result
[0m17:26:37.102321 [info ] [MainThread]: 
[0m17:26:37.102590 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:26:37.102771 [info ] [MainThread]: 
[0m17:26:37.102960 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m17:26:37.105414 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.393783, "process_user_time": 2.840266, "process_kernel_time": 1.547451, "process_mem_max_rss": "208044032", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:26:37.105763 [debug] [MainThread]: Command `dbt run` succeeded at 17:26:37.105704 after 6.39 seconds
[0m17:26:37.105978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058c6420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d66fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dba030>]}
[0m17:26:37.106179 [debug] [MainThread]: Flushing usage events
[0m17:28:00.589461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102d9fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114e73a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114e73800>]}


============================== 17:28:00.591309 | 09db0590-dbf6-45df-a41e-acf0ca6de3f2 ==============================
[0m17:28:00.591309 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:28:00.591606 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_experimental_parser': 'False', 'static_parser': 'True', 'empty': 'False', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'printer_width': '80', 'indirect_selection': 'eager', 'partial_parse': 'True', 'use_colors': 'True', 'fail_fast': 'False', 'log_cache_events': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'cache_selected_only': 'False', 'no_print': 'None', 'write_json': 'True', 'debug': 'False', 'version_check': 'True', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project'}
[0m17:28:01.702365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '09db0590-dbf6-45df-a41e-acf0ca6de3f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15ed3b740>]}
[0m17:28:01.719618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '09db0590-dbf6-45df-a41e-acf0ca6de3f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115230bc0>]}
[0m17:28:01.720211 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:28:01.729046 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:28:01.783372 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m17:28:01.783617 [debug] [MainThread]: Partial parsing: added file: dw_project://models/output/avg_price_realtime.sql
[0m17:28:01.783730 [debug] [MainThread]: Partial parsing: deleted file: dw_project://models/output/precentage_change.sql
[0m17:28:01.864933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '09db0590-dbf6-45df-a41e-acf0ca6de3f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15f3dc740>]}
[0m17:28:01.897725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '09db0590-dbf6-45df-a41e-acf0ca6de3f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15f132e40>]}
[0m17:28:01.897948 [info ] [MainThread]: Found 4 models, 3 sources, 459 macros
[0m17:28:01.898081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09db0590-dbf6-45df-a41e-acf0ca6de3f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15e21cec0>]}
[0m17:28:01.898752 [info ] [MainThread]: 
[0m17:28:01.898990 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:28:01.900570 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m17:28:01.905373 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m17:28:01.905515 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m17:28:01.905625 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:28:02.903005 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.997 seconds
[0m17:28:02.905943 [debug] [ThreadPool]: On list_lab2: Close
[0m17:28:03.074235 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m17:28:03.087260 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m17:28:03.087760 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m17:28:03.088038 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:28:03.772436 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.684 seconds
[0m17:28:03.776646 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m17:28:03.941124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09db0590-dbf6-45df-a41e-acf0ca6de3f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15ef96c90>]}
[0m17:28:03.942215 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m17:28:03.942613 [info ] [MainThread]: 
[0m17:28:03.946420 [debug] [Thread-1 (]: Began running node model.dw_project.avg_price_realtime
[0m17:28:03.947290 [info ] [Thread-1 (]: 1 of 2 START sql table model analytics.avg_price_realtime ...................... [RUN]
[0m17:28:03.947843 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now model.dw_project.avg_price_realtime)
[0m17:28:03.948173 [debug] [Thread-1 (]: Began compiling node model.dw_project.avg_price_realtime
[0m17:28:04.003456 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.avg_price_realtime"
[0m17:28:04.003963 [debug] [Thread-1 (]: Began executing node model.dw_project.avg_price_realtime
[0m17:28:04.015677 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.avg_price_realtime"
[0m17:28:04.016240 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.avg_price_realtime"
[0m17:28:04.016401 [debug] [Thread-1 (]: On model.dw_project.avg_price_realtime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.avg_price_realtime"} */
create or replace transient table lab2.analytics.avg_price_realtime
         as
        (WITH realtime AS (
    SELECT 
        time_open_v1 AS time_period_start,
        price_close
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    time_period_start,
    AVG(price_close) OVER (ORDER BY time_period_start ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) AS thirty_min_avg_price
FROM realtime
ORDER BY time_period_start
        );
[0m17:28:04.016537 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:28:04.645557 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b898d8-0003-609b-0003-437a000e6212
[0m17:28:04.646419 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 5 at position 8
invalid identifier 'TIME_OPEN_V1'
[0m17:28:04.647052 [debug] [Thread-1 (]: On model.dw_project.avg_price_realtime: Close
[0m17:28:04.846036 [debug] [Thread-1 (]: Database Error in model avg_price_realtime (models/output/avg_price_realtime.sql)
  000904 (42000): SQL compilation error: error line 5 at position 8
  invalid identifier 'TIME_OPEN_V1'
  compiled code at target/run/dw_project/models/output/avg_price_realtime.sql
[0m17:28:04.848784 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09db0590-dbf6-45df-a41e-acf0ca6de3f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120a9c70>]}
[0m17:28:04.849745 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model analytics.avg_price_realtime ............. [[31mERROR[0m in 0.90s]
[0m17:28:04.850505 [debug] [Thread-1 (]: Finished running node model.dw_project.avg_price_realtime
[0m17:28:04.851102 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_daily_summary
[0m17:28:04.851825 [info ] [Thread-1 (]: 2 of 2 START sql table model analytics.bitcoin_daily_summary ................... [RUN]
[0m17:28:04.852339 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.avg_price_realtime, now model.dw_project.bitcoin_daily_summary)
[0m17:28:04.852711 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_daily_summary
[0m17:28:04.857654 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_daily_summary"
[0m17:28:04.859278 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_daily_summary
[0m17:28:04.861781 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_daily_summary"
[0m17:28:04.863263 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_daily_summary"
[0m17:28:04.863629 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_daily_summary"} */
create or replace transient table lab2.analytics.bitcoin_daily_summary
         as
        (WITH historical_data AS (
    SELECT
        TIME_PERIOD_START::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_historical
),
realtime_data AS (
    SELECT
        TIME_OPEN::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    date,
    AVG(PRICE_OPEN) AS avg_open,
    AVG(PRICE_HIGH) AS avg_high,
    AVG(PRICE_LOW) AS avg_low,
    AVG(PRICE_CLOSE) AS avg_close,
    SUM(VOLUME_TRADED) AS total_volume,
    SUM(TRADES_COUNT) AS total_trades
FROM (
    SELECT * FROM historical_data
    UNION ALL
    SELECT * FROM realtime_data
) AS combined_data
GROUP BY date
ORDER BY date
        );
[0m17:28:04.863961 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:28:07.100832 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.237 seconds
[0m17:28:07.130872 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: Close
[0m17:28:07.322616 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09db0590-dbf6-45df-a41e-acf0ca6de3f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15e6e6150>]}
[0m17:28:07.324380 [info ] [Thread-1 (]: 2 of 2 OK created sql table model analytics.bitcoin_daily_summary .............. [[32mSUCCESS 1[0m in 2.47s]
[0m17:28:07.325647 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_daily_summary
[0m17:28:07.326526 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_historical
[0m17:28:07.327372 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_daily_summary, now model.dw_project.bitcoin_historical)
[0m17:28:07.327999 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_historical
[0m17:28:07.332478 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_historical"
[0m17:28:07.333877 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_historical
[0m17:28:07.334297 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_realtime
[0m17:28:07.335105 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_historical, now model.dw_project.bitcoin_realtime)
[0m17:28:07.335656 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_realtime
[0m17:28:07.338755 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_realtime"
[0m17:28:07.340249 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_realtime
[0m17:28:07.341383 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:28:07.341660 [debug] [MainThread]: Connection 'model.dw_project.bitcoin_realtime' was properly closed.
[0m17:28:07.341980 [info ] [MainThread]: 
[0m17:28:07.342266 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 5.44 seconds (5.44s).
[0m17:28:07.342921 [debug] [MainThread]: Command end result
[0m17:28:07.363598 [info ] [MainThread]: 
[0m17:28:07.363914 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:28:07.364092 [info ] [MainThread]: 
[0m17:28:07.364297 [error] [MainThread]:   Database Error in model avg_price_realtime (models/output/avg_price_realtime.sql)
  000904 (42000): SQL compilation error: error line 5 at position 8
  invalid identifier 'TIME_OPEN_V1'
  compiled code at target/run/dw_project/models/output/avg_price_realtime.sql
[0m17:28:07.364456 [info ] [MainThread]: 
[0m17:28:07.364620 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m17:28:07.366584 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.8081098, "process_user_time": 2.363344, "process_kernel_time": 2.322265, "process_mem_max_rss": "208568320", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:28:07.366990 [debug] [MainThread]: Command `dbt run` failed at 17:28:07.366921 after 6.81 seconds
[0m17:28:07.367219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15e74f0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15f1aa7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15ef6ce90>]}
[0m17:28:07.367415 [debug] [MainThread]: Flushing usage events
[0m17:28:51.424296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110761370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d77d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d77a70>]}


============================== 17:28:51.425823 | 0cb4f73f-5aac-4a00-8a82-47a15e406ba1 ==============================
[0m17:28:51.425823 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:28:51.426092 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'quiet': 'False', 'cache_selected_only': 'False', 'introspect': 'True', 'fail_fast': 'False', 'write_json': 'True', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'printer_width': '80', 'version_check': 'True', 'static_parser': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'empty': 'False', 'target_path': 'None', 'invocation_command': 'dbt run', 'warn_error': 'None', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project'}
[0m17:28:52.459190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0cb4f73f-5aac-4a00-8a82-47a15e406ba1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15dc23ad0>]}
[0m17:28:52.479393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0cb4f73f-5aac-4a00-8a82-47a15e406ba1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11116e810>]}
[0m17:28:52.480105 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:28:52.490331 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:28:52.554385 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:28:52.554778 [debug] [MainThread]: Partial parsing: updated file: dw_project://models/output/avg_price_realtime.sql
[0m17:28:52.648142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0cb4f73f-5aac-4a00-8a82-47a15e406ba1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15e0e0800>]}
[0m17:28:52.684671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0cb4f73f-5aac-4a00-8a82-47a15e406ba1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15dd13470>]}
[0m17:28:52.684948 [info ] [MainThread]: Found 4 models, 3 sources, 459 macros
[0m17:28:52.685105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cb4f73f-5aac-4a00-8a82-47a15e406ba1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15dddcaa0>]}
[0m17:28:52.685882 [info ] [MainThread]: 
[0m17:28:52.686142 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:28:52.687980 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m17:28:52.693463 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m17:28:52.693662 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m17:28:52.693781 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:28:53.452103 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.758 seconds
[0m17:28:53.455807 [debug] [ThreadPool]: On list_lab2: Close
[0m17:28:53.637859 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m17:28:53.650748 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m17:28:53.651255 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m17:28:53.651540 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:28:54.231573 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.580 seconds
[0m17:28:54.235780 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m17:28:54.425800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cb4f73f-5aac-4a00-8a82-47a15e406ba1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067bbbf0>]}
[0m17:28:54.427353 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m17:28:54.428125 [info ] [MainThread]: 
[0m17:28:54.434170 [debug] [Thread-1 (]: Began running node model.dw_project.avg_price_realtime
[0m17:28:54.435040 [info ] [Thread-1 (]: 1 of 2 START sql table model analytics.avg_price_realtime ...................... [RUN]
[0m17:28:54.435635 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now model.dw_project.avg_price_realtime)
[0m17:28:54.436128 [debug] [Thread-1 (]: Began compiling node model.dw_project.avg_price_realtime
[0m17:28:54.495238 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.avg_price_realtime"
[0m17:28:54.495797 [debug] [Thread-1 (]: Began executing node model.dw_project.avg_price_realtime
[0m17:28:54.507956 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.avg_price_realtime"
[0m17:28:54.508553 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.avg_price_realtime"
[0m17:28:54.508725 [debug] [Thread-1 (]: On model.dw_project.avg_price_realtime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.avg_price_realtime"} */
create or replace transient table lab2.analytics.avg_price_realtime
         as
        (WITH realtime AS (
    SELECT 
        time_open AS time_period_start,
        price_close
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    time_period_start,
    AVG(price_close) OVER (ORDER BY time_period_start ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) AS thirty_min_avg_price
FROM realtime
ORDER BY time_period_start
        );
[0m17:28:54.508872 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:28:56.049015 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.539 seconds
[0m17:28:56.077048 [debug] [Thread-1 (]: On model.dw_project.avg_price_realtime: Close
[0m17:28:56.252460 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cb4f73f-5aac-4a00-8a82-47a15e406ba1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100adbe0>]}
[0m17:28:56.254274 [info ] [Thread-1 (]: 1 of 2 OK created sql table model analytics.avg_price_realtime ................. [[32mSUCCESS 1[0m in 1.81s]
[0m17:28:56.255458 [debug] [Thread-1 (]: Finished running node model.dw_project.avg_price_realtime
[0m17:28:56.256195 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_daily_summary
[0m17:28:56.257053 [info ] [Thread-1 (]: 2 of 2 START sql table model analytics.bitcoin_daily_summary ................... [RUN]
[0m17:28:56.257770 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.avg_price_realtime, now model.dw_project.bitcoin_daily_summary)
[0m17:28:56.258234 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_daily_summary
[0m17:28:56.262267 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_daily_summary"
[0m17:28:56.264250 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_daily_summary
[0m17:28:56.267039 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_daily_summary"
[0m17:28:56.268573 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_daily_summary"
[0m17:28:56.268968 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_daily_summary"} */
create or replace transient table lab2.analytics.bitcoin_daily_summary
         as
        (WITH historical_data AS (
    SELECT
        TIME_PERIOD_START::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_historical
),
realtime_data AS (
    SELECT
        TIME_OPEN::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    date,
    AVG(PRICE_OPEN) AS avg_open,
    AVG(PRICE_HIGH) AS avg_high,
    AVG(PRICE_LOW) AS avg_low,
    AVG(PRICE_CLOSE) AS avg_close,
    SUM(VOLUME_TRADED) AS total_volume,
    SUM(TRADES_COUNT) AS total_trades
FROM (
    SELECT * FROM historical_data
    UNION ALL
    SELECT * FROM realtime_data
) AS combined_data
GROUP BY date
ORDER BY date
        );
[0m17:28:56.269316 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:28:58.507333 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.237 seconds
[0m17:28:58.515405 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: Close
[0m17:28:58.689744 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cb4f73f-5aac-4a00-8a82-47a15e406ba1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15dfa1a30>]}
[0m17:28:58.691360 [info ] [Thread-1 (]: 2 of 2 OK created sql table model analytics.bitcoin_daily_summary .............. [[32mSUCCESS 1[0m in 2.43s]
[0m17:28:58.692431 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_daily_summary
[0m17:28:58.693184 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_historical
[0m17:28:58.693991 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_daily_summary, now model.dw_project.bitcoin_historical)
[0m17:28:58.694589 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_historical
[0m17:28:58.699104 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_historical"
[0m17:28:58.700505 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_historical
[0m17:28:58.700970 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_realtime
[0m17:28:58.701694 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_historical, now model.dw_project.bitcoin_realtime)
[0m17:28:58.702336 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_realtime
[0m17:28:58.705220 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_realtime"
[0m17:28:58.706525 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_realtime
[0m17:28:58.707687 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:28:58.707970 [debug] [MainThread]: Connection 'model.dw_project.bitcoin_realtime' was properly closed.
[0m17:28:58.708278 [info ] [MainThread]: 
[0m17:28:58.708559 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 6.02 seconds (6.02s).
[0m17:28:58.709217 [debug] [MainThread]: Command end result
[0m17:28:58.730206 [info ] [MainThread]: 
[0m17:28:58.730473 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:28:58.730657 [info ] [MainThread]: 
[0m17:28:58.730844 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m17:28:58.732680 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.3324947, "process_user_time": 2.924738, "process_kernel_time": 1.566504, "process_mem_max_rss": "208617472", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:28:58.732989 [debug] [MainThread]: Command `dbt run` succeeded at 17:28:58.732938 after 7.33 seconds
[0m17:28:58.733195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15dda8170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15da14650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d77c20>]}
[0m17:28:58.733420 [debug] [MainThread]: Flushing usage events
[0m17:32:42.622740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10408f170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10405c200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10405d400>]}


============================== 17:32:42.624297 | 148013f8-d226-47b3-97fa-105f93974f26 ==============================
[0m17:32:42.624297 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:32:42.624575 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'introspect': 'True', 'no_print': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'warn_error': 'None', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'printer_width': '80', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'version_check': 'True', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_format': 'default', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'debug': 'False', 'target_path': 'None', 'fail_fast': 'False', 'quiet': 'False'}
[0m17:32:43.529660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '148013f8-d226-47b3-97fa-105f93974f26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118f03e60>]}
[0m17:32:43.546287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '148013f8-d226-47b3-97fa-105f93974f26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ad8110>]}
[0m17:32:43.546773 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:32:43.555805 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:32:43.610340 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m17:32:43.610603 [debug] [MainThread]: Partial parsing: added file: dw_project://models/output/comparison.sql
[0m17:32:43.665125 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dw_project.comparison' (models/output/comparison.sql) depends on a source named 'raw_data.BITCOIN_REALTIME' which was not found
[0m17:32:43.666691 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.0686104, "process_user_time": 2.795719, "process_kernel_time": 1.197688, "process_mem_max_rss": "199540736", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:32:43.666931 [debug] [MainThread]: Command `dbt run` failed at 17:32:43.666887 after 1.07 seconds
[0m17:32:43.667088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11849f500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107037aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107034770>]}
[0m17:32:43.667227 [debug] [MainThread]: Flushing usage events
[0m17:33:14.307652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c95040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086a9460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086a94f0>]}


============================== 17:33:14.309203 | 8791511a-ae8a-4efe-bc21-8be76ff78c1f ==============================
[0m17:33:14.309203 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:33:14.309480 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error': 'None', 'introspect': 'True', 'version_check': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'fail_fast': 'False', 'debug': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'no_print': 'None', 'printer_width': '80', 'empty': 'False', 'log_format': 'default', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'use_colors': 'True', 'invocation_command': 'dbt run', 'quiet': 'False', 'use_experimental_parser': 'False', 'static_parser': 'True'}
[0m17:33:15.053180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8791511a-ae8a-4efe-bc21-8be76ff78c1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14765a900>]}
[0m17:33:15.070216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8791511a-ae8a-4efe-bc21-8be76ff78c1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1471ad130>]}
[0m17:33:15.070696 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:33:15.079774 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:33:15.133717 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m17:33:15.133955 [debug] [MainThread]: Partial parsing: added file: dw_project://models/output/comparison.sql
[0m17:33:15.214523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8791511a-ae8a-4efe-bc21-8be76ff78c1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x168bdcda0>]}
[0m17:33:15.250159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8791511a-ae8a-4efe-bc21-8be76ff78c1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1688176b0>]}
[0m17:33:15.250403 [info ] [MainThread]: Found 5 models, 3 sources, 459 macros
[0m17:33:15.250545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8791511a-ae8a-4efe-bc21-8be76ff78c1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x168bc9070>]}
[0m17:33:15.251247 [info ] [MainThread]: 
[0m17:33:15.251490 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:33:15.253152 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m17:33:15.257916 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m17:33:15.258054 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m17:33:15.258158 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:33:16.152874 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.894 seconds
[0m17:33:16.155825 [debug] [ThreadPool]: On list_lab2: Close
[0m17:33:16.337432 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m17:33:16.351705 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m17:33:16.352236 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m17:33:16.352545 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:33:16.936990 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.584 seconds
[0m17:33:16.940965 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m17:33:17.119934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8791511a-ae8a-4efe-bc21-8be76ff78c1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10810fbc0>]}
[0m17:33:17.121094 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m17:33:17.121588 [info ] [MainThread]: 
[0m17:33:17.126113 [debug] [Thread-1 (]: Began running node model.dw_project.avg_price_realtime
[0m17:33:17.126773 [info ] [Thread-1 (]: 1 of 3 START sql table model analytics.avg_price_realtime ...................... [RUN]
[0m17:33:17.127253 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now model.dw_project.avg_price_realtime)
[0m17:33:17.127564 [debug] [Thread-1 (]: Began compiling node model.dw_project.avg_price_realtime
[0m17:33:17.182322 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.avg_price_realtime"
[0m17:33:17.183711 [debug] [Thread-1 (]: Began executing node model.dw_project.avg_price_realtime
[0m17:33:17.195409 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.avg_price_realtime"
[0m17:33:17.195951 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.avg_price_realtime"
[0m17:33:17.196111 [debug] [Thread-1 (]: On model.dw_project.avg_price_realtime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.avg_price_realtime"} */
create or replace transient table lab2.analytics.avg_price_realtime
         as
        (WITH realtime AS (
    SELECT 
        time_open AS time_period_start,
        price_close
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    time_period_start,
    AVG(price_close) OVER (ORDER BY time_period_start ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) AS thirty_min_avg_price
FROM realtime
ORDER BY time_period_start
        );
[0m17:33:17.196255 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:33:19.219398 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.023 seconds
[0m17:33:19.249098 [debug] [Thread-1 (]: On model.dw_project.avg_price_realtime: Close
[0m17:33:19.451569 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8791511a-ae8a-4efe-bc21-8be76ff78c1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cfdcd0>]}
[0m17:33:19.453445 [info ] [Thread-1 (]: 1 of 3 OK created sql table model analytics.avg_price_realtime ................. [[32mSUCCESS 1[0m in 2.32s]
[0m17:33:19.454651 [debug] [Thread-1 (]: Finished running node model.dw_project.avg_price_realtime
[0m17:33:19.455514 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_daily_summary
[0m17:33:19.456422 [info ] [Thread-1 (]: 2 of 3 START sql table model analytics.bitcoin_daily_summary ................... [RUN]
[0m17:33:19.457063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.avg_price_realtime, now model.dw_project.bitcoin_daily_summary)
[0m17:33:19.457565 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_daily_summary
[0m17:33:19.462593 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_daily_summary"
[0m17:33:19.464883 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_daily_summary
[0m17:33:19.467914 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_daily_summary"
[0m17:33:19.469477 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_daily_summary"
[0m17:33:19.469851 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_daily_summary"} */
create or replace transient table lab2.analytics.bitcoin_daily_summary
         as
        (WITH historical_data AS (
    SELECT
        TIME_PERIOD_START::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_historical
),
realtime_data AS (
    SELECT
        TIME_OPEN::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    date,
    AVG(PRICE_OPEN) AS avg_open,
    AVG(PRICE_HIGH) AS avg_high,
    AVG(PRICE_LOW) AS avg_low,
    AVG(PRICE_CLOSE) AS avg_close,
    SUM(VOLUME_TRADED) AS total_volume,
    SUM(TRADES_COUNT) AS total_trades
FROM (
    SELECT * FROM historical_data
    UNION ALL
    SELECT * FROM realtime_data
) AS combined_data
GROUP BY date
ORDER BY date
        );
[0m17:33:19.470195 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:33:21.269249 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.798 seconds
[0m17:33:21.273832 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: Close
[0m17:33:21.452754 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8791511a-ae8a-4efe-bc21-8be76ff78c1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x168a846b0>]}
[0m17:33:21.454173 [info ] [Thread-1 (]: 2 of 3 OK created sql table model analytics.bitcoin_daily_summary .............. [[32mSUCCESS 1[0m in 2.00s]
[0m17:33:21.454890 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_daily_summary
[0m17:33:21.455385 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_historical
[0m17:33:21.455985 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_daily_summary, now model.dw_project.bitcoin_historical)
[0m17:33:21.456528 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_historical
[0m17:33:21.459621 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_historical"
[0m17:33:21.460573 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_historical
[0m17:33:21.460918 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_realtime
[0m17:33:21.461276 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_historical, now model.dw_project.bitcoin_realtime)
[0m17:33:21.461558 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_realtime
[0m17:33:21.463509 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_realtime"
[0m17:33:21.464379 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_realtime
[0m17:33:21.464660 [debug] [Thread-1 (]: Began running node model.dw_project.comparison
[0m17:33:21.465027 [info ] [Thread-1 (]: 3 of 3 START sql table model analytics.comparison .............................. [RUN]
[0m17:33:21.465490 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_realtime, now model.dw_project.comparison)
[0m17:33:21.465731 [debug] [Thread-1 (]: Began compiling node model.dw_project.comparison
[0m17:33:21.468027 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.comparison"
[0m17:33:21.468511 [debug] [Thread-1 (]: Began executing node model.dw_project.comparison
[0m17:33:21.470059 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.comparison"
[0m17:33:21.471170 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.comparison"
[0m17:33:21.471438 [debug] [Thread-1 (]: On model.dw_project.comparison: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.comparison"} */
create or replace transient table lab2.analytics.comparison
         as
        (WITH latest_realtime AS (
    SELECT 
        time_open AS time_period_start,
        price_close
    FROM lab2.raw_data.bitcoin_realtime
    WHERE time_open_v1 = (SELECT MAX(time_open_v1) FROM lab2.raw_data.bitcoin_realtime)
),
latest_historical AS (
    SELECT 
        time_period_end,
        price_close
    FROM lab2.raw_data.bitcoin_historical
    WHERE time_period_end = (SELECT MAX(time_period_end) FROM lab2.raw_data.bitcoin_historical)
)

SELECT
    h.time_period_end AS historical_time,
    h.price_close AS historical_close,
    r.time_period_start AS realtime_time,
    r.price_close AS realtime_close,
    CASE 
        WHEN h.price_close = 0 THEN NULL
        ELSE (r.price_close - h.price_close) / h.price_close * 100 
    END AS price_change_percentage
FROM latest_historical h
JOIN latest_realtime r
    ON DATE_TRUNC('DAY', h.time_period_end) = DATE_TRUNC('DAY', r.time_period_start)
ORDER BY h.time_period_end DESC
        );
[0m17:33:21.471678 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:33:22.180508 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b898dd-0003-60e9-0003-437a000dc25a
[0m17:33:22.181493 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 8 at position 10
invalid identifier 'TIME_OPEN_V1'
[0m17:33:22.182220 [debug] [Thread-1 (]: On model.dw_project.comparison: Close
[0m17:33:22.450878 [debug] [Thread-1 (]: Database Error in model comparison (models/output/comparison.sql)
  000904 (42000): SQL compilation error: error line 8 at position 10
  invalid identifier 'TIME_OPEN_V1'
  compiled code at target/run/dw_project/models/output/comparison.sql
[0m17:33:22.451990 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8791511a-ae8a-4efe-bc21-8be76ff78c1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1477ac7a0>]}
[0m17:33:22.452998 [error] [Thread-1 (]: 3 of 3 ERROR creating sql table model analytics.comparison ..................... [[31mERROR[0m in 0.99s]
[0m17:33:22.453781 [debug] [Thread-1 (]: Finished running node model.dw_project.comparison
[0m17:33:22.455502 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:33:22.455947 [debug] [MainThread]: Connection 'model.dw_project.comparison' was properly closed.
[0m17:33:22.456309 [info ] [MainThread]: 
[0m17:33:22.456614 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 7.20 seconds (7.20s).
[0m17:33:22.457501 [debug] [MainThread]: Command end result
[0m17:33:22.479282 [info ] [MainThread]: 
[0m17:33:22.479599 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:33:22.479784 [info ] [MainThread]: 
[0m17:33:22.480020 [error] [MainThread]:   Database Error in model comparison (models/output/comparison.sql)
  000904 (42000): SQL compilation error: error line 8 at position 10
  invalid identifier 'TIME_OPEN_V1'
  compiled code at target/run/dw_project/models/output/comparison.sql
[0m17:33:22.480204 [info ] [MainThread]: 
[0m17:33:22.480390 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m17:33:22.482197 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 8.19731, "process_user_time": 2.769172, "process_kernel_time": 1.726834, "process_mem_max_rss": "207060992", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:33:22.482491 [debug] [MainThread]: Command `dbt run` failed at 17:33:22.482439 after 8.20 seconds
[0m17:33:22.482691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10876c170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052a2870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109408ce0>]}
[0m17:33:22.482880 [debug] [MainThread]: Flushing usage events
[0m17:33:46.285645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105028a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d5d3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d5d430>]}


============================== 17:33:46.287234 | a497e3a4-ca6f-4efa-98fb-b198f87488c2 ==============================
[0m17:33:46.287234 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:33:46.287505 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'target_path': 'None', 'cache_selected_only': 'False', 'use_colors': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'printer_width': '80', 'version_check': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'fail_fast': 'False', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'invocation_command': 'dbt run', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'use_experimental_parser': 'False', 'warn_error': 'None', 'no_print': 'None', 'static_parser': 'True'}
[0m17:33:47.039107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a497e3a4-ca6f-4efa-98fb-b198f87488c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1655dc680>]}
[0m17:33:47.055547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a497e3a4-ca6f-4efa-98fb-b198f87488c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1654ba1e0>]}
[0m17:33:47.056615 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:33:47.065655 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:33:47.120141 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:33:47.120431 [debug] [MainThread]: Partial parsing: updated file: dw_project://models/output/comparison.sql
[0m17:33:47.201796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a497e3a4-ca6f-4efa-98fb-b198f87488c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1658d0e60>]}
[0m17:33:47.233211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a497e3a4-ca6f-4efa-98fb-b198f87488c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1657a8140>]}
[0m17:33:47.233418 [info ] [MainThread]: Found 5 models, 3 sources, 459 macros
[0m17:33:47.233563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a497e3a4-ca6f-4efa-98fb-b198f87488c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x165abb7d0>]}
[0m17:33:47.234281 [info ] [MainThread]: 
[0m17:33:47.234519 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:33:47.236150 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m17:33:47.240881 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m17:33:47.241013 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m17:33:47.241114 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:33:47.987944 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.745 seconds
[0m17:33:47.990447 [debug] [ThreadPool]: On list_lab2: Close
[0m17:33:48.182330 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m17:33:48.196128 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m17:33:48.196613 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m17:33:48.196923 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:33:48.772588 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.575 seconds
[0m17:33:48.776344 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m17:33:48.944253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a497e3a4-ca6f-4efa-98fb-b198f87488c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1657ab830>]}
[0m17:33:48.945508 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m17:33:48.946083 [info ] [MainThread]: 
[0m17:33:48.950402 [debug] [Thread-1 (]: Began running node model.dw_project.avg_price_realtime
[0m17:33:48.951225 [info ] [Thread-1 (]: 1 of 3 START sql table model analytics.avg_price_realtime ...................... [RUN]
[0m17:33:48.951794 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now model.dw_project.avg_price_realtime)
[0m17:33:48.952188 [debug] [Thread-1 (]: Began compiling node model.dw_project.avg_price_realtime
[0m17:33:49.009689 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.avg_price_realtime"
[0m17:33:49.010256 [debug] [Thread-1 (]: Began executing node model.dw_project.avg_price_realtime
[0m17:33:49.022245 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.avg_price_realtime"
[0m17:33:49.022821 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.avg_price_realtime"
[0m17:33:49.022990 [debug] [Thread-1 (]: On model.dw_project.avg_price_realtime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.avg_price_realtime"} */
create or replace transient table lab2.analytics.avg_price_realtime
         as
        (WITH realtime AS (
    SELECT 
        time_open AS time_period_start,
        price_close
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    time_period_start,
    AVG(price_close) OVER (ORDER BY time_period_start ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) AS thirty_min_avg_price
FROM realtime
ORDER BY time_period_start
        );
[0m17:33:49.023142 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:33:51.068181 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.044 seconds
[0m17:33:51.092605 [debug] [Thread-1 (]: On model.dw_project.avg_price_realtime: Close
[0m17:33:51.264317 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a497e3a4-ca6f-4efa-98fb-b198f87488c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1658aecf0>]}
[0m17:33:51.266319 [info ] [Thread-1 (]: 1 of 3 OK created sql table model analytics.avg_price_realtime ................. [[32mSUCCESS 1[0m in 2.31s]
[0m17:33:51.267588 [debug] [Thread-1 (]: Finished running node model.dw_project.avg_price_realtime
[0m17:33:51.268389 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_daily_summary
[0m17:33:51.269285 [info ] [Thread-1 (]: 2 of 3 START sql table model analytics.bitcoin_daily_summary ................... [RUN]
[0m17:33:51.270035 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.avg_price_realtime, now model.dw_project.bitcoin_daily_summary)
[0m17:33:51.270584 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_daily_summary
[0m17:33:51.275586 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_daily_summary"
[0m17:33:51.276834 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_daily_summary
[0m17:33:51.279734 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_daily_summary"
[0m17:33:51.281307 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_daily_summary"
[0m17:33:51.281695 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_daily_summary"} */
create or replace transient table lab2.analytics.bitcoin_daily_summary
         as
        (WITH historical_data AS (
    SELECT
        TIME_PERIOD_START::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_historical
),
realtime_data AS (
    SELECT
        TIME_OPEN::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    date,
    AVG(PRICE_OPEN) AS avg_open,
    AVG(PRICE_HIGH) AS avg_high,
    AVG(PRICE_LOW) AS avg_low,
    AVG(PRICE_CLOSE) AS avg_close,
    SUM(VOLUME_TRADED) AS total_volume,
    SUM(TRADES_COUNT) AS total_trades
FROM (
    SELECT * FROM historical_data
    UNION ALL
    SELECT * FROM realtime_data
) AS combined_data
GROUP BY date
ORDER BY date
        );
[0m17:33:51.282041 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:33:53.626261 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.344 seconds
[0m17:33:53.631775 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: Close
[0m17:33:53.813324 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a497e3a4-ca6f-4efa-98fb-b198f87488c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1658af1d0>]}
[0m17:33:53.815190 [info ] [Thread-1 (]: 2 of 3 OK created sql table model analytics.bitcoin_daily_summary .............. [[32mSUCCESS 1[0m in 2.54s]
[0m17:33:53.816354 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_daily_summary
[0m17:33:53.817038 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_historical
[0m17:33:53.817857 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_daily_summary, now model.dw_project.bitcoin_historical)
[0m17:33:53.818541 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_historical
[0m17:33:53.823089 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_historical"
[0m17:33:53.824512 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_historical
[0m17:33:53.824930 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_realtime
[0m17:33:53.825390 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_historical, now model.dw_project.bitcoin_realtime)
[0m17:33:53.826072 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_realtime
[0m17:33:53.828841 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_realtime"
[0m17:33:53.829783 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_realtime
[0m17:33:53.830145 [debug] [Thread-1 (]: Began running node model.dw_project.comparison
[0m17:33:53.830829 [info ] [Thread-1 (]: 3 of 3 START sql table model analytics.comparison .............................. [RUN]
[0m17:33:53.831490 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_realtime, now model.dw_project.comparison)
[0m17:33:53.831884 [debug] [Thread-1 (]: Began compiling node model.dw_project.comparison
[0m17:33:53.834905 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.comparison"
[0m17:33:53.835529 [debug] [Thread-1 (]: Began executing node model.dw_project.comparison
[0m17:33:53.837696 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.comparison"
[0m17:33:53.839137 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.comparison"
[0m17:33:53.839447 [debug] [Thread-1 (]: On model.dw_project.comparison: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.comparison"} */
create or replace transient table lab2.analytics.comparison
         as
        (WITH latest_realtime AS (
    SELECT 
        time_open AS time_period_start,
        price_close
    FROM lab2.raw_data.bitcoin_realtime
    WHERE time_open = (SELECT MAX(time_open) FROM lab2.raw_data.bitcoin_realtime)
),
latest_historical AS (
    SELECT 
        time_period_end,
        price_close
    FROM lab2.raw_data.bitcoin_historical
    WHERE time_period_end = (SELECT MAX(time_period_end) FROM lab2.raw_data.bitcoin_historical)
)

SELECT
    h.time_period_end AS historical_time,
    h.price_close AS historical_close,
    r.time_period_start AS realtime_time,
    r.price_close AS realtime_close,
    CASE 
        WHEN h.price_close = 0 THEN NULL
        ELSE (r.price_close - h.price_close) / h.price_close * 100 
    END AS price_change_percentage
FROM latest_historical h
JOIN latest_realtime r
    ON DATE_TRUNC('DAY', h.time_period_end) = DATE_TRUNC('DAY', r.time_period_start)
ORDER BY h.time_period_end DESC
        );
[0m17:33:53.839731 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:33:54.857683 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.017 seconds
[0m17:33:54.861766 [debug] [Thread-1 (]: On model.dw_project.comparison: Close
[0m17:33:55.021328 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a497e3a4-ca6f-4efa-98fb-b198f87488c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10820ad20>]}
[0m17:33:55.022634 [info ] [Thread-1 (]: 3 of 3 OK created sql table model analytics.comparison ......................... [[32mSUCCESS 1[0m in 1.19s]
[0m17:33:55.023484 [debug] [Thread-1 (]: Finished running node model.dw_project.comparison
[0m17:33:55.025498 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:33:55.026064 [debug] [MainThread]: Connection 'model.dw_project.comparison' was properly closed.
[0m17:33:55.026490 [info ] [MainThread]: 
[0m17:33:55.026870 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 7.79 seconds (7.79s).
[0m17:33:55.027860 [debug] [MainThread]: Command end result
[0m17:33:55.050170 [info ] [MainThread]: 
[0m17:33:55.050435 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:33:55.050609 [info ] [MainThread]: 
[0m17:33:55.050795 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m17:33:55.052775 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.795031, "process_user_time": 3.058566, "process_kernel_time": 1.429496, "process_mem_max_rss": "208191488", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:33:55.053082 [debug] [MainThread]: Command `dbt run` succeeded at 17:33:55.053027 after 8.80 seconds
[0m17:33:55.053286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d66ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d5d430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10820b7a0>]}
[0m17:33:55.053485 [debug] [MainThread]: Flushing usage events
[0m12:52:32.791463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112fabb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a73aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a73770>]}


============================== 12:52:32.793005 | 80253944-0b42-405f-a47a-c693b1d031f0 ==============================
[0m12:52:32.793005 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:52:32.793277 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'empty': 'False', 'static_parser': 'True', 'indirect_selection': 'eager', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'introspect': 'True', 'no_print': 'None', 'use_colors': 'True', 'log_format': 'default', 'debug': 'False', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'partial_parse': 'True', 'fail_fast': 'False', 'cache_selected_only': 'False', 'version_check': 'True', 'write_json': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'target_path': 'None'}
[0m12:52:33.703067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '80253944-0b42-405f-a47a-c693b1d031f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113aa1d90>]}
[0m12:52:33.719742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '80253944-0b42-405f-a47a-c693b1d031f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139573b0>]}
[0m12:52:33.720226 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:52:33.728956 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m12:52:33.782820 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:52:33.783015 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:52:33.793685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '80253944-0b42-405f-a47a-c693b1d031f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125d0b860>]}
[0m12:52:33.827511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80253944-0b42-405f-a47a-c693b1d031f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15f724fb0>]}
[0m12:52:33.827737 [info ] [MainThread]: Found 5 models, 3 sources, 459 macros
[0m12:52:33.827878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80253944-0b42-405f-a47a-c693b1d031f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15cc2a930>]}
[0m12:52:33.828601 [info ] [MainThread]: 
[0m12:52:33.828845 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:52:33.830551 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m12:52:33.836019 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m12:52:33.836153 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m12:52:33.836255 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:52:34.943392 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.107 seconds
[0m12:52:34.946459 [debug] [ThreadPool]: On list_lab2: Close
[0m12:52:35.137440 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m12:52:35.148648 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m12:52:35.149144 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m12:52:35.149417 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:52:35.961038 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.811 seconds
[0m12:52:35.964380 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m12:52:36.157258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80253944-0b42-405f-a47a-c693b1d031f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15f5bbd70>]}
[0m12:52:36.158122 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m12:52:36.158585 [info ] [MainThread]: 
[0m12:52:36.161688 [debug] [Thread-1 (]: Began running node model.dw_project.avg_price_realtime
[0m12:52:36.162535 [info ] [Thread-1 (]: 1 of 3 START sql table model analytics.avg_price_realtime ...................... [RUN]
[0m12:52:36.163229 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now model.dw_project.avg_price_realtime)
[0m12:52:36.163737 [debug] [Thread-1 (]: Began compiling node model.dw_project.avg_price_realtime
[0m12:52:36.172321 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.avg_price_realtime"
[0m12:52:36.173394 [debug] [Thread-1 (]: Began executing node model.dw_project.avg_price_realtime
[0m12:52:36.185574 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.avg_price_realtime"
[0m12:52:36.186238 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.avg_price_realtime"
[0m12:52:36.186423 [debug] [Thread-1 (]: On model.dw_project.avg_price_realtime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.avg_price_realtime"} */
create or replace transient table lab2.analytics.avg_price_realtime
         as
        (WITH realtime AS (
    SELECT 
        time_open AS time_period_start,
        price_close
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    time_period_start,
    AVG(price_close) OVER (ORDER BY time_period_start ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) AS thirty_min_avg_price
FROM realtime
ORDER BY time_period_start
        );
[0m12:52:36.186575 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:52:38.625119 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.438 seconds
[0m12:52:38.653435 [debug] [Thread-1 (]: On model.dw_project.avg_price_realtime: Close
[0m12:52:38.822013 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80253944-0b42-405f-a47a-c693b1d031f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15d8295e0>]}
[0m12:52:38.824068 [info ] [Thread-1 (]: 1 of 3 OK created sql table model analytics.avg_price_realtime ................. [[32mSUCCESS 1[0m in 2.66s]
[0m12:52:38.825393 [debug] [Thread-1 (]: Finished running node model.dw_project.avg_price_realtime
[0m12:52:38.826309 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_daily_summary
[0m12:52:38.827517 [info ] [Thread-1 (]: 2 of 3 START sql table model analytics.bitcoin_daily_summary ................... [RUN]
[0m12:52:38.828557 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.avg_price_realtime, now model.dw_project.bitcoin_daily_summary)
[0m12:52:38.829350 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_daily_summary
[0m12:52:38.834862 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_daily_summary"
[0m12:52:38.836321 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_daily_summary
[0m12:52:38.840676 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_daily_summary"
[0m12:52:38.842156 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_daily_summary"
[0m12:52:38.842519 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_daily_summary"} */
create or replace transient table lab2.analytics.bitcoin_daily_summary
         as
        (WITH historical_data AS (
    SELECT
        TIME_PERIOD_START::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_historical
),
realtime_data AS (
    SELECT
        TIME_OPEN::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    date,
    AVG(PRICE_OPEN) AS avg_open,
    AVG(PRICE_HIGH) AS avg_high,
    AVG(PRICE_LOW) AS avg_low,
    AVG(PRICE_CLOSE) AS avg_close,
    SUM(VOLUME_TRADED) AS total_volume,
    SUM(TRADES_COUNT) AS total_trades
FROM (
    SELECT * FROM historical_data
    UNION ALL
    SELECT * FROM realtime_data
) AS combined_data
GROUP BY date
ORDER BY date
        );
[0m12:52:38.842856 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:52:41.089287 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.246 seconds
[0m12:52:41.093850 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: Close
[0m12:52:41.266197 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80253944-0b42-405f-a47a-c693b1d031f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1681c8bc0>]}
[0m12:52:41.267810 [info ] [Thread-1 (]: 2 of 3 OK created sql table model analytics.bitcoin_daily_summary .............. [[32mSUCCESS 1[0m in 2.44s]
[0m12:52:41.268706 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_daily_summary
[0m12:52:41.269238 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_historical
[0m12:52:41.269860 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_daily_summary, now model.dw_project.bitcoin_historical)
[0m12:52:41.270364 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_historical
[0m12:52:41.274908 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_historical"
[0m12:52:41.276455 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_historical
[0m12:52:41.276929 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_realtime
[0m12:52:41.277331 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_historical, now model.dw_project.bitcoin_realtime)
[0m12:52:41.277769 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_realtime
[0m12:52:41.281001 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_realtime"
[0m12:52:41.282245 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_realtime
[0m12:52:41.282675 [debug] [Thread-1 (]: Began running node model.dw_project.comparison
[0m12:52:41.283126 [info ] [Thread-1 (]: 3 of 3 START sql table model analytics.comparison .............................. [RUN]
[0m12:52:41.283519 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_realtime, now model.dw_project.comparison)
[0m12:52:41.283810 [debug] [Thread-1 (]: Began compiling node model.dw_project.comparison
[0m12:52:41.286695 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.comparison"
[0m12:52:41.287318 [debug] [Thread-1 (]: Began executing node model.dw_project.comparison
[0m12:52:41.289094 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.comparison"
[0m12:52:41.290375 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.comparison"
[0m12:52:41.290668 [debug] [Thread-1 (]: On model.dw_project.comparison: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.comparison"} */
create or replace transient table lab2.analytics.comparison
         as
        (WITH latest_realtime AS (
    SELECT 
        time_open AS time_period_start,
        price_close
    FROM lab2.raw_data.bitcoin_realtime
    WHERE time_open = (SELECT MAX(time_open) FROM lab2.raw_data.bitcoin_realtime)
),
latest_historical AS (
    SELECT 
        time_period_end,
        price_close
    FROM lab2.raw_data.bitcoin_historical
    WHERE time_period_end = (SELECT MAX(time_period_end) FROM lab2.raw_data.bitcoin_historical)
)

SELECT
    h.time_period_end AS historical_time,
    h.price_close AS historical_close,
    r.time_period_start AS realtime_time,
    r.price_close AS realtime_close,
    CASE 
        WHEN h.price_close = 0 THEN NULL
        ELSE (r.price_close - h.price_close) / h.price_close * 100 
    END AS price_change_percentage
FROM latest_historical h
JOIN latest_realtime r
    ON DATE_TRUNC('DAY', h.time_period_end) = DATE_TRUNC('DAY', r.time_period_start)
ORDER BY h.time_period_end DESC
        );
[0m12:52:41.290937 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:52:43.232040 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.941 seconds
[0m12:52:43.236206 [debug] [Thread-1 (]: On model.dw_project.comparison: Close
[0m12:52:43.410158 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80253944-0b42-405f-a47a-c693b1d031f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16809cda0>]}
[0m12:52:43.411668 [info ] [Thread-1 (]: 3 of 3 OK created sql table model analytics.comparison ......................... [[32mSUCCESS 1[0m in 2.13s]
[0m12:52:43.412654 [debug] [Thread-1 (]: Finished running node model.dw_project.comparison
[0m12:52:43.414549 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:52:43.414997 [debug] [MainThread]: Connection 'model.dw_project.comparison' was properly closed.
[0m12:52:43.415552 [info ] [MainThread]: 
[0m12:52:43.416050 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 9.59 seconds (9.59s).
[0m12:52:43.417284 [debug] [MainThread]: Command end result
[0m12:52:43.485924 [info ] [MainThread]: 
[0m12:52:43.486178 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:52:43.486318 [info ] [MainThread]: 
[0m12:52:43.486482 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:52:43.488085 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.724136, "process_user_time": 2.493496, "process_kernel_time": 1.935325, "process_mem_max_rss": "205225984", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:52:43.488337 [debug] [MainThread]: Command `dbt run` succeeded at 12:52:43.488299 after 10.72 seconds
[0m12:52:43.488502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129d8260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15f669010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15f669310>]}
[0m12:52:43.488649 [debug] [MainThread]: Flushing usage events
[0m19:00:49.575548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109823650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109853da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109853b30>]}


============================== 19:00:49.576960 | aaddd123-318c-4b18-a7fd-559bc50e08a1 ==============================
[0m19:00:49.576960 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:00:49.577233 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'introspect': 'True', 'use_colors': 'True', 'fail_fast': 'False', 'no_print': 'None', 'static_parser': 'True', 'write_json': 'True', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'quiet': 'False', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'version_check': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'indirect_selection': 'eager', 'invocation_command': 'dbt run', 'warn_error': 'None', 'empty': 'False', 'use_experimental_parser': 'False', 'target_path': 'None', 'log_cache_events': 'False', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'log_format': 'default'}
[0m19:00:50.475644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aaddd123-318c-4b18-a7fd-559bc50e08a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129782a20>]}
[0m19:00:50.492392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aaddd123-318c-4b18-a7fd-559bc50e08a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10540af00>]}
[0m19:00:50.492841 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:00:50.501811 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:00:50.555450 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m19:00:50.555717 [debug] [MainThread]: Partial parsing: added file: dw_project://models/output/summary.sql
[0m19:00:50.636217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aaddd123-318c-4b18-a7fd-559bc50e08a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a0e50a0>]}
[0m19:00:50.670610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aaddd123-318c-4b18-a7fd-559bc50e08a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a0d2e10>]}
[0m19:00:50.670820 [info ] [MainThread]: Found 6 models, 3 sources, 459 macros
[0m19:00:50.670968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aaddd123-318c-4b18-a7fd-559bc50e08a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a0e5550>]}
[0m19:00:50.671688 [info ] [MainThread]: 
[0m19:00:50.671928 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:00:50.673546 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m19:00:50.678229 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m19:00:50.678364 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m19:00:50.678463 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:00:51.738129 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.059 seconds
[0m19:00:51.742600 [debug] [ThreadPool]: On list_lab2: Close
[0m19:00:51.933519 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m19:00:51.984437 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m19:00:51.984699 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m19:00:51.984840 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:00:52.447948 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.463 seconds
[0m19:00:52.451522 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m19:00:52.694276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aaddd123-318c-4b18-a7fd-559bc50e08a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a0e50a0>]}
[0m19:00:52.695375 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m19:00:52.695872 [info ] [MainThread]: 
[0m19:00:52.700697 [debug] [Thread-1 (]: Began running node model.dw_project.avg_price_realtime
[0m19:00:52.701577 [info ] [Thread-1 (]: 1 of 4 START sql table model analytics.avg_price_realtime ...................... [RUN]
[0m19:00:52.702172 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now model.dw_project.avg_price_realtime)
[0m19:00:52.702562 [debug] [Thread-1 (]: Began compiling node model.dw_project.avg_price_realtime
[0m19:00:52.710630 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.avg_price_realtime"
[0m19:00:52.711992 [debug] [Thread-1 (]: Began executing node model.dw_project.avg_price_realtime
[0m19:00:52.730997 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.avg_price_realtime"
[0m19:00:52.732310 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.avg_price_realtime"
[0m19:00:52.732559 [debug] [Thread-1 (]: On model.dw_project.avg_price_realtime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.avg_price_realtime"} */
create or replace transient table lab2.analytics.avg_price_realtime
         as
        (WITH realtime AS (
    SELECT 
        time_open AS time_period_start,
        price_close
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    time_period_start,
    AVG(price_close) OVER (ORDER BY time_period_start ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) AS thirty_min_avg_price
FROM realtime
ORDER BY time_period_start
        );
[0m19:00:52.732760 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:00:54.810139 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.077 seconds
[0m19:00:54.838071 [debug] [Thread-1 (]: On model.dw_project.avg_price_realtime: Close
[0m19:00:55.115842 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aaddd123-318c-4b18-a7fd-559bc50e08a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a3c8f80>]}
[0m19:00:55.117194 [info ] [Thread-1 (]: 1 of 4 OK created sql table model analytics.avg_price_realtime ................. [[32mSUCCESS 1[0m in 2.41s]
[0m19:00:55.117978 [debug] [Thread-1 (]: Finished running node model.dw_project.avg_price_realtime
[0m19:00:55.118550 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_daily_summary
[0m19:00:55.119223 [info ] [Thread-1 (]: 2 of 4 START sql table model analytics.bitcoin_daily_summary ................... [RUN]
[0m19:00:55.119806 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.avg_price_realtime, now model.dw_project.bitcoin_daily_summary)
[0m19:00:55.120325 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_daily_summary
[0m19:00:55.125269 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_daily_summary"
[0m19:00:55.126852 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_daily_summary
[0m19:00:55.130062 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_daily_summary"
[0m19:00:55.132090 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_daily_summary"
[0m19:00:55.132559 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_daily_summary"} */
create or replace transient table lab2.analytics.bitcoin_daily_summary
         as
        (WITH historical_data AS (
    SELECT
        TIME_PERIOD_START::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_historical
),
realtime_data AS (
    SELECT
        TIME_OPEN::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    date,
    AVG(PRICE_OPEN) AS avg_open,
    AVG(PRICE_HIGH) AS avg_high,
    AVG(PRICE_LOW) AS avg_low,
    AVG(PRICE_CLOSE) AS avg_close,
    SUM(VOLUME_TRADED) AS total_volume,
    SUM(TRADES_COUNT) AS total_trades
FROM (
    SELECT * FROM historical_data
    UNION ALL
    SELECT * FROM realtime_data
) AS combined_data
GROUP BY date
ORDER BY date
        );
[0m19:00:55.132969 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:00:57.237928 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.105 seconds
[0m19:00:57.242761 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: Close
[0m19:00:57.502137 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aaddd123-318c-4b18-a7fd-559bc50e08a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129f83a70>]}
[0m19:00:57.503943 [info ] [Thread-1 (]: 2 of 4 OK created sql table model analytics.bitcoin_daily_summary .............. [[32mSUCCESS 1[0m in 2.38s]
[0m19:00:57.505275 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_daily_summary
[0m19:00:57.506162 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_historical
[0m19:00:57.507206 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_daily_summary, now model.dw_project.bitcoin_historical)
[0m19:00:57.508021 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_historical
[0m19:00:57.513347 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_historical"
[0m19:00:57.516214 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_historical
[0m19:00:57.516768 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_realtime
[0m19:00:57.517353 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_historical, now model.dw_project.bitcoin_realtime)
[0m19:00:57.517873 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_realtime
[0m19:00:57.520898 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_realtime"
[0m19:00:57.522114 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_realtime
[0m19:00:57.522478 [debug] [Thread-1 (]: Began running node model.dw_project.comparison
[0m19:00:57.522961 [info ] [Thread-1 (]: 3 of 4 START sql table model analytics.comparison .............................. [RUN]
[0m19:00:57.523843 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_realtime, now model.dw_project.comparison)
[0m19:00:57.524239 [debug] [Thread-1 (]: Began compiling node model.dw_project.comparison
[0m19:00:57.525825 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.comparison"
[0m19:00:57.526336 [debug] [Thread-1 (]: Began executing node model.dw_project.comparison
[0m19:00:57.528275 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.comparison"
[0m19:00:57.529055 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.comparison"
[0m19:00:57.529230 [debug] [Thread-1 (]: On model.dw_project.comparison: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.comparison"} */
create or replace transient table lab2.analytics.comparison
         as
        (WITH latest_realtime AS (
    SELECT 
        time_open AS time_period_start,
        price_close
    FROM lab2.raw_data.bitcoin_realtime
    WHERE time_open = (SELECT MAX(time_open) FROM lab2.raw_data.bitcoin_realtime)
),
latest_historical AS (
    SELECT 
        time_period_end,
        price_close
    FROM lab2.raw_data.bitcoin_historical
    WHERE time_period_end = (SELECT MAX(time_period_end) FROM lab2.raw_data.bitcoin_historical)
)

SELECT
    h.time_period_end AS historical_time,
    h.price_close AS historical_close,
    r.time_period_start AS realtime_time,
    r.price_close AS realtime_close,
    CASE 
        WHEN h.price_close = 0 THEN NULL
        ELSE (r.price_close - h.price_close) / h.price_close * 100 
    END AS price_change_percentage
FROM latest_historical h
JOIN latest_realtime r
    ON DATE_TRUNC('DAY', h.time_period_end) = DATE_TRUNC('DAY', r.time_period_start)
ORDER BY h.time_period_end DESC
        );
[0m19:00:57.529382 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:00:58.536243 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.006 seconds
[0m19:00:58.540555 [debug] [Thread-1 (]: On model.dw_project.comparison: Close
[0m19:00:58.724145 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aaddd123-318c-4b18-a7fd-559bc50e08a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129f9c2c0>]}
[0m19:00:58.725709 [info ] [Thread-1 (]: 3 of 4 OK created sql table model analytics.comparison ......................... [[32mSUCCESS 1[0m in 1.20s]
[0m19:00:58.726828 [debug] [Thread-1 (]: Finished running node model.dw_project.comparison
[0m19:00:58.727628 [debug] [Thread-1 (]: Began running node model.dw_project.summary
[0m19:00:58.728372 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics.summary ................................. [RUN]
[0m19:00:58.729083 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.comparison, now model.dw_project.summary)
[0m19:00:58.729617 [debug] [Thread-1 (]: Began compiling node model.dw_project.summary
[0m19:00:58.738611 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.summary"
[0m19:00:58.739137 [debug] [Thread-1 (]: Began executing node model.dw_project.summary
[0m19:00:58.740554 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.summary"
[0m19:00:58.741294 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.summary"
[0m19:00:58.741456 [debug] [Thread-1 (]: On model.dw_project.summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.summary"} */
create or replace transient table lab2.analytics.summary
         as
        (WITH  __dbt__cte__bitcoin_historical as (
SELECT 
    time_period_start,
    time_period_end,
    time_open,
    time_close,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_historical
WHERE time_period_start IS NOT NULL
),  __dbt__cte__bitcoin_realtime as (
SELECT 
    time_open,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_realtime
WHERE price_close IS NOT NULL
), historical AS (
    SELECT * 
    FROM __dbt__cte__bitcoin_historical
),
realtime AS (
    SELECT * 
    FROM __dbt__cte__bitcoin_realtime
)
SELECT
    h.time_period_start AS timestamp,
    h.price_open AS historical_open,
    h.price_close AS historical_close,
    r.price_open AS realtime_open,
    r.price_close AS realtime_close
FROM historical h
LEFT JOIN realtime r 
    ON DATE_TRUNC('HOUR', h.time_period_start) = DATE_TRUNC('HOUR', r.time_open_v1)
        );
[0m19:00:58.741597 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:00:59.355690 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89ed4-0003-6302-0003-437a000e837e
[0m19:00:59.356238 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 44 at position 68
invalid identifier 'R.TIME_OPEN_V1'
[0m19:00:59.356741 [debug] [Thread-1 (]: On model.dw_project.summary: Close
[0m19:00:59.599154 [debug] [Thread-1 (]: Database Error in model summary (models/output/summary.sql)
  000904 (42000): SQL compilation error: error line 44 at position 68
  invalid identifier 'R.TIME_OPEN_V1'
  compiled code at target/run/dw_project/models/output/summary.sql
[0m19:00:59.600057 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aaddd123-318c-4b18-a7fd-559bc50e08a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129d95760>]}
[0m19:00:59.600976 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model analytics.summary ........................ [[31mERROR[0m in 0.87s]
[0m19:00:59.601835 [debug] [Thread-1 (]: Finished running node model.dw_project.summary
[0m19:00:59.603158 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:00:59.603450 [debug] [MainThread]: Connection 'model.dw_project.summary' was properly closed.
[0m19:00:59.603772 [info ] [MainThread]: 
[0m19:00:59.604129 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 8.93 seconds (8.93s).
[0m19:00:59.605417 [debug] [MainThread]: Command end result
[0m19:00:59.621852 [info ] [MainThread]: 
[0m19:00:59.622136 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:00:59.622272 [info ] [MainThread]: 
[0m19:00:59.622433 [error] [MainThread]:   Database Error in model summary (models/output/summary.sql)
  000904 (42000): SQL compilation error: error line 44 at position 68
  invalid identifier 'R.TIME_OPEN_V1'
  compiled code at target/run/dw_project/models/output/summary.sql
[0m19:00:59.622553 [info ] [MainThread]: 
[0m19:00:59.622691 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m19:00:59.624321 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 10.075018, "process_user_time": 3.524029, "process_kernel_time": 1.102361, "process_mem_max_rss": "209518592", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:00:59.624632 [debug] [MainThread]: Command `dbt run` failed at 19:00:59.624580 after 10.08 seconds
[0m19:00:59.624814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10938c170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10956af90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129fd54c0>]}
[0m19:00:59.624967 [debug] [MainThread]: Flushing usage events
[0m19:01:18.616558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104088470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049a9310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049a9400>]}


============================== 19:01:18.617780 | 01206cb1-ea41-4f6f-9063-99553b82cabd ==============================
[0m19:01:18.617780 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:01:18.618043 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'use_experimental_parser': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'cache_selected_only': 'False', 'printer_width': '80', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'empty': 'False', 'invocation_command': 'dbt run', 'use_colors': 'True', 'fail_fast': 'False', 'quiet': 'False', 'target_path': 'None', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'log_cache_events': 'False', 'introspect': 'True', 'indirect_selection': 'eager', 'version_check': 'True', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'debug': 'False'}
[0m19:01:19.341742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '01206cb1-ea41-4f6f-9063-99553b82cabd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1370c6930>]}
[0m19:01:19.358726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '01206cb1-ea41-4f6f-9063-99553b82cabd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049df800>]}
[0m19:01:19.359237 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:01:19.368007 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:01:19.421227 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:01:19.421508 [debug] [MainThread]: Partial parsing: updated file: dw_project://models/output/summary.sql
[0m19:01:19.501343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '01206cb1-ea41-4f6f-9063-99553b82cabd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1421e9610>]}
[0m19:01:19.532912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '01206cb1-ea41-4f6f-9063-99553b82cabd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1421dabd0>]}
[0m19:01:19.533111 [info ] [MainThread]: Found 6 models, 3 sources, 459 macros
[0m19:01:19.533251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01206cb1-ea41-4f6f-9063-99553b82cabd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137610890>]}
[0m19:01:19.533960 [info ] [MainThread]: 
[0m19:01:19.534187 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:01:19.535796 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m19:01:19.540476 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m19:01:19.540608 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m19:01:19.540710 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:01:20.199835 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.659 seconds
[0m19:01:20.201207 [debug] [ThreadPool]: On list_lab2: Close
[0m19:01:20.390407 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m19:01:20.403072 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m19:01:20.403733 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m19:01:20.404234 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:01:21.336914 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.932 seconds
[0m19:01:21.340815 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m19:01:21.641539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01206cb1-ea41-4f6f-9063-99553b82cabd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10440f9e0>]}
[0m19:01:21.642875 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m19:01:21.643467 [info ] [MainThread]: 
[0m19:01:21.647953 [debug] [Thread-1 (]: Began running node model.dw_project.avg_price_realtime
[0m19:01:21.648666 [info ] [Thread-1 (]: 1 of 4 START sql table model analytics.avg_price_realtime ...................... [RUN]
[0m19:01:21.649199 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now model.dw_project.avg_price_realtime)
[0m19:01:21.649583 [debug] [Thread-1 (]: Began compiling node model.dw_project.avg_price_realtime
[0m19:01:21.706801 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.avg_price_realtime"
[0m19:01:21.707390 [debug] [Thread-1 (]: Began executing node model.dw_project.avg_price_realtime
[0m19:01:21.719456 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.avg_price_realtime"
[0m19:01:21.720309 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.avg_price_realtime"
[0m19:01:21.720540 [debug] [Thread-1 (]: On model.dw_project.avg_price_realtime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.avg_price_realtime"} */
create or replace transient table lab2.analytics.avg_price_realtime
         as
        (WITH realtime AS (
    SELECT 
        time_open AS time_period_start,
        price_close
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    time_period_start,
    AVG(price_close) OVER (ORDER BY time_period_start ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) AS thirty_min_avg_price
FROM realtime
ORDER BY time_period_start
        );
[0m19:01:21.720696 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:01:23.388566 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.667 seconds
[0m19:01:23.418518 [debug] [Thread-1 (]: On model.dw_project.avg_price_realtime: Close
[0m19:01:23.734019 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01206cb1-ea41-4f6f-9063-99553b82cabd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ffdb80>]}
[0m19:01:23.735450 [info ] [Thread-1 (]: 1 of 4 OK created sql table model analytics.avg_price_realtime ................. [[32mSUCCESS 1[0m in 2.08s]
[0m19:01:23.736426 [debug] [Thread-1 (]: Finished running node model.dw_project.avg_price_realtime
[0m19:01:23.737101 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_daily_summary
[0m19:01:23.737950 [info ] [Thread-1 (]: 2 of 4 START sql table model analytics.bitcoin_daily_summary ................... [RUN]
[0m19:01:23.738564 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.avg_price_realtime, now model.dw_project.bitcoin_daily_summary)
[0m19:01:23.738959 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_daily_summary
[0m19:01:23.742452 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_daily_summary"
[0m19:01:23.743307 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_daily_summary
[0m19:01:23.745505 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_daily_summary"
[0m19:01:23.746927 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_daily_summary"
[0m19:01:23.747299 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_daily_summary"} */
create or replace transient table lab2.analytics.bitcoin_daily_summary
         as
        (WITH historical_data AS (
    SELECT
        TIME_PERIOD_START::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_historical
),
realtime_data AS (
    SELECT
        TIME_OPEN::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    date,
    AVG(PRICE_OPEN) AS avg_open,
    AVG(PRICE_HIGH) AS avg_high,
    AVG(PRICE_LOW) AS avg_low,
    AVG(PRICE_CLOSE) AS avg_close,
    SUM(VOLUME_TRADED) AS total_volume,
    SUM(TRADES_COUNT) AS total_trades
FROM (
    SELECT * FROM historical_data
    UNION ALL
    SELECT * FROM realtime_data
) AS combined_data
GROUP BY date
ORDER BY date
        );
[0m19:01:23.747649 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:01:25.725822 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.978 seconds
[0m19:01:25.730609 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: Close
[0m19:01:26.071929 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01206cb1-ea41-4f6f-9063-99553b82cabd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137679730>]}
[0m19:01:26.073569 [info ] [Thread-1 (]: 2 of 4 OK created sql table model analytics.bitcoin_daily_summary .............. [[32mSUCCESS 1[0m in 2.33s]
[0m19:01:26.074709 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_daily_summary
[0m19:01:26.075480 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_historical
[0m19:01:26.076402 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_daily_summary, now model.dw_project.bitcoin_historical)
[0m19:01:26.077080 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_historical
[0m19:01:26.081700 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_historical"
[0m19:01:26.083628 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_historical
[0m19:01:26.084431 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_realtime
[0m19:01:26.085079 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_historical, now model.dw_project.bitcoin_realtime)
[0m19:01:26.085576 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_realtime
[0m19:01:26.088584 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_realtime"
[0m19:01:26.089624 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_realtime
[0m19:01:26.089973 [debug] [Thread-1 (]: Began running node model.dw_project.comparison
[0m19:01:26.090819 [info ] [Thread-1 (]: 3 of 4 START sql table model analytics.comparison .............................. [RUN]
[0m19:01:26.091335 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_realtime, now model.dw_project.comparison)
[0m19:01:26.091660 [debug] [Thread-1 (]: Began compiling node model.dw_project.comparison
[0m19:01:26.094631 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.comparison"
[0m19:01:26.095231 [debug] [Thread-1 (]: Began executing node model.dw_project.comparison
[0m19:01:26.097077 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.comparison"
[0m19:01:26.098465 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.comparison"
[0m19:01:26.098770 [debug] [Thread-1 (]: On model.dw_project.comparison: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.comparison"} */
create or replace transient table lab2.analytics.comparison
         as
        (WITH latest_realtime AS (
    SELECT 
        time_open AS time_period_start,
        price_close
    FROM lab2.raw_data.bitcoin_realtime
    WHERE time_open = (SELECT MAX(time_open) FROM lab2.raw_data.bitcoin_realtime)
),
latest_historical AS (
    SELECT 
        time_period_end,
        price_close
    FROM lab2.raw_data.bitcoin_historical
    WHERE time_period_end = (SELECT MAX(time_period_end) FROM lab2.raw_data.bitcoin_historical)
)

SELECT
    h.time_period_end AS historical_time,
    h.price_close AS historical_close,
    r.time_period_start AS realtime_time,
    r.price_close AS realtime_close,
    CASE 
        WHEN h.price_close = 0 THEN NULL
        ELSE (r.price_close - h.price_close) / h.price_close * 100 
    END AS price_change_percentage
FROM latest_historical h
JOIN latest_realtime r
    ON DATE_TRUNC('DAY', h.time_period_end) = DATE_TRUNC('DAY', r.time_period_start)
ORDER BY h.time_period_end DESC
        );
[0m19:01:26.099052 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:01:27.484461 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.385 seconds
[0m19:01:27.486589 [debug] [Thread-1 (]: On model.dw_project.comparison: Close
[0m19:01:27.673065 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01206cb1-ea41-4f6f-9063-99553b82cabd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1425f99a0>]}
[0m19:01:27.674109 [info ] [Thread-1 (]: 3 of 4 OK created sql table model analytics.comparison ......................... [[32mSUCCESS 1[0m in 1.58s]
[0m19:01:27.674816 [debug] [Thread-1 (]: Finished running node model.dw_project.comparison
[0m19:01:27.675286 [debug] [Thread-1 (]: Began running node model.dw_project.summary
[0m19:01:27.675861 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics.summary ................................. [RUN]
[0m19:01:27.676400 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.comparison, now model.dw_project.summary)
[0m19:01:27.676790 [debug] [Thread-1 (]: Began compiling node model.dw_project.summary
[0m19:01:27.687040 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.summary"
[0m19:01:27.688257 [debug] [Thread-1 (]: Began executing node model.dw_project.summary
[0m19:01:27.691612 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.summary"
[0m19:01:27.693689 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.summary"
[0m19:01:27.694095 [debug] [Thread-1 (]: On model.dw_project.summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.summary"} */
create or replace transient table lab2.analytics.summary
         as
        (WITH  __dbt__cte__bitcoin_historical as (
SELECT 
    time_period_start,
    time_period_end,
    time_open,
    time_close,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_historical
WHERE time_period_start IS NOT NULL
),  __dbt__cte__bitcoin_realtime as (
SELECT 
    time_open,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_realtime
WHERE price_close IS NOT NULL
), historical AS (
    SELECT * 
    FROM __dbt__cte__bitcoin_historical
),
realtime AS (
    SELECT * 
    FROM __dbt__cte__bitcoin_realtime
)
SELECT
    h.time_period_start AS timestamp,
    h.price_open AS historical_open,
    h.price_close AS historical_close,
    r.price_open AS realtime_open,
    r.price_close AS realtime_close
FROM historical h
LEFT JOIN realtime r 
    ON DATE_TRUNC('HOUR', h.time_period_start) = DATE_TRUNC('HOUR', r.time_open)
        );
[0m19:01:27.694440 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:01:29.504943 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.810 seconds
[0m19:01:29.511818 [debug] [Thread-1 (]: On model.dw_project.summary: Close
[0m19:01:29.696301 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01206cb1-ea41-4f6f-9063-99553b82cabd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1375ab6b0>]}
[0m19:01:29.697082 [info ] [Thread-1 (]: 4 of 4 OK created sql table model analytics.summary ............................ [[32mSUCCESS 1[0m in 2.02s]
[0m19:01:29.697603 [debug] [Thread-1 (]: Finished running node model.dw_project.summary
[0m19:01:29.698578 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:01:29.698855 [debug] [MainThread]: Connection 'model.dw_project.summary' was properly closed.
[0m19:01:29.699151 [info ] [MainThread]: 
[0m19:01:29.699442 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 10.16 seconds (10.16s).
[0m19:01:29.700388 [debug] [MainThread]: Command end result
[0m19:01:29.723579 [info ] [MainThread]: 
[0m19:01:29.723822 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:01:29.723952 [info ] [MainThread]: 
[0m19:01:29.724088 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m19:01:29.726304 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.131691, "process_user_time": 2.493296, "process_kernel_time": 2.004939, "process_mem_max_rss": "208338944", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:01:29.726524 [debug] [MainThread]: Command `dbt run` succeeded at 19:01:29.726487 after 11.13 seconds
[0m19:01:29.726677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136ca2ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059c3ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137562330>]}
[0m19:01:29.726814 [debug] [MainThread]: Flushing usage events
[0m19:04:13.535936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c74920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107373d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107373aa0>]}


============================== 19:04:13.537784 | 52b1890d-c318-410b-a640-7fcf6430ca6a ==============================
[0m19:04:13.537784 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:04:13.538083 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'debug': 'False', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'empty': 'False', 'use_colors': 'True', 'target_path': 'None', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'warn_error': 'None', 'log_format': 'default', 'partial_parse': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'printer_width': '80', 'write_json': 'True'}
[0m19:04:14.485045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '52b1890d-c318-410b-a640-7fcf6430ca6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153558980>]}
[0m19:04:14.501718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '52b1890d-c318-410b-a640-7fcf6430ca6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1534e4aa0>]}
[0m19:04:14.502215 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:04:14.511586 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:04:14.566390 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:04:14.566608 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:04:14.578447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '52b1890d-c318-410b-a640-7fcf6430ca6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1537ae0c0>]}
[0m19:04:14.624804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '52b1890d-c318-410b-a640-7fcf6430ca6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1541a8410>]}
[0m19:04:14.625069 [info ] [MainThread]: Found 6 models, 3 sources, 459 macros
[0m19:04:14.625218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52b1890d-c318-410b-a640-7fcf6430ca6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15359a870>]}
[0m19:04:14.626008 [info ] [MainThread]: 
[0m19:04:14.626260 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:04:14.628011 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m19:04:14.633684 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m19:04:14.633834 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m19:04:14.633937 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:04:15.721250 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.086 seconds
[0m19:04:15.724199 [debug] [ThreadPool]: On list_lab2: Close
[0m19:04:15.918549 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m19:04:15.933129 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m19:04:15.933739 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m19:04:15.934059 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:04:16.722402 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.788 seconds
[0m19:04:16.726853 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m19:04:16.965973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52b1890d-c318-410b-a640-7fcf6430ca6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1542b5af0>]}
[0m19:04:16.967368 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m19:04:16.968069 [info ] [MainThread]: 
[0m19:04:16.973365 [debug] [Thread-1 (]: Began running node model.dw_project.avg_price_realtime
[0m19:04:16.974083 [info ] [Thread-1 (]: 1 of 4 START sql table model analytics.avg_price_realtime ...................... [RUN]
[0m19:04:16.974620 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now model.dw_project.avg_price_realtime)
[0m19:04:16.974982 [debug] [Thread-1 (]: Began compiling node model.dw_project.avg_price_realtime
[0m19:04:16.983622 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.avg_price_realtime"
[0m19:04:16.985197 [debug] [Thread-1 (]: Began executing node model.dw_project.avg_price_realtime
[0m19:04:17.004464 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.avg_price_realtime"
[0m19:04:17.005436 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.avg_price_realtime"
[0m19:04:17.005696 [debug] [Thread-1 (]: On model.dw_project.avg_price_realtime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.avg_price_realtime"} */
create or replace transient table lab2.analytics.avg_price_realtime
         as
        (WITH realtime AS (
    SELECT 
        time_open AS time_period_start,
        price_close
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    time_period_start,
    AVG(price_close) OVER (ORDER BY time_period_start ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) AS thirty_min_avg_price
FROM realtime
ORDER BY time_period_start
        );
[0m19:04:17.005886 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:04:18.913558 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.907 seconds
[0m19:04:18.934536 [debug] [Thread-1 (]: On model.dw_project.avg_price_realtime: Close
[0m19:04:19.128459 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52b1890d-c318-410b-a640-7fcf6430ca6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15362cef0>]}
[0m19:04:19.129296 [info ] [Thread-1 (]: 1 of 4 OK created sql table model analytics.avg_price_realtime ................. [[32mSUCCESS 1[0m in 2.15s]
[0m19:04:19.129778 [debug] [Thread-1 (]: Finished running node model.dw_project.avg_price_realtime
[0m19:04:19.130109 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_daily_summary
[0m19:04:19.130536 [info ] [Thread-1 (]: 2 of 4 START sql table model analytics.bitcoin_daily_summary ................... [RUN]
[0m19:04:19.130911 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.avg_price_realtime, now model.dw_project.bitcoin_daily_summary)
[0m19:04:19.131152 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_daily_summary
[0m19:04:19.133349 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_daily_summary"
[0m19:04:19.135090 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_daily_summary
[0m19:04:19.137768 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_daily_summary"
[0m19:04:19.138769 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_daily_summary"
[0m19:04:19.139006 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_daily_summary"} */
create or replace transient table lab2.analytics.bitcoin_daily_summary
         as
        (WITH historical_data AS (
    SELECT
        TIME_PERIOD_START::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_historical
),
realtime_data AS (
    SELECT
        TIME_OPEN::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    date,
    AVG(PRICE_OPEN) AS avg_open,
    AVG(PRICE_HIGH) AS avg_high,
    AVG(PRICE_LOW) AS avg_low,
    AVG(PRICE_CLOSE) AS avg_close,
    SUM(VOLUME_TRADED) AS total_volume,
    SUM(TRADES_COUNT) AS total_trades
FROM (
    SELECT * FROM historical_data
    UNION ALL
    SELECT * FROM realtime_data
) AS combined_data
GROUP BY date
ORDER BY date
        );
[0m19:04:19.139230 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:04:21.454649 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.315 seconds
[0m19:04:21.459742 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: Close
[0m19:04:21.619437 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52b1890d-c318-410b-a640-7fcf6430ca6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15449a780>]}
[0m19:04:21.620862 [info ] [Thread-1 (]: 2 of 4 OK created sql table model analytics.bitcoin_daily_summary .............. [[32mSUCCESS 1[0m in 2.49s]
[0m19:04:21.621977 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_daily_summary
[0m19:04:21.622626 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_historical
[0m19:04:21.623280 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_daily_summary, now model.dw_project.bitcoin_historical)
[0m19:04:21.623804 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_historical
[0m19:04:21.627057 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_historical"
[0m19:04:21.628041 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_historical
[0m19:04:21.628394 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_realtime
[0m19:04:21.628830 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_historical, now model.dw_project.bitcoin_realtime)
[0m19:04:21.629270 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_realtime
[0m19:04:21.631635 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_realtime"
[0m19:04:21.632544 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_realtime
[0m19:04:21.632828 [debug] [Thread-1 (]: Began running node model.dw_project.comparison
[0m19:04:21.633202 [info ] [Thread-1 (]: 3 of 4 START sql table model analytics.comparison .............................. [RUN]
[0m19:04:21.633595 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_realtime, now model.dw_project.comparison)
[0m19:04:21.633872 [debug] [Thread-1 (]: Began compiling node model.dw_project.comparison
[0m19:04:21.636356 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.comparison"
[0m19:04:21.636985 [debug] [Thread-1 (]: Began executing node model.dw_project.comparison
[0m19:04:21.638663 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.comparison"
[0m19:04:21.639806 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.comparison"
[0m19:04:21.640083 [debug] [Thread-1 (]: On model.dw_project.comparison: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.comparison"} */
create or replace transient table lab2.analytics.comparison
         as
        (WITH latest_realtime AS (
    SELECT 
        time_open AS time_period_start,
        price_close
    FROM lab2.raw_data.bitcoin_realtime
    WHERE time_open = (SELECT MAX(time_open) FROM lab2.raw_data.bitcoin_realtime)
),
latest_historical AS (
    SELECT 
        time_period_end,
        price_close
    FROM lab2.raw_data.bitcoin_historical
    WHERE time_period_end = (SELECT MAX(time_period_end) FROM lab2.raw_data.bitcoin_historical)
)

SELECT
    h.time_period_end AS historical_time,
    h.price_close AS historical_close,
    r.time_period_start AS realtime_time,
    r.price_close AS realtime_close,
    CASE 
        WHEN h.price_close = 0 THEN NULL
        ELSE (r.price_close - h.price_close) / h.price_close * 100 
    END AS price_change_percentage
FROM latest_historical h
JOIN latest_realtime r
    ON DATE_TRUNC('DAY', h.time_period_end) = DATE_TRUNC('DAY', r.time_period_start)
ORDER BY h.time_period_end DESC
        );
[0m19:04:21.640334 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:04:23.575858 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.935 seconds
[0m19:04:23.580673 [debug] [Thread-1 (]: On model.dw_project.comparison: Close
[0m19:04:23.813264 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52b1890d-c318-410b-a640-7fcf6430ca6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1544c9880>]}
[0m19:04:23.814860 [info ] [Thread-1 (]: 3 of 4 OK created sql table model analytics.comparison ......................... [[32mSUCCESS 1[0m in 2.18s]
[0m19:04:23.815708 [debug] [Thread-1 (]: Finished running node model.dw_project.comparison
[0m19:04:23.816279 [debug] [Thread-1 (]: Began running node model.dw_project.summary
[0m19:04:23.816888 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics.summary ................................. [RUN]
[0m19:04:23.817456 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.comparison, now model.dw_project.summary)
[0m19:04:23.817854 [debug] [Thread-1 (]: Began compiling node model.dw_project.summary
[0m19:04:23.825673 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.summary"
[0m19:04:23.826509 [debug] [Thread-1 (]: Began executing node model.dw_project.summary
[0m19:04:23.829182 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.summary"
[0m19:04:23.830563 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.summary"
[0m19:04:23.830865 [debug] [Thread-1 (]: On model.dw_project.summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.summary"} */
create or replace transient table lab2.analytics.summary
         as
        (WITH  __dbt__cte__bitcoin_historical as (
SELECT 
    time_period_start,
    time_period_end,
    time_open,
    time_close,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_historical
WHERE time_period_start IS NOT NULL
),  __dbt__cte__bitcoin_realtime as (
SELECT 
    time_open,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_realtime
WHERE price_close IS NOT NULL
), historical AS (
    SELECT * 
    FROM __dbt__cte__bitcoin_historical
),
realtime AS (
    SELECT * 
    FROM __dbt__cte__bitcoin_realtime
)
SELECT
    h.time_period_start AS timestamp,
    h.price_open AS historical_open,
    h.price_close AS historical_close,
    r.price_open AS realtime_open,
    r.price_close AS realtime_close
FROM historical h
LEFT JOIN realtime r 
    ON DATE_TRUNC('HOUR', h.time_period_start) = DATE_TRUNC('HOUR', r.time_open)
        );
[0m19:04:23.831151 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:04:25.895773 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.064 seconds
[0m19:04:25.902020 [debug] [Thread-1 (]: On model.dw_project.summary: Close
[0m19:04:26.374010 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52b1890d-c318-410b-a640-7fcf6430ca6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10422f6b0>]}
[0m19:04:26.375587 [info ] [Thread-1 (]: 4 of 4 OK created sql table model analytics.summary ............................ [[32mSUCCESS 1[0m in 2.56s]
[0m19:04:26.376469 [debug] [Thread-1 (]: Finished running node model.dw_project.summary
[0m19:04:26.378480 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:04:26.378911 [debug] [MainThread]: Connection 'model.dw_project.summary' was properly closed.
[0m19:04:26.379407 [info ] [MainThread]: 
[0m19:04:26.379837 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 11.75 seconds (11.75s).
[0m19:04:26.381005 [debug] [MainThread]: Command end result
[0m19:04:26.447354 [info ] [MainThread]: 
[0m19:04:26.447630 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:04:26.447765 [info ] [MainThread]: 
[0m19:04:26.447905 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m19:04:26.449780 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.94145, "process_user_time": 2.980294, "process_kernel_time": 1.527935, "process_mem_max_rss": "205307904", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:04:26.450025 [debug] [MainThread]: Command `dbt run` succeeded at 19:04:26.449985 after 12.94 seconds
[0m19:04:26.450189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15425fa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1537adf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1537acc20>]}
[0m19:04:26.450335 [debug] [MainThread]: Flushing usage events
[0m19:07:59.299338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cb0c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dabd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dabaa0>]}


============================== 19:07:59.300763 | 3fd78525-36bc-4fc6-89ad-27a82264c275 ==============================
[0m19:07:59.300763 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:07:59.301037 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'use_experimental_parser': 'False', 'empty': 'False', 'printer_width': '80', 'version_check': 'True', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'target_path': 'None', 'quiet': 'False', 'invocation_command': 'dbt run', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'indirect_selection': 'eager', 'use_colors': 'True', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'static_parser': 'True', 'no_print': 'None', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False'}
[0m19:08:00.195019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3fd78525-36bc-4fc6-89ad-27a82264c275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1252310a0>]}
[0m19:08:00.211397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3fd78525-36bc-4fc6-89ad-27a82264c275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079705c0>]}
[0m19:08:00.211897 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:08:00.226338 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:08:00.280305 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:08:00.280593 [debug] [MainThread]: Partial parsing: updated file: dw_project://models/output/summary.sql
[0m19:08:00.361169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3fd78525-36bc-4fc6-89ad-27a82264c275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126ae1520>]}
[0m19:08:00.396292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3fd78525-36bc-4fc6-89ad-27a82264c275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126ad2d80>]}
[0m19:08:00.396502 [info ] [MainThread]: Found 6 models, 3 sources, 459 macros
[0m19:08:00.396646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fd78525-36bc-4fc6-89ad-27a82264c275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126982e40>]}
[0m19:08:00.397374 [info ] [MainThread]: 
[0m19:08:00.397622 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:08:00.399214 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m19:08:00.403892 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m19:08:00.404024 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m19:08:00.404124 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:08:01.721548 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.316 seconds
[0m19:08:01.726144 [debug] [ThreadPool]: On list_lab2: Close
[0m19:08:02.033793 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m19:08:02.044336 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m19:08:02.044875 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m19:08:02.045239 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:08:03.253973 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.208 seconds
[0m19:08:03.259881 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m19:08:03.505339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fd78525-36bc-4fc6-89ad-27a82264c275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1269ade80>]}
[0m19:08:03.506524 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m19:08:03.507085 [info ] [MainThread]: 
[0m19:08:03.512351 [debug] [Thread-1 (]: Began running node model.dw_project.avg_price_realtime
[0m19:08:03.513154 [info ] [Thread-1 (]: 1 of 4 START sql table model analytics.avg_price_realtime ...................... [RUN]
[0m19:08:03.513802 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now model.dw_project.avg_price_realtime)
[0m19:08:03.514275 [debug] [Thread-1 (]: Began compiling node model.dw_project.avg_price_realtime
[0m19:08:03.572959 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.avg_price_realtime"
[0m19:08:03.574007 [debug] [Thread-1 (]: Began executing node model.dw_project.avg_price_realtime
[0m19:08:03.586034 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.avg_price_realtime"
[0m19:08:03.586587 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.avg_price_realtime"
[0m19:08:03.586756 [debug] [Thread-1 (]: On model.dw_project.avg_price_realtime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.avg_price_realtime"} */
create or replace transient table lab2.analytics.avg_price_realtime
         as
        (WITH realtime AS (
    SELECT 
        time_open AS time_period_start,
        price_close
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    time_period_start,
    AVG(price_close) OVER (ORDER BY time_period_start ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) AS thirty_min_avg_price
FROM realtime
ORDER BY time_period_start
        );
[0m19:08:03.586897 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:08:06.225987 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.638 seconds
[0m19:08:06.250511 [debug] [Thread-1 (]: On model.dw_project.avg_price_realtime: Close
[0m19:08:06.456783 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fd78525-36bc-4fc6-89ad-27a82264c275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125df6120>]}
[0m19:08:06.458293 [info ] [Thread-1 (]: 1 of 4 OK created sql table model analytics.avg_price_realtime ................. [[32mSUCCESS 1[0m in 2.94s]
[0m19:08:06.459326 [debug] [Thread-1 (]: Finished running node model.dw_project.avg_price_realtime
[0m19:08:06.459994 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_daily_summary
[0m19:08:06.460812 [info ] [Thread-1 (]: 2 of 4 START sql table model analytics.bitcoin_daily_summary ................... [RUN]
[0m19:08:06.461499 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.avg_price_realtime, now model.dw_project.bitcoin_daily_summary)
[0m19:08:06.461979 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_daily_summary
[0m19:08:06.466054 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_daily_summary"
[0m19:08:06.467346 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_daily_summary
[0m19:08:06.469617 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_daily_summary"
[0m19:08:06.471098 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_daily_summary"
[0m19:08:06.471471 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_daily_summary"} */
create or replace transient table lab2.analytics.bitcoin_daily_summary
         as
        (WITH historical_data AS (
    SELECT
        TIME_PERIOD_START::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_historical
),
realtime_data AS (
    SELECT
        TIME_OPEN::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    date,
    AVG(PRICE_OPEN) AS avg_open,
    AVG(PRICE_HIGH) AS avg_high,
    AVG(PRICE_LOW) AS avg_low,
    AVG(PRICE_CLOSE) AS avg_close,
    SUM(VOLUME_TRADED) AS total_volume,
    SUM(TRADES_COUNT) AS total_trades
FROM (
    SELECT * FROM historical_data
    UNION ALL
    SELECT * FROM realtime_data
) AS combined_data
GROUP BY date
ORDER BY date
        );
[0m19:08:06.471813 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:08:08.373726 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.901 seconds
[0m19:08:08.378641 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: Close
[0m19:08:08.669497 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fd78525-36bc-4fc6-89ad-27a82264c275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126dd5910>]}
[0m19:08:08.672013 [info ] [Thread-1 (]: 2 of 4 OK created sql table model analytics.bitcoin_daily_summary .............. [[32mSUCCESS 1[0m in 2.21s]
[0m19:08:08.673910 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_daily_summary
[0m19:08:08.674988 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_historical
[0m19:08:08.675549 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_daily_summary, now model.dw_project.bitcoin_historical)
[0m19:08:08.675950 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_historical
[0m19:08:08.680464 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_historical"
[0m19:08:08.683127 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_historical
[0m19:08:08.683551 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_realtime
[0m19:08:08.684087 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_historical, now model.dw_project.bitcoin_realtime)
[0m19:08:08.684514 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_realtime
[0m19:08:08.687088 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_realtime"
[0m19:08:08.688729 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_realtime
[0m19:08:08.689088 [debug] [Thread-1 (]: Began running node model.dw_project.comparison
[0m19:08:08.689793 [info ] [Thread-1 (]: 3 of 4 START sql table model analytics.comparison .............................. [RUN]
[0m19:08:08.690146 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_realtime, now model.dw_project.comparison)
[0m19:08:08.690392 [debug] [Thread-1 (]: Began compiling node model.dw_project.comparison
[0m19:08:08.692898 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.comparison"
[0m19:08:08.693657 [debug] [Thread-1 (]: Began executing node model.dw_project.comparison
[0m19:08:08.695461 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.comparison"
[0m19:08:08.696701 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.comparison"
[0m19:08:08.696981 [debug] [Thread-1 (]: On model.dw_project.comparison: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.comparison"} */
create or replace transient table lab2.analytics.comparison
         as
        (WITH latest_realtime AS (
    SELECT 
        time_open AS time_period_start,
        price_close
    FROM lab2.raw_data.bitcoin_realtime
    WHERE time_open = (SELECT MAX(time_open) FROM lab2.raw_data.bitcoin_realtime)
),
latest_historical AS (
    SELECT 
        time_period_end,
        price_close
    FROM lab2.raw_data.bitcoin_historical
    WHERE time_period_end = (SELECT MAX(time_period_end) FROM lab2.raw_data.bitcoin_historical)
)

SELECT
    h.time_period_end AS historical_time,
    h.price_close AS historical_close,
    r.time_period_start AS realtime_time,
    r.price_close AS realtime_close,
    CASE 
        WHEN h.price_close = 0 THEN NULL
        ELSE (r.price_close - h.price_close) / h.price_close * 100 
    END AS price_change_percentage
FROM latest_historical h
JOIN latest_realtime r
    ON DATE_TRUNC('DAY', h.time_period_end) = DATE_TRUNC('DAY', r.time_period_start)
ORDER BY h.time_period_end DESC
        );
[0m19:08:08.697224 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:08:09.706833 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.009 seconds
[0m19:08:09.713779 [debug] [Thread-1 (]: On model.dw_project.comparison: Close
[0m19:08:09.972971 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fd78525-36bc-4fc6-89ad-27a82264c275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126def1d0>]}
[0m19:08:09.973720 [info ] [Thread-1 (]: 3 of 4 OK created sql table model analytics.comparison ......................... [[32mSUCCESS 1[0m in 1.28s]
[0m19:08:09.974232 [debug] [Thread-1 (]: Finished running node model.dw_project.comparison
[0m19:08:09.974620 [debug] [Thread-1 (]: Began running node model.dw_project.summary
[0m19:08:09.975126 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics.summary ................................. [RUN]
[0m19:08:09.975671 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.comparison, now model.dw_project.summary)
[0m19:08:09.976017 [debug] [Thread-1 (]: Began compiling node model.dw_project.summary
[0m19:08:09.984356 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.summary"
[0m19:08:09.985530 [debug] [Thread-1 (]: Began executing node model.dw_project.summary
[0m19:08:09.988811 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.summary"
[0m19:08:09.990658 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.summary"
[0m19:08:09.991067 [debug] [Thread-1 (]: On model.dw_project.summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.summary"} */
create or replace transient table lab2.analytics.summary
         as
        (WITH  __dbt__cte__bitcoin_historical as (
SELECT 
    time_period_start,
    time_period_end,
    time_open,
    time_close,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_historical
WHERE time_period_start IS NOT NULL
),  __dbt__cte__bitcoin_realtime as (
SELECT 
    time_open,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_realtime
WHERE price_close IS NOT NULL
), historical AS (
    SELECT * 
    FROM __dbt__cte__bitcoin_historical
),
realtime AS (
    SELECT * 
    FROM __dbt__cte__bitcoin_realtime
)
SELECT
    h.time_period_start AS timestamp,
    h.price_open AS historical_open,
    h.price_close AS historical_close,
    r.price_open AS realtime_open,
    r.price_close AS realtime_close
FROM historical h
LEFT JOIN realtime r 
    ON DATE_TRUNC('DATE', h.time_period_start) = DATE_TRUNC('DATE', r.time_open)
        );
[0m19:08:09.992739 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:08:10.622502 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89edc-0003-62ff-0003-437a0010318a
[0m19:08:10.623282 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002151 (22023): SQL compilation error: ['DATE'] is not a valid date/time component for function DATE_TRUNC.
[0m19:08:10.623696 [debug] [Thread-1 (]: On model.dw_project.summary: Close
[0m19:08:10.813199 [debug] [Thread-1 (]: Database Error in model summary (models/output/summary.sql)
  002151 (22023): SQL compilation error: ['DATE'] is not a valid date/time component for function DATE_TRUNC.
  compiled code at target/run/dw_project/models/output/summary.sql
[0m19:08:10.814170 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fd78525-36bc-4fc6-89ad-27a82264c275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106da9c10>]}
[0m19:08:10.814708 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model analytics.summary ........................ [[31mERROR[0m in 0.84s]
[0m19:08:10.815637 [debug] [Thread-1 (]: Finished running node model.dw_project.summary
[0m19:08:10.816813 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:08:10.817306 [debug] [MainThread]: Connection 'model.dw_project.summary' was properly closed.
[0m19:08:10.817749 [info ] [MainThread]: 
[0m19:08:10.818117 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 10.42 seconds (10.42s).
[0m19:08:10.819342 [debug] [MainThread]: Command end result
[0m19:08:10.838250 [info ] [MainThread]: 
[0m19:08:10.838503 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:08:10.838628 [info ] [MainThread]: 
[0m19:08:10.838804 [error] [MainThread]:   Database Error in model summary (models/output/summary.sql)
  002151 (22023): SQL compilation error: ['DATE'] is not a valid date/time component for function DATE_TRUNC.
  compiled code at target/run/dw_project/models/output/summary.sql
[0m19:08:10.839027 [info ] [MainThread]: 
[0m19:08:10.839261 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m19:08:10.840915 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 11.566986, "process_user_time": 3.42419, "process_kernel_time": 1.143196, "process_mem_max_rss": "209338368", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:08:10.841132 [debug] [MainThread]: Command `dbt run` failed at 19:08:10.841098 after 11.57 seconds
[0m19:08:10.841280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d89580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125f96db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125f96c00>]}
[0m19:08:10.841481 [debug] [MainThread]: Flushing usage events
[0m19:08:37.429683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104894980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10612d2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10612d370>]}


============================== 19:08:37.431524 | 038cd593-4b57-422c-abf5-d4051e1af3b9 ==============================
[0m19:08:37.431524 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:08:37.431839 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'log_format': 'default', 'fail_fast': 'False', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'debug': 'False', 'log_cache_events': 'False', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'warn_error': 'None', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'empty': 'False', 'invocation_command': 'dbt run', 'no_print': 'None', 'quiet': 'False', 'printer_width': '80', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m19:08:38.169320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '038cd593-4b57-422c-abf5-d4051e1af3b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15d12b4d0>]}
[0m19:08:38.186020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '038cd593-4b57-422c-abf5-d4051e1af3b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15d12bdd0>]}
[0m19:08:38.186505 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:08:38.195096 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:08:38.248390 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:08:38.248678 [debug] [MainThread]: Partial parsing: updated file: dw_project://models/output/summary.sql
[0m19:08:38.328580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '038cd593-4b57-422c-abf5-d4051e1af3b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15d1a3e00>]}
[0m19:08:38.359691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '038cd593-4b57-422c-abf5-d4051e1af3b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15d6c6690>]}
[0m19:08:38.359909 [info ] [MainThread]: Found 6 models, 3 sources, 459 macros
[0m19:08:38.360051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '038cd593-4b57-422c-abf5-d4051e1af3b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15d4dd8b0>]}
[0m19:08:38.360760 [info ] [MainThread]: 
[0m19:08:38.360996 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:08:38.362607 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m19:08:38.367400 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m19:08:38.367541 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m19:08:38.367652 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:08:39.077249 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.709 seconds
[0m19:08:39.080286 [debug] [ThreadPool]: On list_lab2: Close
[0m19:08:39.264359 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m19:08:39.278004 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m19:08:39.278536 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m19:08:39.278862 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:08:40.117254 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.838 seconds
[0m19:08:40.121261 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m19:08:40.301809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '038cd593-4b57-422c-abf5-d4051e1af3b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15d5a84d0>]}
[0m19:08:40.302984 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m19:08:40.303398 [info ] [MainThread]: 
[0m19:08:40.307365 [debug] [Thread-1 (]: Began running node model.dw_project.avg_price_realtime
[0m19:08:40.308113 [info ] [Thread-1 (]: 1 of 4 START sql table model analytics.avg_price_realtime ...................... [RUN]
[0m19:08:40.308648 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now model.dw_project.avg_price_realtime)
[0m19:08:40.309020 [debug] [Thread-1 (]: Began compiling node model.dw_project.avg_price_realtime
[0m19:08:40.367182 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.avg_price_realtime"
[0m19:08:40.367677 [debug] [Thread-1 (]: Began executing node model.dw_project.avg_price_realtime
[0m19:08:40.379480 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.avg_price_realtime"
[0m19:08:40.380031 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.avg_price_realtime"
[0m19:08:40.380199 [debug] [Thread-1 (]: On model.dw_project.avg_price_realtime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.avg_price_realtime"} */
create or replace transient table lab2.analytics.avg_price_realtime
         as
        (WITH realtime AS (
    SELECT 
        time_open AS time_period_start,
        price_close
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    time_period_start,
    AVG(price_close) OVER (ORDER BY time_period_start ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) AS thirty_min_avg_price
FROM realtime
ORDER BY time_period_start
        );
[0m19:08:40.380338 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:08:42.012274 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.631 seconds
[0m19:08:42.040951 [debug] [Thread-1 (]: On model.dw_project.avg_price_realtime: Close
[0m19:08:42.212352 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '038cd593-4b57-422c-abf5-d4051e1af3b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15e2e8980>]}
[0m19:08:42.213552 [info ] [Thread-1 (]: 1 of 4 OK created sql table model analytics.avg_price_realtime ................. [[32mSUCCESS 1[0m in 1.90s]
[0m19:08:42.214248 [debug] [Thread-1 (]: Finished running node model.dw_project.avg_price_realtime
[0m19:08:42.214714 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_daily_summary
[0m19:08:42.215277 [info ] [Thread-1 (]: 2 of 4 START sql table model analytics.bitcoin_daily_summary ................... [RUN]
[0m19:08:42.215741 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.avg_price_realtime, now model.dw_project.bitcoin_daily_summary)
[0m19:08:42.216098 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_daily_summary
[0m19:08:42.220300 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_daily_summary"
[0m19:08:42.221255 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_daily_summary
[0m19:08:42.223505 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_daily_summary"
[0m19:08:42.225039 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_daily_summary"
[0m19:08:42.225425 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_daily_summary"} */
create or replace transient table lab2.analytics.bitcoin_daily_summary
         as
        (WITH historical_data AS (
    SELECT
        TIME_PERIOD_START::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_historical
),
realtime_data AS (
    SELECT
        TIME_OPEN::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    date,
    AVG(PRICE_OPEN) AS avg_open,
    AVG(PRICE_HIGH) AS avg_high,
    AVG(PRICE_LOW) AS avg_low,
    AVG(PRICE_CLOSE) AS avg_close,
    SUM(VOLUME_TRADED) AS total_volume,
    SUM(TRADES_COUNT) AS total_trades
FROM (
    SELECT * FROM historical_data
    UNION ALL
    SELECT * FROM realtime_data
) AS combined_data
GROUP BY date
ORDER BY date
        );
[0m19:08:42.225762 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:08:44.521889 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.296 seconds
[0m19:08:44.526515 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: Close
[0m19:08:44.707810 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '038cd593-4b57-422c-abf5-d4051e1af3b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b4bc80>]}
[0m19:08:44.708921 [info ] [Thread-1 (]: 2 of 4 OK created sql table model analytics.bitcoin_daily_summary .............. [[32mSUCCESS 1[0m in 2.49s]
[0m19:08:44.709815 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_daily_summary
[0m19:08:44.710423 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_historical
[0m19:08:44.711065 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_daily_summary, now model.dw_project.bitcoin_historical)
[0m19:08:44.711650 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_historical
[0m19:08:44.715221 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_historical"
[0m19:08:44.716947 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_historical
[0m19:08:44.717356 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_realtime
[0m19:08:44.717769 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_historical, now model.dw_project.bitcoin_realtime)
[0m19:08:44.718100 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_realtime
[0m19:08:44.720709 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_realtime"
[0m19:08:44.721664 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_realtime
[0m19:08:44.722081 [debug] [Thread-1 (]: Began running node model.dw_project.comparison
[0m19:08:44.722840 [info ] [Thread-1 (]: 3 of 4 START sql table model analytics.comparison .............................. [RUN]
[0m19:08:44.723362 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_realtime, now model.dw_project.comparison)
[0m19:08:44.723741 [debug] [Thread-1 (]: Began compiling node model.dw_project.comparison
[0m19:08:44.725422 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.comparison"
[0m19:08:44.725796 [debug] [Thread-1 (]: Began executing node model.dw_project.comparison
[0m19:08:44.726984 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.comparison"
[0m19:08:44.727854 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.comparison"
[0m19:08:44.728039 [debug] [Thread-1 (]: On model.dw_project.comparison: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.comparison"} */
create or replace transient table lab2.analytics.comparison
         as
        (WITH latest_realtime AS (
    SELECT 
        time_open AS time_period_start,
        price_close
    FROM lab2.raw_data.bitcoin_realtime
    WHERE time_open = (SELECT MAX(time_open) FROM lab2.raw_data.bitcoin_realtime)
),
latest_historical AS (
    SELECT 
        time_period_end,
        price_close
    FROM lab2.raw_data.bitcoin_historical
    WHERE time_period_end = (SELECT MAX(time_period_end) FROM lab2.raw_data.bitcoin_historical)
)

SELECT
    h.time_period_end AS historical_time,
    h.price_close AS historical_close,
    r.time_period_start AS realtime_time,
    r.price_close AS realtime_close,
    CASE 
        WHEN h.price_close = 0 THEN NULL
        ELSE (r.price_close - h.price_close) / h.price_close * 100 
    END AS price_change_percentage
FROM latest_historical h
JOIN latest_realtime r
    ON DATE_TRUNC('DAY', h.time_period_end) = DATE_TRUNC('DAY', r.time_period_start)
ORDER BY h.time_period_end DESC
        );
[0m19:08:44.728209 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:08:45.955017 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.226 seconds
[0m19:08:45.960518 [debug] [Thread-1 (]: On model.dw_project.comparison: Close
[0m19:08:46.131534 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '038cd593-4b57-422c-abf5-d4051e1af3b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15d27dbb0>]}
[0m19:08:46.133190 [info ] [Thread-1 (]: 3 of 4 OK created sql table model analytics.comparison ......................... [[32mSUCCESS 1[0m in 1.41s]
[0m19:08:46.134293 [debug] [Thread-1 (]: Finished running node model.dw_project.comparison
[0m19:08:46.135055 [debug] [Thread-1 (]: Began running node model.dw_project.summary
[0m19:08:46.135911 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics.summary ................................. [RUN]
[0m19:08:46.136682 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.comparison, now model.dw_project.summary)
[0m19:08:46.137295 [debug] [Thread-1 (]: Began compiling node model.dw_project.summary
[0m19:08:46.149196 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.summary"
[0m19:08:46.150307 [debug] [Thread-1 (]: Began executing node model.dw_project.summary
[0m19:08:46.153532 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.summary"
[0m19:08:46.155175 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.summary"
[0m19:08:46.155560 [debug] [Thread-1 (]: On model.dw_project.summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.summary"} */
create or replace transient table lab2.analytics.summary
         as
        (WITH  __dbt__cte__bitcoin_historical as (
SELECT 
    time_period_start,
    time_period_end,
    time_open,
    time_close,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_historical
WHERE time_period_start IS NOT NULL
),  __dbt__cte__bitcoin_realtime as (
SELECT 
    time_open,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_realtime
WHERE price_close IS NOT NULL
), historical AS (
    SELECT * 
    FROM __dbt__cte__bitcoin_historical
),
realtime AS (
    SELECT * 
    FROM __dbt__cte__bitcoin_realtime
)
SELECT
    h.time_period_start AS timestamp,
    h.price_open AS historical_open,
    h.price_close AS historical_close,
    r.price_open AS realtime_open,
    r.price_close AS realtime_close
FROM historical h
LEFT JOIN realtime r 
    ON DATE_TRUNC('DAY', h.time_period_start) = DATE_TRUNC('DAY', r.time_open)
        );
[0m19:08:46.155898 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:08:48.007086 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.851 seconds
[0m19:08:48.010842 [debug] [Thread-1 (]: On model.dw_project.summary: Close
[0m19:08:48.197790 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '038cd593-4b57-422c-abf5-d4051e1af3b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107114bc0>]}
[0m19:08:48.198890 [info ] [Thread-1 (]: 4 of 4 OK created sql table model analytics.summary ............................ [[32mSUCCESS 1[0m in 2.06s]
[0m19:08:48.199771 [debug] [Thread-1 (]: Finished running node model.dw_project.summary
[0m19:08:48.201277 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:08:48.201770 [debug] [MainThread]: Connection 'model.dw_project.summary' was properly closed.
[0m19:08:48.202282 [info ] [MainThread]: 
[0m19:08:48.202761 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 9.84 seconds (9.84s).
[0m19:08:48.204259 [debug] [MainThread]: Command end result
[0m19:08:48.223608 [info ] [MainThread]: 
[0m19:08:48.223871 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:08:48.224013 [info ] [MainThread]: 
[0m19:08:48.224162 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m19:08:48.225711 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.824663, "process_user_time": 2.386088, "process_kernel_time": 2.151894, "process_mem_max_rss": "206716928", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:08:48.225940 [debug] [MainThread]: Command `dbt run` succeeded at 19:08:48.225904 after 10.82 seconds
[0m19:08:48.226101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b51eab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15d296450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15d2968d0>]}
[0m19:08:48.226238 [debug] [MainThread]: Flushing usage events
[0m19:09:35.389548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071cf0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071b7260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061e1400>]}


============================== 19:09:35.391024 | 13c4a425-2ad3-4dec-b29f-bf89f3957c60 ==============================
[0m19:09:35.391024 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:09:35.391289 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'fail_fast': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'empty': 'False', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'partial_parse': 'True', 'debug': 'False', 'cache_selected_only': 'False', 'printer_width': '80', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'version_check': 'True', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'use_experimental_parser': 'False', 'introspect': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'write_json': 'True', 'quiet': 'False', 'log_cache_events': 'False'}
[0m19:09:36.289443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '13c4a425-2ad3-4dec-b29f-bf89f3957c60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1340c10a0>]}
[0m19:09:36.306238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '13c4a425-2ad3-4dec-b29f-bf89f3957c60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1143a5760>]}
[0m19:09:36.306739 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:09:36.315993 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:09:36.371664 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:09:36.371930 [debug] [MainThread]: Partial parsing: updated file: dw_project://models/output/summary.sql
[0m19:09:36.451607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '13c4a425-2ad3-4dec-b29f-bf89f3957c60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1429e1400>]}
[0m19:09:36.485663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '13c4a425-2ad3-4dec-b29f-bf89f3957c60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1429d6d80>]}
[0m19:09:36.485863 [info ] [MainThread]: Found 6 models, 3 sources, 459 macros
[0m19:09:36.486008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13c4a425-2ad3-4dec-b29f-bf89f3957c60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1429e3560>]}
[0m19:09:36.486725 [info ] [MainThread]: 
[0m19:09:36.486956 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:09:36.488569 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m19:09:36.493298 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m19:09:36.493431 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m19:09:36.493532 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:09:37.462033 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.968 seconds
[0m19:09:37.465394 [debug] [ThreadPool]: On list_lab2: Close
[0m19:09:37.701271 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m19:09:37.714177 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m19:09:37.714472 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m19:09:37.714604 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:09:38.344591 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.630 seconds
[0m19:09:38.349049 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m19:09:38.650053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13c4a425-2ad3-4dec-b29f-bf89f3957c60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c47cb0>]}
[0m19:09:38.651312 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m19:09:38.651911 [info ] [MainThread]: 
[0m19:09:38.657046 [debug] [Thread-1 (]: Began running node model.dw_project.avg_price_realtime
[0m19:09:38.657911 [info ] [Thread-1 (]: 1 of 4 START sql table model analytics.avg_price_realtime ...................... [RUN]
[0m19:09:38.658603 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now model.dw_project.avg_price_realtime)
[0m19:09:38.659061 [debug] [Thread-1 (]: Began compiling node model.dw_project.avg_price_realtime
[0m19:09:38.717666 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.avg_price_realtime"
[0m19:09:38.719185 [debug] [Thread-1 (]: Began executing node model.dw_project.avg_price_realtime
[0m19:09:38.731145 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.avg_price_realtime"
[0m19:09:38.731940 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.avg_price_realtime"
[0m19:09:38.732174 [debug] [Thread-1 (]: On model.dw_project.avg_price_realtime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.avg_price_realtime"} */
create or replace transient table lab2.analytics.avg_price_realtime
         as
        (WITH realtime AS (
    SELECT 
        time_open AS time_period_start,
        price_close
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    time_period_start,
    AVG(price_close) OVER (ORDER BY time_period_start ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) AS thirty_min_avg_price
FROM realtime
ORDER BY time_period_start
        );
[0m19:09:38.732330 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:09:40.405872 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.673 seconds
[0m19:09:40.434939 [debug] [Thread-1 (]: On model.dw_project.avg_price_realtime: Close
[0m19:09:40.604488 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13c4a425-2ad3-4dec-b29f-bf89f3957c60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106835cd0>]}
[0m19:09:40.605692 [info ] [Thread-1 (]: 1 of 4 OK created sql table model analytics.avg_price_realtime ................. [[32mSUCCESS 1[0m in 1.94s]
[0m19:09:40.606453 [debug] [Thread-1 (]: Finished running node model.dw_project.avg_price_realtime
[0m19:09:40.606957 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_daily_summary
[0m19:09:40.607744 [info ] [Thread-1 (]: 2 of 4 START sql table model analytics.bitcoin_daily_summary ................... [RUN]
[0m19:09:40.608504 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.avg_price_realtime, now model.dw_project.bitcoin_daily_summary)
[0m19:09:40.608945 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_daily_summary
[0m19:09:40.612341 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_daily_summary"
[0m19:09:40.613248 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_daily_summary
[0m19:09:40.615415 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_daily_summary"
[0m19:09:40.617033 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_daily_summary"
[0m19:09:40.617392 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_daily_summary"} */
create or replace transient table lab2.analytics.bitcoin_daily_summary
         as
        (WITH historical_data AS (
    SELECT
        TIME_PERIOD_START::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_historical
),
realtime_data AS (
    SELECT
        TIME_OPEN::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    date,
    AVG(PRICE_OPEN) AS avg_open,
    AVG(PRICE_HIGH) AS avg_high,
    AVG(PRICE_LOW) AS avg_low,
    AVG(PRICE_CLOSE) AS avg_close,
    SUM(VOLUME_TRADED) AS total_volume,
    SUM(TRADES_COUNT) AS total_trades
FROM (
    SELECT * FROM historical_data
    UNION ALL
    SELECT * FROM realtime_data
) AS combined_data
GROUP BY date
ORDER BY date
        );
[0m19:09:40.617683 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:09:42.889802 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.272 seconds
[0m19:09:42.893697 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: Close
[0m19:09:43.111311 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13c4a425-2ad3-4dec-b29f-bf89f3957c60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10722f200>]}
[0m19:09:43.112275 [info ] [Thread-1 (]: 2 of 4 OK created sql table model analytics.bitcoin_daily_summary .............. [[32mSUCCESS 1[0m in 2.50s]
[0m19:09:43.113127 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_daily_summary
[0m19:09:43.113789 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_historical
[0m19:09:43.114493 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_daily_summary, now model.dw_project.bitcoin_historical)
[0m19:09:43.115072 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_historical
[0m19:09:43.119204 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_historical"
[0m19:09:43.120486 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_historical
[0m19:09:43.120908 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_realtime
[0m19:09:43.121460 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_historical, now model.dw_project.bitcoin_realtime)
[0m19:09:43.121877 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_realtime
[0m19:09:43.124487 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_realtime"
[0m19:09:43.125449 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_realtime
[0m19:09:43.125896 [debug] [Thread-1 (]: Began running node model.dw_project.comparison
[0m19:09:43.126402 [info ] [Thread-1 (]: 3 of 4 START sql table model analytics.comparison .............................. [RUN]
[0m19:09:43.126678 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_realtime, now model.dw_project.comparison)
[0m19:09:43.126903 [debug] [Thread-1 (]: Began compiling node model.dw_project.comparison
[0m19:09:43.128449 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.comparison"
[0m19:09:43.128944 [debug] [Thread-1 (]: Began executing node model.dw_project.comparison
[0m19:09:43.129961 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.comparison"
[0m19:09:43.130765 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.comparison"
[0m19:09:43.130940 [debug] [Thread-1 (]: On model.dw_project.comparison: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.comparison"} */
create or replace transient table lab2.analytics.comparison
         as
        (WITH latest_realtime AS (
    SELECT 
        time_open AS time_period_start,
        price_close
    FROM lab2.raw_data.bitcoin_realtime
    WHERE time_open = (SELECT MAX(time_open) FROM lab2.raw_data.bitcoin_realtime)
),
latest_historical AS (
    SELECT 
        time_period_end,
        price_close
    FROM lab2.raw_data.bitcoin_historical
    WHERE time_period_end = (SELECT MAX(time_period_end) FROM lab2.raw_data.bitcoin_historical)
)

SELECT
    h.time_period_end AS historical_time,
    h.price_close AS historical_close,
    r.time_period_start AS realtime_time,
    r.price_close AS realtime_close,
    CASE 
        WHEN h.price_close = 0 THEN NULL
        ELSE (r.price_close - h.price_close) / h.price_close * 100 
    END AS price_change_percentage
FROM latest_historical h
JOIN latest_realtime r
    ON DATE_TRUNC('DAY', h.time_period_end) = DATE_TRUNC('DAY', r.time_period_start)
ORDER BY h.time_period_end DESC
        );
[0m19:09:43.131097 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:09:44.405046 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.274 seconds
[0m19:09:44.408446 [debug] [Thread-1 (]: On model.dw_project.comparison: Close
[0m19:09:44.608171 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13c4a425-2ad3-4dec-b29f-bf89f3957c60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142bfd9a0>]}
[0m19:09:44.609757 [info ] [Thread-1 (]: 3 of 4 OK created sql table model analytics.comparison ......................... [[32mSUCCESS 1[0m in 1.48s]
[0m19:09:44.610863 [debug] [Thread-1 (]: Finished running node model.dw_project.comparison
[0m19:09:44.611788 [debug] [Thread-1 (]: Began running node model.dw_project.summary
[0m19:09:44.612799 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics.summary ................................. [RUN]
[0m19:09:44.613596 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.comparison, now model.dw_project.summary)
[0m19:09:44.614197 [debug] [Thread-1 (]: Began compiling node model.dw_project.summary
[0m19:09:44.625852 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.summary"
[0m19:09:44.626991 [debug] [Thread-1 (]: Began executing node model.dw_project.summary
[0m19:09:44.630484 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.summary"
[0m19:09:44.632282 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.summary"
[0m19:09:44.632679 [debug] [Thread-1 (]: On model.dw_project.summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.summary"} */
create or replace transient table lab2.analytics.summary
         as
        (WITH  __dbt__cte__bitcoin_historical as (
SELECT 
    time_period_start,
    time_period_end,
    time_open,
    time_close,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_historical
WHERE time_period_start IS NOT NULL
),  __dbt__cte__bitcoin_realtime as (
SELECT 
    time_open,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_realtime
WHERE price_close IS NOT NULL
), historical AS (
    SELECT * 
    FROM __dbt__cte__bitcoin_historical
),
realtime AS (
    SELECT * 
    FROM __dbt__cte__bitcoin_realtime
)
SELECT
    h.time_period_start AS timestamp,
    h.price_open AS historical_open,
    h.price_close AS historical_close,
    r.price_open AS realtime_open,
    r.price_close AS realtime_close
FROM historical h
LEFT JOIN realtime r 
    ON DATE_TRUNC('YEAR', h.time_period_start) = DATE_TRUNC('YEAR', r.time_open)
        );
[0m19:09:44.632978 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:09:46.066160 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.433 seconds
[0m19:09:46.071059 [debug] [Thread-1 (]: On model.dw_project.summary: Close
[0m19:09:46.275220 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13c4a425-2ad3-4dec-b29f-bf89f3957c60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071b7830>]}
[0m19:09:46.276679 [info ] [Thread-1 (]: 4 of 4 OK created sql table model analytics.summary ............................ [[32mSUCCESS 1[0m in 1.66s]
[0m19:09:46.277916 [debug] [Thread-1 (]: Finished running node model.dw_project.summary
[0m19:09:46.279476 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:09:46.279838 [debug] [MainThread]: Connection 'model.dw_project.summary' was properly closed.
[0m19:09:46.280234 [info ] [MainThread]: 
[0m19:09:46.280572 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 9.79 seconds (9.79s).
[0m19:09:46.281630 [debug] [MainThread]: Command end result
[0m19:09:46.304556 [info ] [MainThread]: 
[0m19:09:46.304810 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:09:46.304984 [info ] [MainThread]: 
[0m19:09:46.305165 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m19:09:46.307767 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.940939, "process_user_time": 3.252235, "process_kernel_time": 1.36389, "process_mem_max_rss": "207912960", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:09:46.308045 [debug] [MainThread]: Command `dbt run` succeeded at 19:09:46.307997 after 10.94 seconds
[0m19:09:46.308234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139f2930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134197380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134196300>]}
[0m19:09:46.308416 [debug] [MainThread]: Flushing usage events
[0m16:52:42.029638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106258950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062cd370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062cd400>]}


============================== 16:52:42.033555 | ab906a1c-f78d-47eb-84b7-39f78dafb107 ==============================
[0m16:52:42.033555 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:52:42.033915 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'partial_parse': 'True', 'log_cache_events': 'False', 'warn_error': 'None', 'indirect_selection': 'eager', 'static_parser': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'debug': 'False', 'invocation_command': 'dbt run', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'use_colors': 'True', 'quiet': 'False', 'printer_width': '80', 'write_json': 'True', 'fail_fast': 'False'}
[0m16:52:43.079891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ab906a1c-f78d-47eb-84b7-39f78dafb107', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1525bc500>]}
[0m16:52:43.102512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ab906a1c-f78d-47eb-84b7-39f78dafb107', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1525dfaa0>]}
[0m16:52:43.103639 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m16:52:43.116723 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:52:43.184001 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 1 files changed.
[0m16:52:43.184304 [debug] [MainThread]: Partial parsing: deleted file: dw_project://models/output/summary.sql
[0m16:52:43.184509 [debug] [MainThread]: Partial parsing: updated file: dw_project://models/output/comparison.sql
[0m16:52:43.247153 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dw_project.comparison' (models/output/comparison.sql) depends on a node named 'bitcoin_realtime_aggregated' which was not found
[0m16:52:43.249128 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.2466635, "process_user_time": 1.582482, "process_kernel_time": 2.406386, "process_mem_max_rss": "200966144", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:52:43.249495 [debug] [MainThread]: Command `dbt run` failed at 16:52:43.249438 after 1.25 seconds
[0m16:52:43.249704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10773bb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x154093470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d4bda0>]}
[0m16:52:43.249876 [debug] [MainThread]: Flushing usage events
[0m16:55:24.949283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101871fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d554f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d55460>]}


============================== 16:55:24.950844 | 037e3784-f40b-4ec1-b49d-f8544fbaad53 ==============================
[0m16:55:24.950844 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:55:24.951128 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'write_json': 'True', 'fail_fast': 'False', 'quiet': 'False', 'introspect': 'True', 'partial_parse': 'True', 'static_parser': 'True', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'target_path': 'None', 'debug': 'False', 'printer_width': '80', 'version_check': 'True', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'warn_error': 'None', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'empty': 'False', 'use_colors': 'True', 'log_format': 'default', 'invocation_command': 'dbt run'}
[0m16:55:25.765339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '037e3784-f40b-4ec1-b49d-f8544fbaad53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107177ce0>]}
[0m16:55:25.781733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '037e3784-f40b-4ec1-b49d-f8544fbaad53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107127d10>]}
[0m16:55:25.782157 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m16:55:25.791183 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:55:25.843568 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 2 files added, 1 files changed.
[0m16:55:25.843821 [debug] [MainThread]: Partial parsing: added file: dw_project://models/output/bitcoin_realtime_aggregated.sql
[0m16:55:25.843948 [debug] [MainThread]: Partial parsing: added file: dw_project://models/output/bitcoin_historical_aggregated.sql
[0m16:55:25.844048 [debug] [MainThread]: Partial parsing: deleted file: dw_project://models/output/summary.sql
[0m16:55:25.844179 [debug] [MainThread]: Partial parsing: updated file: dw_project://models/output/comparison.sql
[0m16:55:25.926221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '037e3784-f40b-4ec1-b49d-f8544fbaad53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15c80d760>]}
[0m16:55:25.961040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '037e3784-f40b-4ec1-b49d-f8544fbaad53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15c8d36b0>]}
[0m16:55:25.961267 [info ] [MainThread]: Found 7 models, 3 sources, 459 macros
[0m16:55:25.961408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '037e3784-f40b-4ec1-b49d-f8544fbaad53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15c80d280>]}
[0m16:55:25.962145 [info ] [MainThread]: 
[0m16:55:25.962383 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:55:25.964020 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m16:55:25.968704 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m16:55:25.968841 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m16:55:25.968943 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:55:26.883886 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.914 seconds
[0m16:55:26.886209 [debug] [ThreadPool]: On list_lab2: Close
[0m16:55:27.138719 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m16:55:27.151149 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m16:55:27.151652 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m16:55:27.151940 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:55:27.778727 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.626 seconds
[0m16:55:27.783856 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m16:55:27.963811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '037e3784-f40b-4ec1-b49d-f8544fbaad53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15c8ed8e0>]}
[0m16:55:27.965200 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m16:55:27.965889 [info ] [MainThread]: 
[0m16:55:27.971436 [debug] [Thread-1 (]: Began running node model.dw_project.avg_price_realtime
[0m16:55:27.972336 [info ] [Thread-1 (]: 1 of 5 START sql table model analytics.avg_price_realtime ...................... [RUN]
[0m16:55:27.972972 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now model.dw_project.avg_price_realtime)
[0m16:55:27.973426 [debug] [Thread-1 (]: Began compiling node model.dw_project.avg_price_realtime
[0m16:55:28.031729 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.avg_price_realtime"
[0m16:55:28.032574 [debug] [Thread-1 (]: Began executing node model.dw_project.avg_price_realtime
[0m16:55:28.044598 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.avg_price_realtime"
[0m16:55:28.045182 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.avg_price_realtime"
[0m16:55:28.045350 [debug] [Thread-1 (]: On model.dw_project.avg_price_realtime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.avg_price_realtime"} */
create or replace transient table lab2.analytics.avg_price_realtime
         as
        (WITH realtime AS (
    SELECT 
        time_open AS time_period_start,
        price_close
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    time_period_start,
    AVG(price_close) OVER (ORDER BY time_period_start ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) AS thirty_min_avg_price
FROM realtime
ORDER BY time_period_start
        );
[0m16:55:28.045491 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:30.342594 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.297 seconds
[0m16:55:30.366242 [debug] [Thread-1 (]: On model.dw_project.avg_price_realtime: Close
[0m16:55:30.549559 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '037e3784-f40b-4ec1-b49d-f8544fbaad53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15bfaf200>]}
[0m16:55:30.551262 [info ] [Thread-1 (]: 1 of 5 OK created sql table model analytics.avg_price_realtime ................. [[32mSUCCESS 1[0m in 2.57s]
[0m16:55:30.552390 [debug] [Thread-1 (]: Finished running node model.dw_project.avg_price_realtime
[0m16:55:30.553213 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_daily_summary
[0m16:55:30.554192 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.bitcoin_daily_summary ................... [RUN]
[0m16:55:30.555020 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.avg_price_realtime, now model.dw_project.bitcoin_daily_summary)
[0m16:55:30.555580 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_daily_summary
[0m16:55:30.559261 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_daily_summary"
[0m16:55:30.560693 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_daily_summary
[0m16:55:30.562913 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_daily_summary"
[0m16:55:30.564377 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_daily_summary"
[0m16:55:30.564741 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_daily_summary"} */
create or replace transient table lab2.analytics.bitcoin_daily_summary
         as
        (WITH historical_data AS (
    SELECT
        TIME_PERIOD_START::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_historical
),
realtime_data AS (
    SELECT
        TIME_OPEN::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    date,
    AVG(PRICE_OPEN) AS avg_open,
    AVG(PRICE_HIGH) AS avg_high,
    AVG(PRICE_LOW) AS avg_low,
    AVG(PRICE_CLOSE) AS avg_close,
    SUM(VOLUME_TRADED) AS total_volume,
    SUM(TRADES_COUNT) AS total_trades
FROM (
    SELECT * FROM historical_data
    UNION ALL
    SELECT * FROM realtime_data
) AS combined_data
GROUP BY date
ORDER BY date
        );
[0m16:55:30.565071 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:33.003094 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.438 seconds
[0m16:55:33.007812 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: Close
[0m16:55:33.203311 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '037e3784-f40b-4ec1-b49d-f8544fbaad53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15baf79b0>]}
[0m16:55:33.204915 [info ] [Thread-1 (]: 2 of 5 OK created sql table model analytics.bitcoin_daily_summary .............. [[32mSUCCESS 1[0m in 2.65s]
[0m16:55:33.206020 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_daily_summary
[0m16:55:33.206775 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_historical
[0m16:55:33.207640 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_daily_summary, now model.dw_project.bitcoin_historical)
[0m16:55:33.208485 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_historical
[0m16:55:33.213342 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_historical"
[0m16:55:33.215829 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_historical
[0m16:55:33.216314 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_realtime
[0m16:55:33.216892 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_historical, now model.dw_project.bitcoin_realtime)
[0m16:55:33.217563 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_realtime
[0m16:55:33.220337 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_realtime"
[0m16:55:33.221937 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_realtime
[0m16:55:33.222431 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_historical_aggregated
[0m16:55:33.223009 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.bitcoin_historical_aggregated ........... [RUN]
[0m16:55:33.223406 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_realtime, now model.dw_project.bitcoin_historical_aggregated)
[0m16:55:33.223712 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_historical_aggregated
[0m16:55:33.229469 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_historical_aggregated"
[0m16:55:33.229983 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_historical_aggregated
[0m16:55:33.232200 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_historical_aggregated"
[0m16:55:33.233310 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_historical_aggregated"
[0m16:55:33.233570 [debug] [Thread-1 (]: On model.dw_project.bitcoin_historical_aggregated: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_historical_aggregated"} */
create or replace transient table lab2.analytics.bitcoin_historical_aggregated
         as
        (-- bitcoin_historical_aggregated.sql
WITH  __dbt__cte__bitcoin_historical as (
SELECT 
    time_period_start,
    time_period_end,
    time_open,
    time_close,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_historical
WHERE time_period_start IS NOT NULL
), historical_agg AS (
    SELECT 
        DATE(TIME_PERIOD_START) AS DAY,
        MIN(PRICE_LOW) AS PRICE_LOW,
        MAX(PRICE_HIGH) AS PRICE_HIGH,
        SUM(VOLUME_TRADED) AS VOLUME_TRADED,
        COUNT(TRADES_COUNT) AS TRADES_COUNT
    FROM __dbt__cte__bitcoin_historical
    GROUP BY DATE(TIME_PERIOD_START)
)
SELECT 
    DAY,
    PRICE_LOW,
    PRICE_HIGH,
    VOLUME_TRADED,
    TRADES_COUNT
FROM historical_agg;
[0m16:55:33.233807 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:33.902406 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8a3f7-0003-624b-0003-437a0010710a
[0m16:55:33.903166 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 34 at position 19 unexpected ';'.
[0m16:55:33.903712 [debug] [Thread-1 (]: On model.dw_project.bitcoin_historical_aggregated: Close
[0m16:55:34.125892 [debug] [Thread-1 (]: Database Error in model bitcoin_historical_aggregated (models/output/bitcoin_historical_aggregated.sql)
  001003 (42000): SQL compilation error:
  syntax error line 34 at position 19 unexpected ';'.
  compiled code at target/run/dw_project/models/output/bitcoin_historical_aggregated.sql
[0m16:55:34.127385 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '037e3784-f40b-4ec1-b49d-f8544fbaad53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15be7d2b0>]}
[0m16:55:34.128685 [error] [Thread-1 (]: 3 of 5 ERROR creating sql table model analytics.bitcoin_historical_aggregated .. [[31mERROR[0m in 0.90s]
[0m16:55:34.129609 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_historical_aggregated
[0m16:55:34.130204 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_realtime_aggregated
[0m16:55:34.131222 [info ] [Thread-1 (]: 4 of 5 START sql table model analytics.bitcoin_realtime_aggregated ............. [RUN]
[0m16:55:34.131833 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_historical_aggregated, now model.dw_project.bitcoin_realtime_aggregated)
[0m16:55:34.132213 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_realtime_aggregated
[0m16:55:34.139730 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_realtime_aggregated"
[0m16:55:34.140498 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_realtime_aggregated
[0m16:55:34.142672 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_realtime_aggregated"
[0m16:55:34.143853 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_realtime_aggregated"
[0m16:55:34.144149 [debug] [Thread-1 (]: On model.dw_project.bitcoin_realtime_aggregated: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_realtime_aggregated"} */
create or replace transient table lab2.analytics.bitcoin_realtime_aggregated
         as
        (-- bitcoin_realtime_aggregated.sql
WITH  __dbt__cte__bitcoin_realtime as (
SELECT 
    time_open,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_realtime
WHERE price_close IS NOT NULL
), real_time_agg AS (
    SELECT 
        DATE(TIME_PERIOD_START) AS DAY,
        MIN(PRICE_LOW) AS PRICE_LOW,
        MAX(PRICE_HIGH) AS PRICE_HIGH,
        SUM(VOLUME_TRADED) AS VOLUME_TRADED,
        COUNT(TRADES_COUNT) AS TRADES_COUNT
    FROM __dbt__cte__bitcoin_realtime
    GROUP BY DATE(TIME_PERIOD_START)
)
SELECT 
    DAY,
    PRICE_LOW,
    PRICE_HIGH,
    VOLUME_TRADED,
    TRADES_COUNT
FROM real_time_agg;
[0m16:55:34.144431 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:34.779883 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8a3f7-0003-62ff-0003-437a0010332e
[0m16:55:34.781118 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 31 at position 18 unexpected ';'.
[0m16:55:34.782042 [debug] [Thread-1 (]: On model.dw_project.bitcoin_realtime_aggregated: Close
[0m16:55:34.982682 [debug] [Thread-1 (]: Database Error in model bitcoin_realtime_aggregated (models/output/bitcoin_realtime_aggregated.sql)
  001003 (42000): SQL compilation error:
  syntax error line 31 at position 18 unexpected ';'.
  compiled code at target/run/dw_project/models/output/bitcoin_realtime_aggregated.sql
[0m16:55:34.983788 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '037e3784-f40b-4ec1-b49d-f8544fbaad53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15bdae390>]}
[0m16:55:34.984716 [error] [Thread-1 (]: 4 of 5 ERROR creating sql table model analytics.bitcoin_realtime_aggregated .... [[31mERROR[0m in 0.85s]
[0m16:55:34.985518 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_realtime_aggregated
[0m16:55:34.986869 [debug] [Thread-1 (]: Began running node model.dw_project.comparison
[0m16:55:34.987476 [info ] [Thread-1 (]: 5 of 5 SKIP relation analytics.comparison ...................................... [[33mSKIP[0m]
[0m16:55:34.988416 [debug] [Thread-1 (]: Finished running node model.dw_project.comparison
[0m16:55:34.989930 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:55:34.990276 [debug] [MainThread]: Connection 'model.dw_project.bitcoin_realtime_aggregated' was properly closed.
[0m16:55:34.990664 [info ] [MainThread]: 
[0m16:55:34.990997 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 9.03 seconds (9.03s).
[0m16:55:34.992095 [debug] [MainThread]: Command end result
[0m16:55:35.013292 [info ] [MainThread]: 
[0m16:55:35.013554 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m16:55:35.013738 [info ] [MainThread]: 
[0m16:55:35.013952 [error] [MainThread]:   Database Error in model bitcoin_historical_aggregated (models/output/bitcoin_historical_aggregated.sql)
  001003 (42000): SQL compilation error:
  syntax error line 34 at position 19 unexpected ';'.
  compiled code at target/run/dw_project/models/output/bitcoin_historical_aggregated.sql
[0m16:55:35.014118 [info ] [MainThread]: 
[0m16:55:35.014313 [error] [MainThread]:   Database Error in model bitcoin_realtime_aggregated (models/output/bitcoin_realtime_aggregated.sql)
  001003 (42000): SQL compilation error:
  syntax error line 31 at position 18 unexpected ';'.
  compiled code at target/run/dw_project/models/output/bitcoin_realtime_aggregated.sql
[0m16:55:35.014477 [info ] [MainThread]: 
[0m16:55:35.014653 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=1 TOTAL=5
[0m16:55:35.016518 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 10.089454, "process_user_time": 3.249743, "process_kernel_time": 1.314625, "process_mem_max_rss": "207912960", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:55:35.016884 [debug] [MainThread]: Command `dbt run` failed at 16:55:35.016823 after 10.09 seconds
[0m16:55:35.017107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d58170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aa4ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15be6f950>]}
[0m16:55:35.017303 [debug] [MainThread]: Flushing usage events
[0m16:56:08.945656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c6adb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f59250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f592e0>]}


============================== 16:56:08.947376 | 02a4721b-8b2d-4d6e-86ad-081d2474dd03 ==============================
[0m16:56:08.947376 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:56:08.947699 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'printer_width': '80', 'quiet': 'False', 'log_format': 'default', 'log_cache_events': 'False', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'warn_error': 'None', 'version_check': 'True', 'no_print': 'None', 'debug': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'write_json': 'True', 'empty': 'False', 'cache_selected_only': 'False', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'use_experimental_parser': 'False'}
[0m16:56:09.719951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '02a4721b-8b2d-4d6e-86ad-081d2474dd03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15fec32f0>]}
[0m16:56:09.736779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '02a4721b-8b2d-4d6e-86ad-081d2474dd03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac088f0>]}
[0m16:56:09.737284 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m16:56:09.746597 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:56:09.802362 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m16:56:09.802654 [debug] [MainThread]: Partial parsing: updated file: dw_project://models/output/bitcoin_realtime_aggregated.sql
[0m16:56:09.802806 [debug] [MainThread]: Partial parsing: updated file: dw_project://models/output/bitcoin_historical_aggregated.sql
[0m16:56:09.802940 [debug] [MainThread]: Partial parsing: updated file: dw_project://models/output/comparison.sql
[0m16:56:09.884657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '02a4721b-8b2d-4d6e-86ad-081d2474dd03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16030b350>]}
[0m16:56:09.917796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '02a4721b-8b2d-4d6e-86ad-081d2474dd03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1603cc710>]}
[0m16:56:09.918021 [info ] [MainThread]: Found 7 models, 3 sources, 459 macros
[0m16:56:09.918172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02a4721b-8b2d-4d6e-86ad-081d2474dd03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16032fe60>]}
[0m16:56:09.918899 [info ] [MainThread]: 
[0m16:56:09.919146 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:56:09.920823 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m16:56:09.925510 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m16:56:09.925647 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m16:56:09.925748 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:56:10.799112 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.873 seconds
[0m16:56:10.802403 [debug] [ThreadPool]: On list_lab2: Close
[0m16:56:10.989902 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m16:56:11.003367 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m16:56:11.003862 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m16:56:11.004199 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:56:11.580842 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.576 seconds
[0m16:56:11.585591 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m16:56:11.787732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02a4721b-8b2d-4d6e-86ad-081d2474dd03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1602addf0>]}
[0m16:56:11.789285 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m16:56:11.790157 [info ] [MainThread]: 
[0m16:56:11.795427 [debug] [Thread-1 (]: Began running node model.dw_project.avg_price_realtime
[0m16:56:11.796274 [info ] [Thread-1 (]: 1 of 5 START sql table model analytics.avg_price_realtime ...................... [RUN]
[0m16:56:11.796899 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now model.dw_project.avg_price_realtime)
[0m16:56:11.797291 [debug] [Thread-1 (]: Began compiling node model.dw_project.avg_price_realtime
[0m16:56:11.854949 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.avg_price_realtime"
[0m16:56:11.855433 [debug] [Thread-1 (]: Began executing node model.dw_project.avg_price_realtime
[0m16:56:11.867529 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.avg_price_realtime"
[0m16:56:11.868102 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.avg_price_realtime"
[0m16:56:11.868270 [debug] [Thread-1 (]: On model.dw_project.avg_price_realtime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.avg_price_realtime"} */
create or replace transient table lab2.analytics.avg_price_realtime
         as
        (WITH realtime AS (
    SELECT 
        time_open AS time_period_start,
        price_close
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    time_period_start,
    AVG(price_close) OVER (ORDER BY time_period_start ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) AS thirty_min_avg_price
FROM realtime
ORDER BY time_period_start
        );
[0m16:56:11.868412 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:56:13.963391 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.094 seconds
[0m16:56:13.992418 [debug] [Thread-1 (]: On model.dw_project.avg_price_realtime: Close
[0m16:56:14.174640 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02a4721b-8b2d-4d6e-86ad-081d2474dd03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15fe29100>]}
[0m16:56:14.176220 [info ] [Thread-1 (]: 1 of 5 OK created sql table model analytics.avg_price_realtime ................. [[32mSUCCESS 1[0m in 2.38s]
[0m16:56:14.177283 [debug] [Thread-1 (]: Finished running node model.dw_project.avg_price_realtime
[0m16:56:14.177988 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_daily_summary
[0m16:56:14.178927 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.bitcoin_daily_summary ................... [RUN]
[0m16:56:14.179720 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.avg_price_realtime, now model.dw_project.bitcoin_daily_summary)
[0m16:56:14.180371 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_daily_summary
[0m16:56:14.183963 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_daily_summary"
[0m16:56:14.184776 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_daily_summary
[0m16:56:14.187023 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_daily_summary"
[0m16:56:14.188475 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_daily_summary"
[0m16:56:14.188849 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_daily_summary"} */
create or replace transient table lab2.analytics.bitcoin_daily_summary
         as
        (WITH historical_data AS (
    SELECT
        TIME_PERIOD_START::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_historical
),
realtime_data AS (
    SELECT
        TIME_OPEN::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    date,
    AVG(PRICE_OPEN) AS avg_open,
    AVG(PRICE_HIGH) AS avg_high,
    AVG(PRICE_LOW) AS avg_low,
    AVG(PRICE_CLOSE) AS avg_close,
    SUM(VOLUME_TRADED) AS total_volume,
    SUM(TRADES_COUNT) AS total_trades
FROM (
    SELECT * FROM historical_data
    UNION ALL
    SELECT * FROM realtime_data
) AS combined_data
GROUP BY date
ORDER BY date
        );
[0m16:56:14.189189 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:56:16.624708 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.435 seconds
[0m16:56:16.627803 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: Close
[0m16:56:16.813665 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02a4721b-8b2d-4d6e-86ad-081d2474dd03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x160158080>]}
[0m16:56:16.815498 [info ] [Thread-1 (]: 2 of 5 OK created sql table model analytics.bitcoin_daily_summary .............. [[32mSUCCESS 1[0m in 2.63s]
[0m16:56:16.816680 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_daily_summary
[0m16:56:16.817486 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_historical
[0m16:56:16.818346 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_daily_summary, now model.dw_project.bitcoin_historical)
[0m16:56:16.818866 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_historical
[0m16:56:16.824223 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_historical"
[0m16:56:16.827175 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_historical
[0m16:56:16.827747 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_realtime
[0m16:56:16.828444 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_historical, now model.dw_project.bitcoin_realtime)
[0m16:56:16.828969 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_realtime
[0m16:56:16.831983 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_realtime"
[0m16:56:16.833179 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_realtime
[0m16:56:16.833559 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_historical_aggregated
[0m16:56:16.834128 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.bitcoin_historical_aggregated ........... [RUN]
[0m16:56:16.834797 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_realtime, now model.dw_project.bitcoin_historical_aggregated)
[0m16:56:16.835210 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_historical_aggregated
[0m16:56:16.841058 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_historical_aggregated"
[0m16:56:16.841655 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_historical_aggregated
[0m16:56:16.843987 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_historical_aggregated"
[0m16:56:16.845008 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_historical_aggregated"
[0m16:56:16.845275 [debug] [Thread-1 (]: On model.dw_project.bitcoin_historical_aggregated: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_historical_aggregated"} */
create or replace transient table lab2.analytics.bitcoin_historical_aggregated
         as
        (-- bitcoin_historical_aggregated.sql
WITH  __dbt__cte__bitcoin_historical as (
SELECT 
    time_period_start,
    time_period_end,
    time_open,
    time_close,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_historical
WHERE time_period_start IS NOT NULL
), historical_agg AS (
    SELECT 
        DATE(TIME_PERIOD_START) AS DAY,
        MIN(PRICE_LOW) AS PRICE_LOW,
        MAX(PRICE_HIGH) AS PRICE_HIGH,
        SUM(VOLUME_TRADED) AS VOLUME_TRADED,
        COUNT(TRADES_COUNT) AS TRADES_COUNT
    FROM __dbt__cte__bitcoin_historical
    GROUP BY DATE(TIME_PERIOD_START)
)
SELECT 
    DAY,
    PRICE_LOW,
    PRICE_HIGH,
    VOLUME_TRADED,
    TRADES_COUNT
FROM historical_agg
        );
[0m16:56:16.845528 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:56:18.571723 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.726 seconds
[0m16:56:18.576069 [debug] [Thread-1 (]: On model.dw_project.bitcoin_historical_aggregated: Close
[0m16:56:18.750142 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02a4721b-8b2d-4d6e-86ad-081d2474dd03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089835c0>]}
[0m16:56:18.751917 [info ] [Thread-1 (]: 3 of 5 OK created sql table model analytics.bitcoin_historical_aggregated ...... [[32mSUCCESS 1[0m in 1.92s]
[0m16:56:18.753050 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_historical_aggregated
[0m16:56:18.753796 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_realtime_aggregated
[0m16:56:18.754577 [info ] [Thread-1 (]: 4 of 5 START sql table model analytics.bitcoin_realtime_aggregated ............. [RUN]
[0m16:56:18.755352 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_historical_aggregated, now model.dw_project.bitcoin_realtime_aggregated)
[0m16:56:18.755857 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_realtime_aggregated
[0m16:56:18.765048 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_realtime_aggregated"
[0m16:56:18.766046 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_realtime_aggregated
[0m16:56:18.768422 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_realtime_aggregated"
[0m16:56:18.769790 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_realtime_aggregated"
[0m16:56:18.770162 [debug] [Thread-1 (]: On model.dw_project.bitcoin_realtime_aggregated: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_realtime_aggregated"} */
create or replace transient table lab2.analytics.bitcoin_realtime_aggregated
         as
        (-- bitcoin_realtime_aggregated.sql
WITH  __dbt__cte__bitcoin_realtime as (
SELECT 
    time_open,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_realtime
WHERE price_close IS NOT NULL
), real_time_agg AS (
    SELECT 
        DATE(TIME_PERIOD_START) AS DAY,
        MIN(PRICE_LOW) AS PRICE_LOW,
        MAX(PRICE_HIGH) AS PRICE_HIGH,
        SUM(VOLUME_TRADED) AS VOLUME_TRADED,
        COUNT(TRADES_COUNT) AS TRADES_COUNT
    FROM __dbt__cte__bitcoin_realtime
    GROUP BY DATE(TIME_PERIOD_START)
)
SELECT 
    DAY,
    PRICE_LOW,
    PRICE_HIGH,
    VOLUME_TRADED,
    TRADES_COUNT
FROM real_time_agg
        );
[0m16:56:18.770499 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:56:19.520298 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8a3f8-0003-64f2-0003-437a0010d0ca
[0m16:56:19.520994 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 17 at position 13
invalid identifier 'TIME_PERIOD_START'
[0m16:56:19.521606 [debug] [Thread-1 (]: On model.dw_project.bitcoin_realtime_aggregated: Close
[0m16:56:19.710548 [debug] [Thread-1 (]: Database Error in model bitcoin_realtime_aggregated (models/output/bitcoin_realtime_aggregated.sql)
  000904 (42000): SQL compilation error: error line 17 at position 13
  invalid identifier 'TIME_PERIOD_START'
  compiled code at target/run/dw_project/models/output/bitcoin_realtime_aggregated.sql
[0m16:56:19.711701 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02a4721b-8b2d-4d6e-86ad-081d2474dd03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac0bb90>]}
[0m16:56:19.712468 [error] [Thread-1 (]: 4 of 5 ERROR creating sql table model analytics.bitcoin_realtime_aggregated .... [[31mERROR[0m in 0.96s]
[0m16:56:19.713530 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_realtime_aggregated
[0m16:56:19.714796 [debug] [Thread-1 (]: Began running node model.dw_project.comparison
[0m16:56:19.715504 [info ] [Thread-1 (]: 5 of 5 SKIP relation analytics.comparison ...................................... [[33mSKIP[0m]
[0m16:56:19.716137 [debug] [Thread-1 (]: Finished running node model.dw_project.comparison
[0m16:56:19.717357 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:56:19.717747 [debug] [MainThread]: Connection 'model.dw_project.bitcoin_realtime_aggregated' was properly closed.
[0m16:56:19.718103 [info ] [MainThread]: 
[0m16:56:19.718399 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 9.80 seconds (9.80s).
[0m16:56:19.719380 [debug] [MainThread]: Command end result
[0m16:56:19.733800 [info ] [MainThread]: 
[0m16:56:19.734073 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:56:19.734215 [info ] [MainThread]: 
[0m16:56:19.734388 [error] [MainThread]:   Database Error in model bitcoin_realtime_aggregated (models/output/bitcoin_realtime_aggregated.sql)
  000904 (42000): SQL compilation error: error line 17 at position 13
  invalid identifier 'TIME_PERIOD_START'
  compiled code at target/run/dw_project/models/output/bitcoin_realtime_aggregated.sql
[0m16:56:19.734516 [info ] [MainThread]: 
[0m16:56:19.734655 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
[0m16:56:19.736237 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 10.81334, "process_user_time": 2.896916, "process_kernel_time": 1.624419, "process_mem_max_rss": "211042304", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:56:19.736582 [debug] [MainThread]: Command `dbt run` failed at 16:56:19.736532 after 10.81 seconds
[0m16:56:19.736769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a65e450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052ce960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x160532fc0>]}
[0m16:56:19.736928 [debug] [MainThread]: Flushing usage events
[0m16:58:55.800180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10540df40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10599bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10599b8f0>]}


============================== 16:58:55.802127 | cdd77d47-f7b1-4770-b0c8-5ba10589ab0a ==============================
[0m16:58:55.802127 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:58:55.802434 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'no_print': 'None', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'static_parser': 'True', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'use_colors': 'True', 'printer_width': '80', 'version_check': 'True', 'debug': 'False', 'log_cache_events': 'False', 'target_path': 'None', 'fail_fast': 'False', 'quiet': 'False', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project'}
[0m16:58:56.834153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cdd77d47-f7b1-4770-b0c8-5ba10589ab0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13fedfbc0>]}
[0m16:58:56.851865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cdd77d47-f7b1-4770-b0c8-5ba10589ab0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f860a40>]}
[0m16:58:56.852563 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m16:58:56.862097 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:58:56.917182 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:58:56.917526 [debug] [MainThread]: Partial parsing: updated file: dw_project://models/output/bitcoin_realtime_aggregated.sql
[0m16:58:57.027289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cdd77d47-f7b1-4770-b0c8-5ba10589ab0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1624e9af0>]}
[0m16:58:57.063425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cdd77d47-f7b1-4770-b0c8-5ba10589ab0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1624cb260>]}
[0m16:58:57.063704 [info ] [MainThread]: Found 7 models, 3 sources, 459 macros
[0m16:58:57.063861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cdd77d47-f7b1-4770-b0c8-5ba10589ab0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1624eb530>]}
[0m16:58:57.064625 [info ] [MainThread]: 
[0m16:58:57.064882 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:58:57.066639 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m16:58:57.071638 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m16:58:57.071798 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m16:58:57.071908 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:58:57.767391 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.694 seconds
[0m16:58:57.770336 [debug] [ThreadPool]: On list_lab2: Close
[0m16:58:57.937692 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m16:58:57.949522 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m16:58:57.949947 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m16:58:57.950217 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:58:58.710996 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.760 seconds
[0m16:58:58.714761 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m16:58:58.944797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cdd77d47-f7b1-4770-b0c8-5ba10589ab0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1621df950>]}
[0m16:58:58.946098 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m16:58:58.946905 [info ] [MainThread]: 
[0m16:58:58.952121 [debug] [Thread-1 (]: Began running node model.dw_project.avg_price_realtime
[0m16:58:58.953027 [info ] [Thread-1 (]: 1 of 5 START sql table model analytics.avg_price_realtime ...................... [RUN]
[0m16:58:58.953615 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now model.dw_project.avg_price_realtime)
[0m16:58:58.953969 [debug] [Thread-1 (]: Began compiling node model.dw_project.avg_price_realtime
[0m16:58:59.011232 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.avg_price_realtime"
[0m16:58:59.012959 [debug] [Thread-1 (]: Began executing node model.dw_project.avg_price_realtime
[0m16:58:59.025232 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.avg_price_realtime"
[0m16:58:59.025823 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.avg_price_realtime"
[0m16:58:59.026000 [debug] [Thread-1 (]: On model.dw_project.avg_price_realtime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.avg_price_realtime"} */
create or replace transient table lab2.analytics.avg_price_realtime
         as
        (WITH realtime AS (
    SELECT 
        time_open AS time_period_start,
        price_close
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    time_period_start,
    AVG(price_close) OVER (ORDER BY time_period_start ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) AS thirty_min_avg_price
FROM realtime
ORDER BY time_period_start
        );
[0m16:58:59.026144 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:59:00.879410 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.853 seconds
[0m16:59:00.906120 [debug] [Thread-1 (]: On model.dw_project.avg_price_realtime: Close
[0m16:59:01.135263 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdd77d47-f7b1-4770-b0c8-5ba10589ab0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1622d5d60>]}
[0m16:59:01.137123 [info ] [Thread-1 (]: 1 of 5 OK created sql table model analytics.avg_price_realtime ................. [[32mSUCCESS 1[0m in 2.18s]
[0m16:59:01.138253 [debug] [Thread-1 (]: Finished running node model.dw_project.avg_price_realtime
[0m16:59:01.138983 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_daily_summary
[0m16:59:01.139924 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.bitcoin_daily_summary ................... [RUN]
[0m16:59:01.140672 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.avg_price_realtime, now model.dw_project.bitcoin_daily_summary)
[0m16:59:01.141205 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_daily_summary
[0m16:59:01.146345 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_daily_summary"
[0m16:59:01.148287 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_daily_summary
[0m16:59:01.150784 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_daily_summary"
[0m16:59:01.152284 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_daily_summary"
[0m16:59:01.152676 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_daily_summary"} */
create or replace transient table lab2.analytics.bitcoin_daily_summary
         as
        (WITH historical_data AS (
    SELECT
        TIME_PERIOD_START::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_historical
),
realtime_data AS (
    SELECT
        TIME_OPEN::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    date,
    AVG(PRICE_OPEN) AS avg_open,
    AVG(PRICE_HIGH) AS avg_high,
    AVG(PRICE_LOW) AS avg_low,
    AVG(PRICE_CLOSE) AS avg_close,
    SUM(VOLUME_TRADED) AS total_volume,
    SUM(TRADES_COUNT) AS total_trades
FROM (
    SELECT * FROM historical_data
    UNION ALL
    SELECT * FROM realtime_data
) AS combined_data
GROUP BY date
ORDER BY date
        );
[0m16:59:01.153027 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:59:04.254551 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.101 seconds
[0m16:59:04.258692 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: Close
[0m16:59:04.443447 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdd77d47-f7b1-4770-b0c8-5ba10589ab0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1624989b0>]}
[0m16:59:04.444598 [info ] [Thread-1 (]: 2 of 5 OK created sql table model analytics.bitcoin_daily_summary .............. [[32mSUCCESS 1[0m in 3.30s]
[0m16:59:04.445496 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_daily_summary
[0m16:59:04.446126 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_historical
[0m16:59:04.446806 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_daily_summary, now model.dw_project.bitcoin_historical)
[0m16:59:04.447409 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_historical
[0m16:59:04.451111 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_historical"
[0m16:59:04.452943 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_historical
[0m16:59:04.453536 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_realtime
[0m16:59:04.454222 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_historical, now model.dw_project.bitcoin_realtime)
[0m16:59:04.454603 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_realtime
[0m16:59:04.457982 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_realtime"
[0m16:59:04.459541 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_realtime
[0m16:59:04.459754 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_historical_aggregated
[0m16:59:04.460368 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.bitcoin_historical_aggregated ........... [RUN]
[0m16:59:04.460828 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_realtime, now model.dw_project.bitcoin_historical_aggregated)
[0m16:59:04.461185 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_historical_aggregated
[0m16:59:04.465362 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_historical_aggregated"
[0m16:59:04.466223 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_historical_aggregated
[0m16:59:04.467574 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_historical_aggregated"
[0m16:59:04.468733 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_historical_aggregated"
[0m16:59:04.469058 [debug] [Thread-1 (]: On model.dw_project.bitcoin_historical_aggregated: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_historical_aggregated"} */
create or replace transient table lab2.analytics.bitcoin_historical_aggregated
         as
        (-- bitcoin_historical_aggregated.sql
WITH  __dbt__cte__bitcoin_historical as (
SELECT 
    time_period_start,
    time_period_end,
    time_open,
    time_close,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_historical
WHERE time_period_start IS NOT NULL
), historical_agg AS (
    SELECT 
        DATE(TIME_PERIOD_START) AS DAY,
        MIN(PRICE_LOW) AS PRICE_LOW,
        MAX(PRICE_HIGH) AS PRICE_HIGH,
        SUM(VOLUME_TRADED) AS VOLUME_TRADED,
        COUNT(TRADES_COUNT) AS TRADES_COUNT
    FROM __dbt__cte__bitcoin_historical
    GROUP BY DATE(TIME_PERIOD_START)
)
SELECT 
    DAY,
    PRICE_LOW,
    PRICE_HIGH,
    VOLUME_TRADED,
    TRADES_COUNT
FROM historical_agg
        );
[0m16:59:04.469356 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:59:06.507663 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.038 seconds
[0m16:59:06.511969 [debug] [Thread-1 (]: On model.dw_project.bitcoin_historical_aggregated: Close
[0m16:59:06.693255 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdd77d47-f7b1-4770-b0c8-5ba10589ab0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1626de9c0>]}
[0m16:59:06.695016 [info ] [Thread-1 (]: 3 of 5 OK created sql table model analytics.bitcoin_historical_aggregated ...... [[32mSUCCESS 1[0m in 2.23s]
[0m16:59:06.696201 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_historical_aggregated
[0m16:59:06.697016 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_realtime_aggregated
[0m16:59:06.697991 [info ] [Thread-1 (]: 4 of 5 START sql table model analytics.bitcoin_realtime_aggregated ............. [RUN]
[0m16:59:06.698792 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_historical_aggregated, now model.dw_project.bitcoin_realtime_aggregated)
[0m16:59:06.699337 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_realtime_aggregated
[0m16:59:06.709161 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_realtime_aggregated"
[0m16:59:06.710220 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_realtime_aggregated
[0m16:59:06.712700 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_realtime_aggregated"
[0m16:59:06.714080 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_realtime_aggregated"
[0m16:59:06.714449 [debug] [Thread-1 (]: On model.dw_project.bitcoin_realtime_aggregated: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_realtime_aggregated"} */
create or replace transient table lab2.analytics.bitcoin_realtime_aggregated
         as
        (-- bitcoin_realtime_aggregated.sql
WITH  __dbt__cte__bitcoin_realtime as (
SELECT 
    time_open,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_realtime
WHERE price_close IS NOT NULL
), real_time_agg AS (
    SELECT 
        DATE(start_time) AS DAY,  -- Correct column name here
        MIN(PRICE_LOW) AS PRICE_LOW,
        MAX(PRICE_HIGH) AS PRICE_HIGH,
        SUM(VOLUME_TRADED) AS VOLUME_TRADED,
        COUNT(TRADES_COUNT) AS TRADES_COUNT
    FROM __dbt__cte__bitcoin_realtime
    GROUP BY DATE(start_time)  -- Ensure this matches the correct column name
)
SELECT 
    DAY,
    PRICE_LOW,
    PRICE_HIGH,
    VOLUME_TRADED,
    TRADES_COUNT
FROM real_time_agg;
[0m16:59:06.714784 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:59:07.123254 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8a3fb-0003-6502-0003-437a0010a10a
[0m16:59:07.124318 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 31 at position 18 unexpected ';'.
[0m16:59:07.124901 [debug] [Thread-1 (]: On model.dw_project.bitcoin_realtime_aggregated: Close
[0m16:59:07.329254 [debug] [Thread-1 (]: Database Error in model bitcoin_realtime_aggregated (models/output/bitcoin_realtime_aggregated.sql)
  001003 (42000): SQL compilation error:
  syntax error line 31 at position 18 unexpected ';'.
  compiled code at target/run/dw_project/models/output/bitcoin_realtime_aggregated.sql
[0m16:59:07.330452 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdd77d47-f7b1-4770-b0c8-5ba10589ab0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13fedf1a0>]}
[0m16:59:07.331663 [error] [Thread-1 (]: 4 of 5 ERROR creating sql table model analytics.bitcoin_realtime_aggregated .... [[31mERROR[0m in 0.63s]
[0m16:59:07.332444 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_realtime_aggregated
[0m16:59:07.334002 [debug] [Thread-1 (]: Began running node model.dw_project.comparison
[0m16:59:07.334696 [info ] [Thread-1 (]: 5 of 5 SKIP relation analytics.comparison ...................................... [[33mSKIP[0m]
[0m16:59:07.335215 [debug] [Thread-1 (]: Finished running node model.dw_project.comparison
[0m16:59:07.336505 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:59:07.336859 [debug] [MainThread]: Connection 'model.dw_project.bitcoin_realtime_aggregated' was properly closed.
[0m16:59:07.337256 [info ] [MainThread]: 
[0m16:59:07.337600 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 10.27 seconds (10.27s).
[0m16:59:07.338742 [debug] [MainThread]: Command end result
[0m16:59:07.360637 [info ] [MainThread]: 
[0m16:59:07.360918 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:59:07.361092 [info ] [MainThread]: 
[0m16:59:07.361308 [error] [MainThread]:   Database Error in model bitcoin_realtime_aggregated (models/output/bitcoin_realtime_aggregated.sql)
  001003 (42000): SQL compilation error:
  syntax error line 31 at position 18 unexpected ';'.
  compiled code at target/run/dw_project/models/output/bitcoin_realtime_aggregated.sql
[0m16:59:07.361489 [info ] [MainThread]: 
[0m16:59:07.361675 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
[0m16:59:07.363529 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 11.588477, "process_user_time": 2.045824, "process_kernel_time": 2.644711, "process_mem_max_rss": "210403328", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:59:07.363815 [debug] [MainThread]: Command `dbt run` failed at 16:59:07.363765 after 11.59 seconds
[0m16:59:07.364023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x162571850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13fe61c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16249b6e0>]}
[0m16:59:07.364208 [debug] [MainThread]: Flushing usage events
[0m16:59:18.991470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102778c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040113a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104011430>]}


============================== 16:59:18.992763 | 3f5a7a9d-115d-4bd0-8b6d-0fcde4ea9141 ==============================
[0m16:59:18.992763 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:59:18.993028 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'version_check': 'True', 'fail_fast': 'False', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'use_colors': 'True', 'invocation_command': 'dbt run', 'use_experimental_parser': 'False', 'warn_error': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'target_path': 'None', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'indirect_selection': 'eager', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'partial_parse': 'True', 'debug': 'False', 'write_json': 'True'}
[0m16:59:19.540190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3f5a7a9d-115d-4bd0-8b6d-0fcde4ea9141', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bc2cf0>]}
[0m16:59:19.557552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3f5a7a9d-115d-4bd0-8b6d-0fcde4ea9141', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10538dfa0>]}
[0m16:59:19.558569 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m16:59:19.566712 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:59:19.618971 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:59:19.619245 [debug] [MainThread]: Partial parsing: updated file: dw_project://models/output/bitcoin_realtime_aggregated.sql
[0m16:59:19.697181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3f5a7a9d-115d-4bd0-8b6d-0fcde4ea9141', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1418f1b20>]}
[0m16:59:19.728912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3f5a7a9d-115d-4bd0-8b6d-0fcde4ea9141', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1418cb200>]}
[0m16:59:19.729122 [info ] [MainThread]: Found 7 models, 3 sources, 459 macros
[0m16:59:19.729268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f5a7a9d-115d-4bd0-8b6d-0fcde4ea9141', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1411f6150>]}
[0m16:59:19.729968 [info ] [MainThread]: 
[0m16:59:19.730212 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:59:19.731883 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m16:59:19.736699 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m16:59:19.736838 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m16:59:19.736946 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:59:20.453099 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.716 seconds
[0m16:59:20.455744 [debug] [ThreadPool]: On list_lab2: Close
[0m16:59:20.648042 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m16:59:20.659508 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m16:59:20.659965 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m16:59:20.660231 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:59:21.349192 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.689 seconds
[0m16:59:21.353804 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m16:59:21.530692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f5a7a9d-115d-4bd0-8b6d-0fcde4ea9141', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141261250>]}
[0m16:59:21.532191 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m16:59:21.532943 [info ] [MainThread]: 
[0m16:59:21.538880 [debug] [Thread-1 (]: Began running node model.dw_project.avg_price_realtime
[0m16:59:21.539754 [info ] [Thread-1 (]: 1 of 5 START sql table model analytics.avg_price_realtime ...................... [RUN]
[0m16:59:21.540495 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now model.dw_project.avg_price_realtime)
[0m16:59:21.541027 [debug] [Thread-1 (]: Began compiling node model.dw_project.avg_price_realtime
[0m16:59:21.600021 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.avg_price_realtime"
[0m16:59:21.600560 [debug] [Thread-1 (]: Began executing node model.dw_project.avg_price_realtime
[0m16:59:21.612699 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.avg_price_realtime"
[0m16:59:21.613358 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.avg_price_realtime"
[0m16:59:21.613521 [debug] [Thread-1 (]: On model.dw_project.avg_price_realtime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.avg_price_realtime"} */
create or replace transient table lab2.analytics.avg_price_realtime
         as
        (WITH realtime AS (
    SELECT 
        time_open AS time_period_start,
        price_close
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    time_period_start,
    AVG(price_close) OVER (ORDER BY time_period_start ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) AS thirty_min_avg_price
FROM realtime
ORDER BY time_period_start
        );
[0m16:59:21.613664 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:59:23.020339 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.406 seconds
[0m16:59:23.042426 [debug] [Thread-1 (]: On model.dw_project.avg_price_realtime: Close
[0m16:59:23.221940 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f5a7a9d-115d-4bd0-8b6d-0fcde4ea9141', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a737d0>]}
[0m16:59:23.223144 [info ] [Thread-1 (]: 1 of 5 OK created sql table model analytics.avg_price_realtime ................. [[32mSUCCESS 1[0m in 1.68s]
[0m16:59:23.224172 [debug] [Thread-1 (]: Finished running node model.dw_project.avg_price_realtime
[0m16:59:23.224759 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_daily_summary
[0m16:59:23.225262 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.bitcoin_daily_summary ................... [RUN]
[0m16:59:23.226039 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.avg_price_realtime, now model.dw_project.bitcoin_daily_summary)
[0m16:59:23.226596 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_daily_summary
[0m16:59:23.230824 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_daily_summary"
[0m16:59:23.231659 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_daily_summary
[0m16:59:23.234024 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_daily_summary"
[0m16:59:23.235618 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_daily_summary"
[0m16:59:23.235910 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_daily_summary"} */
create or replace transient table lab2.analytics.bitcoin_daily_summary
         as
        (WITH historical_data AS (
    SELECT
        TIME_PERIOD_START::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_historical
),
realtime_data AS (
    SELECT
        TIME_OPEN::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    date,
    AVG(PRICE_OPEN) AS avg_open,
    AVG(PRICE_HIGH) AS avg_high,
    AVG(PRICE_LOW) AS avg_low,
    AVG(PRICE_CLOSE) AS avg_close,
    SUM(VOLUME_TRADED) AS total_volume,
    SUM(TRADES_COUNT) AS total_trades
FROM (
    SELECT * FROM historical_data
    UNION ALL
    SELECT * FROM realtime_data
) AS combined_data
GROUP BY date
ORDER BY date
        );
[0m16:59:23.236090 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:59:25.553646 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.317 seconds
[0m16:59:25.558951 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: Close
[0m16:59:25.734661 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f5a7a9d-115d-4bd0-8b6d-0fcde4ea9141', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1417ae540>]}
[0m16:59:25.736090 [info ] [Thread-1 (]: 2 of 5 OK created sql table model analytics.bitcoin_daily_summary .............. [[32mSUCCESS 1[0m in 2.51s]
[0m16:59:25.737484 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_daily_summary
[0m16:59:25.738120 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_historical
[0m16:59:25.738782 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_daily_summary, now model.dw_project.bitcoin_historical)
[0m16:59:25.739322 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_historical
[0m16:59:25.742552 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_historical"
[0m16:59:25.743578 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_historical
[0m16:59:25.743939 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_realtime
[0m16:59:25.744505 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_historical, now model.dw_project.bitcoin_realtime)
[0m16:59:25.744945 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_realtime
[0m16:59:25.747182 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_realtime"
[0m16:59:25.748099 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_realtime
[0m16:59:25.748416 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_historical_aggregated
[0m16:59:25.748822 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.bitcoin_historical_aggregated ........... [RUN]
[0m16:59:25.749200 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_realtime, now model.dw_project.bitcoin_historical_aggregated)
[0m16:59:25.749451 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_historical_aggregated
[0m16:59:25.754333 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_historical_aggregated"
[0m16:59:25.754796 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_historical_aggregated
[0m16:59:25.756702 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_historical_aggregated"
[0m16:59:25.757713 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_historical_aggregated"
[0m16:59:25.757968 [debug] [Thread-1 (]: On model.dw_project.bitcoin_historical_aggregated: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_historical_aggregated"} */
create or replace transient table lab2.analytics.bitcoin_historical_aggregated
         as
        (-- bitcoin_historical_aggregated.sql
WITH  __dbt__cte__bitcoin_historical as (
SELECT 
    time_period_start,
    time_period_end,
    time_open,
    time_close,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_historical
WHERE time_period_start IS NOT NULL
), historical_agg AS (
    SELECT 
        DATE(TIME_PERIOD_START) AS DAY,
        MIN(PRICE_LOW) AS PRICE_LOW,
        MAX(PRICE_HIGH) AS PRICE_HIGH,
        SUM(VOLUME_TRADED) AS VOLUME_TRADED,
        COUNT(TRADES_COUNT) AS TRADES_COUNT
    FROM __dbt__cte__bitcoin_historical
    GROUP BY DATE(TIME_PERIOD_START)
)
SELECT 
    DAY,
    PRICE_LOW,
    PRICE_HIGH,
    VOLUME_TRADED,
    TRADES_COUNT
FROM historical_agg
        );
[0m16:59:25.758209 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:59:27.086655 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.328 seconds
[0m16:59:27.087719 [debug] [Thread-1 (]: On model.dw_project.bitcoin_historical_aggregated: Close
[0m16:59:27.244444 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f5a7a9d-115d-4bd0-8b6d-0fcde4ea9141', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14167d6a0>]}
[0m16:59:27.245657 [info ] [Thread-1 (]: 3 of 5 OK created sql table model analytics.bitcoin_historical_aggregated ...... [[32mSUCCESS 1[0m in 1.50s]
[0m16:59:27.246598 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_historical_aggregated
[0m16:59:27.247250 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_realtime_aggregated
[0m16:59:27.248055 [info ] [Thread-1 (]: 4 of 5 START sql table model analytics.bitcoin_realtime_aggregated ............. [RUN]
[0m16:59:27.248752 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_historical_aggregated, now model.dw_project.bitcoin_realtime_aggregated)
[0m16:59:27.249311 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_realtime_aggregated
[0m16:59:27.258311 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_realtime_aggregated"
[0m16:59:27.259073 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_realtime_aggregated
[0m16:59:27.260482 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_realtime_aggregated"
[0m16:59:27.261239 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_realtime_aggregated"
[0m16:59:27.261423 [debug] [Thread-1 (]: On model.dw_project.bitcoin_realtime_aggregated: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_realtime_aggregated"} */
create or replace transient table lab2.analytics.bitcoin_realtime_aggregated
         as
        (-- bitcoin_realtime_aggregated.sql
WITH  __dbt__cte__bitcoin_realtime as (
SELECT 
    time_open,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_realtime
WHERE price_close IS NOT NULL
), real_time_agg AS (
    SELECT 
        DATE(start_time) AS DAY,  -- Correct column name here
        MIN(PRICE_LOW) AS PRICE_LOW,
        MAX(PRICE_HIGH) AS PRICE_HIGH,
        SUM(VOLUME_TRADED) AS VOLUME_TRADED,
        COUNT(TRADES_COUNT) AS TRADES_COUNT
    FROM __dbt__cte__bitcoin_realtime
    GROUP BY DATE(start_time)  -- Ensure this matches the correct column name
)
SELECT 
    DAY,
    PRICE_LOW,
    PRICE_HIGH,
    VOLUME_TRADED,
    TRADES_COUNT
FROM real_time_agg
        );
[0m16:59:27.261577 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:59:27.884335 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8a3fb-0003-64f2-0003-437a0010d0d6
[0m16:59:27.885283 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 17 at position 13
invalid identifier 'START_TIME'
[0m16:59:27.885872 [debug] [Thread-1 (]: On model.dw_project.bitcoin_realtime_aggregated: Close
[0m16:59:28.064610 [debug] [Thread-1 (]: Database Error in model bitcoin_realtime_aggregated (models/output/bitcoin_realtime_aggregated.sql)
  000904 (42000): SQL compilation error: error line 17 at position 13
  invalid identifier 'START_TIME'
  compiled code at target/run/dw_project/models/output/bitcoin_realtime_aggregated.sql
[0m16:59:28.065965 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f5a7a9d-115d-4bd0-8b6d-0fcde4ea9141', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14140bb00>]}
[0m16:59:28.067860 [error] [Thread-1 (]: 4 of 5 ERROR creating sql table model analytics.bitcoin_realtime_aggregated .... [[31mERROR[0m in 0.82s]
[0m16:59:28.069278 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_realtime_aggregated
[0m16:59:28.070979 [debug] [Thread-1 (]: Began running node model.dw_project.comparison
[0m16:59:28.071701 [info ] [Thread-1 (]: 5 of 5 SKIP relation analytics.comparison ...................................... [[33mSKIP[0m]
[0m16:59:28.072351 [debug] [Thread-1 (]: Finished running node model.dw_project.comparison
[0m16:59:28.073539 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:59:28.073865 [debug] [MainThread]: Connection 'model.dw_project.bitcoin_realtime_aggregated' was properly closed.
[0m16:59:28.074201 [info ] [MainThread]: 
[0m16:59:28.074510 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 8.34 seconds (8.34s).
[0m16:59:28.075438 [debug] [MainThread]: Command end result
[0m16:59:28.095165 [info ] [MainThread]: 
[0m16:59:28.095468 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:59:28.095631 [info ] [MainThread]: 
[0m16:59:28.095841 [error] [MainThread]:   Database Error in model bitcoin_realtime_aggregated (models/output/bitcoin_realtime_aggregated.sql)
  000904 (42000): SQL compilation error: error line 17 at position 13
  invalid identifier 'START_TIME'
  compiled code at target/run/dw_project/models/output/bitcoin_realtime_aggregated.sql
[0m16:59:28.096011 [info ] [MainThread]: 
[0m16:59:28.096182 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
[0m16:59:28.098621 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 9.128422, "process_user_time": 2.581969, "process_kernel_time": 1.809522, "process_mem_max_rss": "209485824", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:59:28.098921 [debug] [MainThread]: Command `dbt run` failed at 16:59:28.098871 after 9.13 seconds
[0m16:59:28.099137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10502f9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104667b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1417f26f0>]}
[0m16:59:28.099324 [debug] [MainThread]: Flushing usage events
[0m17:01:03.258065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10658f9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105959340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059592e0>]}


============================== 17:01:03.259860 | 8738d095-2028-497f-8356-696636af2e43 ==============================
[0m17:01:03.259860 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:01:03.260144 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'warn_error': 'None', 'log_format': 'default', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'no_print': 'None', 'static_parser': 'True', 'write_json': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_experimental_parser': 'False', 'target_path': 'None', 'log_cache_events': 'False', 'quiet': 'False', 'introspect': 'True', 'invocation_command': 'dbt run', 'debug': 'False', 'printer_width': '80', 'empty': 'False', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'partial_parse': 'True', 'fail_fast': 'False', 'use_colors': 'True'}
[0m17:01:04.152494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8738d095-2028-497f-8356-696636af2e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10598f860>]}
[0m17:01:04.169576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8738d095-2028-497f-8356-696636af2e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106866ed0>]}
[0m17:01:04.170040 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:01:04.178984 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:01:04.234725 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:01:04.235021 [debug] [MainThread]: Partial parsing: updated file: dw_project://models/output/bitcoin_realtime_aggregated.sql
[0m17:01:04.290286 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dw_project.bitcoin_realtime_aggregated' (models/output/bitcoin_realtime_aggregated.sql) depends on a node named 'BITCOIN_REALTIME' which was not found
[0m17:01:04.292112 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.0567758, "process_user_time": 2.567726, "process_kernel_time": 1.357986, "process_mem_max_rss": "197443584", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:01:04.292413 [debug] [MainThread]: Command `dbt run` failed at 17:01:04.292358 after 1.06 seconds
[0m17:01:04.292615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10669b980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a0696d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1490281a0>]}
[0m17:01:04.292779 [debug] [MainThread]: Flushing usage events
[0m17:01:44.977891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12018eea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120477e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120477a10>]}


============================== 17:01:44.979451 | 5978e34a-9ba7-411e-8eb2-431a4f81308c ==============================
[0m17:01:44.979451 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:01:44.979736 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'partial_parse': 'True', 'printer_width': '80', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'debug': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'target_path': 'None', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'write_json': 'True', 'static_parser': 'True', 'indirect_selection': 'eager', 'log_format': 'default', 'warn_error': 'None', 'empty': 'False', 'quiet': 'False', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs'}
[0m17:01:45.715279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5978e34a-9ba7-411e-8eb2-431a4f81308c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137a3b980>]}
[0m17:01:45.732363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5978e34a-9ba7-411e-8eb2-431a4f81308c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120475910>]}
[0m17:01:45.732850 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:01:45.741312 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:01:45.796370 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:01:45.796668 [debug] [MainThread]: Partial parsing: updated file: dw_project://models/output/bitcoin_realtime_aggregated.sql
[0m17:01:45.882136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5978e34a-9ba7-411e-8eb2-431a4f81308c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145cd1970>]}
[0m17:01:45.916662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5978e34a-9ba7-411e-8eb2-431a4f81308c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145cbf560>]}
[0m17:01:45.916900 [info ] [MainThread]: Found 7 models, 3 sources, 459 macros
[0m17:01:45.917049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5978e34a-9ba7-411e-8eb2-431a4f81308c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145ccf800>]}
[0m17:01:45.917773 [info ] [MainThread]: 
[0m17:01:45.918019 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:01:45.919721 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m17:01:45.924591 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m17:01:45.924721 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m17:01:45.924821 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:01:46.791105 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.865 seconds
[0m17:01:46.793883 [debug] [ThreadPool]: On list_lab2: Close
[0m17:01:46.979733 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m17:01:46.992692 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m17:01:46.993235 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m17:01:46.993561 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:01:47.695799 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.702 seconds
[0m17:01:47.700165 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m17:01:47.909493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5978e34a-9ba7-411e-8eb2-431a4f81308c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c53c50>]}
[0m17:01:47.910675 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m17:01:47.911259 [info ] [MainThread]: 
[0m17:01:47.918272 [debug] [Thread-1 (]: Began running node model.dw_project.avg_price_realtime
[0m17:01:47.919164 [info ] [Thread-1 (]: 1 of 5 START sql table model analytics.avg_price_realtime ...................... [RUN]
[0m17:01:47.920057 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now model.dw_project.avg_price_realtime)
[0m17:01:47.920738 [debug] [Thread-1 (]: Began compiling node model.dw_project.avg_price_realtime
[0m17:01:47.977980 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.avg_price_realtime"
[0m17:01:47.978978 [debug] [Thread-1 (]: Began executing node model.dw_project.avg_price_realtime
[0m17:01:47.991301 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.avg_price_realtime"
[0m17:01:47.991897 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.avg_price_realtime"
[0m17:01:47.992073 [debug] [Thread-1 (]: On model.dw_project.avg_price_realtime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.avg_price_realtime"} */
create or replace transient table lab2.analytics.avg_price_realtime
         as
        (WITH realtime AS (
    SELECT 
        time_open AS time_period_start,
        price_close
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    time_period_start,
    AVG(price_close) OVER (ORDER BY time_period_start ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) AS thirty_min_avg_price
FROM realtime
ORDER BY time_period_start
        );
[0m17:01:47.992223 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:01:50.063888 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.071 seconds
[0m17:01:50.092459 [debug] [Thread-1 (]: On model.dw_project.avg_price_realtime: Close
[0m17:01:50.283105 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5978e34a-9ba7-411e-8eb2-431a4f81308c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1471ad850>]}
[0m17:01:50.284951 [info ] [Thread-1 (]: 1 of 5 OK created sql table model analytics.avg_price_realtime ................. [[32mSUCCESS 1[0m in 2.36s]
[0m17:01:50.286085 [debug] [Thread-1 (]: Finished running node model.dw_project.avg_price_realtime
[0m17:01:50.286825 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_daily_summary
[0m17:01:50.287855 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.bitcoin_daily_summary ................... [RUN]
[0m17:01:50.288599 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.avg_price_realtime, now model.dw_project.bitcoin_daily_summary)
[0m17:01:50.289121 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_daily_summary
[0m17:01:50.293906 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_daily_summary"
[0m17:01:50.295845 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_daily_summary
[0m17:01:50.298326 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_daily_summary"
[0m17:01:50.299797 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_daily_summary"
[0m17:01:50.300166 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_daily_summary"} */
create or replace transient table lab2.analytics.bitcoin_daily_summary
         as
        (WITH historical_data AS (
    SELECT
        TIME_PERIOD_START::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_historical
),
realtime_data AS (
    SELECT
        TIME_OPEN::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    date,
    AVG(PRICE_OPEN) AS avg_open,
    AVG(PRICE_HIGH) AS avg_high,
    AVG(PRICE_LOW) AS avg_low,
    AVG(PRICE_CLOSE) AS avg_close,
    SUM(VOLUME_TRADED) AS total_volume,
    SUM(TRADES_COUNT) AS total_trades
FROM (
    SELECT * FROM historical_data
    UNION ALL
    SELECT * FROM realtime_data
) AS combined_data
GROUP BY date
ORDER BY date
        );
[0m17:01:50.300508 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:01:52.624765 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.324 seconds
[0m17:01:52.629370 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: Close
[0m17:01:52.802137 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5978e34a-9ba7-411e-8eb2-431a4f81308c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1471c9940>]}
[0m17:01:52.803941 [info ] [Thread-1 (]: 2 of 5 OK created sql table model analytics.bitcoin_daily_summary .............. [[32mSUCCESS 1[0m in 2.51s]
[0m17:01:52.805759 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_daily_summary
[0m17:01:52.806811 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_historical
[0m17:01:52.807689 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_daily_summary, now model.dw_project.bitcoin_historical)
[0m17:01:52.808286 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_historical
[0m17:01:52.813462 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_historical"
[0m17:01:52.816273 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_historical
[0m17:01:52.816716 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_realtime
[0m17:01:52.817257 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_historical, now model.dw_project.bitcoin_realtime)
[0m17:01:52.817842 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_realtime
[0m17:01:52.820340 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_realtime"
[0m17:01:52.821951 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_realtime
[0m17:01:52.822373 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_historical_aggregated
[0m17:01:52.822899 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.bitcoin_historical_aggregated ........... [RUN]
[0m17:01:52.823284 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_realtime, now model.dw_project.bitcoin_historical_aggregated)
[0m17:01:52.823574 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_historical_aggregated
[0m17:01:52.829095 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_historical_aggregated"
[0m17:01:52.829968 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_historical_aggregated
[0m17:01:52.832109 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_historical_aggregated"
[0m17:01:52.833316 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_historical_aggregated"
[0m17:01:52.833592 [debug] [Thread-1 (]: On model.dw_project.bitcoin_historical_aggregated: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_historical_aggregated"} */
create or replace transient table lab2.analytics.bitcoin_historical_aggregated
         as
        (-- bitcoin_historical_aggregated.sql
WITH  __dbt__cte__bitcoin_historical as (
SELECT 
    time_period_start,
    time_period_end,
    time_open,
    time_close,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_historical
WHERE time_period_start IS NOT NULL
), historical_agg AS (
    SELECT 
        DATE(TIME_PERIOD_START) AS DAY,
        MIN(PRICE_LOW) AS PRICE_LOW,
        MAX(PRICE_HIGH) AS PRICE_HIGH,
        SUM(VOLUME_TRADED) AS VOLUME_TRADED,
        COUNT(TRADES_COUNT) AS TRADES_COUNT
    FROM __dbt__cte__bitcoin_historical
    GROUP BY DATE(TIME_PERIOD_START)
)
SELECT 
    DAY,
    PRICE_LOW,
    PRICE_HIGH,
    VOLUME_TRADED,
    TRADES_COUNT
FROM historical_agg
        );
[0m17:01:52.833842 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:01:54.674295 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.840 seconds
[0m17:01:54.679026 [debug] [Thread-1 (]: On model.dw_project.bitcoin_historical_aggregated: Close
[0m17:01:54.905287 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5978e34a-9ba7-411e-8eb2-431a4f81308c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d1b6e0>]}
[0m17:01:54.906609 [info ] [Thread-1 (]: 3 of 5 OK created sql table model analytics.bitcoin_historical_aggregated ...... [[32mSUCCESS 1[0m in 2.08s]
[0m17:01:54.907600 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_historical_aggregated
[0m17:01:54.908256 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_realtime_aggregated
[0m17:01:54.909043 [info ] [Thread-1 (]: 4 of 5 START sql table model analytics.bitcoin_realtime_aggregated ............. [RUN]
[0m17:01:54.909772 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_historical_aggregated, now model.dw_project.bitcoin_realtime_aggregated)
[0m17:01:54.910350 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_realtime_aggregated
[0m17:01:54.918507 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_realtime_aggregated"
[0m17:01:54.919291 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_realtime_aggregated
[0m17:01:54.920907 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_realtime_aggregated"
[0m17:01:54.921753 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_realtime_aggregated"
[0m17:01:54.921978 [debug] [Thread-1 (]: On model.dw_project.bitcoin_realtime_aggregated: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_realtime_aggregated"} */
create or replace transient table lab2.analytics.bitcoin_realtime_aggregated
         as
        (-- bitcoin_realtime_aggregated.sql
WITH  __dbt__cte__bitcoin_realtime as (
SELECT 
    time_open,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_realtime
WHERE price_close IS NOT NULL
), real_time_agg AS (
    SELECT 
        DATE(TIME_PERIOD_START) AS DAY,  -- Correct column name here
        MIN(PRICE_LOW) AS PRICE_LOW,
        MAX(PRICE_HIGH) AS PRICE_HIGH,
        SUM(VOLUME_TRADED) AS VOLUME_TRADED,
        COUNT(TRADES_COUNT) AS TRADES_COUNT
    FROM __dbt__cte__bitcoin_realtime
    GROUP BY DATE(TIME_PERIOD_START)  -- Ensure this matches the correct column name
)
SELECT 
    DAY,
    PRICE_LOW,
    PRICE_HIGH,
    VOLUME_TRADED,
    TRADES_COUNT
FROM real_time_agg
        );
[0m17:01:54.922188 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:01:55.349302 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8a3fd-0003-65f7-0003-437a001140b2
[0m17:01:55.350230 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 17 at position 13
invalid identifier 'TIME_PERIOD_START'
[0m17:01:55.350803 [debug] [Thread-1 (]: On model.dw_project.bitcoin_realtime_aggregated: Close
[0m17:01:55.526229 [debug] [Thread-1 (]: Database Error in model bitcoin_realtime_aggregated (models/output/bitcoin_realtime_aggregated.sql)
  000904 (42000): SQL compilation error: error line 17 at position 13
  invalid identifier 'TIME_PERIOD_START'
  compiled code at target/run/dw_project/models/output/bitcoin_realtime_aggregated.sql
[0m17:01:55.527013 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5978e34a-9ba7-411e-8eb2-431a4f81308c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1471cac90>]}
[0m17:01:55.527689 [error] [Thread-1 (]: 4 of 5 ERROR creating sql table model analytics.bitcoin_realtime_aggregated .... [[31mERROR[0m in 0.62s]
[0m17:01:55.528432 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_realtime_aggregated
[0m17:01:55.529449 [debug] [Thread-1 (]: Began running node model.dw_project.comparison
[0m17:01:55.529934 [info ] [Thread-1 (]: 5 of 5 SKIP relation analytics.comparison ...................................... [[33mSKIP[0m]
[0m17:01:55.530333 [debug] [Thread-1 (]: Finished running node model.dw_project.comparison
[0m17:01:55.531492 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:01:55.531936 [debug] [MainThread]: Connection 'model.dw_project.bitcoin_realtime_aggregated' was properly closed.
[0m17:01:55.532340 [info ] [MainThread]: 
[0m17:01:55.532754 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 9.61 seconds (9.61s).
[0m17:01:55.534055 [debug] [MainThread]: Command end result
[0m17:01:55.558221 [info ] [MainThread]: 
[0m17:01:55.558573 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:01:55.558767 [info ] [MainThread]: 
[0m17:01:55.558998 [error] [MainThread]:   Database Error in model bitcoin_realtime_aggregated (models/output/bitcoin_realtime_aggregated.sql)
  000904 (42000): SQL compilation error: error line 17 at position 13
  invalid identifier 'TIME_PERIOD_START'
  compiled code at target/run/dw_project/models/output/bitcoin_realtime_aggregated.sql
[0m17:01:55.559177 [info ] [MainThread]: 
[0m17:01:55.559369 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
[0m17:01:55.561343 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 10.605493, "process_user_time": 3.414694, "process_kernel_time": 1.183711, "process_mem_max_rss": "209567744", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:01:55.561749 [debug] [MainThread]: Command `dbt run` failed at 17:01:55.561678 after 10.61 seconds
[0m17:01:55.562019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145dcb620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145ccffb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145b9f920>]}
[0m17:01:55.562255 [debug] [MainThread]: Flushing usage events
[0m17:02:01.796361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a133e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b2b9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b2b680>]}


============================== 17:02:01.797850 | f4c4362b-f5b2-4e41-97ae-45f4cce66344 ==============================
[0m17:02:01.797850 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:02:01.798133 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'quiet': 'False', 'invocation_command': 'dbt debug', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'use_colors': 'True', 'printer_width': '80', 'version_check': 'True', 'introspect': 'True', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'log_cache_events': 'False', 'log_format': 'default', 'indirect_selection': 'eager', 'fail_fast': 'False', 'static_parser': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'empty': 'None', 'debug': 'False', 'no_print': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:02:01.804077 [info ] [MainThread]: dbt version: 1.8.7
[0m17:02:01.804252 [info ] [MainThread]: python version: 3.12.4
[0m17:02:01.804364 [info ] [MainThread]: python path: /opt/anaconda3/bin/python
[0m17:02:01.804466 [info ] [MainThread]: os info: macOS-14.4-arm64-arm-64bit
[0m17:02:02.307779 [info ] [MainThread]: Using profiles dir at /Users/drashtibhingradiya/Desktop/dw_project
[0m17:02:02.308074 [info ] [MainThread]: Using profiles.yml file at /Users/drashtibhingradiya/Desktop/dw_project/profiles.yml
[0m17:02:02.308201 [info ] [MainThread]: Using dbt_project.yml file at /Users/drashtibhingradiya/Desktop/dw_project/dbt_project.yml
[0m17:02:02.308568 [info ] [MainThread]: adapter type: snowflake
[0m17:02:02.308682 [info ] [MainThread]: adapter version: 1.8.4
[0m17:02:02.338285 [info ] [MainThread]: Configuration:
[0m17:02:02.338530 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:02:02.338650 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:02:02.338764 [info ] [MainThread]: Required dependencies:
[0m17:02:02.338907 [debug] [MainThread]: Executing "git --help"
[0m17:02:02.353959 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:02:02.354454 [debug] [MainThread]: STDERR: "b''"
[0m17:02:02.354595 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:02:02.354741 [info ] [MainThread]: Connection:
[0m17:02:02.354885 [info ] [MainThread]:   account: MWXXFJX-HP43653
[0m17:02:02.354991 [info ] [MainThread]:   user: drashti27
[0m17:02:02.355086 [info ] [MainThread]:   database: lab2
[0m17:02:02.355181 [info ] [MainThread]:   warehouse: dw
[0m17:02:02.355271 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m17:02:02.355362 [info ] [MainThread]:   schema: analytics
[0m17:02:02.355458 [info ] [MainThread]:   authenticator: None
[0m17:02:02.355548 [info ] [MainThread]:   oauth_client_id: None
[0m17:02:02.355639 [info ] [MainThread]:   query_tag: None
[0m17:02:02.355730 [info ] [MainThread]:   client_session_keep_alive: False
[0m17:02:02.355819 [info ] [MainThread]:   host: None
[0m17:02:02.355911 [info ] [MainThread]:   port: None
[0m17:02:02.355998 [info ] [MainThread]:   proxy_host: None
[0m17:02:02.356089 [info ] [MainThread]:   proxy_port: None
[0m17:02:02.356175 [info ] [MainThread]:   protocol: None
[0m17:02:02.356262 [info ] [MainThread]:   connect_retries: 1
[0m17:02:02.356354 [info ] [MainThread]:   connect_timeout: None
[0m17:02:02.356442 [info ] [MainThread]:   retry_on_database_errors: False
[0m17:02:02.356531 [info ] [MainThread]:   retry_all: False
[0m17:02:02.356618 [info ] [MainThread]:   insecure_mode: False
[0m17:02:02.356705 [info ] [MainThread]:   reuse_connections: None
[0m17:02:02.356975 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:02:02.360146 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m17:02:02.361057 [debug] [MainThread]: Using snowflake connection "debug"
[0m17:02:02.361185 [debug] [MainThread]: On debug: select 1 as id
[0m17:02:02.361286 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:02:03.365847 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.004 seconds
[0m17:02:03.368059 [debug] [MainThread]: On debug: Close
[0m17:02:03.563580 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:02:03.564353 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:02:03.567426 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.795159, "process_user_time": 1.603543, "process_kernel_time": 1.950713, "process_mem_max_rss": "197246976", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:02:03.568398 [debug] [MainThread]: Command `dbt debug` succeeded at 17:02:03.568249 after 1.80 seconds
[0m17:02:03.568908 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:02:03.569426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104864170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13fe225a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a4f79b0>]}
[0m17:02:03.570001 [debug] [MainThread]: Flushing usage events
[0m17:05:27.996466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076674a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b3fa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b3f620>]}


============================== 17:05:27.997956 | 3608b259-58ae-45d9-ace3-1a5e76b022e6 ==============================
[0m17:05:27.997956 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:05:27.998219 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'partial_parse': 'True', 'introspect': 'True', 'write_json': 'True', 'log_cache_events': 'False', 'warn_error': 'None', 'use_colors': 'True', 'invocation_command': 'dbt debug', 'debug': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'fail_fast': 'False', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'printer_width': '80', 'target_path': 'None', 'log_format': 'default', 'static_parser': 'True', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'empty': 'None', 'indirect_selection': 'eager'}
[0m17:05:28.005708 [info ] [MainThread]: dbt version: 1.8.7
[0m17:05:28.005871 [info ] [MainThread]: python version: 3.12.4
[0m17:05:28.005990 [info ] [MainThread]: python path: /opt/anaconda3/bin/python
[0m17:05:28.006097 [info ] [MainThread]: os info: macOS-14.4-arm64-arm-64bit
[0m17:05:28.795122 [info ] [MainThread]: Using profiles dir at /Users/drashtibhingradiya/Desktop/dw_project
[0m17:05:28.795346 [info ] [MainThread]: Using profiles.yml file at /Users/drashtibhingradiya/Desktop/dw_project/profiles.yml
[0m17:05:28.795469 [info ] [MainThread]: Using dbt_project.yml file at /Users/drashtibhingradiya/Desktop/dw_project/dbt_project.yml
[0m17:05:28.795788 [info ] [MainThread]: adapter type: snowflake
[0m17:05:28.795902 [info ] [MainThread]: adapter version: 1.8.4
[0m17:05:28.822693 [info ] [MainThread]: Configuration:
[0m17:05:28.822867 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:05:28.822984 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:05:28.823093 [info ] [MainThread]: Required dependencies:
[0m17:05:28.823234 [debug] [MainThread]: Executing "git --help"
[0m17:05:28.832610 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:05:28.833033 [debug] [MainThread]: STDERR: "b''"
[0m17:05:28.833158 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:05:28.833290 [info ] [MainThread]: Connection:
[0m17:05:28.833420 [info ] [MainThread]:   account: MWXXFJX-HP43653
[0m17:05:28.833520 [info ] [MainThread]:   user: drashti27
[0m17:05:28.833613 [info ] [MainThread]:   database: lab2
[0m17:05:28.833703 [info ] [MainThread]:   warehouse: dw
[0m17:05:28.833790 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m17:05:28.833880 [info ] [MainThread]:   schema: analytics
[0m17:05:28.833979 [info ] [MainThread]:   authenticator: None
[0m17:05:28.834067 [info ] [MainThread]:   oauth_client_id: None
[0m17:05:28.834158 [info ] [MainThread]:   query_tag: None
[0m17:05:28.834251 [info ] [MainThread]:   client_session_keep_alive: False
[0m17:05:28.834346 [info ] [MainThread]:   host: None
[0m17:05:28.834436 [info ] [MainThread]:   port: None
[0m17:05:28.834522 [info ] [MainThread]:   proxy_host: None
[0m17:05:28.834611 [info ] [MainThread]:   proxy_port: None
[0m17:05:28.834699 [info ] [MainThread]:   protocol: None
[0m17:05:28.834785 [info ] [MainThread]:   connect_retries: 1
[0m17:05:28.834870 [info ] [MainThread]:   connect_timeout: None
[0m17:05:28.834957 [info ] [MainThread]:   retry_on_database_errors: False
[0m17:05:28.835045 [info ] [MainThread]:   retry_all: False
[0m17:05:28.835130 [info ] [MainThread]:   insecure_mode: False
[0m17:05:28.835216 [info ] [MainThread]:   reuse_connections: None
[0m17:05:28.835498 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:05:28.838591 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m17:05:28.839401 [debug] [MainThread]: Using snowflake connection "debug"
[0m17:05:28.839512 [debug] [MainThread]: On debug: select 1 as id
[0m17:05:28.839608 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:05:29.636491 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.797 seconds
[0m17:05:29.638748 [debug] [MainThread]: On debug: Close
[0m17:05:29.933964 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:05:29.935065 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:05:29.941262 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.9676144, "process_user_time": 2.606912, "process_kernel_time": 1.29626, "process_mem_max_rss": "197509120", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:05:29.942414 [debug] [MainThread]: Command `dbt debug` succeeded at 17:05:29.942259 after 1.97 seconds
[0m17:05:29.942923 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:05:29.943408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140a0a570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140b37050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127b106e0>]}
[0m17:05:29.943958 [debug] [MainThread]: Flushing usage events
[0m17:05:33.201119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d7f650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103dd7470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d9d460>]}


============================== 17:05:33.202259 | 20310474-c253-451e-8244-8ab7f1d3d864 ==============================
[0m17:05:33.202259 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:05:33.202529 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'log_cache_events': 'False', 'quiet': 'False', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'log_format': 'default', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'use_experimental_parser': 'False', 'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'invocation_command': 'dbt run', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'indirect_selection': 'eager', 'write_json': 'True', 'cache_selected_only': 'False', 'partial_parse': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])'}
[0m17:05:33.717916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '20310474-c253-451e-8244-8ab7f1d3d864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b33b980>]}
[0m17:05:33.735684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '20310474-c253-451e-8244-8ab7f1d3d864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b4a0380>]}
[0m17:05:33.736108 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:05:33.744829 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:05:33.799399 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:05:33.799672 [debug] [MainThread]: Partial parsing: updated file: dw_project://models/output/bitcoin_realtime_aggregated.sql
[0m17:05:33.880523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '20310474-c253-451e-8244-8ab7f1d3d864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12baf1880>]}
[0m17:05:33.911375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '20310474-c253-451e-8244-8ab7f1d3d864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12bacb590>]}
[0m17:05:33.911592 [info ] [MainThread]: Found 7 models, 3 sources, 459 macros
[0m17:05:33.911735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20310474-c253-451e-8244-8ab7f1d3d864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b7943b0>]}
[0m17:05:33.912471 [info ] [MainThread]: 
[0m17:05:33.912723 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:05:33.914367 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m17:05:33.919093 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m17:05:33.919224 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m17:05:33.919329 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:05:34.627627 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.708 seconds
[0m17:05:34.630218 [debug] [ThreadPool]: On list_lab2: Close
[0m17:05:34.841613 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m17:05:34.854852 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m17:05:34.855329 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m17:05:34.855607 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:05:35.654341 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.798 seconds
[0m17:05:35.659810 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m17:05:35.848371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20310474-c253-451e-8244-8ab7f1d3d864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b459400>]}
[0m17:05:35.849888 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m17:05:35.850647 [info ] [MainThread]: 
[0m17:05:35.856137 [debug] [Thread-1 (]: Began running node model.dw_project.avg_price_realtime
[0m17:05:35.857189 [info ] [Thread-1 (]: 1 of 5 START sql table model analytics.avg_price_realtime ...................... [RUN]
[0m17:05:35.857976 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now model.dw_project.avg_price_realtime)
[0m17:05:35.858581 [debug] [Thread-1 (]: Began compiling node model.dw_project.avg_price_realtime
[0m17:05:35.916229 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.avg_price_realtime"
[0m17:05:35.917599 [debug] [Thread-1 (]: Began executing node model.dw_project.avg_price_realtime
[0m17:05:35.929509 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.avg_price_realtime"
[0m17:05:35.930075 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.avg_price_realtime"
[0m17:05:35.930238 [debug] [Thread-1 (]: On model.dw_project.avg_price_realtime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.avg_price_realtime"} */
create or replace transient table lab2.analytics.avg_price_realtime
         as
        (WITH realtime AS (
    SELECT 
        time_open AS time_period_start,
        price_close
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    time_period_start,
    AVG(price_close) OVER (ORDER BY time_period_start ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) AS thirty_min_avg_price
FROM realtime
ORDER BY time_period_start
        );
[0m17:05:35.930379 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:05:38.213255 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.282 seconds
[0m17:05:38.239602 [debug] [Thread-1 (]: On model.dw_project.avg_price_realtime: Close
[0m17:05:38.419844 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20310474-c253-451e-8244-8ab7f1d3d864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a0c4d70>]}
[0m17:05:38.421676 [info ] [Thread-1 (]: 1 of 5 OK created sql table model analytics.avg_price_realtime ................. [[32mSUCCESS 1[0m in 2.56s]
[0m17:05:38.422983 [debug] [Thread-1 (]: Finished running node model.dw_project.avg_price_realtime
[0m17:05:38.423728 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_daily_summary
[0m17:05:38.424716 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.bitcoin_daily_summary ................... [RUN]
[0m17:05:38.425500 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.avg_price_realtime, now model.dw_project.bitcoin_daily_summary)
[0m17:05:38.426117 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_daily_summary
[0m17:05:38.431720 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_daily_summary"
[0m17:05:38.433656 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_daily_summary
[0m17:05:38.436116 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_daily_summary"
[0m17:05:38.437615 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_daily_summary"
[0m17:05:38.437992 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_daily_summary"} */
create or replace transient table lab2.analytics.bitcoin_daily_summary
         as
        (WITH historical_data AS (
    SELECT
        TIME_PERIOD_START::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_historical
),
realtime_data AS (
    SELECT
        TIME_OPEN::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    date,
    AVG(PRICE_OPEN) AS avg_open,
    AVG(PRICE_HIGH) AS avg_high,
    AVG(PRICE_LOW) AS avg_low,
    AVG(PRICE_CLOSE) AS avg_close,
    SUM(VOLUME_TRADED) AS total_volume,
    SUM(TRADES_COUNT) AS total_trades
FROM (
    SELECT * FROM historical_data
    UNION ALL
    SELECT * FROM realtime_data
) AS combined_data
GROUP BY date
ORDER BY date
        );
[0m17:05:38.438333 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:05:40.044794 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.606 seconds
[0m17:05:40.048414 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: Close
[0m17:05:40.224579 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20310474-c253-451e-8244-8ab7f1d3d864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ba9a240>]}
[0m17:05:40.225730 [info ] [Thread-1 (]: 2 of 5 OK created sql table model analytics.bitcoin_daily_summary .............. [[32mSUCCESS 1[0m in 1.80s]
[0m17:05:40.226672 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_daily_summary
[0m17:05:40.227306 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_historical
[0m17:05:40.227971 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_daily_summary, now model.dw_project.bitcoin_historical)
[0m17:05:40.228555 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_historical
[0m17:05:40.232676 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_historical"
[0m17:05:40.233823 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_historical
[0m17:05:40.234304 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_realtime
[0m17:05:40.234887 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_historical, now model.dw_project.bitcoin_realtime)
[0m17:05:40.235214 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_realtime
[0m17:05:40.237683 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_realtime"
[0m17:05:40.238996 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_realtime
[0m17:05:40.239312 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_historical_aggregated
[0m17:05:40.239742 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.bitcoin_historical_aggregated ........... [RUN]
[0m17:05:40.240038 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_realtime, now model.dw_project.bitcoin_historical_aggregated)
[0m17:05:40.240204 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_historical_aggregated
[0m17:05:40.243036 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_historical_aggregated"
[0m17:05:40.243403 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_historical_aggregated
[0m17:05:40.244721 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_historical_aggregated"
[0m17:05:40.245411 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_historical_aggregated"
[0m17:05:40.245581 [debug] [Thread-1 (]: On model.dw_project.bitcoin_historical_aggregated: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_historical_aggregated"} */
create or replace transient table lab2.analytics.bitcoin_historical_aggregated
         as
        (-- bitcoin_historical_aggregated.sql
WITH  __dbt__cte__bitcoin_historical as (
SELECT 
    time_period_start,
    time_period_end,
    time_open,
    time_close,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_historical
WHERE time_period_start IS NOT NULL
), historical_agg AS (
    SELECT 
        DATE(TIME_PERIOD_START) AS DAY,
        MIN(PRICE_LOW) AS PRICE_LOW,
        MAX(PRICE_HIGH) AS PRICE_HIGH,
        SUM(VOLUME_TRADED) AS VOLUME_TRADED,
        COUNT(TRADES_COUNT) AS TRADES_COUNT
    FROM __dbt__cte__bitcoin_historical
    GROUP BY DATE(TIME_PERIOD_START)
)
SELECT 
    DAY,
    PRICE_LOW,
    PRICE_HIGH,
    VOLUME_TRADED,
    TRADES_COUNT
FROM historical_agg
        );
[0m17:05:40.245745 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:05:42.410660 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.164 seconds
[0m17:05:42.414364 [debug] [Thread-1 (]: On model.dw_project.bitcoin_historical_aggregated: Close
[0m17:05:42.587790 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20310474-c253-451e-8244-8ab7f1d3d864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038cb530>]}
[0m17:05:42.588924 [info ] [Thread-1 (]: 3 of 5 OK created sql table model analytics.bitcoin_historical_aggregated ...... [[32mSUCCESS 1[0m in 2.35s]
[0m17:05:42.589818 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_historical_aggregated
[0m17:05:42.590440 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_realtime_aggregated
[0m17:05:42.591185 [info ] [Thread-1 (]: 4 of 5 START sql table model analytics.bitcoin_realtime_aggregated ............. [RUN]
[0m17:05:42.591868 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_historical_aggregated, now model.dw_project.bitcoin_realtime_aggregated)
[0m17:05:42.592420 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_realtime_aggregated
[0m17:05:42.601623 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_realtime_aggregated"
[0m17:05:42.602399 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_realtime_aggregated
[0m17:05:42.603741 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_realtime_aggregated"
[0m17:05:42.604516 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_realtime_aggregated"
[0m17:05:42.604708 [debug] [Thread-1 (]: On model.dw_project.bitcoin_realtime_aggregated: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_realtime_aggregated"} */
create or replace transient table lab2.analytics.bitcoin_realtime_aggregated
         as
        (WITH  __dbt__cte__bitcoin_realtime as (
SELECT 
    time_open,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_realtime
WHERE price_close IS NOT NULL
), real_time_agg AS (
    SELECT 
        DATE(rt.TIME_PERIOD_START) AS DAY,
        MIN(rt.RealTimePriceLow) AS PRICE_LOW,
        MAX(rt.RealTimePriceHigh) AS PRICE_HIGH,
        SUM(rt.RealTimeVolume) AS VOLUME_TRADED,
        COUNT(rt.RealTimeTrades) AS TRADES_COUNT
    FROM __dbt__cte__bitcoin_realtime rt
    GROUP BY DATE(rt.TIME_PERIOD_START)
)
SELECT 
    DAY,
    PRICE_LOW,
    PRICE_HIGH,
    VOLUME_TRADED,
    TRADES_COUNT
FROM real_time_agg
        );
[0m17:05:42.604854 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:05:43.355588 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8a401-0003-6510-0003-437a001120ae
[0m17:05:43.356577 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 16 at position 13
invalid identifier 'RT.TIME_PERIOD_START'
[0m17:05:43.357196 [debug] [Thread-1 (]: On model.dw_project.bitcoin_realtime_aggregated: Close
[0m17:05:43.535545 [debug] [Thread-1 (]: Database Error in model bitcoin_realtime_aggregated (models/output/bitcoin_realtime_aggregated.sql)
  000904 (42000): SQL compilation error: error line 16 at position 13
  invalid identifier 'RT.TIME_PERIOD_START'
  compiled code at target/run/dw_project/models/output/bitcoin_realtime_aggregated.sql
[0m17:05:43.536270 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20310474-c253-451e-8244-8ab7f1d3d864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b87caa0>]}
[0m17:05:43.537015 [error] [Thread-1 (]: 4 of 5 ERROR creating sql table model analytics.bitcoin_realtime_aggregated .... [[31mERROR[0m in 0.94s]
[0m17:05:43.537658 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_realtime_aggregated
[0m17:05:43.538598 [debug] [Thread-1 (]: Began running node model.dw_project.comparison
[0m17:05:43.538992 [info ] [Thread-1 (]: 5 of 5 SKIP relation analytics.comparison ...................................... [[33mSKIP[0m]
[0m17:05:43.539389 [debug] [Thread-1 (]: Finished running node model.dw_project.comparison
[0m17:05:43.540477 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:05:43.540776 [debug] [MainThread]: Connection 'model.dw_project.bitcoin_realtime_aggregated' was properly closed.
[0m17:05:43.541129 [info ] [MainThread]: 
[0m17:05:43.541391 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 9.63 seconds (9.63s).
[0m17:05:43.542285 [debug] [MainThread]: Command end result
[0m17:05:43.563541 [info ] [MainThread]: 
[0m17:05:43.563792 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:05:43.563961 [info ] [MainThread]: 
[0m17:05:43.564167 [error] [MainThread]:   Database Error in model bitcoin_realtime_aggregated (models/output/bitcoin_realtime_aggregated.sql)
  000904 (42000): SQL compilation error: error line 16 at position 13
  invalid identifier 'RT.TIME_PERIOD_START'
  compiled code at target/run/dw_project/models/output/bitcoin_realtime_aggregated.sql
[0m17:05:43.564338 [info ] [MainThread]: 
[0m17:05:43.564520 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
[0m17:05:43.565786 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 10.385931, "process_user_time": 1.862804, "process_kernel_time": 2.528422, "process_mem_max_rss": "211025920", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:05:43.566072 [debug] [MainThread]: Command `dbt run` failed at 17:05:43.566024 after 10.39 seconds
[0m17:05:43.566265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104350170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ba30e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12bdcdc40>]}
[0m17:05:43.566444 [debug] [MainThread]: Flushing usage events
[0m17:06:22.301861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9caf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098592b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109859340>]}


============================== 17:06:22.303402 | e75d0622-db80-4a8d-bbe5-7465d34b7fa1 ==============================
[0m17:06:22.303402 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:06:22.303693 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'target_path': 'None', 'log_cache_events': 'False', 'quiet': 'False', 'no_print': 'None', 'empty': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'version_check': 'True', 'debug': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'introspect': 'True', 'indirect_selection': 'eager', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'cache_selected_only': 'False', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'log_format': 'default', 'write_json': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])'}
[0m17:06:22.972623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e75d0622-db80-4a8d-bbe5-7465d34b7fa1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c55a960>]}
[0m17:06:22.990259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e75d0622-db80-4a8d-bbe5-7465d34b7fa1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab71970>]}
[0m17:06:22.990775 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:06:22.999251 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:06:23.051783 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:06:23.052049 [debug] [MainThread]: Partial parsing: updated file: dw_project://models/output/bitcoin_realtime_aggregated.sql
[0m17:06:23.134077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e75d0622-db80-4a8d-bbe5-7465d34b7fa1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ee8aa80>]}
[0m17:06:23.165920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e75d0622-db80-4a8d-bbe5-7465d34b7fa1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x157bb7350>]}
[0m17:06:23.166140 [info ] [MainThread]: Found 7 models, 3 sources, 459 macros
[0m17:06:23.166296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e75d0622-db80-4a8d-bbe5-7465d34b7fa1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x157bded50>]}
[0m17:06:23.167027 [info ] [MainThread]: 
[0m17:06:23.167283 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:06:23.168999 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m17:06:23.173674 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m17:06:23.173807 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m17:06:23.173910 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:06:24.024587 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.850 seconds
[0m17:06:24.028404 [debug] [ThreadPool]: On list_lab2: Close
[0m17:06:24.204959 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m17:06:24.218515 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m17:06:24.219093 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m17:06:24.219445 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:06:24.877468 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.658 seconds
[0m17:06:24.881713 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m17:06:25.067430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e75d0622-db80-4a8d-bbe5-7465d34b7fa1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x157bcd0a0>]}
[0m17:06:25.069109 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m17:06:25.069886 [info ] [MainThread]: 
[0m17:06:25.075975 [debug] [Thread-1 (]: Began running node model.dw_project.avg_price_realtime
[0m17:06:25.076880 [info ] [Thread-1 (]: 1 of 5 START sql table model analytics.avg_price_realtime ...................... [RUN]
[0m17:06:25.077663 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now model.dw_project.avg_price_realtime)
[0m17:06:25.078161 [debug] [Thread-1 (]: Began compiling node model.dw_project.avg_price_realtime
[0m17:06:25.135918 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.avg_price_realtime"
[0m17:06:25.136430 [debug] [Thread-1 (]: Began executing node model.dw_project.avg_price_realtime
[0m17:06:25.148451 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.avg_price_realtime"
[0m17:06:25.149017 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.avg_price_realtime"
[0m17:06:25.149186 [debug] [Thread-1 (]: On model.dw_project.avg_price_realtime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.avg_price_realtime"} */
create or replace transient table lab2.analytics.avg_price_realtime
         as
        (WITH realtime AS (
    SELECT 
        time_open AS time_period_start,
        price_close
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    time_period_start,
    AVG(price_close) OVER (ORDER BY time_period_start ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) AS thirty_min_avg_price
FROM realtime
ORDER BY time_period_start
        );
[0m17:06:25.149329 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:26.853893 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.704 seconds
[0m17:06:26.880120 [debug] [Thread-1 (]: On model.dw_project.avg_price_realtime: Close
[0m17:06:27.057826 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e75d0622-db80-4a8d-bbe5-7465d34b7fa1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12caa5a60>]}
[0m17:06:27.059754 [info ] [Thread-1 (]: 1 of 5 OK created sql table model analytics.avg_price_realtime ................. [[32mSUCCESS 1[0m in 1.98s]
[0m17:06:27.061134 [debug] [Thread-1 (]: Finished running node model.dw_project.avg_price_realtime
[0m17:06:27.062043 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_daily_summary
[0m17:06:27.063047 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.bitcoin_daily_summary ................... [RUN]
[0m17:06:27.063861 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.avg_price_realtime, now model.dw_project.bitcoin_daily_summary)
[0m17:06:27.064458 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_daily_summary
[0m17:06:27.069574 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_daily_summary"
[0m17:06:27.070539 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_daily_summary
[0m17:06:27.073300 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_daily_summary"
[0m17:06:27.074933 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_daily_summary"
[0m17:06:27.075307 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_daily_summary"} */
create or replace transient table lab2.analytics.bitcoin_daily_summary
         as
        (WITH historical_data AS (
    SELECT
        TIME_PERIOD_START::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_historical
),
realtime_data AS (
    SELECT
        TIME_OPEN::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    date,
    AVG(PRICE_OPEN) AS avg_open,
    AVG(PRICE_HIGH) AS avg_high,
    AVG(PRICE_LOW) AS avg_low,
    AVG(PRICE_CLOSE) AS avg_close,
    SUM(VOLUME_TRADED) AS total_volume,
    SUM(TRADES_COUNT) AS total_trades
FROM (
    SELECT * FROM historical_data
    UNION ALL
    SELECT * FROM realtime_data
) AS combined_data
GROUP BY date
ORDER BY date
        );
[0m17:06:27.075648 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:28.696349 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.620 seconds
[0m17:06:28.700687 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: Close
[0m17:06:28.895506 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e75d0622-db80-4a8d-bbe5-7465d34b7fa1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fe5b920>]}
[0m17:06:28.897214 [info ] [Thread-1 (]: 2 of 5 OK created sql table model analytics.bitcoin_daily_summary .............. [[32mSUCCESS 1[0m in 1.83s]
[0m17:06:28.898029 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_daily_summary
[0m17:06:28.898765 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_historical
[0m17:06:28.899404 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_daily_summary, now model.dw_project.bitcoin_historical)
[0m17:06:28.899904 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_historical
[0m17:06:28.905066 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_historical"
[0m17:06:28.906657 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_historical
[0m17:06:28.907127 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_realtime
[0m17:06:28.907692 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_historical, now model.dw_project.bitcoin_realtime)
[0m17:06:28.908031 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_realtime
[0m17:06:28.911342 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_realtime"
[0m17:06:28.912967 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_realtime
[0m17:06:28.913445 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_historical_aggregated
[0m17:06:28.914073 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.bitcoin_historical_aggregated ........... [RUN]
[0m17:06:28.914734 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_realtime, now model.dw_project.bitcoin_historical_aggregated)
[0m17:06:28.915137 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_historical_aggregated
[0m17:06:28.921263 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_historical_aggregated"
[0m17:06:28.921838 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_historical_aggregated
[0m17:06:28.924121 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_historical_aggregated"
[0m17:06:28.925282 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_historical_aggregated"
[0m17:06:28.925588 [debug] [Thread-1 (]: On model.dw_project.bitcoin_historical_aggregated: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_historical_aggregated"} */
create or replace transient table lab2.analytics.bitcoin_historical_aggregated
         as
        (-- bitcoin_historical_aggregated.sql
WITH  __dbt__cte__bitcoin_historical as (
SELECT 
    time_period_start,
    time_period_end,
    time_open,
    time_close,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_historical
WHERE time_period_start IS NOT NULL
), historical_agg AS (
    SELECT 
        DATE(TIME_PERIOD_START) AS DAY,
        MIN(PRICE_LOW) AS PRICE_LOW,
        MAX(PRICE_HIGH) AS PRICE_HIGH,
        SUM(VOLUME_TRADED) AS VOLUME_TRADED,
        COUNT(TRADES_COUNT) AS TRADES_COUNT
    FROM __dbt__cte__bitcoin_historical
    GROUP BY DATE(TIME_PERIOD_START)
)
SELECT 
    DAY,
    PRICE_LOW,
    PRICE_HIGH,
    VOLUME_TRADED,
    TRADES_COUNT
FROM historical_agg
        );
[0m17:06:28.925863 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:30.952569 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.026 seconds
[0m17:06:30.956801 [debug] [Thread-1 (]: On model.dw_project.bitcoin_historical_aggregated: Close
[0m17:06:31.232264 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e75d0622-db80-4a8d-bbe5-7465d34b7fa1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fe6e270>]}
[0m17:06:31.234117 [info ] [Thread-1 (]: 3 of 5 OK created sql table model analytics.bitcoin_historical_aggregated ...... [[32mSUCCESS 1[0m in 2.32s]
[0m17:06:31.235521 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_historical_aggregated
[0m17:06:31.236313 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_realtime_aggregated
[0m17:06:31.237181 [info ] [Thread-1 (]: 4 of 5 START sql table model analytics.bitcoin_realtime_aggregated ............. [RUN]
[0m17:06:31.237895 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_historical_aggregated, now model.dw_project.bitcoin_realtime_aggregated)
[0m17:06:31.238612 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_realtime_aggregated
[0m17:06:31.247891 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_realtime_aggregated"
[0m17:06:31.248785 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_realtime_aggregated
[0m17:06:31.251176 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_realtime_aggregated"
[0m17:06:31.252559 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_realtime_aggregated"
[0m17:06:31.252878 [debug] [Thread-1 (]: On model.dw_project.bitcoin_realtime_aggregated: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_realtime_aggregated"} */
create or replace transient table lab2.analytics.bitcoin_realtime_aggregated
         as
        (WITH  __dbt__cte__bitcoin_realtime as (
SELECT 
    time_open,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_realtime
WHERE price_close IS NOT NULL
), real_time_agg AS (
    SELECT 
        DATE(TIME_PERIOD_START) AS DAY,
        MIN(rt.RealTimePriceLow) AS PRICE_LOW,
        MAX(rt.RealTimePriceHigh) AS PRICE_HIGH,
        SUM(rt.RealTimeVolume) AS VOLUME_TRADED,
        COUNT(rt.RealTimeTrades) AS TRADES_COUNT
    FROM __dbt__cte__bitcoin_realtime rt
    GROUP BY DATE(TIME_PERIOD_START)
)
SELECT 
    DAY,
    PRICE_LOW,
    PRICE_HIGH,
    VOLUME_TRADED,
    TRADES_COUNT
FROM real_time_agg
        );
[0m17:06:31.253163 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:31.875873 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8a402-0003-6460-0003-437a0010b152
[0m17:06:31.876375 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 16 at position 13
invalid identifier 'TIME_PERIOD_START'
[0m17:06:31.876795 [debug] [Thread-1 (]: On model.dw_project.bitcoin_realtime_aggregated: Close
[0m17:06:32.060061 [debug] [Thread-1 (]: Database Error in model bitcoin_realtime_aggregated (models/output/bitcoin_realtime_aggregated.sql)
  000904 (42000): SQL compilation error: error line 16 at position 13
  invalid identifier 'TIME_PERIOD_START'
  compiled code at target/run/dw_project/models/output/bitcoin_realtime_aggregated.sql
[0m17:06:32.060656 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e75d0622-db80-4a8d-bbe5-7465d34b7fa1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12faaf1d0>]}
[0m17:06:32.061317 [error] [Thread-1 (]: 4 of 5 ERROR creating sql table model analytics.bitcoin_realtime_aggregated .... [[31mERROR[0m in 0.82s]
[0m17:06:32.061928 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_realtime_aggregated
[0m17:06:32.062991 [debug] [Thread-1 (]: Began running node model.dw_project.comparison
[0m17:06:32.063769 [info ] [Thread-1 (]: 5 of 5 SKIP relation analytics.comparison ...................................... [[33mSKIP[0m]
[0m17:06:32.064288 [debug] [Thread-1 (]: Finished running node model.dw_project.comparison
[0m17:06:32.065318 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:06:32.065720 [debug] [MainThread]: Connection 'model.dw_project.bitcoin_realtime_aggregated' was properly closed.
[0m17:06:32.066129 [info ] [MainThread]: 
[0m17:06:32.066496 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 8.90 seconds (8.90s).
[0m17:06:32.067699 [debug] [MainThread]: Command end result
[0m17:06:32.083454 [info ] [MainThread]: 
[0m17:06:32.083702 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:06:32.083859 [info ] [MainThread]: 
[0m17:06:32.084151 [error] [MainThread]:   Database Error in model bitcoin_realtime_aggregated (models/output/bitcoin_realtime_aggregated.sql)
  000904 (42000): SQL compilation error: error line 16 at position 13
  invalid identifier 'TIME_PERIOD_START'
  compiled code at target/run/dw_project/models/output/bitcoin_realtime_aggregated.sql
[0m17:06:32.084388 [info ] [MainThread]: 
[0m17:06:32.084571 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
[0m17:06:32.085774 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 9.806753, "process_user_time": 2.653547, "process_kernel_time": 1.873244, "process_mem_max_rss": "209698816", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:06:32.085996 [debug] [MainThread]: Command `dbt run` failed at 17:06:32.085960 after 9.81 seconds
[0m17:06:32.086166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4d1d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x157d99820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x157d9a480>]}
[0m17:06:32.086305 [debug] [MainThread]: Flushing usage events
[0m17:07:14.593552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10848d760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d37fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d37c80>]}


============================== 17:07:14.595560 | 9bf666b6-f57f-49d6-8aff-ebc5f75bd06d ==============================
[0m17:07:14.595560 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:07:14.595891 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'indirect_selection': 'eager', 'use_colors': 'True', 'introspect': 'True', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'log_cache_events': 'False', 'static_parser': 'True', 'partial_parse': 'True', 'debug': 'False', 'version_check': 'True', 'empty': 'False', 'write_json': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'quiet': 'False', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'fail_fast': 'False', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'printer_width': '80'}
[0m17:07:15.361707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9bf666b6-f57f-49d6-8aff-ebc5f75bd06d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119072990>]}
[0m17:07:15.380051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9bf666b6-f57f-49d6-8aff-ebc5f75bd06d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b861070>]}
[0m17:07:15.380666 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:07:15.389117 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:07:15.444516 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:07:15.444810 [debug] [MainThread]: Partial parsing: updated file: dw_project://models/output/bitcoin_realtime_aggregated.sql
[0m17:07:15.531810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9bf666b6-f57f-49d6-8aff-ebc5f75bd06d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1294e9b80>]}
[0m17:07:15.568509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9bf666b6-f57f-49d6-8aff-ebc5f75bd06d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1294cb440>]}
[0m17:07:15.568775 [info ] [MainThread]: Found 7 models, 3 sources, 459 macros
[0m17:07:15.568929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9bf666b6-f57f-49d6-8aff-ebc5f75bd06d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1294eac60>]}
[0m17:07:15.569730 [info ] [MainThread]: 
[0m17:07:15.570005 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:07:15.571927 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m17:07:15.577505 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m17:07:15.577700 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m17:07:15.577822 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:07:16.826890 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.249 seconds
[0m17:07:16.831713 [debug] [ThreadPool]: On list_lab2: Close
[0m17:07:17.018804 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m17:07:17.033997 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m17:07:17.034537 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m17:07:17.034864 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:07:17.743527 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.708 seconds
[0m17:07:17.748537 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m17:07:17.951852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9bf666b6-f57f-49d6-8aff-ebc5f75bd06d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8ca2a0>]}
[0m17:07:17.953069 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m17:07:17.953649 [info ] [MainThread]: 
[0m17:07:17.958571 [debug] [Thread-1 (]: Began running node model.dw_project.avg_price_realtime
[0m17:07:17.959392 [info ] [Thread-1 (]: 1 of 5 START sql table model analytics.avg_price_realtime ...................... [RUN]
[0m17:07:17.959959 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now model.dw_project.avg_price_realtime)
[0m17:07:17.960341 [debug] [Thread-1 (]: Began compiling node model.dw_project.avg_price_realtime
[0m17:07:18.018278 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.avg_price_realtime"
[0m17:07:18.018793 [debug] [Thread-1 (]: Began executing node model.dw_project.avg_price_realtime
[0m17:07:18.030704 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.avg_price_realtime"
[0m17:07:18.031263 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.avg_price_realtime"
[0m17:07:18.031421 [debug] [Thread-1 (]: On model.dw_project.avg_price_realtime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.avg_price_realtime"} */
create or replace transient table lab2.analytics.avg_price_realtime
         as
        (WITH realtime AS (
    SELECT 
        time_open AS time_period_start,
        price_close
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    time_period_start,
    AVG(price_close) OVER (ORDER BY time_period_start ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) AS thirty_min_avg_price
FROM realtime
ORDER BY time_period_start
        );
[0m17:07:18.031564 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:19.695171 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.663 seconds
[0m17:07:19.717315 [debug] [Thread-1 (]: On model.dw_project.avg_price_realtime: Close
[0m17:07:19.895820 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bf666b6-f57f-49d6-8aff-ebc5f75bd06d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1292fd970>]}
[0m17:07:19.897350 [info ] [Thread-1 (]: 1 of 5 OK created sql table model analytics.avg_price_realtime ................. [[32mSUCCESS 1[0m in 1.93s]
[0m17:07:19.898339 [debug] [Thread-1 (]: Finished running node model.dw_project.avg_price_realtime
[0m17:07:19.899205 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_daily_summary
[0m17:07:19.899984 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.bitcoin_daily_summary ................... [RUN]
[0m17:07:19.900606 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.avg_price_realtime, now model.dw_project.bitcoin_daily_summary)
[0m17:07:19.901010 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_daily_summary
[0m17:07:19.904578 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_daily_summary"
[0m17:07:19.905405 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_daily_summary
[0m17:07:19.907588 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_daily_summary"
[0m17:07:19.908955 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_daily_summary"
[0m17:07:19.909265 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_daily_summary"} */
create or replace transient table lab2.analytics.bitcoin_daily_summary
         as
        (WITH historical_data AS (
    SELECT
        TIME_PERIOD_START::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_historical
),
realtime_data AS (
    SELECT
        TIME_OPEN::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    date,
    AVG(PRICE_OPEN) AS avg_open,
    AVG(PRICE_HIGH) AS avg_high,
    AVG(PRICE_LOW) AS avg_low,
    AVG(PRICE_CLOSE) AS avg_close,
    SUM(VOLUME_TRADED) AS total_volume,
    SUM(TRADES_COUNT) AS total_trades
FROM (
    SELECT * FROM historical_data
    UNION ALL
    SELECT * FROM realtime_data
) AS combined_data
GROUP BY date
ORDER BY date
        );
[0m17:07:19.909550 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:21.843455 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.933 seconds
[0m17:07:21.848320 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: Close
[0m17:07:22.053030 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bf666b6-f57f-49d6-8aff-ebc5f75bd06d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1293ad310>]}
[0m17:07:22.054813 [info ] [Thread-1 (]: 2 of 5 OK created sql table model analytics.bitcoin_daily_summary .............. [[32mSUCCESS 1[0m in 2.15s]
[0m17:07:22.055996 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_daily_summary
[0m17:07:22.056696 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_historical
[0m17:07:22.057536 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_daily_summary, now model.dw_project.bitcoin_historical)
[0m17:07:22.058147 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_historical
[0m17:07:22.062761 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_historical"
[0m17:07:22.064472 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_historical
[0m17:07:22.065069 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_realtime
[0m17:07:22.065641 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_historical, now model.dw_project.bitcoin_realtime)
[0m17:07:22.066002 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_realtime
[0m17:07:22.068497 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_realtime"
[0m17:07:22.069602 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_realtime
[0m17:07:22.069958 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_historical_aggregated
[0m17:07:22.070393 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.bitcoin_historical_aggregated ........... [RUN]
[0m17:07:22.070930 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_realtime, now model.dw_project.bitcoin_historical_aggregated)
[0m17:07:22.071296 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_historical_aggregated
[0m17:07:22.076871 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_historical_aggregated"
[0m17:07:22.077412 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_historical_aggregated
[0m17:07:22.079775 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_historical_aggregated"
[0m17:07:22.080967 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_historical_aggregated"
[0m17:07:22.081245 [debug] [Thread-1 (]: On model.dw_project.bitcoin_historical_aggregated: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_historical_aggregated"} */
create or replace transient table lab2.analytics.bitcoin_historical_aggregated
         as
        (-- bitcoin_historical_aggregated.sql
WITH  __dbt__cte__bitcoin_historical as (
SELECT 
    time_period_start,
    time_period_end,
    time_open,
    time_close,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_historical
WHERE time_period_start IS NOT NULL
), historical_agg AS (
    SELECT 
        DATE(TIME_PERIOD_START) AS DAY,
        MIN(PRICE_LOW) AS PRICE_LOW,
        MAX(PRICE_HIGH) AS PRICE_HIGH,
        SUM(VOLUME_TRADED) AS VOLUME_TRADED,
        COUNT(TRADES_COUNT) AS TRADES_COUNT
    FROM __dbt__cte__bitcoin_historical
    GROUP BY DATE(TIME_PERIOD_START)
)
SELECT 
    DAY,
    PRICE_LOW,
    PRICE_HIGH,
    VOLUME_TRADED,
    TRADES_COUNT
FROM historical_agg
        );
[0m17:07:22.081488 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:23.791136 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.709 seconds
[0m17:07:23.795238 [debug] [Thread-1 (]: On model.dw_project.bitcoin_historical_aggregated: Close
[0m17:07:23.990732 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bf666b6-f57f-49d6-8aff-ebc5f75bd06d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107283830>]}
[0m17:07:23.992415 [info ] [Thread-1 (]: 3 of 5 OK created sql table model analytics.bitcoin_historical_aggregated ...... [[32mSUCCESS 1[0m in 1.92s]
[0m17:07:23.993651 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_historical_aggregated
[0m17:07:23.994470 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_realtime_aggregated
[0m17:07:23.995402 [info ] [Thread-1 (]: 4 of 5 START sql table model analytics.bitcoin_realtime_aggregated ............. [RUN]
[0m17:07:23.996210 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_historical_aggregated, now model.dw_project.bitcoin_realtime_aggregated)
[0m17:07:23.996917 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_realtime_aggregated
[0m17:07:24.006194 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_realtime_aggregated"
[0m17:07:24.007271 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_realtime_aggregated
[0m17:07:24.009682 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_realtime_aggregated"
[0m17:07:24.011113 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_realtime_aggregated"
[0m17:07:24.011484 [debug] [Thread-1 (]: On model.dw_project.bitcoin_realtime_aggregated: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_realtime_aggregated"} */
create or replace transient table lab2.analytics.bitcoin_realtime_aggregated
         as
        (WITH  __dbt__cte__bitcoin_realtime as (
SELECT 
    time_open,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_realtime
WHERE price_close IS NOT NULL
), real_time_agg AS (
    SELECT 
        DATE(TIME_PERIOD_START) AS DAY,
        MIN(RealTimePriceLow) AS PRICE_LOW,
        MAX(RealTimePriceHigh) AS PRICE_HIGH,
        SUM(RealTimeVolume) AS VOLUME_TRADED,
        COUNT(RealTimeTrades) AS TRADES_COUNT
    FROM __dbt__cte__bitcoin_realtime
    GROUP BY DATE(TIME_PERIOD_START)
)
SELECT 
    DAY,
    PRICE_LOW,
    PRICE_HIGH,
    VOLUME_TRADED,
    TRADES_COUNT
FROM real_time_agg
        );
[0m17:07:24.011836 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:24.692040 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8a403-0003-65ec-0003-437a001130ca
[0m17:07:24.692702 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 16 at position 13
invalid identifier 'TIME_PERIOD_START'
[0m17:07:24.693226 [debug] [Thread-1 (]: On model.dw_project.bitcoin_realtime_aggregated: Close
[0m17:07:24.887804 [debug] [Thread-1 (]: Database Error in model bitcoin_realtime_aggregated (models/output/bitcoin_realtime_aggregated.sql)
  000904 (42000): SQL compilation error: error line 16 at position 13
  invalid identifier 'TIME_PERIOD_START'
  compiled code at target/run/dw_project/models/output/bitcoin_realtime_aggregated.sql
[0m17:07:24.888888 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bf666b6-f57f-49d6-8aff-ebc5f75bd06d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1292fc260>]}
[0m17:07:24.889857 [error] [Thread-1 (]: 4 of 5 ERROR creating sql table model analytics.bitcoin_realtime_aggregated .... [[31mERROR[0m in 0.89s]
[0m17:07:24.890642 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_realtime_aggregated
[0m17:07:24.891839 [debug] [Thread-1 (]: Began running node model.dw_project.comparison
[0m17:07:24.892666 [info ] [Thread-1 (]: 5 of 5 SKIP relation analytics.comparison ...................................... [[33mSKIP[0m]
[0m17:07:24.893511 [debug] [Thread-1 (]: Finished running node model.dw_project.comparison
[0m17:07:24.894803 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:07:24.895258 [debug] [MainThread]: Connection 'model.dw_project.bitcoin_realtime_aggregated' was properly closed.
[0m17:07:24.895677 [info ] [MainThread]: 
[0m17:07:24.896030 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 9.33 seconds (9.33s).
[0m17:07:24.897139 [debug] [MainThread]: Command end result
[0m17:07:24.919138 [info ] [MainThread]: 
[0m17:07:24.919373 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:07:24.919542 [info ] [MainThread]: 
[0m17:07:24.919755 [error] [MainThread]:   Database Error in model bitcoin_realtime_aggregated (models/output/bitcoin_realtime_aggregated.sql)
  000904 (42000): SQL compilation error: error line 16 at position 13
  invalid identifier 'TIME_PERIOD_START'
  compiled code at target/run/dw_project/models/output/bitcoin_realtime_aggregated.sql
[0m17:07:24.919930 [info ] [MainThread]: 
[0m17:07:24.920109 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
[0m17:07:24.921989 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 10.352612, "process_user_time": 3.250418, "process_kernel_time": 1.326866, "process_mem_max_rss": "208732160", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:07:24.922294 [debug] [MainThread]: Command `dbt run` failed at 17:07:24.922241 after 10.35 seconds
[0m17:07:24.922508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1291ae960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084eaf60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1030ee960>]}
[0m17:07:24.922690 [debug] [MainThread]: Flushing usage events
[0m17:08:28.714072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b41700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10542c530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107359400>]}


============================== 17:08:28.715761 | a3805a5d-4f0c-4876-bb4e-dd76cc45e9e5 ==============================
[0m17:08:28.715761 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:08:28.716055 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'empty': 'False', 'write_json': 'True', 'log_cache_events': 'False', 'invocation_command': 'dbt run', 'partial_parse': 'True', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'version_check': 'True', 'printer_width': '80', 'fail_fast': 'False', 'introspect': 'True', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'indirect_selection': 'eager', 'no_print': 'None', 'debug': 'False', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'quiet': 'False', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None'}
[0m17:08:29.472492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a3805a5d-4f0c-4876-bb4e-dd76cc45e9e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106498e0>]}
[0m17:08:29.489785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a3805a5d-4f0c-4876-bb4e-dd76cc45e9e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16554f020>]}
[0m17:08:29.490268 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:08:29.498875 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:08:29.552745 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:08:29.553036 [debug] [MainThread]: Partial parsing: updated file: dw_project://models/output/bitcoin_realtime_aggregated.sql
[0m17:08:29.636873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a3805a5d-4f0c-4876-bb4e-dd76cc45e9e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x165b1efc0>]}
[0m17:08:29.670447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a3805a5d-4f0c-4876-bb4e-dd76cc45e9e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x165fd32f0>]}
[0m17:08:29.670661 [info ] [MainThread]: Found 7 models, 3 sources, 459 macros
[0m17:08:29.670805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3805a5d-4f0c-4876-bb4e-dd76cc45e9e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070789e0>]}
[0m17:08:29.671530 [info ] [MainThread]: 
[0m17:08:29.671769 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:08:29.673457 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m17:08:29.678211 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m17:08:29.678345 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m17:08:29.678448 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:08:30.464123 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.785 seconds
[0m17:08:30.467288 [debug] [ThreadPool]: On list_lab2: Close
[0m17:08:30.654531 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m17:08:30.668842 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m17:08:30.669407 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m17:08:30.669731 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:08:31.355447 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.685 seconds
[0m17:08:31.360848 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m17:08:31.556217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3805a5d-4f0c-4876-bb4e-dd76cc45e9e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cbbbf0>]}
[0m17:08:31.557473 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m17:08:31.558035 [info ] [MainThread]: 
[0m17:08:31.562431 [debug] [Thread-1 (]: Began running node model.dw_project.avg_price_realtime
[0m17:08:31.563167 [info ] [Thread-1 (]: 1 of 5 START sql table model analytics.avg_price_realtime ...................... [RUN]
[0m17:08:31.563695 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now model.dw_project.avg_price_realtime)
[0m17:08:31.564061 [debug] [Thread-1 (]: Began compiling node model.dw_project.avg_price_realtime
[0m17:08:31.621828 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.avg_price_realtime"
[0m17:08:31.622357 [debug] [Thread-1 (]: Began executing node model.dw_project.avg_price_realtime
[0m17:08:31.634053 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.avg_price_realtime"
[0m17:08:31.634592 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.avg_price_realtime"
[0m17:08:31.634754 [debug] [Thread-1 (]: On model.dw_project.avg_price_realtime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.avg_price_realtime"} */
create or replace transient table lab2.analytics.avg_price_realtime
         as
        (WITH realtime AS (
    SELECT 
        time_open AS time_period_start,
        price_close
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    time_period_start,
    AVG(price_close) OVER (ORDER BY time_period_start ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) AS thirty_min_avg_price
FROM realtime
ORDER BY time_period_start
        );
[0m17:08:31.634891 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:08:34.035935 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.400 seconds
[0m17:08:34.062954 [debug] [Thread-1 (]: On model.dw_project.avg_price_realtime: Close
[0m17:08:34.251186 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3805a5d-4f0c-4876-bb4e-dd76cc45e9e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x165ed95b0>]}
[0m17:08:34.252475 [info ] [Thread-1 (]: 1 of 5 OK created sql table model analytics.avg_price_realtime ................. [[32mSUCCESS 1[0m in 2.69s]
[0m17:08:34.253538 [debug] [Thread-1 (]: Finished running node model.dw_project.avg_price_realtime
[0m17:08:34.254240 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_daily_summary
[0m17:08:34.255145 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.bitcoin_daily_summary ................... [RUN]
[0m17:08:34.255958 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.avg_price_realtime, now model.dw_project.bitcoin_daily_summary)
[0m17:08:34.256583 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_daily_summary
[0m17:08:34.260842 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_daily_summary"
[0m17:08:34.261650 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_daily_summary
[0m17:08:34.263525 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_daily_summary"
[0m17:08:34.264304 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_daily_summary"
[0m17:08:34.264484 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_daily_summary"} */
create or replace transient table lab2.analytics.bitcoin_daily_summary
         as
        (WITH historical_data AS (
    SELECT
        TIME_PERIOD_START::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_historical
),
realtime_data AS (
    SELECT
        TIME_OPEN::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    date,
    AVG(PRICE_OPEN) AS avg_open,
    AVG(PRICE_HIGH) AS avg_high,
    AVG(PRICE_LOW) AS avg_low,
    AVG(PRICE_CLOSE) AS avg_close,
    SUM(VOLUME_TRADED) AS total_volume,
    SUM(TRADES_COUNT) AS total_trades
FROM (
    SELECT * FROM historical_data
    UNION ALL
    SELECT * FROM realtime_data
) AS combined_data
GROUP BY date
ORDER BY date
        );
[0m17:08:34.264637 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:08:35.674526 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.410 seconds
[0m17:08:35.678884 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: Close
[0m17:08:35.858176 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3805a5d-4f0c-4876-bb4e-dd76cc45e9e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x165d6adb0>]}
[0m17:08:35.859453 [info ] [Thread-1 (]: 2 of 5 OK created sql table model analytics.bitcoin_daily_summary .............. [[32mSUCCESS 1[0m in 1.60s]
[0m17:08:35.860226 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_daily_summary
[0m17:08:35.860674 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_historical
[0m17:08:35.861234 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_daily_summary, now model.dw_project.bitcoin_historical)
[0m17:08:35.861837 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_historical
[0m17:08:35.865431 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_historical"
[0m17:08:35.866309 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_historical
[0m17:08:35.866697 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_realtime
[0m17:08:35.867220 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_historical, now model.dw_project.bitcoin_realtime)
[0m17:08:35.867784 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_realtime
[0m17:08:35.870941 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_realtime"
[0m17:08:35.871813 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_realtime
[0m17:08:35.872040 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_historical_aggregated
[0m17:08:35.872253 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.bitcoin_historical_aggregated ........... [RUN]
[0m17:08:35.872613 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_realtime, now model.dw_project.bitcoin_historical_aggregated)
[0m17:08:35.872834 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_historical_aggregated
[0m17:08:35.875823 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_historical_aggregated"
[0m17:08:35.876203 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_historical_aggregated
[0m17:08:35.877630 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_historical_aggregated"
[0m17:08:35.878373 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_historical_aggregated"
[0m17:08:35.878552 [debug] [Thread-1 (]: On model.dw_project.bitcoin_historical_aggregated: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_historical_aggregated"} */
create or replace transient table lab2.analytics.bitcoin_historical_aggregated
         as
        (-- bitcoin_historical_aggregated.sql
WITH  __dbt__cte__bitcoin_historical as (
SELECT 
    time_period_start,
    time_period_end,
    time_open,
    time_close,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_historical
WHERE time_period_start IS NOT NULL
), historical_agg AS (
    SELECT 
        DATE(TIME_PERIOD_START) AS DAY,
        MIN(PRICE_LOW) AS PRICE_LOW,
        MAX(PRICE_HIGH) AS PRICE_HIGH,
        SUM(VOLUME_TRADED) AS VOLUME_TRADED,
        COUNT(TRADES_COUNT) AS TRADES_COUNT
    FROM __dbt__cte__bitcoin_historical
    GROUP BY DATE(TIME_PERIOD_START)
)
SELECT 
    DAY,
    PRICE_LOW,
    PRICE_HIGH,
    VOLUME_TRADED,
    TRADES_COUNT
FROM historical_agg
        );
[0m17:08:35.878729 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:08:37.928219 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.049 seconds
[0m17:08:37.932838 [debug] [Thread-1 (]: On model.dw_project.bitcoin_historical_aggregated: Close
[0m17:08:38.138335 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3805a5d-4f0c-4876-bb4e-dd76cc45e9e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x165d7cfb0>]}
[0m17:08:38.139841 [info ] [Thread-1 (]: 3 of 5 OK created sql table model analytics.bitcoin_historical_aggregated ...... [[32mSUCCESS 1[0m in 2.27s]
[0m17:08:38.140816 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_historical_aggregated
[0m17:08:38.141435 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_realtime_aggregated
[0m17:08:38.142173 [info ] [Thread-1 (]: 4 of 5 START sql table model analytics.bitcoin_realtime_aggregated ............. [RUN]
[0m17:08:38.142760 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_historical_aggregated, now model.dw_project.bitcoin_realtime_aggregated)
[0m17:08:38.143213 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_realtime_aggregated
[0m17:08:38.151110 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_realtime_aggregated"
[0m17:08:38.151912 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_realtime_aggregated
[0m17:08:38.154025 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_realtime_aggregated"
[0m17:08:38.155189 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_realtime_aggregated"
[0m17:08:38.155498 [debug] [Thread-1 (]: On model.dw_project.bitcoin_realtime_aggregated: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_realtime_aggregated"} */
create or replace transient table lab2.analytics.bitcoin_realtime_aggregated
         as
        (WITH  __dbt__cte__bitcoin_realtime as (
SELECT 
    time_open,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_realtime
WHERE price_close IS NOT NULL
), real_time_agg AS (
    SELECT 
        DATE(rt.TIME_PERIOD_START) AS DAY,
        MIN(rt.RealTimePriceLow) AS PRICE_LOW,
        MAX(rt.RealTimePriceHigh) AS PRICE_HIGH,
        SUM(rt.RealTimeVolume) AS VOLUME_TRADED,
        COUNT(rt.RealTimeTrades) AS TRADES_COUNT
    FROM __dbt__cte__bitcoin_realtime AS rt
    GROUP BY DATE(rt.TIME_PERIOD_START)
)
SELECT 
    DAY,
    PRICE_LOW,
    PRICE_HIGH,
    VOLUME_TRADED,
    TRADES_COUNT
FROM real_time_agg
        );
[0m17:08:38.155780 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:08:38.651785 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8a404-0003-6322-0003-437a001110de
[0m17:08:38.652517 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 16 at position 13
invalid identifier 'RT.TIME_PERIOD_START'
[0m17:08:38.653039 [debug] [Thread-1 (]: On model.dw_project.bitcoin_realtime_aggregated: Close
[0m17:08:38.852829 [debug] [Thread-1 (]: Database Error in model bitcoin_realtime_aggregated (models/output/bitcoin_realtime_aggregated.sql)
  000904 (42000): SQL compilation error: error line 16 at position 13
  invalid identifier 'RT.TIME_PERIOD_START'
  compiled code at target/run/dw_project/models/output/bitcoin_realtime_aggregated.sql
[0m17:08:38.853913 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3805a5d-4f0c-4876-bb4e-dd76cc45e9e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x165d7cc80>]}
[0m17:08:38.854847 [error] [Thread-1 (]: 4 of 5 ERROR creating sql table model analytics.bitcoin_realtime_aggregated .... [[31mERROR[0m in 0.71s]
[0m17:08:38.855739 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_realtime_aggregated
[0m17:08:38.856865 [debug] [Thread-1 (]: Began running node model.dw_project.comparison
[0m17:08:38.857307 [info ] [Thread-1 (]: 5 of 5 SKIP relation analytics.comparison ...................................... [[33mSKIP[0m]
[0m17:08:38.857770 [debug] [Thread-1 (]: Finished running node model.dw_project.comparison
[0m17:08:38.858881 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:08:38.859311 [debug] [MainThread]: Connection 'model.dw_project.bitcoin_realtime_aggregated' was properly closed.
[0m17:08:38.859675 [info ] [MainThread]: 
[0m17:08:38.859987 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 9.19 seconds (9.19s).
[0m17:08:38.861293 [debug] [MainThread]: Command end result
[0m17:08:38.884980 [info ] [MainThread]: 
[0m17:08:38.885290 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:08:38.885480 [info ] [MainThread]: 
[0m17:08:38.885707 [error] [MainThread]:   Database Error in model bitcoin_realtime_aggregated (models/output/bitcoin_realtime_aggregated.sql)
  000904 (42000): SQL compilation error: error line 16 at position 13
  invalid identifier 'RT.TIME_PERIOD_START'
  compiled code at target/run/dw_project/models/output/bitcoin_realtime_aggregated.sql
[0m17:08:38.885891 [info ] [MainThread]: 
[0m17:08:38.886071 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
[0m17:08:38.888124 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 10.195374, "process_user_time": 2.757282, "process_kernel_time": 1.783865, "process_mem_max_rss": "208830464", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:08:38.888429 [debug] [MainThread]: Command `dbt run` failed at 17:08:38.888380 after 10.20 seconds
[0m17:08:38.888632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b41700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x165ac0050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x165fe3fb0>]}
[0m17:08:38.888825 [debug] [MainThread]: Flushing usage events
[0m17:11:13.337995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10464e1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10524fb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10524f800>]}


============================== 17:11:13.339668 | 1c8af923-82a4-4fd5-b7e4-850dbc29edc7 ==============================
[0m17:11:13.339668 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:11:13.339953 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'static_parser': 'True', 'printer_width': '80', 'fail_fast': 'False', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'write_json': 'True', 'introspect': 'True', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'use_experimental_parser': 'False', 'quiet': 'False', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_colors': 'True', 'debug': 'False', 'partial_parse': 'True', 'indirect_selection': 'eager', 'empty': 'False', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'invocation_command': 'dbt run', 'log_format': 'default'}
[0m17:11:14.250133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1c8af923-82a4-4fd5-b7e4-850dbc29edc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x139edcbf0>]}
[0m17:11:14.266917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1c8af923-82a4-4fd5-b7e4-850dbc29edc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1280e0e90>]}
[0m17:11:14.267397 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:11:14.276013 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:11:14.333852 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:11:14.334200 [debug] [MainThread]: Partial parsing: updated file: dw_project://models/output/bitcoin_realtime_aggregated.sql
[0m17:11:14.416495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c8af923-82a4-4fd5-b7e4-850dbc29edc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a39d5b0>]}
[0m17:11:14.451315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1c8af923-82a4-4fd5-b7e4-850dbc29edc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a4cef60>]}
[0m17:11:14.451527 [info ] [MainThread]: Found 7 models, 3 sources, 459 macros
[0m17:11:14.451680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c8af923-82a4-4fd5-b7e4-850dbc29edc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052203b0>]}
[0m17:11:14.452412 [info ] [MainThread]: 
[0m17:11:14.452659 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:11:14.454354 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m17:11:14.459108 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m17:11:14.459238 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m17:11:14.459340 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:11:15.234344 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.774 seconds
[0m17:11:15.237431 [debug] [ThreadPool]: On list_lab2: Close
[0m17:11:15.435444 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m17:11:15.449477 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m17:11:15.450066 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m17:11:15.450402 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:11:16.106192 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.656 seconds
[0m17:11:16.110666 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m17:11:16.322920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c8af923-82a4-4fd5-b7e4-850dbc29edc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a3f2e10>]}
[0m17:11:16.324392 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m17:11:16.325138 [info ] [MainThread]: 
[0m17:11:16.331077 [debug] [Thread-1 (]: Began running node model.dw_project.avg_price_realtime
[0m17:11:16.331902 [info ] [Thread-1 (]: 1 of 5 START sql table model analytics.avg_price_realtime ...................... [RUN]
[0m17:11:16.332543 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now model.dw_project.avg_price_realtime)
[0m17:11:16.332983 [debug] [Thread-1 (]: Began compiling node model.dw_project.avg_price_realtime
[0m17:11:16.391041 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.avg_price_realtime"
[0m17:11:16.392568 [debug] [Thread-1 (]: Began executing node model.dw_project.avg_price_realtime
[0m17:11:16.404670 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.avg_price_realtime"
[0m17:11:16.405236 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.avg_price_realtime"
[0m17:11:16.405400 [debug] [Thread-1 (]: On model.dw_project.avg_price_realtime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.avg_price_realtime"} */
create or replace transient table lab2.analytics.avg_price_realtime
         as
        (WITH realtime AS (
    SELECT 
        time_open AS time_period_start,
        price_close
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    time_period_start,
    AVG(price_close) OVER (ORDER BY time_period_start ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) AS thirty_min_avg_price
FROM realtime
ORDER BY time_period_start
        );
[0m17:11:16.405546 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:11:17.846459 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.440 seconds
[0m17:11:17.875315 [debug] [Thread-1 (]: On model.dw_project.avg_price_realtime: Close
[0m17:11:18.058935 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c8af923-82a4-4fd5-b7e4-850dbc29edc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104889a90>]}
[0m17:11:18.060480 [info ] [Thread-1 (]: 1 of 5 OK created sql table model analytics.avg_price_realtime ................. [[32mSUCCESS 1[0m in 1.72s]
[0m17:11:18.061478 [debug] [Thread-1 (]: Finished running node model.dw_project.avg_price_realtime
[0m17:11:18.062136 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_daily_summary
[0m17:11:18.062951 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.bitcoin_daily_summary ................... [RUN]
[0m17:11:18.063592 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.avg_price_realtime, now model.dw_project.bitcoin_daily_summary)
[0m17:11:18.064038 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_daily_summary
[0m17:11:18.067836 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_daily_summary"
[0m17:11:18.069736 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_daily_summary
[0m17:11:18.072038 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_daily_summary"
[0m17:11:18.073912 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_daily_summary"
[0m17:11:18.074336 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_daily_summary"} */
create or replace transient table lab2.analytics.bitcoin_daily_summary
         as
        (WITH historical_data AS (
    SELECT
        TIME_PERIOD_START::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_historical
),
realtime_data AS (
    SELECT
        TIME_OPEN::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    date,
    AVG(PRICE_OPEN) AS avg_open,
    AVG(PRICE_HIGH) AS avg_high,
    AVG(PRICE_LOW) AS avg_low,
    AVG(PRICE_CLOSE) AS avg_close,
    SUM(VOLUME_TRADED) AS total_volume,
    SUM(TRADES_COUNT) AS total_trades
FROM (
    SELECT * FROM historical_data
    UNION ALL
    SELECT * FROM realtime_data
) AS combined_data
GROUP BY date
ORDER BY date
        );
[0m17:11:18.074652 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:11:19.720647 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.645 seconds
[0m17:11:19.725442 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: Close
[0m17:11:19.900714 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c8af923-82a4-4fd5-b7e4-850dbc29edc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a3000b0>]}
[0m17:11:19.902590 [info ] [Thread-1 (]: 2 of 5 OK created sql table model analytics.bitcoin_daily_summary .............. [[32mSUCCESS 1[0m in 1.84s]
[0m17:11:19.903964 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_daily_summary
[0m17:11:19.904882 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_historical
[0m17:11:19.905999 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_daily_summary, now model.dw_project.bitcoin_historical)
[0m17:11:19.906830 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_historical
[0m17:11:19.912037 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_historical"
[0m17:11:19.914212 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_historical
[0m17:11:19.915041 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_realtime
[0m17:11:19.915714 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_historical, now model.dw_project.bitcoin_realtime)
[0m17:11:19.916345 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_realtime
[0m17:11:19.919373 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_realtime"
[0m17:11:19.921066 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_realtime
[0m17:11:19.921536 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_historical_aggregated
[0m17:11:19.922134 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.bitcoin_historical_aggregated ........... [RUN]
[0m17:11:19.922540 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_realtime, now model.dw_project.bitcoin_historical_aggregated)
[0m17:11:19.922843 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_historical_aggregated
[0m17:11:19.928695 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_historical_aggregated"
[0m17:11:19.929427 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_historical_aggregated
[0m17:11:19.931755 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_historical_aggregated"
[0m17:11:19.932830 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_historical_aggregated"
[0m17:11:19.933095 [debug] [Thread-1 (]: On model.dw_project.bitcoin_historical_aggregated: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_historical_aggregated"} */
create or replace transient table lab2.analytics.bitcoin_historical_aggregated
         as
        (-- bitcoin_historical_aggregated.sql
WITH  __dbt__cte__bitcoin_historical as (
SELECT 
    time_period_start,
    time_period_end,
    time_open,
    time_close,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_historical
WHERE time_period_start IS NOT NULL
), historical_agg AS (
    SELECT 
        DATE(TIME_PERIOD_START) AS DAY,
        MIN(PRICE_LOW) AS PRICE_LOW,
        MAX(PRICE_HIGH) AS PRICE_HIGH,
        SUM(VOLUME_TRADED) AS VOLUME_TRADED,
        COUNT(TRADES_COUNT) AS TRADES_COUNT
    FROM __dbt__cte__bitcoin_historical
    GROUP BY DATE(TIME_PERIOD_START)
)
SELECT 
    DAY,
    PRICE_LOW,
    PRICE_HIGH,
    VOLUME_TRADED,
    TRADES_COUNT
FROM historical_agg
        );
[0m17:11:19.933343 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:11:21.666195 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.732 seconds
[0m17:11:21.669899 [debug] [Thread-1 (]: On model.dw_project.bitcoin_historical_aggregated: Close
[0m17:11:21.888691 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c8af923-82a4-4fd5-b7e4-850dbc29edc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a3a7d70>]}
[0m17:11:21.889814 [info ] [Thread-1 (]: 3 of 5 OK created sql table model analytics.bitcoin_historical_aggregated ...... [[32mSUCCESS 1[0m in 1.97s]
[0m17:11:21.890716 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_historical_aggregated
[0m17:11:21.891343 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_realtime_aggregated
[0m17:11:21.892142 [info ] [Thread-1 (]: 4 of 5 START sql table model analytics.bitcoin_realtime_aggregated ............. [RUN]
[0m17:11:21.892841 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_historical_aggregated, now model.dw_project.bitcoin_realtime_aggregated)
[0m17:11:21.893380 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_realtime_aggregated
[0m17:11:21.902058 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_realtime_aggregated"
[0m17:11:21.902855 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_realtime_aggregated
[0m17:11:21.904752 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_realtime_aggregated"
[0m17:11:21.905560 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_realtime_aggregated"
[0m17:11:21.905775 [debug] [Thread-1 (]: On model.dw_project.bitcoin_realtime_aggregated: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_realtime_aggregated"} */
create or replace transient table lab2.analytics.bitcoin_realtime_aggregated
         as
        (WITH  __dbt__cte__bitcoin_realtime as (
SELECT 
    time_open,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_realtime
WHERE price_close IS NOT NULL
), real_time_agg AS (
    SELECT 
    DATE(TIME_PERIOD_START) AS DAY, 
    MIN(PRICE_LOW) AS PRICE_LOW,
    MAX(PRICE_HIGH) AS PRICE_HIGH,
    SUM(VOLUME_TRADED) AS VOLUME_TRADED,
    COUNT(TRADES_COUNT) AS TRADES_COUNT
FROM __dbt__cte__bitcoin_realtime
GROUP BY DATE(TIME_PERIOD_START)

)
SELECT 
    DAY,
    PRICE_LOW,
    PRICE_HIGH,
    VOLUME_TRADED,
    TRADES_COUNT
FROM real_time_agg
        );
[0m17:11:21.905946 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:11:22.513324 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8a407-0003-6500-0003-437a001100c6
[0m17:11:22.514000 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 16 at position 9
invalid identifier 'TIME_PERIOD_START'
[0m17:11:22.514538 [debug] [Thread-1 (]: On model.dw_project.bitcoin_realtime_aggregated: Close
[0m17:11:22.701999 [debug] [Thread-1 (]: Database Error in model bitcoin_realtime_aggregated (models/output/bitcoin_realtime_aggregated.sql)
  000904 (42000): SQL compilation error: error line 16 at position 9
  invalid identifier 'TIME_PERIOD_START'
  compiled code at target/run/dw_project/models/output/bitcoin_realtime_aggregated.sql
[0m17:11:22.703220 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c8af923-82a4-4fd5-b7e4-850dbc29edc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a3a7770>]}
[0m17:11:22.704345 [error] [Thread-1 (]: 4 of 5 ERROR creating sql table model analytics.bitcoin_realtime_aggregated .... [[31mERROR[0m in 0.81s]
[0m17:11:22.705286 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_realtime_aggregated
[0m17:11:22.706818 [debug] [Thread-1 (]: Began running node model.dw_project.comparison
[0m17:11:22.707572 [info ] [Thread-1 (]: 5 of 5 SKIP relation analytics.comparison ...................................... [[33mSKIP[0m]
[0m17:11:22.708115 [debug] [Thread-1 (]: Finished running node model.dw_project.comparison
[0m17:11:22.709337 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:11:22.709660 [debug] [MainThread]: Connection 'model.dw_project.bitcoin_realtime_aggregated' was properly closed.
[0m17:11:22.710041 [info ] [MainThread]: 
[0m17:11:22.710391 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 8.26 seconds (8.26s).
[0m17:11:22.711466 [debug] [MainThread]: Command end result
[0m17:11:22.734000 [info ] [MainThread]: 
[0m17:11:22.734260 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:11:22.734440 [info ] [MainThread]: 
[0m17:11:22.734656 [error] [MainThread]:   Database Error in model bitcoin_realtime_aggregated (models/output/bitcoin_realtime_aggregated.sql)
  000904 (42000): SQL compilation error: error line 16 at position 9
  invalid identifier 'TIME_PERIOD_START'
  compiled code at target/run/dw_project/models/output/bitcoin_realtime_aggregated.sql
[0m17:11:22.734836 [info ] [MainThread]: 
[0m17:11:22.735017 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
[0m17:11:22.736936 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 9.423115, "process_user_time": 2.843866, "process_kernel_time": 1.754359, "process_mem_max_rss": "207962112", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:11:22.737288 [debug] [MainThread]: Command `dbt run` failed at 17:11:22.737230 after 9.42 seconds
[0m17:11:22.737501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10524f8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a131a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x139fae1b0>]}
[0m17:11:22.737699 [debug] [MainThread]: Flushing usage events
[0m17:13:35.438380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10728f380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10615eea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10615d400>]}


============================== 17:13:35.439832 | a1c43d5c-4e02-41d6-9b0e-a7900cc395c1 ==============================
[0m17:13:35.439832 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:13:35.440116 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'target_path': 'None', 'log_format': 'default', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'write_json': 'True', 'cache_selected_only': 'False', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'printer_width': '80', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'quiet': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'invocation_command': 'dbt run', 'version_check': 'True', 'introspect': 'True', 'warn_error': 'None'}
[0m17:13:36.162677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a1c43d5c-4e02-41d6-9b0e-a7900cc395c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072fa150>]}
[0m17:13:36.180107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a1c43d5c-4e02-41d6-9b0e-a7900cc395c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10759dbe0>]}
[0m17:13:36.181247 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:13:36.188829 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:13:36.242612 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 0 files added, 1 files changed.
[0m17:13:36.242896 [debug] [MainThread]: Partial parsing: deleted file: dw_project://models/output/bitcoin_realtime_aggregated.sql
[0m17:13:36.243020 [debug] [MainThread]: Partial parsing: deleted file: dw_project://models/output/bitcoin_historical_aggregated.sql
[0m17:13:36.243144 [debug] [MainThread]: Partial parsing: updated file: dw_project://models/output/comparison.sql
[0m17:13:36.299746 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dw_project.comparison' (models/output/comparison.sql) depends on a node named 'BITCOIN_HISTORICAL' which was not found
[0m17:13:36.301633 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.88469404, "process_user_time": 2.568292, "process_kernel_time": 1.353162, "process_mem_max_rss": "197574656", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:13:36.301899 [debug] [MainThread]: Command `dbt run` failed at 17:13:36.301849 after 0.89 seconds
[0m17:13:36.302069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10728e900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16c4f3260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16c49f3e0>]}
[0m17:13:36.302227 [debug] [MainThread]: Flushing usage events
[0m17:14:02.157794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091df9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10922bd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10922b920>]}


============================== 17:14:02.159296 | 8871694e-4121-4fac-9e9c-4eb97ce2673c ==============================
[0m17:14:02.159296 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:14:02.159582 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'indirect_selection': 'eager', 'target_path': 'None', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'use_experimental_parser': 'False', 'write_json': 'True', 'static_parser': 'True', 'partial_parse': 'True', 'debug': 'False', 'log_format': 'default', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'printer_width': '80', 'no_print': 'None', 'warn_error': 'None', 'empty': 'False', 'invocation_command': 'dbt run', 'use_colors': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'quiet': 'False'}
[0m17:14:02.907110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8871694e-4121-4fac-9e9c-4eb97ce2673c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1432b7980>]}
[0m17:14:02.924682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8871694e-4121-4fac-9e9c-4eb97ce2673c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144165b50>]}
[0m17:14:02.925236 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:14:02.933399 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:14:02.987824 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 0 files added, 0 files changed.
[0m17:14:02.988051 [debug] [MainThread]: Partial parsing: deleted file: dw_project://models/output/comparison.sql
[0m17:14:02.988160 [debug] [MainThread]: Partial parsing: deleted file: dw_project://models/output/bitcoin_realtime_aggregated.sql
[0m17:14:02.988259 [debug] [MainThread]: Partial parsing: deleted file: dw_project://models/output/bitcoin_historical_aggregated.sql
[0m17:14:03.020785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8871694e-4121-4fac-9e9c-4eb97ce2673c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1443969c0>]}
[0m17:14:03.054938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8871694e-4121-4fac-9e9c-4eb97ce2673c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1446dc530>]}
[0m17:14:03.055183 [info ] [MainThread]: Found 4 models, 3 sources, 459 macros
[0m17:14:03.055332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8871694e-4121-4fac-9e9c-4eb97ce2673c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14299f2f0>]}
[0m17:14:03.056041 [info ] [MainThread]: 
[0m17:14:03.056285 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:14:03.057900 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m17:14:03.063166 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m17:14:03.063304 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m17:14:03.063408 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:14:03.737170 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.673 seconds
[0m17:14:03.740190 [debug] [ThreadPool]: On list_lab2: Close
[0m17:14:03.923275 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m17:14:03.938804 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m17:14:03.939402 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m17:14:03.939733 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:14:04.648785 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.709 seconds
[0m17:14:04.650811 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m17:14:04.843134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8871694e-4121-4fac-9e9c-4eb97ce2673c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1443715b0>]}
[0m17:14:04.844509 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m17:14:04.845088 [info ] [MainThread]: 
[0m17:14:04.849978 [debug] [Thread-1 (]: Began running node model.dw_project.avg_price_realtime
[0m17:14:04.850607 [info ] [Thread-1 (]: 1 of 2 START sql table model analytics.avg_price_realtime ...................... [RUN]
[0m17:14:04.851147 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now model.dw_project.avg_price_realtime)
[0m17:14:04.851535 [debug] [Thread-1 (]: Began compiling node model.dw_project.avg_price_realtime
[0m17:14:04.860131 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.avg_price_realtime"
[0m17:14:04.860898 [debug] [Thread-1 (]: Began executing node model.dw_project.avg_price_realtime
[0m17:14:04.880748 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.avg_price_realtime"
[0m17:14:04.881532 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.avg_price_realtime"
[0m17:14:04.881756 [debug] [Thread-1 (]: On model.dw_project.avg_price_realtime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.avg_price_realtime"} */
create or replace transient table lab2.analytics.avg_price_realtime
         as
        (WITH realtime AS (
    SELECT 
        time_open AS time_period_start,
        price_close
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    time_period_start,
    AVG(price_close) OVER (ORDER BY time_period_start ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) AS thirty_min_avg_price
FROM realtime
ORDER BY time_period_start
        );
[0m17:14:04.881947 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:14:06.986434 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.104 seconds
[0m17:14:07.010924 [debug] [Thread-1 (]: On model.dw_project.avg_price_realtime: Close
[0m17:14:07.203991 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8871694e-4121-4fac-9e9c-4eb97ce2673c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144128d70>]}
[0m17:14:07.205878 [info ] [Thread-1 (]: 1 of 2 OK created sql table model analytics.avg_price_realtime ................. [[32mSUCCESS 1[0m in 2.35s]
[0m17:14:07.207209 [debug] [Thread-1 (]: Finished running node model.dw_project.avg_price_realtime
[0m17:14:07.208114 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_daily_summary
[0m17:14:07.209272 [info ] [Thread-1 (]: 2 of 2 START sql table model analytics.bitcoin_daily_summary ................... [RUN]
[0m17:14:07.210219 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.avg_price_realtime, now model.dw_project.bitcoin_daily_summary)
[0m17:14:07.210836 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_daily_summary
[0m17:14:07.215956 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_daily_summary"
[0m17:14:07.216904 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_daily_summary
[0m17:14:07.219635 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_daily_summary"
[0m17:14:07.221183 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_daily_summary"
[0m17:14:07.221539 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_daily_summary"} */
create or replace transient table lab2.analytics.bitcoin_daily_summary
         as
        (WITH historical_data AS (
    SELECT
        TIME_PERIOD_START::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_historical
),
realtime_data AS (
    SELECT
        TIME_OPEN::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    date,
    AVG(PRICE_OPEN) AS avg_open,
    AVG(PRICE_HIGH) AS avg_high,
    AVG(PRICE_LOW) AS avg_low,
    AVG(PRICE_CLOSE) AS avg_close,
    SUM(VOLUME_TRADED) AS total_volume,
    SUM(TRADES_COUNT) AS total_trades
FROM (
    SELECT * FROM historical_data
    UNION ALL
    SELECT * FROM realtime_data
) AS combined_data
GROUP BY date
ORDER BY date
        );
[0m17:14:07.221870 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:14:09.400258 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.178 seconds
[0m17:14:09.404557 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: Close
[0m17:14:09.576969 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8871694e-4121-4fac-9e9c-4eb97ce2673c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14499a3c0>]}
[0m17:14:09.578882 [info ] [Thread-1 (]: 2 of 2 OK created sql table model analytics.bitcoin_daily_summary .............. [[32mSUCCESS 1[0m in 2.37s]
[0m17:14:09.580073 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_daily_summary
[0m17:14:09.580783 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_historical
[0m17:14:09.581518 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_daily_summary, now model.dw_project.bitcoin_historical)
[0m17:14:09.582023 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_historical
[0m17:14:09.586576 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_historical"
[0m17:14:09.587969 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_historical
[0m17:14:09.588423 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_realtime
[0m17:14:09.588985 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_historical, now model.dw_project.bitcoin_realtime)
[0m17:14:09.589485 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_realtime
[0m17:14:09.592067 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_realtime"
[0m17:14:09.592894 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_realtime
[0m17:14:09.594052 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:14:09.594313 [debug] [MainThread]: Connection 'model.dw_project.bitcoin_realtime' was properly closed.
[0m17:14:09.594632 [info ] [MainThread]: 
[0m17:14:09.594923 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 6.54 seconds (6.54s).
[0m17:14:09.595587 [debug] [MainThread]: Command end result
[0m17:14:09.656206 [info ] [MainThread]: 
[0m17:14:09.656441 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:14:09.656570 [info ] [MainThread]: 
[0m17:14:09.656701 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m17:14:09.658515 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.5234823, "process_user_time": 2.921645, "process_kernel_time": 1.420694, "process_mem_max_rss": "203702272", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:14:09.658760 [debug] [MainThread]: Command `dbt run` succeeded at 17:14:09.658720 after 7.52 seconds
[0m17:14:09.658921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10844f980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143689df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144b3a450>]}
[0m17:14:09.659073 [debug] [MainThread]: Flushing usage events
[0m17:16:31.455036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c41970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e59310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e593a0>]}


============================== 17:16:31.456787 | 9ef801da-fbf9-4f69-adc2-1f109ddc569e ==============================
[0m17:16:31.456787 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:16:31.457071 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'debug': 'False', 'quiet': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'printer_width': '80', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'use_colors': 'True', 'version_check': 'True', 'log_cache_events': 'False', 'target_path': 'None', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'write_json': 'True', 'partial_parse': 'True', 'no_print': 'None', 'fail_fast': 'False', 'introspect': 'True', 'empty': 'False', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])'}
[0m17:16:32.452955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9ef801da-fbf9-4f69-adc2-1f109ddc569e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16b6ef6e0>]}
[0m17:16:32.470727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9ef801da-fbf9-4f69-adc2-1f109ddc569e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16b902570>]}
[0m17:16:32.471382 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:16:32.480548 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:16:32.539097 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m17:16:32.539409 [debug] [MainThread]: Partial parsing: added file: dw_project://models/output/bitcoin_aggregated_realtime.sql
[0m17:16:32.623331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ef801da-fbf9-4f69-adc2-1f109ddc569e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16d2d9190>]}
[0m17:16:32.658821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ef801da-fbf9-4f69-adc2-1f109ddc569e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16d2cabd0>]}
[0m17:16:32.659038 [info ] [MainThread]: Found 5 models, 3 sources, 459 macros
[0m17:16:32.659184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ef801da-fbf9-4f69-adc2-1f109ddc569e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16f6461b0>]}
[0m17:16:32.659886 [info ] [MainThread]: 
[0m17:16:32.660130 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:16:32.661711 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m17:16:32.666435 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m17:16:32.666575 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m17:16:32.666683 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:16:33.528701 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.861 seconds
[0m17:16:33.531948 [debug] [ThreadPool]: On list_lab2: Close
[0m17:16:33.710387 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m17:16:33.723322 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m17:16:33.723720 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m17:16:33.723958 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:16:34.503283 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.779 seconds
[0m17:16:34.507778 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m17:16:34.729437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ef801da-fbf9-4f69-adc2-1f109ddc569e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075bbc20>]}
[0m17:16:34.731018 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m17:16:34.731822 [info ] [MainThread]: 
[0m17:16:34.737008 [debug] [Thread-1 (]: Began running node model.dw_project.avg_price_realtime
[0m17:16:34.737780 [info ] [Thread-1 (]: 1 of 3 START sql table model analytics.avg_price_realtime ...................... [RUN]
[0m17:16:34.738327 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now model.dw_project.avg_price_realtime)
[0m17:16:34.738720 [debug] [Thread-1 (]: Began compiling node model.dw_project.avg_price_realtime
[0m17:16:34.801371 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.avg_price_realtime"
[0m17:16:34.801878 [debug] [Thread-1 (]: Began executing node model.dw_project.avg_price_realtime
[0m17:16:34.814871 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.avg_price_realtime"
[0m17:16:34.815884 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.avg_price_realtime"
[0m17:16:34.816130 [debug] [Thread-1 (]: On model.dw_project.avg_price_realtime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.avg_price_realtime"} */
create or replace transient table lab2.analytics.avg_price_realtime
         as
        (WITH realtime AS (
    SELECT 
        time_open AS time_period_start,
        price_close
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    time_period_start,
    AVG(price_close) OVER (ORDER BY time_period_start ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) AS thirty_min_avg_price
FROM realtime
ORDER BY time_period_start
        );
[0m17:16:34.816292 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:16:36.757182 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.940 seconds
[0m17:16:36.785316 [debug] [Thread-1 (]: On model.dw_project.avg_price_realtime: Close
[0m17:16:36.970198 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ef801da-fbf9-4f69-adc2-1f109ddc569e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110cada30>]}
[0m17:16:36.972264 [info ] [Thread-1 (]: 1 of 3 OK created sql table model analytics.avg_price_realtime ................. [[32mSUCCESS 1[0m in 2.23s]
[0m17:16:36.973534 [debug] [Thread-1 (]: Finished running node model.dw_project.avg_price_realtime
[0m17:16:36.974268 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_daily_summary
[0m17:16:36.975164 [info ] [Thread-1 (]: 2 of 3 START sql table model analytics.bitcoin_daily_summary ................... [RUN]
[0m17:16:36.975808 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.avg_price_realtime, now model.dw_project.bitcoin_daily_summary)
[0m17:16:36.976350 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_daily_summary
[0m17:16:36.981135 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_daily_summary"
[0m17:16:36.983249 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_daily_summary
[0m17:16:36.985933 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_daily_summary"
[0m17:16:36.987488 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_daily_summary"
[0m17:16:36.987869 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_daily_summary"} */
create or replace transient table lab2.analytics.bitcoin_daily_summary
         as
        (WITH historical_data AS (
    SELECT
        TIME_PERIOD_START::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_historical
),
realtime_data AS (
    SELECT
        TIME_OPEN::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    date,
    AVG(PRICE_OPEN) AS avg_open,
    AVG(PRICE_HIGH) AS avg_high,
    AVG(PRICE_LOW) AS avg_low,
    AVG(PRICE_CLOSE) AS avg_close,
    SUM(VOLUME_TRADED) AS total_volume,
    SUM(TRADES_COUNT) AS total_trades
FROM (
    SELECT * FROM historical_data
    UNION ALL
    SELECT * FROM realtime_data
) AS combined_data
GROUP BY date
ORDER BY date
        );
[0m17:16:36.988216 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:16:39.211785 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.223 seconds
[0m17:16:39.216452 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: Close
[0m17:16:39.459777 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ef801da-fbf9-4f69-adc2-1f109ddc569e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16d2a5f40>]}
[0m17:16:39.461381 [info ] [Thread-1 (]: 2 of 3 OK created sql table model analytics.bitcoin_daily_summary .............. [[32mSUCCESS 1[0m in 2.48s]
[0m17:16:39.462374 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_daily_summary
[0m17:16:39.463011 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_historical
[0m17:16:39.463777 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_daily_summary, now model.dw_project.bitcoin_historical)
[0m17:16:39.464331 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_historical
[0m17:16:39.468557 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_historical"
[0m17:16:39.470649 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_historical
[0m17:16:39.471049 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_realtime
[0m17:16:39.471520 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_historical, now model.dw_project.bitcoin_realtime)
[0m17:16:39.471964 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_realtime
[0m17:16:39.474368 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_realtime"
[0m17:16:39.475406 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_realtime
[0m17:16:39.476168 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_aggregated_realtime
[0m17:16:39.476919 [info ] [Thread-1 (]: 3 of 3 START sql table model analytics.bitcoin_aggregated_realtime ............. [RUN]
[0m17:16:39.477295 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_realtime, now model.dw_project.bitcoin_aggregated_realtime)
[0m17:16:39.477565 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_aggregated_realtime
[0m17:16:39.482991 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_aggregated_realtime"
[0m17:16:39.483509 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_aggregated_realtime
[0m17:16:39.485481 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_aggregated_realtime"
[0m17:16:39.486412 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_aggregated_realtime"
[0m17:16:39.486675 [debug] [Thread-1 (]: On model.dw_project.bitcoin_aggregated_realtime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_aggregated_realtime"} */
create or replace transient table lab2.analytics.bitcoin_aggregated_realtime
         as
        (-- Aggregated real-time data by day from bitcoin_realtime table
WITH  __dbt__cte__bitcoin_realtime as (
SELECT 
    time_open,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_realtime
WHERE price_close IS NOT NULL
), real_time_agg AS (
    SELECT 
        DATE(TIME_PERIOD_START) AS DAY, 
        MIN(PRICE_LOW) AS PRICE_LOW,
        MAX(PRICE_HIGH) AS PRICE_HIGH,
        SUM(VOLUME_TRADED) AS VOLUME_TRADED,
        COUNT(TRADES_COUNT) AS TRADES_COUNT
    FROM __dbt__cte__bitcoin_realtime  -- Reference the real-time table
    GROUP BY DATE(TIME_PERIOD_START)  -- Grouping by day
)

-- Select final result
SELECT 
    DAY,
    PRICE_LOW,
    PRICE_HIGH,
    VOLUME_TRADED,
    TRADES_COUNT
FROM real_time_agg
        );
[0m17:16:39.486919 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:16:39.993382 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8a40c-0003-65ec-0003-437a001130f6
[0m17:16:39.994335 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 17 at position 13
invalid identifier 'TIME_PERIOD_START'
[0m17:16:39.994951 [debug] [Thread-1 (]: On model.dw_project.bitcoin_aggregated_realtime: Close
[0m17:16:40.220583 [debug] [Thread-1 (]: Database Error in model bitcoin_aggregated_realtime (models/output/bitcoin_aggregated_realtime.sql)
  000904 (42000): SQL compilation error: error line 17 at position 13
  invalid identifier 'TIME_PERIOD_START'
  compiled code at target/run/dw_project/models/output/bitcoin_aggregated_realtime.sql
[0m17:16:40.221802 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ef801da-fbf9-4f69-adc2-1f109ddc569e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16d1a0620>]}
[0m17:16:40.222900 [error] [Thread-1 (]: 3 of 3 ERROR creating sql table model analytics.bitcoin_aggregated_realtime .... [[31mERROR[0m in 0.74s]
[0m17:16:40.224012 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_aggregated_realtime
[0m17:16:40.226467 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:16:40.227062 [debug] [MainThread]: Connection 'model.dw_project.bitcoin_aggregated_realtime' was properly closed.
[0m17:16:40.227542 [info ] [MainThread]: 
[0m17:16:40.227922 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 7.57 seconds (7.57s).
[0m17:16:40.228924 [debug] [MainThread]: Command end result
[0m17:16:40.252392 [info ] [MainThread]: 
[0m17:16:40.252659 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:16:40.252829 [info ] [MainThread]: 
[0m17:16:40.253047 [error] [MainThread]:   Database Error in model bitcoin_aggregated_realtime (models/output/bitcoin_aggregated_realtime.sql)
  000904 (42000): SQL compilation error: error line 17 at position 13
  invalid identifier 'TIME_PERIOD_START'
  compiled code at target/run/dw_project/models/output/bitcoin_aggregated_realtime.sql
[0m17:16:40.253219 [info ] [MainThread]: 
[0m17:16:40.253405 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m17:16:40.255356 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 8.825702, "process_user_time": 2.113707, "process_kernel_time": 2.55572, "process_mem_max_rss": "209354752", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:16:40.255676 [debug] [MainThread]: Command `dbt run` failed at 17:16:40.255622 after 8.83 seconds
[0m17:16:40.255898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11158e870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111eac90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16f5b8a40>]}
[0m17:16:40.256095 [debug] [MainThread]: Flushing usage events
[0m17:17:14.541120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115ad160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11223be60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11223bb00>]}


============================== 17:17:14.542867 | 34f207ab-853e-418f-9413-924733fa56bc ==============================
[0m17:17:14.542867 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:17:14.543150 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'warn_error': 'None', 'introspect': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'version_check': 'True', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'printer_width': '80', 'log_format': 'default', 'quiet': 'False', 'static_parser': 'True', 'partial_parse': 'True', 'use_colors': 'True', 'invocation_command': 'dbt run', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'no_print': 'None', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'debug': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'use_experimental_parser': 'False'}
[0m17:17:15.328913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '34f207ab-853e-418f-9413-924733fa56bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1622a5610>]}
[0m17:17:15.346571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '34f207ab-853e-418f-9413-924733fa56bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11220be00>]}
[0m17:17:15.347005 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:17:15.355117 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:17:15.411079 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m17:17:15.411372 [debug] [MainThread]: Partial parsing: added file: dw_project://models/output/bitcoin_aggregated_historical.sql
[0m17:17:15.411491 [debug] [MainThread]: Partial parsing: deleted file: dw_project://models/output/bitcoin_aggregated_realtime.sql
[0m17:17:15.494488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '34f207ab-853e-418f-9413-924733fa56bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x167ad93a0>]}
[0m17:17:15.525900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '34f207ab-853e-418f-9413-924733fa56bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x167acac00>]}
[0m17:17:15.526118 [info ] [MainThread]: Found 5 models, 3 sources, 459 macros
[0m17:17:15.526262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34f207ab-853e-418f-9413-924733fa56bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x167ad9b50>]}
[0m17:17:15.526966 [info ] [MainThread]: 
[0m17:17:15.527206 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:17:15.528816 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m17:17:15.533574 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m17:17:15.533720 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m17:17:15.533822 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:17:16.313347 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.779 seconds
[0m17:17:16.317031 [debug] [ThreadPool]: On list_lab2: Close
[0m17:17:16.524492 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m17:17:16.536013 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m17:17:16.536555 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m17:17:16.536859 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:17:17.301296 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.764 seconds
[0m17:17:17.303706 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m17:17:17.499890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34f207ab-853e-418f-9413-924733fa56bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x166f97200>]}
[0m17:17:17.500905 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m17:17:17.501419 [info ] [MainThread]: 
[0m17:17:17.505139 [debug] [Thread-1 (]: Began running node model.dw_project.avg_price_realtime
[0m17:17:17.505987 [info ] [Thread-1 (]: 1 of 3 START sql table model analytics.avg_price_realtime ...................... [RUN]
[0m17:17:17.506506 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now model.dw_project.avg_price_realtime)
[0m17:17:17.506902 [debug] [Thread-1 (]: Began compiling node model.dw_project.avg_price_realtime
[0m17:17:17.555041 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.avg_price_realtime"
[0m17:17:17.555909 [debug] [Thread-1 (]: Began executing node model.dw_project.avg_price_realtime
[0m17:17:17.568598 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.avg_price_realtime"
[0m17:17:17.569328 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.avg_price_realtime"
[0m17:17:17.569509 [debug] [Thread-1 (]: On model.dw_project.avg_price_realtime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.avg_price_realtime"} */
create or replace transient table lab2.analytics.avg_price_realtime
         as
        (WITH realtime AS (
    SELECT 
        time_open AS time_period_start,
        price_close
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    time_period_start,
    AVG(price_close) OVER (ORDER BY time_period_start ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) AS thirty_min_avg_price
FROM realtime
ORDER BY time_period_start
        );
[0m17:17:17.569654 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:18.737599 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.167 seconds
[0m17:17:18.758551 [debug] [Thread-1 (]: On model.dw_project.avg_price_realtime: Close
[0m17:17:18.946946 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34f207ab-853e-418f-9413-924733fa56bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x167b6ca40>]}
[0m17:17:18.948257 [info ] [Thread-1 (]: 1 of 3 OK created sql table model analytics.avg_price_realtime ................. [[32mSUCCESS 1[0m in 1.44s]
[0m17:17:18.949333 [debug] [Thread-1 (]: Finished running node model.dw_project.avg_price_realtime
[0m17:17:18.950075 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_daily_summary
[0m17:17:18.950995 [info ] [Thread-1 (]: 2 of 3 START sql table model analytics.bitcoin_daily_summary ................... [RUN]
[0m17:17:18.951801 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.avg_price_realtime, now model.dw_project.bitcoin_daily_summary)
[0m17:17:18.952366 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_daily_summary
[0m17:17:18.956680 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_daily_summary"
[0m17:17:18.957595 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_daily_summary
[0m17:17:18.959059 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_daily_summary"
[0m17:17:18.960044 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_daily_summary"
[0m17:17:18.960231 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_daily_summary"} */
create or replace transient table lab2.analytics.bitcoin_daily_summary
         as
        (WITH historical_data AS (
    SELECT
        TIME_PERIOD_START::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_historical
),
realtime_data AS (
    SELECT
        TIME_OPEN::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    date,
    AVG(PRICE_OPEN) AS avg_open,
    AVG(PRICE_HIGH) AS avg_high,
    AVG(PRICE_LOW) AS avg_low,
    AVG(PRICE_CLOSE) AS avg_close,
    SUM(VOLUME_TRADED) AS total_volume,
    SUM(TRADES_COUNT) AS total_trades
FROM (
    SELECT * FROM historical_data
    UNION ALL
    SELECT * FROM realtime_data
) AS combined_data
GROUP BY date
ORDER BY date
        );
[0m17:17:18.960386 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:20.583284 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.622 seconds
[0m17:17:20.587336 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: Close
[0m17:17:20.826947 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34f207ab-853e-418f-9413-924733fa56bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x167dc9190>]}
[0m17:17:20.829256 [info ] [Thread-1 (]: 2 of 3 OK created sql table model analytics.bitcoin_daily_summary .............. [[32mSUCCESS 1[0m in 1.87s]
[0m17:17:20.830585 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_daily_summary
[0m17:17:20.831499 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_historical
[0m17:17:20.832348 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_daily_summary, now model.dw_project.bitcoin_historical)
[0m17:17:20.832913 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_historical
[0m17:17:20.837744 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_historical"
[0m17:17:20.839091 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_historical
[0m17:17:20.839566 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_realtime
[0m17:17:20.840241 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_historical, now model.dw_project.bitcoin_realtime)
[0m17:17:20.840779 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_realtime
[0m17:17:20.843450 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_realtime"
[0m17:17:20.844552 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_realtime
[0m17:17:20.844931 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_aggregated_historical
[0m17:17:20.845376 [info ] [Thread-1 (]: 3 of 3 START sql table model analytics.bitcoin_aggregated_historical ........... [RUN]
[0m17:17:20.845741 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_realtime, now model.dw_project.bitcoin_aggregated_historical)
[0m17:17:20.846029 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_aggregated_historical
[0m17:17:20.851755 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_aggregated_historical"
[0m17:17:20.852242 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_aggregated_historical
[0m17:17:20.854373 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_aggregated_historical"
[0m17:17:20.855368 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_aggregated_historical"
[0m17:17:20.855628 [debug] [Thread-1 (]: On model.dw_project.bitcoin_aggregated_historical: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_aggregated_historical"} */
create or replace transient table lab2.analytics.bitcoin_aggregated_historical
         as
        (-- Aggregated historical data by day from bitcoin_historical table
WITH  __dbt__cte__bitcoin_historical as (
SELECT 
    time_period_start,
    time_period_end,
    time_open,
    time_close,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_historical
WHERE time_period_start IS NOT NULL
), historical_agg AS (
    SELECT 
        DATE(TIME_PERIOD_START) AS DAY, 
        MIN(PRICE_LOW) AS PRICE_LOW,
        MAX(PRICE_HIGH) AS PRICE_HIGH,
        SUM(VOLUME_TRADED) AS VOLUME_TRADED,
        COUNT(TRADES_COUNT) AS TRADES_COUNT
    FROM __dbt__cte__bitcoin_historical  -- Reference the historical table
    GROUP BY DATE(TIME_PERIOD_START)  -- Grouping by day
)

-- Select final result
SELECT 
    DAY,
    PRICE_LOW,
    PRICE_HIGH,
    VOLUME_TRADED,
    TRADES_COUNT
FROM historical_agg;
[0m17:17:20.855874 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:21.519608 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8a40d-0003-65f7-0003-437a001140d2
[0m17:17:21.520480 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 36 at position 19 unexpected ';'.
[0m17:17:21.521144 [debug] [Thread-1 (]: On model.dw_project.bitcoin_aggregated_historical: Close
[0m17:17:21.743349 [debug] [Thread-1 (]: Database Error in model bitcoin_aggregated_historical (models/output/bitcoin_aggregated_historical.sql)
  001003 (42000): SQL compilation error:
  syntax error line 36 at position 19 unexpected ';'.
  compiled code at target/run/dw_project/models/output/bitcoin_aggregated_historical.sql
[0m17:17:21.744713 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34f207ab-853e-418f-9413-924733fa56bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16799f1a0>]}
[0m17:17:21.745890 [error] [Thread-1 (]: 3 of 3 ERROR creating sql table model analytics.bitcoin_aggregated_historical .. [[31mERROR[0m in 0.90s]
[0m17:17:21.746781 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_aggregated_historical
[0m17:17:21.748757 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:17:21.749191 [debug] [MainThread]: Connection 'model.dw_project.bitcoin_aggregated_historical' was properly closed.
[0m17:17:21.749694 [info ] [MainThread]: 
[0m17:17:21.750104 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 6.22 seconds (6.22s).
[0m17:17:21.751319 [debug] [MainThread]: Command end result
[0m17:17:21.774981 [info ] [MainThread]: 
[0m17:17:21.775264 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:17:21.775436 [info ] [MainThread]: 
[0m17:17:21.775651 [error] [MainThread]:   Database Error in model bitcoin_aggregated_historical (models/output/bitcoin_aggregated_historical.sql)
  001003 (42000): SQL compilation error:
  syntax error line 36 at position 19 unexpected ';'.
  compiled code at target/run/dw_project/models/output/bitcoin_aggregated_historical.sql
[0m17:17:21.775821 [info ] [MainThread]: 
[0m17:17:21.776004 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m17:17:21.778077 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 7.261573, "process_user_time": 2.841392, "process_kernel_time": 1.448003, "process_mem_max_rss": "208699392", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:17:21.778378 [debug] [MainThread]: Command `dbt run` failed at 17:17:21.778327 after 7.26 seconds
[0m17:17:21.778580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x167a2b500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11223bd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11223bb00>]}
[0m17:17:21.778758 [debug] [MainThread]: Flushing usage events
[0m17:17:31.425336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123cafc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a54620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a55490>]}


============================== 17:17:31.426513 | 22b4ffa7-104b-417a-abe5-67f2ea568927 ==============================
[0m17:17:31.426513 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:17:31.426779 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'partial_parse': 'True', 'introspect': 'True', 'no_print': 'None', 'warn_error': 'None', 'indirect_selection': 'eager', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'quiet': 'False', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'use_experimental_parser': 'False', 'use_colors': 'True', 'printer_width': '80', 'debug': 'False', 'static_parser': 'True', 'write_json': 'True', 'target_path': 'None', 'empty': 'False', 'invocation_command': 'dbt run', 'fail_fast': 'False'}
[0m17:17:31.891707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '22b4ffa7-104b-417a-abe5-67f2ea568927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15474ec90>]}
[0m17:17:31.908311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '22b4ffa7-104b-417a-abe5-67f2ea568927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125a16a0>]}
[0m17:17:31.908630 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:17:31.915999 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:17:31.962356 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:17:31.962639 [debug] [MainThread]: Partial parsing: updated file: dw_project://models/output/bitcoin_aggregated_historical.sql
[0m17:17:32.041704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '22b4ffa7-104b-417a-abe5-67f2ea568927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x157fe11c0>]}
[0m17:17:32.070979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '22b4ffa7-104b-417a-abe5-67f2ea568927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x157fcab10>]}
[0m17:17:32.071200 [info ] [MainThread]: Found 5 models, 3 sources, 459 macros
[0m17:17:32.071361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22b4ffa7-104b-417a-abe5-67f2ea568927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x157ea4650>]}
[0m17:17:32.072086 [info ] [MainThread]: 
[0m17:17:32.072332 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:17:32.073961 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m17:17:32.078649 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m17:17:32.078779 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m17:17:32.078883 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:17:32.803723 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.725 seconds
[0m17:17:32.807319 [debug] [ThreadPool]: On list_lab2: Close
[0m17:17:33.047063 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m17:17:33.059977 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m17:17:33.060442 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m17:17:33.060727 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:17:33.798382 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.737 seconds
[0m17:17:33.802016 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m17:17:33.983825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22b4ffa7-104b-417a-abe5-67f2ea568927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x157b61190>]}
[0m17:17:33.984939 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m17:17:33.985496 [info ] [MainThread]: 
[0m17:17:33.988595 [debug] [Thread-1 (]: Began running node model.dw_project.avg_price_realtime
[0m17:17:33.989455 [info ] [Thread-1 (]: 1 of 3 START sql table model analytics.avg_price_realtime ...................... [RUN]
[0m17:17:33.990057 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now model.dw_project.avg_price_realtime)
[0m17:17:33.990472 [debug] [Thread-1 (]: Began compiling node model.dw_project.avg_price_realtime
[0m17:17:34.034749 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.avg_price_realtime"
[0m17:17:34.035211 [debug] [Thread-1 (]: Began executing node model.dw_project.avg_price_realtime
[0m17:17:34.046396 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.avg_price_realtime"
[0m17:17:34.046954 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.avg_price_realtime"
[0m17:17:34.047115 [debug] [Thread-1 (]: On model.dw_project.avg_price_realtime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.avg_price_realtime"} */
create or replace transient table lab2.analytics.avg_price_realtime
         as
        (WITH realtime AS (
    SELECT 
        time_open AS time_period_start,
        price_close
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    time_period_start,
    AVG(price_close) OVER (ORDER BY time_period_start ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) AS thirty_min_avg_price
FROM realtime
ORDER BY time_period_start
        );
[0m17:17:34.047256 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:35.839436 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.792 seconds
[0m17:17:35.867778 [debug] [Thread-1 (]: On model.dw_project.avg_price_realtime: Close
[0m17:17:36.075008 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22b4ffa7-104b-417a-abe5-67f2ea568927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102bf6b0>]}
[0m17:17:36.076613 [info ] [Thread-1 (]: 1 of 3 OK created sql table model analytics.avg_price_realtime ................. [[32mSUCCESS 1[0m in 2.08s]
[0m17:17:36.077650 [debug] [Thread-1 (]: Finished running node model.dw_project.avg_price_realtime
[0m17:17:36.078405 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_daily_summary
[0m17:17:36.079191 [info ] [Thread-1 (]: 2 of 3 START sql table model analytics.bitcoin_daily_summary ................... [RUN]
[0m17:17:36.079817 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.avg_price_realtime, now model.dw_project.bitcoin_daily_summary)
[0m17:17:36.080710 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_daily_summary
[0m17:17:36.084528 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_daily_summary"
[0m17:17:36.086571 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_daily_summary
[0m17:17:36.088872 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_daily_summary"
[0m17:17:36.090267 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_daily_summary"
[0m17:17:36.090582 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_daily_summary"} */
create or replace transient table lab2.analytics.bitcoin_daily_summary
         as
        (WITH historical_data AS (
    SELECT
        TIME_PERIOD_START::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_historical
),
realtime_data AS (
    SELECT
        TIME_OPEN::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    date,
    AVG(PRICE_OPEN) AS avg_open,
    AVG(PRICE_HIGH) AS avg_high,
    AVG(PRICE_LOW) AS avg_low,
    AVG(PRICE_CLOSE) AS avg_close,
    SUM(VOLUME_TRADED) AS total_volume,
    SUM(TRADES_COUNT) AS total_trades
FROM (
    SELECT * FROM historical_data
    UNION ALL
    SELECT * FROM realtime_data
) AS combined_data
GROUP BY date
ORDER BY date
        );
[0m17:17:36.090868 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:37.477680 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.387 seconds
[0m17:17:37.481262 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: Close
[0m17:17:37.678470 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22b4ffa7-104b-417a-abe5-67f2ea568927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x157ea0bc0>]}
[0m17:17:37.679640 [info ] [Thread-1 (]: 2 of 3 OK created sql table model analytics.bitcoin_daily_summary .............. [[32mSUCCESS 1[0m in 1.60s]
[0m17:17:37.680588 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_daily_summary
[0m17:17:37.681247 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_historical
[0m17:17:37.681926 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_daily_summary, now model.dw_project.bitcoin_historical)
[0m17:17:37.682532 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_historical
[0m17:17:37.686728 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_historical"
[0m17:17:37.687885 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_historical
[0m17:17:37.688236 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_realtime
[0m17:17:37.688723 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_historical, now model.dw_project.bitcoin_realtime)
[0m17:17:37.689125 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_realtime
[0m17:17:37.691495 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_realtime"
[0m17:17:37.692486 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_realtime
[0m17:17:37.692874 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_aggregated_historical
[0m17:17:37.693325 [info ] [Thread-1 (]: 3 of 3 START sql table model analytics.bitcoin_aggregated_historical ........... [RUN]
[0m17:17:37.693606 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_realtime, now model.dw_project.bitcoin_aggregated_historical)
[0m17:17:37.693751 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_aggregated_historical
[0m17:17:37.696640 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_aggregated_historical"
[0m17:17:37.696964 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_aggregated_historical
[0m17:17:37.698163 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_aggregated_historical"
[0m17:17:37.698780 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_aggregated_historical"
[0m17:17:37.698952 [debug] [Thread-1 (]: On model.dw_project.bitcoin_aggregated_historical: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_aggregated_historical"} */
create or replace transient table lab2.analytics.bitcoin_aggregated_historical
         as
        (-- Aggregated historical data by day from bitcoin_historical table
WITH  __dbt__cte__bitcoin_historical as (
SELECT 
    time_period_start,
    time_period_end,
    time_open,
    time_close,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_historical
WHERE time_period_start IS NOT NULL
), historical_agg AS (
    SELECT 
        DATE(TIME_PERIOD_START) AS DAY, 
        MIN(PRICE_LOW) AS PRICE_LOW,
        MAX(PRICE_HIGH) AS PRICE_HIGH,
        SUM(VOLUME_TRADED) AS VOLUME_TRADED,
        COUNT(TRADES_COUNT) AS TRADES_COUNT
    FROM __dbt__cte__bitcoin_historical  -- Reference the historical table
    GROUP BY DATE(TIME_PERIOD_START)  -- Grouping by day
)

-- Select final result
SELECT 
    DAY,
    PRICE_LOW,
    PRICE_HIGH,
    VOLUME_TRADED,
    TRADES_COUNT
FROM historical_agg
        );
[0m17:17:37.699104 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:39.525655 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.826 seconds
[0m17:17:39.529256 [debug] [Thread-1 (]: On model.dw_project.bitcoin_aggregated_historical: Close
[0m17:17:39.712561 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22b4ffa7-104b-417a-abe5-67f2ea568927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103836e0>]}
[0m17:17:39.713881 [info ] [Thread-1 (]: 3 of 3 OK created sql table model analytics.bitcoin_aggregated_historical ...... [[32mSUCCESS 1[0m in 2.02s]
[0m17:17:39.715024 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_aggregated_historical
[0m17:17:39.716642 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:17:39.717152 [debug] [MainThread]: Connection 'model.dw_project.bitcoin_aggregated_historical' was properly closed.
[0m17:17:39.717703 [info ] [MainThread]: 
[0m17:17:39.718219 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 7.65 seconds (7.65s).
[0m17:17:39.719509 [debug] [MainThread]: Command end result
[0m17:17:39.736693 [info ] [MainThread]: 
[0m17:17:39.736928 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:17:39.737057 [info ] [MainThread]: 
[0m17:17:39.737195 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m17:17:39.738599 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.333841, "process_user_time": 1.734638, "process_kernel_time": 2.619148, "process_mem_max_rss": "211075072", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:17:39.738816 [debug] [MainThread]: Command `dbt run` succeeded at 17:17:39.738779 after 8.33 seconds
[0m17:17:39.738972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112573e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116eaed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116ea420>]}
[0m17:17:39.739107 [debug] [MainThread]: Flushing usage events
[0m17:19:40.232078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e530b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106869400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106869490>]}


============================== 17:19:40.233563 | ca15d84e-1f68-4f7f-b0f7-0ed1e2eca4b1 ==============================
[0m17:19:40.233563 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:19:40.233841 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'debug': 'False', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'log_cache_events': 'False', 'write_json': 'True', 'use_colors': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'cache_selected_only': 'False', 'version_check': 'True', 'printer_width': '80', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'warn_error': 'None', 'indirect_selection': 'eager', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'empty': 'False', 'use_experimental_parser': 'False', 'static_parser': 'True', 'no_print': 'None', 'partial_parse': 'True'}
[0m17:19:41.146540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca15d84e-1f68-4f7f-b0f7-0ed1e2eca4b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10729c230>]}
[0m17:19:41.163666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ca15d84e-1f68-4f7f-b0f7-0ed1e2eca4b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14d49fdd0>]}
[0m17:19:41.164155 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:19:41.173320 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:19:41.227871 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m17:19:41.228134 [debug] [MainThread]: Partial parsing: added file: dw_project://models/output/moving_avg_realtime.sql
[0m17:19:41.309226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca15d84e-1f68-4f7f-b0f7-0ed1e2eca4b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10744d250>]}
[0m17:19:41.344225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca15d84e-1f68-4f7f-b0f7-0ed1e2eca4b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14deceed0>]}
[0m17:19:41.344436 [info ] [MainThread]: Found 6 models, 3 sources, 459 macros
[0m17:19:41.344591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca15d84e-1f68-4f7f-b0f7-0ed1e2eca4b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14dee3500>]}
[0m17:19:41.345342 [info ] [MainThread]: 
[0m17:19:41.345587 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:19:41.347209 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m17:19:41.351947 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m17:19:41.352081 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m17:19:41.352189 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:19:42.094666 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.742 seconds
[0m17:19:42.097519 [debug] [ThreadPool]: On list_lab2: Close
[0m17:19:42.298865 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m17:19:42.311637 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m17:19:42.312060 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m17:19:42.312297 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:19:42.982528 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.670 seconds
[0m17:19:42.986216 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m17:19:43.167134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca15d84e-1f68-4f7f-b0f7-0ed1e2eca4b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14da651f0>]}
[0m17:19:43.168667 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m17:19:43.169573 [info ] [MainThread]: 
[0m17:19:43.174466 [debug] [Thread-1 (]: Began running node model.dw_project.avg_price_realtime
[0m17:19:43.175307 [info ] [Thread-1 (]: 1 of 4 START sql table model analytics.avg_price_realtime ...................... [RUN]
[0m17:19:43.176013 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now model.dw_project.avg_price_realtime)
[0m17:19:43.176487 [debug] [Thread-1 (]: Began compiling node model.dw_project.avg_price_realtime
[0m17:19:43.235545 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.avg_price_realtime"
[0m17:19:43.236097 [debug] [Thread-1 (]: Began executing node model.dw_project.avg_price_realtime
[0m17:19:43.248240 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.avg_price_realtime"
[0m17:19:43.249043 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.avg_price_realtime"
[0m17:19:43.249219 [debug] [Thread-1 (]: On model.dw_project.avg_price_realtime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.avg_price_realtime"} */
create or replace transient table lab2.analytics.avg_price_realtime
         as
        (WITH realtime AS (
    SELECT 
        time_open AS time_period_start,
        price_close
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    time_period_start,
    AVG(price_close) OVER (ORDER BY time_period_start ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) AS thirty_min_avg_price
FROM realtime
ORDER BY time_period_start
        );
[0m17:19:43.249363 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:19:44.993935 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.744 seconds
[0m17:19:45.020994 [debug] [Thread-1 (]: On model.dw_project.avg_price_realtime: Close
[0m17:19:45.191573 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca15d84e-1f68-4f7f-b0f7-0ed1e2eca4b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062cbbf0>]}
[0m17:19:45.193161 [info ] [Thread-1 (]: 1 of 4 OK created sql table model analytics.avg_price_realtime ................. [[32mSUCCESS 1[0m in 2.01s]
[0m17:19:45.194289 [debug] [Thread-1 (]: Finished running node model.dw_project.avg_price_realtime
[0m17:19:45.195028 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_daily_summary
[0m17:19:45.196002 [info ] [Thread-1 (]: 2 of 4 START sql table model analytics.bitcoin_daily_summary ................... [RUN]
[0m17:19:45.196888 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.avg_price_realtime, now model.dw_project.bitcoin_daily_summary)
[0m17:19:45.197360 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_daily_summary
[0m17:19:45.200762 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_daily_summary"
[0m17:19:45.201567 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_daily_summary
[0m17:19:45.203786 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_daily_summary"
[0m17:19:45.205244 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_daily_summary"
[0m17:19:45.205606 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_daily_summary"} */
create or replace transient table lab2.analytics.bitcoin_daily_summary
         as
        (WITH historical_data AS (
    SELECT
        TIME_PERIOD_START::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_historical
),
realtime_data AS (
    SELECT
        TIME_OPEN::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    date,
    AVG(PRICE_OPEN) AS avg_open,
    AVG(PRICE_HIGH) AS avg_high,
    AVG(PRICE_LOW) AS avg_low,
    AVG(PRICE_CLOSE) AS avg_close,
    SUM(VOLUME_TRADED) AS total_volume,
    SUM(TRADES_COUNT) AS total_trades
FROM (
    SELECT * FROM historical_data
    UNION ALL
    SELECT * FROM realtime_data
) AS combined_data
GROUP BY date
ORDER BY date
        );
[0m17:19:45.205941 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:19:47.144866 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.938 seconds
[0m17:19:47.150126 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: Close
[0m17:19:47.375767 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca15d84e-1f68-4f7f-b0f7-0ed1e2eca4b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062cbbf0>]}
[0m17:19:47.377443 [info ] [Thread-1 (]: 2 of 4 OK created sql table model analytics.bitcoin_daily_summary .............. [[32mSUCCESS 1[0m in 2.18s]
[0m17:19:47.378745 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_daily_summary
[0m17:19:47.379618 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_historical
[0m17:19:47.380558 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_daily_summary, now model.dw_project.bitcoin_historical)
[0m17:19:47.381259 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_historical
[0m17:19:47.386262 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_historical"
[0m17:19:47.387809 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_historical
[0m17:19:47.388273 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_realtime
[0m17:19:47.389428 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_historical, now model.dw_project.bitcoin_realtime)
[0m17:19:47.390063 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_realtime
[0m17:19:47.393131 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_realtime"
[0m17:19:47.394721 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_realtime
[0m17:19:47.395127 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_aggregated_historical
[0m17:19:47.395589 [info ] [Thread-1 (]: 3 of 4 START sql table model analytics.bitcoin_aggregated_historical ........... [RUN]
[0m17:19:47.396159 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_realtime, now model.dw_project.bitcoin_aggregated_historical)
[0m17:19:47.396534 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_aggregated_historical
[0m17:19:47.402692 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_aggregated_historical"
[0m17:19:47.403444 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_aggregated_historical
[0m17:19:47.405769 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_aggregated_historical"
[0m17:19:47.406884 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_aggregated_historical"
[0m17:19:47.407158 [debug] [Thread-1 (]: On model.dw_project.bitcoin_aggregated_historical: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_aggregated_historical"} */
create or replace transient table lab2.analytics.bitcoin_aggregated_historical
         as
        (-- Aggregated historical data by day from bitcoin_historical table
WITH  __dbt__cte__bitcoin_historical as (
SELECT 
    time_period_start,
    time_period_end,
    time_open,
    time_close,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_historical
WHERE time_period_start IS NOT NULL
), historical_agg AS (
    SELECT 
        DATE(TIME_PERIOD_START) AS DAY, 
        MIN(PRICE_LOW) AS PRICE_LOW,
        MAX(PRICE_HIGH) AS PRICE_HIGH,
        SUM(VOLUME_TRADED) AS VOLUME_TRADED,
        COUNT(TRADES_COUNT) AS TRADES_COUNT
    FROM __dbt__cte__bitcoin_historical  -- Reference the historical table
    GROUP BY DATE(TIME_PERIOD_START)  -- Grouping by day
)

-- Select final result
SELECT 
    DAY,
    PRICE_LOW,
    PRICE_HIGH,
    VOLUME_TRADED,
    TRADES_COUNT
FROM historical_agg
        );
[0m17:19:47.407418 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:19:48.852445 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.445 seconds
[0m17:19:48.857740 [debug] [Thread-1 (]: On model.dw_project.bitcoin_aggregated_historical: Close
[0m17:19:49.065653 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca15d84e-1f68-4f7f-b0f7-0ed1e2eca4b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14df29940>]}
[0m17:19:49.067394 [info ] [Thread-1 (]: 3 of 4 OK created sql table model analytics.bitcoin_aggregated_historical ...... [[32mSUCCESS 1[0m in 1.67s]
[0m17:19:49.068827 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_aggregated_historical
[0m17:19:49.069717 [debug] [Thread-1 (]: Began running node model.dw_project.moving_avg_realtime
[0m17:19:49.070540 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics.moving_avg_realtime ..................... [RUN]
[0m17:19:49.071208 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_aggregated_historical, now model.dw_project.moving_avg_realtime)
[0m17:19:49.071750 [debug] [Thread-1 (]: Began compiling node model.dw_project.moving_avg_realtime
[0m17:19:49.081481 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.moving_avg_realtime"
[0m17:19:49.082586 [debug] [Thread-1 (]: Began executing node model.dw_project.moving_avg_realtime
[0m17:19:49.085019 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.moving_avg_realtime"
[0m17:19:49.086549 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.moving_avg_realtime"
[0m17:19:49.086932 [debug] [Thread-1 (]: On model.dw_project.moving_avg_realtime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.moving_avg_realtime"} */
create or replace transient table lab2.analytics.moving_avg_realtime
         as
        (-- Calculate moving averages (e.g., 7-day moving average) for real-time data
WITH  __dbt__cte__bitcoin_realtime as (
SELECT 
    time_open,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_realtime
WHERE price_close IS NOT NULL
), real_time_moving_avg AS (
    SELECT
        DATE(TIME_PERIOD_START) AS DAY,
        PRICE_OPEN,
        VOLUME_TRADED,
        AVG(PRICE_OPEN) OVER (ORDER BY TIME_PERIOD_START ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS PRICE_OPEN_7DAY_AVG,
        AVG(VOLUME_TRADED) OVER (ORDER BY TIME_PERIOD_START ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS VOLUME_TRADED_7DAY_AVG
    FROM __dbt__cte__bitcoin_realtime
)

-- Select final result
SELECT 
    DAY,
    PRICE_OPEN,
    VOLUME_TRADED,
    PRICE_OPEN_7DAY_AVG,
    VOLUME_TRADED_7DAY_AVG
FROM real_time_moving_avg
        );
[0m17:19:49.087275 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:19:49.577606 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8a40f-0003-64f2-0003-437a0010d11e
[0m17:19:49.578577 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 17 at position 13
invalid identifier 'TIME_PERIOD_START'
[0m17:19:49.579130 [debug] [Thread-1 (]: On model.dw_project.moving_avg_realtime: Close
[0m17:19:49.766216 [debug] [Thread-1 (]: Database Error in model moving_avg_realtime (models/output/moving_avg_realtime.sql)
  000904 (42000): SQL compilation error: error line 17 at position 13
  invalid identifier 'TIME_PERIOD_START'
  compiled code at target/run/dw_project/models/output/moving_avg_realtime.sql
[0m17:19:49.767443 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca15d84e-1f68-4f7f-b0f7-0ed1e2eca4b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14dcdbf20>]}
[0m17:19:49.768349 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model analytics.moving_avg_realtime ............ [[31mERROR[0m in 0.70s]
[0m17:19:49.769128 [debug] [Thread-1 (]: Finished running node model.dw_project.moving_avg_realtime
[0m17:19:49.770522 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:19:49.770980 [debug] [MainThread]: Connection 'model.dw_project.moving_avg_realtime' was properly closed.
[0m17:19:49.771392 [info ] [MainThread]: 
[0m17:19:49.771807 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 8.43 seconds (8.43s).
[0m17:19:49.772836 [debug] [MainThread]: Command end result
[0m17:19:49.792099 [info ] [MainThread]: 
[0m17:19:49.792333 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:19:49.792467 [info ] [MainThread]: 
[0m17:19:49.792628 [error] [MainThread]:   Database Error in model moving_avg_realtime (models/output/moving_avg_realtime.sql)
  000904 (42000): SQL compilation error: error line 17 at position 13
  invalid identifier 'TIME_PERIOD_START'
  compiled code at target/run/dw_project/models/output/moving_avg_realtime.sql
[0m17:19:49.792828 [info ] [MainThread]: 
[0m17:19:49.793035 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m17:19:49.794728 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 9.586625, "process_user_time": 3.094273, "process_kernel_time": 1.445709, "process_mem_max_rss": "209010688", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:19:49.794961 [debug] [MainThread]: Command `dbt run` failed at 17:19:49.794922 after 9.59 seconds
[0m17:19:49.795144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10345e960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14d51d0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f1ae540>]}
[0m17:19:49.795366 [debug] [MainThread]: Flushing usage events
[0m17:20:55.216967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10704a720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f59490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f59400>]}


============================== 17:20:55.218405 | 25e357cb-933d-43da-9b28-7de0b06b44cc ==============================
[0m17:20:55.218405 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:20:55.218670 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'quiet': 'False', 'log_cache_events': 'False', 'static_parser': 'True', 'printer_width': '80', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'warn_error': 'None', 'log_format': 'default', 'cache_selected_only': 'False', 'target_path': 'None', 'write_json': 'True', 'fail_fast': 'False', 'no_print': 'None', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'partial_parse': 'True', 'invocation_command': 'dbt run', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'empty': 'False', 'debug': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])'}
[0m17:20:55.927735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '25e357cb-933d-43da-9b28-7de0b06b44cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147aa90a0>]}
[0m17:20:55.945139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '25e357cb-933d-43da-9b28-7de0b06b44cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1477aa3c0>]}
[0m17:20:55.945652 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:20:55.954470 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:20:56.007899 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:20:56.008187 [debug] [MainThread]: Partial parsing: updated file: dw_project://models/output/moving_avg_realtime.sql
[0m17:20:56.087974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '25e357cb-933d-43da-9b28-7de0b06b44cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14dff0710>]}
[0m17:20:56.119987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '25e357cb-933d-43da-9b28-7de0b06b44cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e0d71d0>]}
[0m17:20:56.120208 [info ] [MainThread]: Found 6 models, 3 sources, 459 macros
[0m17:20:56.120360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25e357cb-933d-43da-9b28-7de0b06b44cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14daf7a10>]}
[0m17:20:56.121066 [info ] [MainThread]: 
[0m17:20:56.121302 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:20:56.122943 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m17:20:56.127637 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m17:20:56.127770 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m17:20:56.127873 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:20:56.881237 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.752 seconds
[0m17:20:56.884832 [debug] [ThreadPool]: On list_lab2: Close
[0m17:20:57.067613 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m17:20:57.079513 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m17:20:57.079936 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m17:20:57.080209 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:20:57.731433 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.651 seconds
[0m17:20:57.735725 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m17:20:57.933582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25e357cb-933d-43da-9b28-7de0b06b44cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ddad730>]}
[0m17:20:57.934836 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m17:20:57.935411 [info ] [MainThread]: 
[0m17:20:57.940513 [debug] [Thread-1 (]: Began running node model.dw_project.avg_price_realtime
[0m17:20:57.941573 [info ] [Thread-1 (]: 1 of 4 START sql table model analytics.avg_price_realtime ...................... [RUN]
[0m17:20:57.942243 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now model.dw_project.avg_price_realtime)
[0m17:20:57.942660 [debug] [Thread-1 (]: Began compiling node model.dw_project.avg_price_realtime
[0m17:20:57.999777 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.avg_price_realtime"
[0m17:20:58.001271 [debug] [Thread-1 (]: Began executing node model.dw_project.avg_price_realtime
[0m17:20:58.013173 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.avg_price_realtime"
[0m17:20:58.013743 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.avg_price_realtime"
[0m17:20:58.013905 [debug] [Thread-1 (]: On model.dw_project.avg_price_realtime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.avg_price_realtime"} */
create or replace transient table lab2.analytics.avg_price_realtime
         as
        (WITH realtime AS (
    SELECT 
        time_open AS time_period_start,
        price_close
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    time_period_start,
    AVG(price_close) OVER (ORDER BY time_period_start ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) AS thirty_min_avg_price
FROM realtime
ORDER BY time_period_start
        );
[0m17:20:58.014047 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:20:59.822834 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.808 seconds
[0m17:20:59.851067 [debug] [Thread-1 (]: On model.dw_project.avg_price_realtime: Close
[0m17:21:00.027376 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25e357cb-933d-43da-9b28-7de0b06b44cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14dfdc980>]}
[0m17:21:00.028976 [info ] [Thread-1 (]: 1 of 4 OK created sql table model analytics.avg_price_realtime ................. [[32mSUCCESS 1[0m in 2.08s]
[0m17:21:00.030075 [debug] [Thread-1 (]: Finished running node model.dw_project.avg_price_realtime
[0m17:21:00.030736 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_daily_summary
[0m17:21:00.031612 [info ] [Thread-1 (]: 2 of 4 START sql table model analytics.bitcoin_daily_summary ................... [RUN]
[0m17:21:00.032312 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.avg_price_realtime, now model.dw_project.bitcoin_daily_summary)
[0m17:21:00.032826 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_daily_summary
[0m17:21:00.037783 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_daily_summary"
[0m17:21:00.039951 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_daily_summary
[0m17:21:00.043071 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_daily_summary"
[0m17:21:00.044932 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_daily_summary"
[0m17:21:00.045312 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_daily_summary"} */
create or replace transient table lab2.analytics.bitcoin_daily_summary
         as
        (WITH historical_data AS (
    SELECT
        TIME_PERIOD_START::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_historical
),
realtime_data AS (
    SELECT
        TIME_OPEN::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    date,
    AVG(PRICE_OPEN) AS avg_open,
    AVG(PRICE_HIGH) AS avg_high,
    AVG(PRICE_LOW) AS avg_low,
    AVG(PRICE_CLOSE) AS avg_close,
    SUM(VOLUME_TRADED) AS total_volume,
    SUM(TRADES_COUNT) AS total_trades
FROM (
    SELECT * FROM historical_data
    UNION ALL
    SELECT * FROM realtime_data
) AS combined_data
GROUP BY date
ORDER BY date
        );
[0m17:21:00.045655 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:21:01.971603 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.925 seconds
[0m17:21:01.975814 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: Close
[0m17:21:02.182167 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25e357cb-933d-43da-9b28-7de0b06b44cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14dc289e0>]}
[0m17:21:02.183968 [info ] [Thread-1 (]: 2 of 4 OK created sql table model analytics.bitcoin_daily_summary .............. [[32mSUCCESS 1[0m in 2.15s]
[0m17:21:02.185221 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_daily_summary
[0m17:21:02.186029 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_historical
[0m17:21:02.186799 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_daily_summary, now model.dw_project.bitcoin_historical)
[0m17:21:02.187365 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_historical
[0m17:21:02.192050 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_historical"
[0m17:21:02.193635 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_historical
[0m17:21:02.194421 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_realtime
[0m17:21:02.195412 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_historical, now model.dw_project.bitcoin_realtime)
[0m17:21:02.195919 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_realtime
[0m17:21:02.198843 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_realtime"
[0m17:21:02.200129 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_realtime
[0m17:21:02.200518 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_aggregated_historical
[0m17:21:02.200964 [info ] [Thread-1 (]: 3 of 4 START sql table model analytics.bitcoin_aggregated_historical ........... [RUN]
[0m17:21:02.201463 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_realtime, now model.dw_project.bitcoin_aggregated_historical)
[0m17:21:02.201753 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_aggregated_historical
[0m17:21:02.207412 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_aggregated_historical"
[0m17:21:02.207954 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_aggregated_historical
[0m17:21:02.210199 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_aggregated_historical"
[0m17:21:02.211327 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_aggregated_historical"
[0m17:21:02.211620 [debug] [Thread-1 (]: On model.dw_project.bitcoin_aggregated_historical: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_aggregated_historical"} */
create or replace transient table lab2.analytics.bitcoin_aggregated_historical
         as
        (-- Aggregated historical data by day from bitcoin_historical table
WITH  __dbt__cte__bitcoin_historical as (
SELECT 
    time_period_start,
    time_period_end,
    time_open,
    time_close,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_historical
WHERE time_period_start IS NOT NULL
), historical_agg AS (
    SELECT 
        DATE(TIME_PERIOD_START) AS DAY, 
        MIN(PRICE_LOW) AS PRICE_LOW,
        MAX(PRICE_HIGH) AS PRICE_HIGH,
        SUM(VOLUME_TRADED) AS VOLUME_TRADED,
        COUNT(TRADES_COUNT) AS TRADES_COUNT
    FROM __dbt__cte__bitcoin_historical  -- Reference the historical table
    GROUP BY DATE(TIME_PERIOD_START)  -- Grouping by day
)

-- Select final result
SELECT 
    DAY,
    PRICE_LOW,
    PRICE_HIGH,
    VOLUME_TRADED,
    TRADES_COUNT
FROM historical_agg
        );
[0m17:21:02.211890 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:21:03.711305 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.499 seconds
[0m17:21:03.715602 [debug] [Thread-1 (]: On model.dw_project.bitcoin_aggregated_historical: Close
[0m17:21:03.893769 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25e357cb-933d-43da-9b28-7de0b06b44cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110983440>]}
[0m17:21:03.895435 [info ] [Thread-1 (]: 3 of 4 OK created sql table model analytics.bitcoin_aggregated_historical ...... [[32mSUCCESS 1[0m in 1.69s]
[0m17:21:03.896439 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_aggregated_historical
[0m17:21:03.897100 [debug] [Thread-1 (]: Began running node model.dw_project.moving_avg_realtime
[0m17:21:03.897901 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics.moving_avg_realtime ..................... [RUN]
[0m17:21:03.898602 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_aggregated_historical, now model.dw_project.moving_avg_realtime)
[0m17:21:03.899185 [debug] [Thread-1 (]: Began compiling node model.dw_project.moving_avg_realtime
[0m17:21:03.908317 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.moving_avg_realtime"
[0m17:21:03.909286 [debug] [Thread-1 (]: Began executing node model.dw_project.moving_avg_realtime
[0m17:21:03.911684 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.moving_avg_realtime"
[0m17:21:03.913394 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.moving_avg_realtime"
[0m17:21:03.913724 [debug] [Thread-1 (]: On model.dw_project.moving_avg_realtime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.moving_avg_realtime"} */
create or replace transient table lab2.analytics.moving_avg_realtime
         as
        (-- Calculate moving averages (e.g., 7-day moving average) for real-time data
WITH  __dbt__cte__bitcoin_realtime as (
SELECT 
    time_open,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_realtime
WHERE price_close IS NOT NULL
), real_time_moving_avg AS (
    SELECT
        DATE(TIME_OPEN) AS DAY,
        PRICE_OPEN,
        VOLUME_TRADED,
        AVG(PRICE_OPEN) OVER (ORDER BY TIME_OPEN ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS PRICE_OPEN_7DAY_AVG,
        AVG(VOLUME_TRADED) OVER (ORDER BY TIME_OPEN ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS VOLUME_TRADED_7DAY_AVG
    FROM __dbt__cte__bitcoin_realtime
)

-- Select final result
SELECT 
    DAY,
    PRICE_OPEN,
    VOLUME_TRADED,
    PRICE_OPEN_7DAY_AVG,
    VOLUME_TRADED_7DAY_AVG
FROM real_time_moving_avg
        );
[0m17:21:03.914013 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:21:05.665954 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.751 seconds
[0m17:21:05.669779 [debug] [Thread-1 (]: On model.dw_project.moving_avg_realtime: Close
[0m17:21:05.864955 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25e357cb-933d-43da-9b28-7de0b06b44cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14dde6d50>]}
[0m17:21:05.866580 [info ] [Thread-1 (]: 4 of 4 OK created sql table model analytics.moving_avg_realtime ................ [[32mSUCCESS 1[0m in 1.97s]
[0m17:21:05.867543 [debug] [Thread-1 (]: Finished running node model.dw_project.moving_avg_realtime
[0m17:21:05.869591 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:21:05.870210 [debug] [MainThread]: Connection 'model.dw_project.moving_avg_realtime' was properly closed.
[0m17:21:05.870813 [info ] [MainThread]: 
[0m17:21:05.871344 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 9.75 seconds (9.75s).
[0m17:21:05.872777 [debug] [MainThread]: Command end result
[0m17:21:05.901347 [info ] [MainThread]: 
[0m17:21:05.901717 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:21:05.901914 [info ] [MainThread]: 
[0m17:21:05.902125 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m17:21:05.904339 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.710647, "process_user_time": 3.238368, "process_kernel_time": 1.332682, "process_mem_max_rss": "208273408", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:21:05.904659 [debug] [MainThread]: Command `dbt run` succeeded at 17:21:05.904603 after 10.71 seconds
[0m17:21:05.904877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bea240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112277ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fc8dc70>]}
[0m17:21:05.905084 [debug] [MainThread]: Flushing usage events
[0m17:24:18.104375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128cb110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a77d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a77a40>]}


============================== 17:24:18.106203 | 4307b90f-dfa4-4df1-a8fe-bdec11534dab ==============================
[0m17:24:18.106203 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:24:18.106529 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'debug': 'False', 'fail_fast': 'False', 'quiet': 'False', 'use_colors': 'True', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'version_check': 'True', 'log_format': 'default', 'no_print': 'None', 'partial_parse': 'True', 'write_json': 'True', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'use_experimental_parser': 'False'}
[0m17:24:19.142079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4307b90f-dfa4-4df1-a8fe-bdec11534dab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1268acf80>]}
[0m17:24:19.158625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4307b90f-dfa4-4df1-a8fe-bdec11534dab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127bbeed0>]}
[0m17:24:19.159122 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:24:19.168987 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:24:19.224698 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m17:24:19.224969 [debug] [MainThread]: Partial parsing: added file: dw_project://models/output/percentage_change.sql
[0m17:24:19.225095 [debug] [MainThread]: Partial parsing: deleted file: dw_project://models/output/bitcoin_aggregated_historical.sql
[0m17:24:19.310163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4307b90f-dfa4-4df1-a8fe-bdec11534dab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127ba1100>]}
[0m17:24:19.343790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4307b90f-dfa4-4df1-a8fe-bdec11534dab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133bbaf30>]}
[0m17:24:19.344004 [info ] [MainThread]: Found 6 models, 3 sources, 459 macros
[0m17:24:19.344153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4307b90f-dfa4-4df1-a8fe-bdec11534dab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127ba30e0>]}
[0m17:24:19.344854 [info ] [MainThread]: 
[0m17:24:19.345092 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:24:19.346710 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m17:24:19.351510 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m17:24:19.351653 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m17:24:19.351758 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:24:20.430402 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.077 seconds
[0m17:24:20.434024 [debug] [ThreadPool]: On list_lab2: Close
[0m17:24:20.603790 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m17:24:20.618014 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m17:24:20.618614 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m17:24:20.618945 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:24:21.334029 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.715 seconds
[0m17:24:21.339177 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m17:24:21.524819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4307b90f-dfa4-4df1-a8fe-bdec11534dab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127fb1cd0>]}
[0m17:24:21.526293 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m17:24:21.527012 [info ] [MainThread]: 
[0m17:24:21.532232 [debug] [Thread-1 (]: Began running node model.dw_project.avg_price_realtime
[0m17:24:21.533079 [info ] [Thread-1 (]: 1 of 4 START sql table model analytics.avg_price_realtime ...................... [RUN]
[0m17:24:21.533919 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now model.dw_project.avg_price_realtime)
[0m17:24:21.534459 [debug] [Thread-1 (]: Began compiling node model.dw_project.avg_price_realtime
[0m17:24:21.592051 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.avg_price_realtime"
[0m17:24:21.592990 [debug] [Thread-1 (]: Began executing node model.dw_project.avg_price_realtime
[0m17:24:21.605133 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.avg_price_realtime"
[0m17:24:21.605687 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.avg_price_realtime"
[0m17:24:21.605850 [debug] [Thread-1 (]: On model.dw_project.avg_price_realtime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.avg_price_realtime"} */
create or replace transient table lab2.analytics.avg_price_realtime
         as
        (WITH realtime AS (
    SELECT 
        time_open AS time_period_start,
        price_close
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    time_period_start,
    AVG(price_close) OVER (ORDER BY time_period_start ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) AS thirty_min_avg_price
FROM realtime
ORDER BY time_period_start
        );
[0m17:24:21.605991 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:24:23.906811 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.300 seconds
[0m17:24:23.936240 [debug] [Thread-1 (]: On model.dw_project.avg_price_realtime: Close
[0m17:24:24.160973 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4307b90f-dfa4-4df1-a8fe-bdec11534dab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133bd1130>]}
[0m17:24:24.162575 [info ] [Thread-1 (]: 1 of 4 OK created sql table model analytics.avg_price_realtime ................. [[32mSUCCESS 1[0m in 2.63s]
[0m17:24:24.163444 [debug] [Thread-1 (]: Finished running node model.dw_project.avg_price_realtime
[0m17:24:24.163996 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_daily_summary
[0m17:24:24.164838 [info ] [Thread-1 (]: 2 of 4 START sql table model analytics.bitcoin_daily_summary ................... [RUN]
[0m17:24:24.165421 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.avg_price_realtime, now model.dw_project.bitcoin_daily_summary)
[0m17:24:24.165831 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_daily_summary
[0m17:24:24.170347 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_daily_summary"
[0m17:24:24.171838 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_daily_summary
[0m17:24:24.174200 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_daily_summary"
[0m17:24:24.175986 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_daily_summary"
[0m17:24:24.176480 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_daily_summary"} */
create or replace transient table lab2.analytics.bitcoin_daily_summary
         as
        (WITH historical_data AS (
    SELECT
        TIME_PERIOD_START::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_historical
),
realtime_data AS (
    SELECT
        TIME_OPEN::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    date,
    AVG(PRICE_OPEN) AS avg_open,
    AVG(PRICE_HIGH) AS avg_high,
    AVG(PRICE_LOW) AS avg_low,
    AVG(PRICE_CLOSE) AS avg_close,
    SUM(VOLUME_TRADED) AS total_volume,
    SUM(TRADES_COUNT) AS total_trades
FROM (
    SELECT * FROM historical_data
    UNION ALL
    SELECT * FROM realtime_data
) AS combined_data
GROUP BY date
ORDER BY date
        );
[0m17:24:24.176744 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:24:26.670744 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.494 seconds
[0m17:24:26.675156 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: Close
[0m17:24:26.872630 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4307b90f-dfa4-4df1-a8fe-bdec11534dab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127b2cad0>]}
[0m17:24:26.873781 [info ] [Thread-1 (]: 2 of 4 OK created sql table model analytics.bitcoin_daily_summary .............. [[32mSUCCESS 1[0m in 2.71s]
[0m17:24:26.874661 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_daily_summary
[0m17:24:26.875276 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_historical
[0m17:24:26.875967 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_daily_summary, now model.dw_project.bitcoin_historical)
[0m17:24:26.876554 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_historical
[0m17:24:26.880854 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_historical"
[0m17:24:26.882533 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_historical
[0m17:24:26.883227 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_realtime
[0m17:24:26.883867 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_historical, now model.dw_project.bitcoin_realtime)
[0m17:24:26.884294 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_realtime
[0m17:24:26.887036 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_realtime"
[0m17:24:26.888229 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_realtime
[0m17:24:26.888968 [debug] [Thread-1 (]: Began running node model.dw_project.moving_avg_realtime
[0m17:24:26.889315 [info ] [Thread-1 (]: 3 of 4 START sql table model analytics.moving_avg_realtime ..................... [RUN]
[0m17:24:26.889548 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_realtime, now model.dw_project.moving_avg_realtime)
[0m17:24:26.889699 [debug] [Thread-1 (]: Began compiling node model.dw_project.moving_avg_realtime
[0m17:24:26.893220 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.moving_avg_realtime"
[0m17:24:26.893975 [debug] [Thread-1 (]: Began executing node model.dw_project.moving_avg_realtime
[0m17:24:26.895432 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.moving_avg_realtime"
[0m17:24:26.896148 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.moving_avg_realtime"
[0m17:24:26.896320 [debug] [Thread-1 (]: On model.dw_project.moving_avg_realtime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.moving_avg_realtime"} */
create or replace transient table lab2.analytics.moving_avg_realtime
         as
        (-- Calculate moving averages (e.g., 7-day moving average) for real-time data
WITH  __dbt__cte__bitcoin_realtime as (
SELECT 
    time_open,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_realtime
WHERE price_close IS NOT NULL
), real_time_moving_avg AS (
    SELECT
        DATE(TIME_OPEN) AS DAY,
        PRICE_OPEN,
        VOLUME_TRADED,
        AVG(PRICE_OPEN) OVER (ORDER BY TIME_OPEN ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS PRICE_OPEN_7DAY_AVG,
        AVG(VOLUME_TRADED) OVER (ORDER BY TIME_OPEN ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS VOLUME_TRADED_7DAY_AVG
    FROM __dbt__cte__bitcoin_realtime
)

-- Select final result
SELECT 
    DAY,
    PRICE_OPEN,
    VOLUME_TRADED,
    PRICE_OPEN_7DAY_AVG,
    VOLUME_TRADED_7DAY_AVG
FROM real_time_moving_avg
        );
[0m17:24:26.896470 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:24:28.718829 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.822 seconds
[0m17:24:28.722581 [debug] [Thread-1 (]: On model.dw_project.moving_avg_realtime: Close
[0m17:24:28.934542 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4307b90f-dfa4-4df1-a8fe-bdec11534dab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133c19220>]}
[0m17:24:28.936010 [info ] [Thread-1 (]: 3 of 4 OK created sql table model analytics.moving_avg_realtime ................ [[32mSUCCESS 1[0m in 2.04s]
[0m17:24:28.936923 [debug] [Thread-1 (]: Finished running node model.dw_project.moving_avg_realtime
[0m17:24:28.937499 [debug] [Thread-1 (]: Began running node model.dw_project.percentage_change
[0m17:24:28.938168 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics.percentage_change ....................... [RUN]
[0m17:24:28.938799 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.moving_avg_realtime, now model.dw_project.percentage_change)
[0m17:24:28.939239 [debug] [Thread-1 (]: Began compiling node model.dw_project.percentage_change
[0m17:24:28.949497 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.percentage_change"
[0m17:24:28.950476 [debug] [Thread-1 (]: Began executing node model.dw_project.percentage_change
[0m17:24:28.952591 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.percentage_change"
[0m17:24:28.954027 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.percentage_change"
[0m17:24:28.954361 [debug] [Thread-1 (]: On model.dw_project.percentage_change: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.percentage_change"} */
create or replace transient table lab2.analytics.percentage_change
         as
        (-- Calculate percentage change for PRICE_CLOSE and VOLUME_TRADED for real-time data
WITH  __dbt__cte__bitcoin_realtime as (
SELECT 
    time_open,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_realtime
WHERE price_close IS NOT NULL
), real_time_pct_change AS (
    SELECT
        DATE(TIME_PERIOD_START) AS DAY,
        PRICE_CLOSE,
        VOLUME_TRADED,
        LAG(PRICE_CLOSE) OVER (ORDER BY TIME_PERIOD_START) AS PREV_PRICE_CLOSE,
        LAG(VOLUME_TRADED) OVER (ORDER BY TIME_PERIOD_START) AS PREV_VOLUME_TRADED
    FROM __dbt__cte__bitcoin_realtime
)

-- Select final result with percentage change
SELECT 
    DAY,
    PRICE_CLOSE,
    VOLUME_TRADED,
    CASE 
        WHEN PREV_PRICE_CLOSE IS NULL THEN NULL
        ELSE (PRICE_CLOSE - PREV_PRICE_CLOSE) / PREV_PRICE_CLOSE * 100
    END AS PERCENTAGE_CHANGE_PRICE,
    CASE 
        WHEN PREV_VOLUME_TRADED IS NULL THEN NULL
        ELSE (VOLUME_TRADED - PREV_VOLUME_TRADED) / PREV_VOLUME_TRADED * 100
    END AS PERCENTAGE_CHANGE_VOLUME
FROM real_time_pct_change;
[0m17:24:28.954664 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:24:29.576676 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8a414-0003-65f7-0003-437a001140fa
[0m17:24:29.577271 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 38 at position 25 unexpected ';'.
[0m17:24:29.577793 [debug] [Thread-1 (]: On model.dw_project.percentage_change: Close
[0m17:24:29.757857 [debug] [Thread-1 (]: Database Error in model percentage_change (models/output/percentage_change.sql)
  001003 (42000): SQL compilation error:
  syntax error line 38 at position 25 unexpected ';'.
  compiled code at target/run/dw_project/models/output/percentage_change.sql
[0m17:24:29.758698 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4307b90f-dfa4-4df1-a8fe-bdec11534dab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133c193a0>]}
[0m17:24:29.759597 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model analytics.percentage_change .............. [[31mERROR[0m in 0.82s]
[0m17:24:29.760481 [debug] [Thread-1 (]: Finished running node model.dw_project.percentage_change
[0m17:24:29.761745 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:24:29.762131 [debug] [MainThread]: Connection 'model.dw_project.percentage_change' was properly closed.
[0m17:24:29.762587 [info ] [MainThread]: 
[0m17:24:29.762995 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 10.42 seconds (10.42s).
[0m17:24:29.764190 [debug] [MainThread]: Command end result
[0m17:24:29.779894 [info ] [MainThread]: 
[0m17:24:29.780192 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:24:29.780333 [info ] [MainThread]: 
[0m17:24:29.780501 [error] [MainThread]:   Database Error in model percentage_change (models/output/percentage_change.sql)
  001003 (42000): SQL compilation error:
  syntax error line 38 at position 25 unexpected ';'.
  compiled code at target/run/dw_project/models/output/percentage_change.sql
[0m17:24:29.780625 [info ] [MainThread]: 
[0m17:24:29.780762 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m17:24:29.782413 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 11.704205, "process_user_time": 2.278653, "process_kernel_time": 2.496974, "process_mem_max_rss": "208224256", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:24:29.782711 [debug] [MainThread]: Command `dbt run` failed at 17:24:29.782667 after 11.70 seconds
[0m17:24:29.782887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128ca900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a77a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127efc800>]}
[0m17:24:29.783047 [debug] [MainThread]: Flushing usage events
[0m17:24:45.868893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b8fe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045a01d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045a14c0>]}


============================== 17:24:45.870656 | db2479a0-b0cc-455c-91ed-cd54d9516d77 ==============================
[0m17:24:45.870656 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:24:45.870952 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'indirect_selection': 'eager', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'debug': 'False', 'use_colors': 'True', 'invocation_command': 'dbt run', 'no_print': 'None', 'log_cache_events': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'version_check': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'write_json': 'True', 'empty': 'False'}
[0m17:24:46.623209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'db2479a0-b0cc-455c-91ed-cd54d9516d77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x148a5b920>]}
[0m17:24:46.639993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'db2479a0-b0cc-455c-91ed-cd54d9516d77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x148fa2ae0>]}
[0m17:24:46.640428 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:24:46.650834 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:24:46.704223 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:24:46.704540 [debug] [MainThread]: Partial parsing: updated file: dw_project://models/output/percentage_change.sql
[0m17:24:46.787004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'db2479a0-b0cc-455c-91ed-cd54d9516d77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x148bb78c0>]}
[0m17:24:46.819238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'db2479a0-b0cc-455c-91ed-cd54d9516d77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1495d6e40>]}
[0m17:24:46.819458 [info ] [MainThread]: Found 6 models, 3 sources, 459 macros
[0m17:24:46.819600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db2479a0-b0cc-455c-91ed-cd54d9516d77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14949d010>]}
[0m17:24:46.820332 [info ] [MainThread]: 
[0m17:24:46.820572 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:24:46.822216 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m17:24:46.827003 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m17:24:46.827145 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m17:24:46.827253 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:24:47.591092 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.762 seconds
[0m17:24:47.594682 [debug] [ThreadPool]: On list_lab2: Close
[0m17:24:47.813420 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m17:24:47.825497 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m17:24:47.826009 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m17:24:47.826288 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:24:48.586613 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.760 seconds
[0m17:24:48.591725 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m17:24:48.818240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db2479a0-b0cc-455c-91ed-cd54d9516d77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1491961e0>]}
[0m17:24:48.819172 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m17:24:48.819715 [info ] [MainThread]: 
[0m17:24:48.824019 [debug] [Thread-1 (]: Began running node model.dw_project.avg_price_realtime
[0m17:24:48.824736 [info ] [Thread-1 (]: 1 of 4 START sql table model analytics.avg_price_realtime ...................... [RUN]
[0m17:24:48.825307 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now model.dw_project.avg_price_realtime)
[0m17:24:48.825724 [debug] [Thread-1 (]: Began compiling node model.dw_project.avg_price_realtime
[0m17:24:48.866851 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.avg_price_realtime"
[0m17:24:48.867402 [debug] [Thread-1 (]: Began executing node model.dw_project.avg_price_realtime
[0m17:24:48.878194 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.avg_price_realtime"
[0m17:24:48.878750 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.avg_price_realtime"
[0m17:24:48.878920 [debug] [Thread-1 (]: On model.dw_project.avg_price_realtime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.avg_price_realtime"} */
create or replace transient table lab2.analytics.avg_price_realtime
         as
        (WITH realtime AS (
    SELECT 
        time_open AS time_period_start,
        price_close
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    time_period_start,
    AVG(price_close) OVER (ORDER BY time_period_start ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) AS thirty_min_avg_price
FROM realtime
ORDER BY time_period_start
        );
[0m17:24:48.879061 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:24:50.223416 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.344 seconds
[0m17:24:50.252183 [debug] [Thread-1 (]: On model.dw_project.avg_price_realtime: Close
[0m17:24:50.443513 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db2479a0-b0cc-455c-91ed-cd54d9516d77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1497ac140>]}
[0m17:24:50.445276 [info ] [Thread-1 (]: 1 of 4 OK created sql table model analytics.avg_price_realtime ................. [[32mSUCCESS 1[0m in 1.62s]
[0m17:24:50.446498 [debug] [Thread-1 (]: Finished running node model.dw_project.avg_price_realtime
[0m17:24:50.447154 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_daily_summary
[0m17:24:50.448033 [info ] [Thread-1 (]: 2 of 4 START sql table model analytics.bitcoin_daily_summary ................... [RUN]
[0m17:24:50.448722 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.avg_price_realtime, now model.dw_project.bitcoin_daily_summary)
[0m17:24:50.449320 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_daily_summary
[0m17:24:50.454434 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_daily_summary"
[0m17:24:50.455527 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_daily_summary
[0m17:24:50.458329 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_daily_summary"
[0m17:24:50.459832 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_daily_summary"
[0m17:24:50.460220 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_daily_summary"} */
create or replace transient table lab2.analytics.bitcoin_daily_summary
         as
        (WITH historical_data AS (
    SELECT
        TIME_PERIOD_START::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_historical
),
realtime_data AS (
    SELECT
        TIME_OPEN::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    date,
    AVG(PRICE_OPEN) AS avg_open,
    AVG(PRICE_HIGH) AS avg_high,
    AVG(PRICE_LOW) AS avg_low,
    AVG(PRICE_CLOSE) AS avg_close,
    SUM(VOLUME_TRADED) AS total_volume,
    SUM(TRADES_COUNT) AS total_trades
FROM (
    SELECT * FROM historical_data
    UNION ALL
    SELECT * FROM realtime_data
) AS combined_data
GROUP BY date
ORDER BY date
        );
[0m17:24:50.460558 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:24:52.171056 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.710 seconds
[0m17:24:52.176493 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: Close
[0m17:24:52.351914 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db2479a0-b0cc-455c-91ed-cd54d9516d77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1494b2e70>]}
[0m17:24:52.353626 [info ] [Thread-1 (]: 2 of 4 OK created sql table model analytics.bitcoin_daily_summary .............. [[32mSUCCESS 1[0m in 1.90s]
[0m17:24:52.354912 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_daily_summary
[0m17:24:52.355926 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_historical
[0m17:24:52.357053 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_daily_summary, now model.dw_project.bitcoin_historical)
[0m17:24:52.357781 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_historical
[0m17:24:52.362662 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_historical"
[0m17:24:52.364132 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_historical
[0m17:24:52.364876 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_realtime
[0m17:24:52.365645 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_historical, now model.dw_project.bitcoin_realtime)
[0m17:24:52.366200 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_realtime
[0m17:24:52.369086 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_realtime"
[0m17:24:52.370341 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_realtime
[0m17:24:52.371353 [debug] [Thread-1 (]: Began running node model.dw_project.moving_avg_realtime
[0m17:24:52.371943 [info ] [Thread-1 (]: 3 of 4 START sql table model analytics.moving_avg_realtime ..................... [RUN]
[0m17:24:52.372461 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_realtime, now model.dw_project.moving_avg_realtime)
[0m17:24:52.372786 [debug] [Thread-1 (]: Began compiling node model.dw_project.moving_avg_realtime
[0m17:24:52.378750 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.moving_avg_realtime"
[0m17:24:52.379484 [debug] [Thread-1 (]: Began executing node model.dw_project.moving_avg_realtime
[0m17:24:52.381666 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.moving_avg_realtime"
[0m17:24:52.382691 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.moving_avg_realtime"
[0m17:24:52.382945 [debug] [Thread-1 (]: On model.dw_project.moving_avg_realtime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.moving_avg_realtime"} */
create or replace transient table lab2.analytics.moving_avg_realtime
         as
        (-- Calculate moving averages (e.g., 7-day moving average) for real-time data
WITH  __dbt__cte__bitcoin_realtime as (
SELECT 
    time_open,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_realtime
WHERE price_close IS NOT NULL
), real_time_moving_avg AS (
    SELECT
        DATE(TIME_OPEN) AS DAY,
        PRICE_OPEN,
        VOLUME_TRADED,
        AVG(PRICE_OPEN) OVER (ORDER BY TIME_OPEN ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS PRICE_OPEN_7DAY_AVG,
        AVG(VOLUME_TRADED) OVER (ORDER BY TIME_OPEN ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS VOLUME_TRADED_7DAY_AVG
    FROM __dbt__cte__bitcoin_realtime
)

-- Select final result
SELECT 
    DAY,
    PRICE_OPEN,
    VOLUME_TRADED,
    PRICE_OPEN_7DAY_AVG,
    VOLUME_TRADED_7DAY_AVG
FROM real_time_moving_avg
        );
[0m17:24:52.383202 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:24:53.910373 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.527 seconds
[0m17:24:53.914728 [debug] [Thread-1 (]: On model.dw_project.moving_avg_realtime: Close
[0m17:24:54.103694 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db2479a0-b0cc-455c-91ed-cd54d9516d77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1497e9250>]}
[0m17:24:54.105345 [info ] [Thread-1 (]: 3 of 4 OK created sql table model analytics.moving_avg_realtime ................ [[32mSUCCESS 1[0m in 1.73s]
[0m17:24:54.106339 [debug] [Thread-1 (]: Finished running node model.dw_project.moving_avg_realtime
[0m17:24:54.106982 [debug] [Thread-1 (]: Began running node model.dw_project.percentage_change
[0m17:24:54.107747 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics.percentage_change ....................... [RUN]
[0m17:24:54.108423 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.moving_avg_realtime, now model.dw_project.percentage_change)
[0m17:24:54.108917 [debug] [Thread-1 (]: Began compiling node model.dw_project.percentage_change
[0m17:24:54.119970 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.percentage_change"
[0m17:24:54.121077 [debug] [Thread-1 (]: Began executing node model.dw_project.percentage_change
[0m17:24:54.123618 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.percentage_change"
[0m17:24:54.125331 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.percentage_change"
[0m17:24:54.125655 [debug] [Thread-1 (]: On model.dw_project.percentage_change: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.percentage_change"} */
create or replace transient table lab2.analytics.percentage_change
         as
        (-- Calculate percentage change for PRICE_CLOSE and VOLUME_TRADED for real-time data
WITH  __dbt__cte__bitcoin_realtime as (
SELECT 
    time_open,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_realtime
WHERE price_close IS NOT NULL
), real_time_pct_change AS (
    SELECT
        DATE(TIME_PERIOD_START) AS DAY,
        PRICE_CLOSE,
        VOLUME_TRADED,
        LAG(PRICE_CLOSE) OVER (ORDER BY TIME_PERIOD_START) AS PREV_PRICE_CLOSE,
        LAG(VOLUME_TRADED) OVER (ORDER BY TIME_PERIOD_START) AS PREV_VOLUME_TRADED
    FROM __dbt__cte__bitcoin_realtime
)

-- Select final result with percentage change
SELECT 
    DAY,
    PRICE_CLOSE,
    VOLUME_TRADED,
    CASE 
        WHEN PREV_PRICE_CLOSE IS NULL THEN NULL
        ELSE (PRICE_CLOSE - PREV_PRICE_CLOSE) / PREV_PRICE_CLOSE * 100
    END AS PERCENTAGE_CHANGE_PRICE,
    CASE 
        WHEN PREV_VOLUME_TRADED IS NULL THEN NULL
        ELSE (VOLUME_TRADED - PREV_VOLUME_TRADED) / PREV_VOLUME_TRADED * 100
    END AS PERCENTAGE_CHANGE_VOLUME
FROM real_time_pct_change
        );
[0m17:24:54.125947 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:24:54.815768 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8a414-0003-65f7-0003-437a001140fe
[0m17:24:54.816719 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 17 at position 13
invalid identifier 'TIME_PERIOD_START'
[0m17:24:54.817417 [debug] [Thread-1 (]: On model.dw_project.percentage_change: Close
[0m17:24:54.998870 [debug] [Thread-1 (]: Database Error in model percentage_change (models/output/percentage_change.sql)
  000904 (42000): SQL compilation error: error line 17 at position 13
  invalid identifier 'TIME_PERIOD_START'
  compiled code at target/run/dw_project/models/output/percentage_change.sql
[0m17:24:54.999640 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db2479a0-b0cc-455c-91ed-cd54d9516d77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105577b90>]}
[0m17:24:55.000539 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model analytics.percentage_change .............. [[31mERROR[0m in 0.89s]
[0m17:24:55.001312 [debug] [Thread-1 (]: Finished running node model.dw_project.percentage_change
[0m17:24:55.002489 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:24:55.002800 [debug] [MainThread]: Connection 'model.dw_project.percentage_change' was properly closed.
[0m17:24:55.003138 [info ] [MainThread]: 
[0m17:24:55.003475 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 8.18 seconds (8.18s).
[0m17:24:55.004494 [debug] [MainThread]: Command end result
[0m17:24:55.024066 [info ] [MainThread]: 
[0m17:24:55.024363 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:24:55.024524 [info ] [MainThread]: 
[0m17:24:55.024717 [error] [MainThread]:   Database Error in model percentage_change (models/output/percentage_change.sql)
  000904 (42000): SQL compilation error: error line 17 at position 13
  invalid identifier 'TIME_PERIOD_START'
  compiled code at target/run/dw_project/models/output/percentage_change.sql
[0m17:24:55.024876 [info ] [MainThread]: 
[0m17:24:55.025037 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m17:24:55.026863 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 9.183672, "process_user_time": 2.933661, "process_kernel_time": 1.625136, "process_mem_max_rss": "208011264", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:24:55.027224 [debug] [MainThread]: Command `dbt run` failed at 17:24:55.027166 after 9.18 seconds
[0m17:24:55.027440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1491e4d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1494b03b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1494b3080>]}
[0m17:24:55.027631 [debug] [MainThread]: Flushing usage events
[0m17:25:33.070080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1137cb110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113977fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113977cb0>]}


============================== 17:25:33.071549 | 3b00aeb7-12c4-4a24-9d24-a1cd659087a6 ==============================
[0m17:25:33.071549 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:25:33.071837 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'warn_error': 'None', 'quiet': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'use_colors': 'True', 'log_format': 'default', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'static_parser': 'True', 'empty': 'False', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'introspect': 'True', 'printer_width': '80', 'cache_selected_only': 'False', 'target_path': 'None', 'fail_fast': 'False', 'partial_parse': 'True', 'log_cache_events': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:25:33.599320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b00aeb7-12c4-4a24-9d24-a1cd659087a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d2cc80>]}
[0m17:25:33.616956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3b00aeb7-12c4-4a24-9d24-a1cd659087a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1137fb950>]}
[0m17:25:33.617316 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:25:33.624521 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:25:33.673670 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:25:33.673957 [debug] [MainThread]: Partial parsing: updated file: dw_project://models/output/percentage_change.sql
[0m17:25:33.758069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3b00aeb7-12c4-4a24-9d24-a1cd659087a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1658e11c0>]}
[0m17:25:33.791207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3b00aeb7-12c4-4a24-9d24-a1cd659087a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1658d2720>]}
[0m17:25:33.791432 [info ] [MainThread]: Found 6 models, 3 sources, 459 macros
[0m17:25:33.791586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b00aeb7-12c4-4a24-9d24-a1cd659087a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16549d790>]}
[0m17:25:33.792321 [info ] [MainThread]: 
[0m17:25:33.792569 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:25:33.794244 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m17:25:33.799105 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m17:25:33.799244 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m17:25:33.799351 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:25:34.441132 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.642 seconds
[0m17:25:34.443137 [debug] [ThreadPool]: On list_lab2: Close
[0m17:25:34.624470 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m17:25:34.637631 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m17:25:34.638169 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m17:25:34.638454 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:25:35.486305 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.847 seconds
[0m17:25:35.491300 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m17:25:35.696507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b00aeb7-12c4-4a24-9d24-a1cd659087a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x163897230>]}
[0m17:25:35.698016 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m17:25:35.698768 [info ] [MainThread]: 
[0m17:25:35.703436 [debug] [Thread-1 (]: Began running node model.dw_project.avg_price_realtime
[0m17:25:35.704545 [info ] [Thread-1 (]: 1 of 4 START sql table model analytics.avg_price_realtime ...................... [RUN]
[0m17:25:35.705225 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now model.dw_project.avg_price_realtime)
[0m17:25:35.705682 [debug] [Thread-1 (]: Began compiling node model.dw_project.avg_price_realtime
[0m17:25:35.766131 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.avg_price_realtime"
[0m17:25:35.766678 [debug] [Thread-1 (]: Began executing node model.dw_project.avg_price_realtime
[0m17:25:35.778689 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.avg_price_realtime"
[0m17:25:35.779261 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.avg_price_realtime"
[0m17:25:35.779426 [debug] [Thread-1 (]: On model.dw_project.avg_price_realtime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.avg_price_realtime"} */
create or replace transient table lab2.analytics.avg_price_realtime
         as
        (WITH realtime AS (
    SELECT 
        time_open AS time_period_start,
        price_close
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    time_period_start,
    AVG(price_close) OVER (ORDER BY time_period_start ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) AS thirty_min_avg_price
FROM realtime
ORDER BY time_period_start
        );
[0m17:25:35.779576 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:25:37.329133 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.549 seconds
[0m17:25:37.349594 [debug] [Thread-1 (]: On model.dw_project.avg_price_realtime: Close
[0m17:25:37.539681 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b00aeb7-12c4-4a24-9d24-a1cd659087a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x165a25eb0>]}
[0m17:25:37.541868 [info ] [Thread-1 (]: 1 of 4 OK created sql table model analytics.avg_price_realtime ................. [[32mSUCCESS 1[0m in 1.83s]
[0m17:25:37.543439 [debug] [Thread-1 (]: Finished running node model.dw_project.avg_price_realtime
[0m17:25:37.544253 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_daily_summary
[0m17:25:37.545141 [info ] [Thread-1 (]: 2 of 4 START sql table model analytics.bitcoin_daily_summary ................... [RUN]
[0m17:25:37.545858 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.avg_price_realtime, now model.dw_project.bitcoin_daily_summary)
[0m17:25:37.546363 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_daily_summary
[0m17:25:37.551207 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_daily_summary"
[0m17:25:37.552162 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_daily_summary
[0m17:25:37.554939 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_daily_summary"
[0m17:25:37.556469 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_daily_summary"
[0m17:25:37.556834 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_daily_summary"} */
create or replace transient table lab2.analytics.bitcoin_daily_summary
         as
        (WITH historical_data AS (
    SELECT
        TIME_PERIOD_START::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_historical
),
realtime_data AS (
    SELECT
        TIME_OPEN::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    date,
    AVG(PRICE_OPEN) AS avg_open,
    AVG(PRICE_HIGH) AS avg_high,
    AVG(PRICE_LOW) AS avg_low,
    AVG(PRICE_CLOSE) AS avg_close,
    SUM(VOLUME_TRADED) AS total_volume,
    SUM(TRADES_COUNT) AS total_trades
FROM (
    SELECT * FROM historical_data
    UNION ALL
    SELECT * FROM realtime_data
) AS combined_data
GROUP BY date
ORDER BY date
        );
[0m17:25:37.557179 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:25:39.375677 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.818 seconds
[0m17:25:39.380077 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: Close
[0m17:25:39.563454 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b00aeb7-12c4-4a24-9d24-a1cd659087a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x165adda00>]}
[0m17:25:39.564839 [info ] [Thread-1 (]: 2 of 4 OK created sql table model analytics.bitcoin_daily_summary .............. [[32mSUCCESS 1[0m in 2.02s]
[0m17:25:39.566458 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_daily_summary
[0m17:25:39.567243 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_historical
[0m17:25:39.568057 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_daily_summary, now model.dw_project.bitcoin_historical)
[0m17:25:39.568725 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_historical
[0m17:25:39.572571 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_historical"
[0m17:25:39.573658 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_historical
[0m17:25:39.574057 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_realtime
[0m17:25:39.574440 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_historical, now model.dw_project.bitcoin_realtime)
[0m17:25:39.574783 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_realtime
[0m17:25:39.577193 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_realtime"
[0m17:25:39.578043 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_realtime
[0m17:25:39.578678 [debug] [Thread-1 (]: Began running node model.dw_project.moving_avg_realtime
[0m17:25:39.579056 [info ] [Thread-1 (]: 3 of 4 START sql table model analytics.moving_avg_realtime ..................... [RUN]
[0m17:25:39.579300 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_realtime, now model.dw_project.moving_avg_realtime)
[0m17:25:39.579480 [debug] [Thread-1 (]: Began compiling node model.dw_project.moving_avg_realtime
[0m17:25:39.583229 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.moving_avg_realtime"
[0m17:25:39.583550 [debug] [Thread-1 (]: Began executing node model.dw_project.moving_avg_realtime
[0m17:25:39.584977 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.moving_avg_realtime"
[0m17:25:39.585718 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.moving_avg_realtime"
[0m17:25:39.585902 [debug] [Thread-1 (]: On model.dw_project.moving_avg_realtime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.moving_avg_realtime"} */
create or replace transient table lab2.analytics.moving_avg_realtime
         as
        (-- Calculate moving averages (e.g., 7-day moving average) for real-time data
WITH  __dbt__cte__bitcoin_realtime as (
SELECT 
    time_open,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_realtime
WHERE price_close IS NOT NULL
), real_time_moving_avg AS (
    SELECT
        DATE(TIME_OPEN) AS DAY,
        PRICE_OPEN,
        VOLUME_TRADED,
        AVG(PRICE_OPEN) OVER (ORDER BY TIME_OPEN ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS PRICE_OPEN_7DAY_AVG,
        AVG(VOLUME_TRADED) OVER (ORDER BY TIME_OPEN ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS VOLUME_TRADED_7DAY_AVG
    FROM __dbt__cte__bitcoin_realtime
)

-- Select final result
SELECT 
    DAY,
    PRICE_OPEN,
    VOLUME_TRADED,
    PRICE_OPEN_7DAY_AVG,
    VOLUME_TRADED_7DAY_AVG
FROM real_time_moving_avg
        );
[0m17:25:39.586072 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:25:41.012304 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.426 seconds
[0m17:25:41.015980 [debug] [Thread-1 (]: On model.dw_project.moving_avg_realtime: Close
[0m17:25:41.195998 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b00aeb7-12c4-4a24-9d24-a1cd659087a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120835c0>]}
[0m17:25:41.197825 [info ] [Thread-1 (]: 3 of 4 OK created sql table model analytics.moving_avg_realtime ................ [[32mSUCCESS 1[0m in 1.62s]
[0m17:25:41.199151 [debug] [Thread-1 (]: Finished running node model.dw_project.moving_avg_realtime
[0m17:25:41.199979 [debug] [Thread-1 (]: Began running node model.dw_project.percentage_change
[0m17:25:41.200979 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics.percentage_change ....................... [RUN]
[0m17:25:41.201828 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.moving_avg_realtime, now model.dw_project.percentage_change)
[0m17:25:41.202446 [debug] [Thread-1 (]: Began compiling node model.dw_project.percentage_change
[0m17:25:41.213478 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.percentage_change"
[0m17:25:41.214349 [debug] [Thread-1 (]: Began executing node model.dw_project.percentage_change
[0m17:25:41.216737 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.percentage_change"
[0m17:25:41.218253 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.percentage_change"
[0m17:25:41.218577 [debug] [Thread-1 (]: On model.dw_project.percentage_change: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.percentage_change"} */
create or replace transient table lab2.analytics.percentage_change
         as
        (-- Calculate percentage change for PRICE_CLOSE and VOLUME_TRADED for real-time data
WITH  __dbt__cte__bitcoin_realtime as (
SELECT 
    time_open,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_realtime
WHERE price_close IS NOT NULL
), real_time_pct_change AS (
    SELECT
        DATE(TIME_OPEN) AS DAY,
        PRICE_CLOSE,
        VOLUME_TRADED,
        LAG(PRICE_CLOSE) OVER (ORDER BY TIME_OPEN) AS PREV_PRICE_CLOSE,
        LAG(VOLUME_TRADED) OVER (ORDER BY TIME_OPEN) AS PREV_VOLUME_TRADED
    FROM __dbt__cte__bitcoin_realtime
)

-- Select final result with percentage change
SELECT 
    DAY,
    PRICE_CLOSE,
    VOLUME_TRADED,
    CASE 
        WHEN PREV_PRICE_CLOSE IS NULL THEN NULL
        ELSE (PRICE_CLOSE - PREV_PRICE_CLOSE) / PREV_PRICE_CLOSE * 100
    END AS PERCENTAGE_CHANGE_PRICE,
    CASE 
        WHEN PREV_VOLUME_TRADED IS NULL THEN NULL
        ELSE (VOLUME_TRADED - PREV_VOLUME_TRADED) / PREV_VOLUME_TRADED * 100
    END AS PERCENTAGE_CHANGE_VOLUME
FROM real_time_pct_change
        );
[0m17:25:41.218872 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:25:43.377683 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.158 seconds
[0m17:25:43.381158 [debug] [Thread-1 (]: On model.dw_project.percentage_change: Close
[0m17:25:43.589707 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b00aeb7-12c4-4a24-9d24-a1cd659087a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16554b710>]}
[0m17:25:43.591250 [info ] [Thread-1 (]: 4 of 4 OK created sql table model analytics.percentage_change .................. [[32mSUCCESS 1[0m in 2.39s]
[0m17:25:43.592195 [debug] [Thread-1 (]: Finished running node model.dw_project.percentage_change
[0m17:25:43.594051 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:25:43.594466 [debug] [MainThread]: Connection 'model.dw_project.percentage_change' was properly closed.
[0m17:25:43.594927 [info ] [MainThread]: 
[0m17:25:43.595328 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 9.80 seconds (9.80s).
[0m17:25:43.596862 [debug] [MainThread]: Command end result
[0m17:25:43.620914 [info ] [MainThread]: 
[0m17:25:43.621211 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:25:43.621397 [info ] [MainThread]: 
[0m17:25:43.621592 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m17:25:43.623517 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.576015, "process_user_time": 2.211576, "process_kernel_time": 2.280391, "process_mem_max_rss": "207421440", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:25:43.623845 [debug] [MainThread]: Command `dbt run` succeeded at 17:25:43.623781 after 10.58 seconds
[0m17:25:43.624063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11392b260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132ea480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x165925eb0>]}
[0m17:25:43.624262 [debug] [MainThread]: Flushing usage events
[0m17:29:37.005777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d0f4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108173c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108173950>]}


============================== 17:29:37.007768 | a3a5f31a-861e-4deb-9fb8-90ed0ef26b73 ==============================
[0m17:29:37.007768 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:29:37.008132 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'printer_width': '80', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error': 'None', 'fail_fast': 'False', 'cache_selected_only': 'False', 'target_path': 'None', 'log_format': 'default', 'partial_parse': 'True', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'log_cache_events': 'False', 'use_colors': 'True', 'quiet': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'empty': 'False', 'introspect': 'True', 'debug': 'False', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'no_print': 'None'}
[0m17:29:37.976225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a3a5f31a-861e-4deb-9fb8-90ed0ef26b73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f2176b0>]}
[0m17:29:37.992782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a3a5f31a-861e-4deb-9fb8-90ed0ef26b73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085a3830>]}
[0m17:29:37.993253 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:29:38.001762 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:29:38.056428 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:29:38.056715 [debug] [MainThread]: Partial parsing: updated file: dw_project://models/output/percentage_change.sql
[0m17:29:38.143054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a3a5f31a-861e-4deb-9fb8-90ed0ef26b73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f9ed820>]}
[0m17:29:38.183011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a3a5f31a-861e-4deb-9fb8-90ed0ef26b73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f9d6f90>]}
[0m17:29:38.183355 [info ] [MainThread]: Found 6 models, 3 sources, 459 macros
[0m17:29:38.183531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3a5f31a-861e-4deb-9fb8-90ed0ef26b73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108144440>]}
[0m17:29:38.184383 [info ] [MainThread]: 
[0m17:29:38.184664 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:29:38.186611 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m17:29:38.192224 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m17:29:38.192443 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m17:29:38.192570 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:29:39.028738 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.836 seconds
[0m17:29:39.031827 [debug] [ThreadPool]: On list_lab2: Close
[0m17:29:39.226582 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m17:29:39.240013 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m17:29:39.240518 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m17:29:39.240800 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:29:39.901571 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.661 seconds
[0m17:29:39.904751 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m17:29:40.094358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3a5f31a-861e-4deb-9fb8-90ed0ef26b73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c65f2f0>]}
[0m17:29:40.095490 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m17:29:40.096007 [info ] [MainThread]: 
[0m17:29:40.100632 [debug] [Thread-1 (]: Began running node model.dw_project.avg_price_realtime
[0m17:29:40.101352 [info ] [Thread-1 (]: 1 of 4 START sql table model analytics.avg_price_realtime ...................... [RUN]
[0m17:29:40.101985 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dw_project.avg_price_realtime'
[0m17:29:40.102355 [debug] [Thread-1 (]: Began compiling node model.dw_project.avg_price_realtime
[0m17:29:40.158409 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.avg_price_realtime"
[0m17:29:40.160704 [debug] [Thread-1 (]: Began executing node model.dw_project.avg_price_realtime
[0m17:29:40.172695 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.avg_price_realtime"
[0m17:29:40.173678 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.avg_price_realtime"
[0m17:29:40.173907 [debug] [Thread-1 (]: On model.dw_project.avg_price_realtime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.avg_price_realtime"} */
create or replace transient table lab2.analytics.avg_price_realtime
         as
        (WITH realtime AS (
    SELECT 
        time_open AS time_period_start,
        price_close
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    time_period_start,
    AVG(price_close) OVER (ORDER BY time_period_start ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) AS thirty_min_avg_price
FROM realtime
ORDER BY time_period_start
        );
[0m17:29:40.174073 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:29:42.167796 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.993 seconds
[0m17:29:42.192651 [debug] [Thread-1 (]: On model.dw_project.avg_price_realtime: Close
[0m17:29:42.376047 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3a5f31a-861e-4deb-9fb8-90ed0ef26b73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13fbdf9b0>]}
[0m17:29:42.377842 [info ] [Thread-1 (]: 1 of 4 OK created sql table model analytics.avg_price_realtime ................. [[32mSUCCESS 1[0m in 2.27s]
[0m17:29:42.379241 [debug] [Thread-1 (]: Finished running node model.dw_project.avg_price_realtime
[0m17:29:42.380479 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_daily_summary
[0m17:29:42.381526 [info ] [Thread-1 (]: 2 of 4 START sql table model analytics.bitcoin_daily_summary ................... [RUN]
[0m17:29:42.382280 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.avg_price_realtime, now model.dw_project.bitcoin_daily_summary)
[0m17:29:42.382838 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_daily_summary
[0m17:29:42.387866 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_daily_summary"
[0m17:29:42.389719 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_daily_summary
[0m17:29:42.392611 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_daily_summary"
[0m17:29:42.394115 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_daily_summary"
[0m17:29:42.394494 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_daily_summary"} */
create or replace transient table lab2.analytics.bitcoin_daily_summary
         as
        (WITH historical_data AS (
    SELECT
        TIME_PERIOD_START::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_historical
),
realtime_data AS (
    SELECT
        TIME_OPEN::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    date,
    AVG(PRICE_OPEN) AS avg_open,
    AVG(PRICE_HIGH) AS avg_high,
    AVG(PRICE_LOW) AS avg_low,
    AVG(PRICE_CLOSE) AS avg_close,
    SUM(VOLUME_TRADED) AS total_volume,
    SUM(TRADES_COUNT) AS total_trades
FROM (
    SELECT * FROM historical_data
    UNION ALL
    SELECT * FROM realtime_data
) AS combined_data
GROUP BY date
ORDER BY date
        );
[0m17:29:42.394836 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:29:44.216225 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.821 seconds
[0m17:29:44.220256 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: Close
[0m17:29:44.404853 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3a5f31a-861e-4deb-9fb8-90ed0ef26b73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f8aecf0>]}
[0m17:29:44.406454 [info ] [Thread-1 (]: 2 of 4 OK created sql table model analytics.bitcoin_daily_summary .............. [[32mSUCCESS 1[0m in 2.02s]
[0m17:29:44.407494 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_daily_summary
[0m17:29:44.408196 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_historical
[0m17:29:44.408988 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_daily_summary, now model.dw_project.bitcoin_historical)
[0m17:29:44.409757 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_historical
[0m17:29:44.415308 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_historical"
[0m17:29:44.417294 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_historical
[0m17:29:44.417704 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_realtime
[0m17:29:44.418096 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_historical, now model.dw_project.bitcoin_realtime)
[0m17:29:44.418400 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_realtime
[0m17:29:44.421296 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_realtime"
[0m17:29:44.423494 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_realtime
[0m17:29:44.424714 [debug] [Thread-1 (]: Began running node model.dw_project.moving_avg_realtime
[0m17:29:44.425295 [info ] [Thread-1 (]: 3 of 4 START sql table model analytics.moving_avg_realtime ..................... [RUN]
[0m17:29:44.425753 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_realtime, now model.dw_project.moving_avg_realtime)
[0m17:29:44.426072 [debug] [Thread-1 (]: Began compiling node model.dw_project.moving_avg_realtime
[0m17:29:44.432385 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.moving_avg_realtime"
[0m17:29:44.433079 [debug] [Thread-1 (]: Began executing node model.dw_project.moving_avg_realtime
[0m17:29:44.435400 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.moving_avg_realtime"
[0m17:29:44.436478 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.moving_avg_realtime"
[0m17:29:44.436736 [debug] [Thread-1 (]: On model.dw_project.moving_avg_realtime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.moving_avg_realtime"} */
create or replace transient table lab2.analytics.moving_avg_realtime
         as
        (-- Calculate moving averages (e.g., 7-day moving average) for real-time data
WITH  __dbt__cte__bitcoin_realtime as (
SELECT 
    time_open,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_realtime
WHERE price_close IS NOT NULL
), real_time_moving_avg AS (
    SELECT
        DATE(TIME_OPEN) AS DAY,
        PRICE_OPEN,
        VOLUME_TRADED,
        AVG(PRICE_OPEN) OVER (ORDER BY TIME_OPEN ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS PRICE_OPEN_7DAY_AVG,
        AVG(VOLUME_TRADED) OVER (ORDER BY TIME_OPEN ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS VOLUME_TRADED_7DAY_AVG
    FROM __dbt__cte__bitcoin_realtime
)

-- Select final result
SELECT 
    DAY,
    PRICE_OPEN,
    VOLUME_TRADED,
    PRICE_OPEN_7DAY_AVG,
    VOLUME_TRADED_7DAY_AVG
FROM real_time_moving_avg
        );
[0m17:29:44.436980 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:29:46.444164 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.007 seconds
[0m17:29:46.449006 [debug] [Thread-1 (]: On model.dw_project.moving_avg_realtime: Close
[0m17:29:46.620504 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3a5f31a-861e-4deb-9fb8-90ed0ef26b73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13fa2b620>]}
[0m17:29:46.622067 [info ] [Thread-1 (]: 3 of 4 OK created sql table model analytics.moving_avg_realtime ................ [[32mSUCCESS 1[0m in 2.19s]
[0m17:29:46.622984 [debug] [Thread-1 (]: Finished running node model.dw_project.moving_avg_realtime
[0m17:29:46.623614 [debug] [Thread-1 (]: Began running node model.dw_project.percentage_change
[0m17:29:46.624348 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics.percentage_change ....................... [RUN]
[0m17:29:46.625009 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.moving_avg_realtime, now model.dw_project.percentage_change)
[0m17:29:46.625490 [debug] [Thread-1 (]: Began compiling node model.dw_project.percentage_change
[0m17:29:46.639229 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.percentage_change"
[0m17:29:46.640075 [debug] [Thread-1 (]: Began executing node model.dw_project.percentage_change
[0m17:29:46.642230 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.percentage_change"
[0m17:29:46.643753 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.percentage_change"
[0m17:29:46.644101 [debug] [Thread-1 (]: On model.dw_project.percentage_change: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.percentage_change"} */
create or replace transient table lab2.analytics.percentage_change
         as
        (-- Calculate percentage change for PRICE_CLOSE and VOLUME_TRADED for real-time data, grouped by day
WITH  __dbt__cte__bitcoin_realtime as (
SELECT 
    time_open,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_realtime
WHERE price_close IS NOT NULL
), real_time_pct_change AS (
    SELECT
        DATE(TIME_OPEN) AS DAY,
        PRICE_CLOSE,
        VOLUME_TRADED,
        LAG(PRICE_CLOSE) OVER (PARTITION BY DATE(TIME_OPEN) ORDER BY TIME_OPEN) AS PREV_PRICE_CLOSE,
        LAG(VOLUME_TRADED) OVER (PARTITION BY DATE(TIME_OPEN) ORDER BY TIME_OPEN) AS PREV_VOLUME_TRADED
    FROM __dbt__cte__bitcoin_realtime
)

-- Select final result with percentage change, grouped by day
SELECT 
    DAY,
    MAX(PRICE_CLOSE) AS PRICE_CLOSE,  -- To display the latest PRICE_CLOSE for each day
    MAX(VOLUME_TRADED) AS VOLUME_TRADED,  -- To display the latest VOLUME_TRADED for each day
    CASE 
        WHEN MAX(PREV_PRICE_CLOSE) IS NULL THEN NULL
        ELSE (MAX(PRICE_CLOSE) - MAX(PREV_PRICE_CLOSE)) / MAX(PREV_PRICE_CLOSE) * 100
    END AS PERCENTAGE_CHANGE_PRICE,
    CASE 
        WHEN MAX(PREV_VOLUME_TRADED) IS NULL THEN NULL
        ELSE (MAX(VOLUME_TRADED) - MAX(PREV_VOLUME_TRADED)) / MAX(PREV_VOLUME_TRADED) * 100
    END AS PERCENTAGE_CHANGE_VOLUME
FROM real_time_pct_change
GROUP BY DAY
ORDER BY DAY;
[0m17:29:46.644411 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:29:47.284272 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8a419-0003-6460-0003-437a0010b1a6
[0m17:29:47.285210 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 40 at position 12 unexpected ';'.
[0m17:29:47.285840 [debug] [Thread-1 (]: On model.dw_project.percentage_change: Close
[0m17:29:47.481943 [debug] [Thread-1 (]: Database Error in model percentage_change (models/output/percentage_change.sql)
  001003 (42000): SQL compilation error:
  syntax error line 40 at position 12 unexpected ';'.
  compiled code at target/run/dw_project/models/output/percentage_change.sql
[0m17:29:47.483153 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3a5f31a-861e-4deb-9fb8-90ed0ef26b73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f3dca10>]}
[0m17:29:47.484352 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model analytics.percentage_change .............. [[31mERROR[0m in 0.86s]
[0m17:29:47.485178 [debug] [Thread-1 (]: Finished running node model.dw_project.percentage_change
[0m17:29:47.486689 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:29:47.487077 [debug] [MainThread]: Connection 'list_lab2_analytics' was properly closed.
[0m17:29:47.487332 [debug] [MainThread]: Connection 'model.dw_project.percentage_change' was properly closed.
[0m17:29:47.487731 [info ] [MainThread]: 
[0m17:29:47.488094 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 9.30 seconds (9.30s).
[0m17:29:47.489184 [debug] [MainThread]: Command end result
[0m17:29:47.510892 [info ] [MainThread]: 
[0m17:29:47.511226 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:29:47.511424 [info ] [MainThread]: 
[0m17:29:47.511656 [error] [MainThread]:   Database Error in model percentage_change (models/output/percentage_change.sql)
  001003 (42000): SQL compilation error:
  syntax error line 40 at position 12 unexpected ';'.
  compiled code at target/run/dw_project/models/output/percentage_change.sql
[0m17:29:47.511840 [info ] [MainThread]: 
[0m17:29:47.512035 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m17:29:47.514186 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 10.53695, "process_user_time": 2.503252, "process_kernel_time": 2.21295, "process_mem_max_rss": "208322560", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:29:47.514529 [debug] [MainThread]: Command `dbt run` failed at 17:29:47.514473 after 10.54 seconds
[0m17:29:47.514754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f9d8e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108173bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13fbdd790>]}
[0m17:29:47.514966 [debug] [MainThread]: Flushing usage events
[0m17:29:57.413842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071476b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106df8c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062493d0>]}


============================== 17:29:57.415185 | 5b47a3ff-209d-4bd8-84ca-a3f2a1fb6393 ==============================
[0m17:29:57.415185 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:29:57.415461 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'partial_parse': 'True', 'debug': 'False', 'use_colors': 'True', 'log_cache_events': 'False', 'write_json': 'True', 'empty': 'False', 'printer_width': '80', 'cache_selected_only': 'False', 'introspect': 'True', 'use_experimental_parser': 'False', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_format': 'default', 'no_print': 'None', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'target_path': 'None'}
[0m17:29:57.949864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5b47a3ff-209d-4bd8-84ca-a3f2a1fb6393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13eadf2c0>]}
[0m17:29:57.966790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5b47a3ff-209d-4bd8-84ca-a3f2a1fb6393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fc6a20>]}
[0m17:29:57.967970 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:29:57.976010 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:29:58.029814 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:29:58.030100 [debug] [MainThread]: Partial parsing: updated file: dw_project://models/output/percentage_change.sql
[0m17:29:58.110575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5b47a3ff-209d-4bd8-84ca-a3f2a1fb6393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ebae0c0>]}
[0m17:29:58.143098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5b47a3ff-209d-4bd8-84ca-a3f2a1fb6393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155537020>]}
[0m17:29:58.143313 [info ] [MainThread]: Found 6 models, 3 sources, 459 macros
[0m17:29:58.143454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b47a3ff-209d-4bd8-84ca-a3f2a1fb6393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13eb23bc0>]}
[0m17:29:58.144178 [info ] [MainThread]: 
[0m17:29:58.144418 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:29:58.146046 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m17:29:58.150755 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m17:29:58.150892 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m17:29:58.150995 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:29:58.914777 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.763 seconds
[0m17:29:58.918714 [debug] [ThreadPool]: On list_lab2: Close
[0m17:29:59.119205 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m17:29:59.131959 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m17:29:59.132396 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m17:29:59.132672 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:29:59.865267 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.732 seconds
[0m17:29:59.868787 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m17:30:00.054751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b47a3ff-209d-4bd8-84ca-a3f2a1fb6393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1538ad850>]}
[0m17:30:00.055737 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m17:30:00.056303 [info ] [MainThread]: 
[0m17:30:00.059464 [debug] [Thread-1 (]: Began running node model.dw_project.avg_price_realtime
[0m17:30:00.060368 [info ] [Thread-1 (]: 1 of 4 START sql table model analytics.avg_price_realtime ...................... [RUN]
[0m17:30:00.061085 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now model.dw_project.avg_price_realtime)
[0m17:30:00.061591 [debug] [Thread-1 (]: Began compiling node model.dw_project.avg_price_realtime
[0m17:30:00.105748 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.avg_price_realtime"
[0m17:30:00.106533 [debug] [Thread-1 (]: Began executing node model.dw_project.avg_price_realtime
[0m17:30:00.117710 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.avg_price_realtime"
[0m17:30:00.118307 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.avg_price_realtime"
[0m17:30:00.118464 [debug] [Thread-1 (]: On model.dw_project.avg_price_realtime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.avg_price_realtime"} */
create or replace transient table lab2.analytics.avg_price_realtime
         as
        (WITH realtime AS (
    SELECT 
        time_open AS time_period_start,
        price_close
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    time_period_start,
    AVG(price_close) OVER (ORDER BY time_period_start ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) AS thirty_min_avg_price
FROM realtime
ORDER BY time_period_start
        );
[0m17:30:00.118609 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:30:02.341119 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.222 seconds
[0m17:30:02.369878 [debug] [Thread-1 (]: On model.dw_project.avg_price_realtime: Close
[0m17:30:02.598867 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b47a3ff-209d-4bd8-84ca-a3f2a1fb6393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e899eb0>]}
[0m17:30:02.600733 [info ] [Thread-1 (]: 1 of 4 OK created sql table model analytics.avg_price_realtime ................. [[32mSUCCESS 1[0m in 2.54s]
[0m17:30:02.601960 [debug] [Thread-1 (]: Finished running node model.dw_project.avg_price_realtime
[0m17:30:02.602775 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_daily_summary
[0m17:30:02.603728 [info ] [Thread-1 (]: 2 of 4 START sql table model analytics.bitcoin_daily_summary ................... [RUN]
[0m17:30:02.604508 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.avg_price_realtime, now model.dw_project.bitcoin_daily_summary)
[0m17:30:02.605021 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_daily_summary
[0m17:30:02.609377 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_daily_summary"
[0m17:30:02.611476 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_daily_summary
[0m17:30:02.614073 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_daily_summary"
[0m17:30:02.615601 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_daily_summary"
[0m17:30:02.615988 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_daily_summary"} */
create or replace transient table lab2.analytics.bitcoin_daily_summary
         as
        (WITH historical_data AS (
    SELECT
        TIME_PERIOD_START::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_historical
),
realtime_data AS (
    SELECT
        TIME_OPEN::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    date,
    AVG(PRICE_OPEN) AS avg_open,
    AVG(PRICE_HIGH) AS avg_high,
    AVG(PRICE_LOW) AS avg_low,
    AVG(PRICE_CLOSE) AS avg_close,
    SUM(VOLUME_TRADED) AS total_volume,
    SUM(TRADES_COUNT) AS total_trades
FROM (
    SELECT * FROM historical_data
    UNION ALL
    SELECT * FROM realtime_data
) AS combined_data
GROUP BY date
ORDER BY date
        );
[0m17:30:02.616343 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:30:05.105685 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.489 seconds
[0m17:30:05.110324 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: Close
[0m17:30:05.305682 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b47a3ff-209d-4bd8-84ca-a3f2a1fb6393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15389eb70>]}
[0m17:30:05.307181 [info ] [Thread-1 (]: 2 of 4 OK created sql table model analytics.bitcoin_daily_summary .............. [[32mSUCCESS 1[0m in 2.70s]
[0m17:30:05.308213 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_daily_summary
[0m17:30:05.308826 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_historical
[0m17:30:05.309565 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_daily_summary, now model.dw_project.bitcoin_historical)
[0m17:30:05.310029 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_historical
[0m17:30:05.313947 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_historical"
[0m17:30:05.315345 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_historical
[0m17:30:05.315804 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_realtime
[0m17:30:05.316359 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_historical, now model.dw_project.bitcoin_realtime)
[0m17:30:05.316833 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_realtime
[0m17:30:05.319205 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_realtime"
[0m17:30:05.320060 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_realtime
[0m17:30:05.320912 [debug] [Thread-1 (]: Began running node model.dw_project.moving_avg_realtime
[0m17:30:05.321302 [info ] [Thread-1 (]: 3 of 4 START sql table model analytics.moving_avg_realtime ..................... [RUN]
[0m17:30:05.321612 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_realtime, now model.dw_project.moving_avg_realtime)
[0m17:30:05.321855 [debug] [Thread-1 (]: Began compiling node model.dw_project.moving_avg_realtime
[0m17:30:05.327394 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.moving_avg_realtime"
[0m17:30:05.327844 [debug] [Thread-1 (]: Began executing node model.dw_project.moving_avg_realtime
[0m17:30:05.329906 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.moving_avg_realtime"
[0m17:30:05.330928 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.moving_avg_realtime"
[0m17:30:05.331198 [debug] [Thread-1 (]: On model.dw_project.moving_avg_realtime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.moving_avg_realtime"} */
create or replace transient table lab2.analytics.moving_avg_realtime
         as
        (-- Calculate moving averages (e.g., 7-day moving average) for real-time data
WITH  __dbt__cte__bitcoin_realtime as (
SELECT 
    time_open,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_realtime
WHERE price_close IS NOT NULL
), real_time_moving_avg AS (
    SELECT
        DATE(TIME_OPEN) AS DAY,
        PRICE_OPEN,
        VOLUME_TRADED,
        AVG(PRICE_OPEN) OVER (ORDER BY TIME_OPEN ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS PRICE_OPEN_7DAY_AVG,
        AVG(VOLUME_TRADED) OVER (ORDER BY TIME_OPEN ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS VOLUME_TRADED_7DAY_AVG
    FROM __dbt__cte__bitcoin_realtime
)

-- Select final result
SELECT 
    DAY,
    PRICE_OPEN,
    VOLUME_TRADED,
    PRICE_OPEN_7DAY_AVG,
    VOLUME_TRADED_7DAY_AVG
FROM real_time_moving_avg
        );
[0m17:30:05.331443 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:30:07.564599 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.233 seconds
[0m17:30:07.568374 [debug] [Thread-1 (]: On model.dw_project.moving_avg_realtime: Close
[0m17:30:07.769713 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b47a3ff-209d-4bd8-84ca-a3f2a1fb6393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15572d610>]}
[0m17:30:07.770993 [info ] [Thread-1 (]: 3 of 4 OK created sql table model analytics.moving_avg_realtime ................ [[32mSUCCESS 1[0m in 2.45s]
[0m17:30:07.772155 [debug] [Thread-1 (]: Finished running node model.dw_project.moving_avg_realtime
[0m17:30:07.772938 [debug] [Thread-1 (]: Began running node model.dw_project.percentage_change
[0m17:30:07.774018 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics.percentage_change ....................... [RUN]
[0m17:30:07.774827 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.moving_avg_realtime, now model.dw_project.percentage_change)
[0m17:30:07.775445 [debug] [Thread-1 (]: Began compiling node model.dw_project.percentage_change
[0m17:30:07.786750 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.percentage_change"
[0m17:30:07.787460 [debug] [Thread-1 (]: Began executing node model.dw_project.percentage_change
[0m17:30:07.788592 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.percentage_change"
[0m17:30:07.789370 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.percentage_change"
[0m17:30:07.789560 [debug] [Thread-1 (]: On model.dw_project.percentage_change: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.percentage_change"} */
create or replace transient table lab2.analytics.percentage_change
         as
        (-- Calculate percentage change for PRICE_CLOSE and VOLUME_TRADED for real-time data, grouped by day
WITH  __dbt__cte__bitcoin_realtime as (
SELECT 
    time_open,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_realtime
WHERE price_close IS NOT NULL
), real_time_pct_change AS (
    SELECT
        DATE(TIME_OPEN) AS DAY,
        PRICE_CLOSE,
        VOLUME_TRADED,
        LAG(PRICE_CLOSE) OVER (PARTITION BY DATE(TIME_OPEN) ORDER BY TIME_OPEN) AS PREV_PRICE_CLOSE,
        LAG(VOLUME_TRADED) OVER (PARTITION BY DATE(TIME_OPEN) ORDER BY TIME_OPEN) AS PREV_VOLUME_TRADED
    FROM __dbt__cte__bitcoin_realtime
)

-- Select final result with percentage change, grouped by day
SELECT 
    DAY,
    MAX(PRICE_CLOSE) AS PRICE_CLOSE,  -- To display the latest PRICE_CLOSE for each day
    MAX(VOLUME_TRADED) AS VOLUME_TRADED,  -- To display the latest VOLUME_TRADED for each day
    CASE 
        WHEN MAX(PREV_PRICE_CLOSE) IS NULL THEN NULL
        ELSE (MAX(PRICE_CLOSE) - MAX(PREV_PRICE_CLOSE)) / MAX(PREV_PRICE_CLOSE) * 100
    END AS PERCENTAGE_CHANGE_PRICE,
    CASE 
        WHEN MAX(PREV_VOLUME_TRADED) IS NULL THEN NULL
        ELSE (MAX(VOLUME_TRADED) - MAX(PREV_VOLUME_TRADED)) / MAX(PREV_VOLUME_TRADED) * 100
    END AS PERCENTAGE_CHANGE_VOLUME
FROM real_time_pct_change
GROUP BY DAY
ORDER BY DAY
        );
[0m17:30:07.789718 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:30:10.227316 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.437 seconds
[0m17:30:10.231868 [debug] [Thread-1 (]: On model.dw_project.percentage_change: Close
[0m17:30:10.497257 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b47a3ff-209d-4bd8-84ca-a3f2a1fb6393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15572c8c0>]}
[0m17:30:10.499388 [info ] [Thread-1 (]: 4 of 4 OK created sql table model analytics.percentage_change .................. [[32mSUCCESS 1[0m in 2.72s]
[0m17:30:10.500257 [debug] [Thread-1 (]: Finished running node model.dw_project.percentage_change
[0m17:30:10.501504 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:30:10.501884 [debug] [MainThread]: Connection 'model.dw_project.percentage_change' was properly closed.
[0m17:30:10.502257 [info ] [MainThread]: 
[0m17:30:10.502559 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 12.36 seconds (12.36s).
[0m17:30:10.503338 [debug] [MainThread]: Command end result
[0m17:30:10.523427 [info ] [MainThread]: 
[0m17:30:10.523665 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:30:10.523827 [info ] [MainThread]: 
[0m17:30:10.524006 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m17:30:10.526089 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.134243, "process_user_time": 2.659818, "process_kernel_time": 1.75124, "process_mem_max_rss": "208060416", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:30:10.526408 [debug] [MainThread]: Command `dbt run` succeeded at 17:30:10.526355 after 13.13 seconds
[0m17:30:10.526613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107294e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107263ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1538dc7d0>]}
[0m17:30:10.526803 [debug] [MainThread]: Flushing usage events
[0m17:31:33.424628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a045700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109859310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109859400>]}


============================== 17:31:33.426370 | bb58e935-f2ad-45a5-aa04-9209fcf8392d ==============================
[0m17:31:33.426370 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:31:33.426695 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'debug': 'False', 'version_check': 'True', 'target_path': 'None', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'warn_error': 'None', 'introspect': 'True', 'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'quiet': 'False', 'use_experimental_parser': 'False', 'static_parser': 'True', 'no_print': 'None', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'log_format': 'default', 'empty': 'False', 'invocation_command': 'dbt run', 'cache_selected_only': 'False', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project'}
[0m17:31:34.386951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb58e935-f2ad-45a5-aa04-9209fcf8392d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab2bc50>]}
[0m17:31:34.403861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb58e935-f2ad-45a5-aa04-9209fcf8392d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a045580>]}
[0m17:31:34.404344 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:31:34.412115 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:31:34.468013 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:31:34.468290 [debug] [MainThread]: Partial parsing: updated file: dw_project://models/output/percentage_change.sql
[0m17:31:34.551468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb58e935-f2ad-45a5-aa04-9209fcf8392d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ebe55e0>]}
[0m17:31:34.587239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb58e935-f2ad-45a5-aa04-9209fcf8392d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ebceed0>]}
[0m17:31:34.587461 [info ] [MainThread]: Found 6 models, 3 sources, 459 macros
[0m17:31:34.587607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb58e935-f2ad-45a5-aa04-9209fcf8392d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a4c320>]}
[0m17:31:34.588331 [info ] [MainThread]: 
[0m17:31:34.588574 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:31:34.590227 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m17:31:34.594995 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m17:31:34.595137 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m17:31:34.595252 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:31:35.355983 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.760 seconds
[0m17:31:35.359386 [debug] [ThreadPool]: On list_lab2: Close
[0m17:31:35.542776 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m17:31:35.554157 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m17:31:35.554548 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m17:31:35.554813 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:31:36.152749 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.598 seconds
[0m17:31:36.157051 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m17:31:36.382525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb58e935-f2ad-45a5-aa04-9209fcf8392d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ebdf080>]}
[0m17:31:36.384071 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m17:31:36.384884 [info ] [MainThread]: 
[0m17:31:36.390183 [debug] [Thread-1 (]: Began running node model.dw_project.avg_price_realtime
[0m17:31:36.391241 [info ] [Thread-1 (]: 1 of 4 START sql table model analytics.avg_price_realtime ...................... [RUN]
[0m17:31:36.392035 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now model.dw_project.avg_price_realtime)
[0m17:31:36.392534 [debug] [Thread-1 (]: Began compiling node model.dw_project.avg_price_realtime
[0m17:31:36.451852 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.avg_price_realtime"
[0m17:31:36.454080 [debug] [Thread-1 (]: Began executing node model.dw_project.avg_price_realtime
[0m17:31:36.466065 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.avg_price_realtime"
[0m17:31:36.466857 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.avg_price_realtime"
[0m17:31:36.467057 [debug] [Thread-1 (]: On model.dw_project.avg_price_realtime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.avg_price_realtime"} */
create or replace transient table lab2.analytics.avg_price_realtime
         as
        (WITH realtime AS (
    SELECT 
        time_open AS time_period_start,
        price_close
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    time_period_start,
    AVG(price_close) OVER (ORDER BY time_period_start ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) AS thirty_min_avg_price
FROM realtime
ORDER BY time_period_start
        );
[0m17:31:36.467198 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:31:38.392613 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.925 seconds
[0m17:31:38.419161 [debug] [Thread-1 (]: On model.dw_project.avg_price_realtime: Close
[0m17:31:38.617188 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb58e935-f2ad-45a5-aa04-9209fcf8392d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ead9190>]}
[0m17:31:38.619027 [info ] [Thread-1 (]: 1 of 4 OK created sql table model analytics.avg_price_realtime ................. [[32mSUCCESS 1[0m in 2.22s]
[0m17:31:38.620130 [debug] [Thread-1 (]: Finished running node model.dw_project.avg_price_realtime
[0m17:31:38.620842 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_daily_summary
[0m17:31:38.621632 [info ] [Thread-1 (]: 2 of 4 START sql table model analytics.bitcoin_daily_summary ................... [RUN]
[0m17:31:38.622311 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.avg_price_realtime, now model.dw_project.bitcoin_daily_summary)
[0m17:31:38.622811 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_daily_summary
[0m17:31:38.627388 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_daily_summary"
[0m17:31:38.630063 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_daily_summary
[0m17:31:38.632408 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_daily_summary"
[0m17:31:38.633881 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_daily_summary"
[0m17:31:38.634255 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_daily_summary"} */
create or replace transient table lab2.analytics.bitcoin_daily_summary
         as
        (WITH historical_data AS (
    SELECT
        TIME_PERIOD_START::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_historical
),
realtime_data AS (
    SELECT
        TIME_OPEN::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    date,
    AVG(PRICE_OPEN) AS avg_open,
    AVG(PRICE_HIGH) AS avg_high,
    AVG(PRICE_LOW) AS avg_low,
    AVG(PRICE_CLOSE) AS avg_close,
    SUM(VOLUME_TRADED) AS total_volume,
    SUM(TRADES_COUNT) AS total_trades
FROM (
    SELECT * FROM historical_data
    UNION ALL
    SELECT * FROM realtime_data
) AS combined_data
GROUP BY date
ORDER BY date
        );
[0m17:31:38.634579 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:31:40.543365 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.908 seconds
[0m17:31:40.548367 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: Close
[0m17:31:40.730434 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb58e935-f2ad-45a5-aa04-9209fcf8392d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14abc3da0>]}
[0m17:31:40.732153 [info ] [Thread-1 (]: 2 of 4 OK created sql table model analytics.bitcoin_daily_summary .............. [[32mSUCCESS 1[0m in 2.11s]
[0m17:31:40.733145 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_daily_summary
[0m17:31:40.733810 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_historical
[0m17:31:40.734585 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_daily_summary, now model.dw_project.bitcoin_historical)
[0m17:31:40.735132 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_historical
[0m17:31:40.739448 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_historical"
[0m17:31:40.741618 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_historical
[0m17:31:40.742063 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_realtime
[0m17:31:40.742569 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_historical, now model.dw_project.bitcoin_realtime)
[0m17:31:40.742896 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_realtime
[0m17:31:40.745248 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_realtime"
[0m17:31:40.746747 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_realtime
[0m17:31:40.747114 [debug] [Thread-1 (]: Began running node model.dw_project.percentage_change
[0m17:31:40.747559 [info ] [Thread-1 (]: 3 of 4 START sql table model analytics.percentage_change ....................... [RUN]
[0m17:31:40.747926 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_realtime, now model.dw_project.percentage_change)
[0m17:31:40.748204 [debug] [Thread-1 (]: Began compiling node model.dw_project.percentage_change
[0m17:31:40.756768 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.percentage_change"
[0m17:31:40.758425 [debug] [Thread-1 (]: Began executing node model.dw_project.percentage_change
[0m17:31:40.760335 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.percentage_change"
[0m17:31:40.761884 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.percentage_change"
[0m17:31:40.762170 [debug] [Thread-1 (]: On model.dw_project.percentage_change: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.percentage_change"} */
create or replace transient table lab2.analytics.percentage_change
         as
        (-- Calculate percentage change for PRICE_CLOSE and VOLUME_TRADED for historical data, grouped by day
WITH  __dbt__cte__bitcoin_historical as (
SELECT 
    time_period_start,
    time_period_end,
    time_open,
    time_close,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_historical
WHERE time_period_start IS NOT NULL
), historical_pct_change AS (
    SELECT
        DATE(TIME_PERIOD_START) AS DAY,
        PRICE_CLOSE,
        VOLUME_TRADED,
        LAG(PRICE_CLOSE) OVER (PARTITION BY DATE(TIME_PERIOD_START) ORDER BY TIME_PERIOD_START) AS PREV_PRICE_CLOSE,
        LAG(VOLUME_TRADED) OVER (PARTITION BY DATE(TIME_PERIOD_START) ORDER BY TIME_PERIOD_START) AS PREV_VOLUME_TRADED
    FROM __dbt__cte__bitcoin_historical
)

-- Select final result with percentage change, grouped by day
SELECT 
    DAY,
    MAX(PRICE_CLOSE) AS PRICE_CLOSE,  -- To display the latest PRICE_CLOSE for each day
    MAX(VOLUME_TRADED) AS VOLUME_TRADED,  -- To display the latest VOLUME_TRADED for each day
    CASE 
        WHEN MAX(PREV_PRICE_CLOSE) IS NULL THEN NULL
        ELSE (MAX(PRICE_CLOSE) - MAX(PREV_PRICE_CLOSE)) / MAX(PREV_PRICE_CLOSE) * 100
    END AS PERCENTAGE_CHANGE_PRICE,
    CASE 
        WHEN MAX(PREV_VOLUME_TRADED) IS NULL THEN NULL
        ELSE (MAX(VOLUME_TRADED) - MAX(PREV_VOLUME_TRADED)) / MAX(PREV_VOLUME_TRADED) * 100
    END AS PERCENTAGE_CHANGE_VOLUME
FROM historical_pct_change
GROUP BY DAY
ORDER BY DAY
        );
[0m17:31:40.762411 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:31:42.593265 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.830 seconds
[0m17:31:42.597278 [debug] [Thread-1 (]: On model.dw_project.percentage_change: Close
[0m17:31:42.784875 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb58e935-f2ad-45a5-aa04-9209fcf8392d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ad7ca40>]}
[0m17:31:42.786862 [info ] [Thread-1 (]: 3 of 4 OK created sql table model analytics.percentage_change .................. [[32mSUCCESS 1[0m in 2.04s]
[0m17:31:42.788139 [debug] [Thread-1 (]: Finished running node model.dw_project.percentage_change
[0m17:31:42.789061 [debug] [Thread-1 (]: Began running node model.dw_project.moving_avg_realtime
[0m17:31:42.790271 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics.moving_avg_realtime ..................... [RUN]
[0m17:31:42.791170 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.percentage_change, now model.dw_project.moving_avg_realtime)
[0m17:31:42.791731 [debug] [Thread-1 (]: Began compiling node model.dw_project.moving_avg_realtime
[0m17:31:42.801553 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.moving_avg_realtime"
[0m17:31:42.802882 [debug] [Thread-1 (]: Began executing node model.dw_project.moving_avg_realtime
[0m17:31:42.805328 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.moving_avg_realtime"
[0m17:31:42.807180 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.moving_avg_realtime"
[0m17:31:42.807557 [debug] [Thread-1 (]: On model.dw_project.moving_avg_realtime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.moving_avg_realtime"} */
create or replace transient table lab2.analytics.moving_avg_realtime
         as
        (-- Calculate moving averages (e.g., 7-day moving average) for real-time data
WITH  __dbt__cte__bitcoin_realtime as (
SELECT 
    time_open,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_realtime
WHERE price_close IS NOT NULL
), real_time_moving_avg AS (
    SELECT
        DATE(TIME_OPEN) AS DAY,
        PRICE_OPEN,
        VOLUME_TRADED,
        AVG(PRICE_OPEN) OVER (ORDER BY TIME_OPEN ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS PRICE_OPEN_7DAY_AVG,
        AVG(VOLUME_TRADED) OVER (ORDER BY TIME_OPEN ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS VOLUME_TRADED_7DAY_AVG
    FROM __dbt__cte__bitcoin_realtime
)

-- Select final result
SELECT 
    DAY,
    PRICE_OPEN,
    VOLUME_TRADED,
    PRICE_OPEN_7DAY_AVG,
    VOLUME_TRADED_7DAY_AVG
FROM real_time_moving_avg
        );
[0m17:31:42.807898 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:31:44.639040 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.831 seconds
[0m17:31:44.643605 [debug] [Thread-1 (]: On model.dw_project.moving_avg_realtime: Close
[0m17:31:44.844799 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb58e935-f2ad-45a5-aa04-9209fcf8392d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ac9d190>]}
[0m17:31:44.846178 [info ] [Thread-1 (]: 4 of 4 OK created sql table model analytics.moving_avg_realtime ................ [[32mSUCCESS 1[0m in 2.05s]
[0m17:31:44.846896 [debug] [Thread-1 (]: Finished running node model.dw_project.moving_avg_realtime
[0m17:31:44.848886 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:31:44.849459 [debug] [MainThread]: Connection 'model.dw_project.moving_avg_realtime' was properly closed.
[0m17:31:44.849893 [info ] [MainThread]: 
[0m17:31:44.850254 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 10.26 seconds (10.26s).
[0m17:31:44.851340 [debug] [MainThread]: Command end result
[0m17:31:44.874755 [info ] [MainThread]: 
[0m17:31:44.875064 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:31:44.875260 [info ] [MainThread]: 
[0m17:31:44.875464 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m17:31:44.877349 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.478351, "process_user_time": 2.114604, "process_kernel_time": 2.485648, "process_mem_max_rss": "208470016", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:31:44.877651 [debug] [MainThread]: Command `dbt run` succeeded at 17:31:44.877601 after 11.48 seconds
[0m17:31:44.877847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a70a900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4eadb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ee63830>]}
[0m17:31:44.878036 [debug] [MainThread]: Flushing usage events
[0m17:32:26.794496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f43860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11063bda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11063ba40>]}


============================== 17:32:26.796034 | 1e1dbabd-d614-4ecd-85a5-5153e2739452 ==============================
[0m17:32:26.796034 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:32:26.796321 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'write_json': 'True', 'quiet': 'False', 'fail_fast': 'False', 'cache_selected_only': 'False', 'static_parser': 'True', 'empty': 'False', 'printer_width': '80', 'no_print': 'None', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'debug': 'False', 'partial_parse': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'warn_error': 'None', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'use_colors': 'True', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'send_anonymous_usage_stats': 'True'}
[0m17:32:27.549163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e1dbabd-d614-4ecd-85a5-5153e2739452', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1277e3770>]}
[0m17:32:27.567163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1e1dbabd-d614-4ecd-85a5-5153e2739452', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1634f76e0>]}
[0m17:32:27.567695 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:32:27.575863 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:32:27.630552 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:32:27.630853 [debug] [MainThread]: Partial parsing: updated file: dw_project://models/output/percentage_change.sql
[0m17:32:27.712929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e1dbabd-d614-4ecd-85a5-5153e2739452', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1631b1100>]}
[0m17:32:27.746533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e1dbabd-d614-4ecd-85a5-5153e2739452', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16563c440>]}
[0m17:32:27.746764 [info ] [MainThread]: Found 6 models, 3 sources, 459 macros
[0m17:32:27.746911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e1dbabd-d614-4ecd-85a5-5153e2739452', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1635a2390>]}
[0m17:32:27.747639 [info ] [MainThread]: 
[0m17:32:27.747891 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:32:27.749636 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m17:32:27.754530 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m17:32:27.754671 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m17:32:27.754781 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:32:28.572576 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.817 seconds
[0m17:32:28.575331 [debug] [ThreadPool]: On list_lab2: Close
[0m17:32:28.766583 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m17:32:28.776460 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m17:32:28.776845 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m17:32:28.777082 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:32:29.364599 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.587 seconds
[0m17:32:29.369087 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m17:32:29.560699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e1dbabd-d614-4ecd-85a5-5153e2739452', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1638dde80>]}
[0m17:32:29.562021 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m17:32:29.562863 [info ] [MainThread]: 
[0m17:32:29.568059 [debug] [Thread-1 (]: Began running node model.dw_project.avg_price_realtime
[0m17:32:29.568857 [info ] [Thread-1 (]: 1 of 4 START sql table model analytics.avg_price_realtime ...................... [RUN]
[0m17:32:29.569459 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now model.dw_project.avg_price_realtime)
[0m17:32:29.569903 [debug] [Thread-1 (]: Began compiling node model.dw_project.avg_price_realtime
[0m17:32:29.628467 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.avg_price_realtime"
[0m17:32:29.628987 [debug] [Thread-1 (]: Began executing node model.dw_project.avg_price_realtime
[0m17:32:29.641083 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.avg_price_realtime"
[0m17:32:29.641676 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.avg_price_realtime"
[0m17:32:29.641849 [debug] [Thread-1 (]: On model.dw_project.avg_price_realtime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.avg_price_realtime"} */
create or replace transient table lab2.analytics.avg_price_realtime
         as
        (WITH realtime AS (
    SELECT 
        time_open AS time_period_start,
        price_close
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    time_period_start,
    AVG(price_close) OVER (ORDER BY time_period_start ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) AS thirty_min_avg_price
FROM realtime
ORDER BY time_period_start
        );
[0m17:32:29.641995 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:32:30.954424 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.312 seconds
[0m17:32:30.982398 [debug] [Thread-1 (]: On model.dw_project.avg_price_realtime: Close
[0m17:32:31.158223 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e1dbabd-d614-4ecd-85a5-5153e2739452', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fada60>]}
[0m17:32:31.159919 [info ] [Thread-1 (]: 1 of 4 OK created sql table model analytics.avg_price_realtime ................. [[32mSUCCESS 1[0m in 1.59s]
[0m17:32:31.161097 [debug] [Thread-1 (]: Finished running node model.dw_project.avg_price_realtime
[0m17:32:31.161868 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_daily_summary
[0m17:32:31.162868 [info ] [Thread-1 (]: 2 of 4 START sql table model analytics.bitcoin_daily_summary ................... [RUN]
[0m17:32:31.163642 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.avg_price_realtime, now model.dw_project.bitcoin_daily_summary)
[0m17:32:31.164173 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_daily_summary
[0m17:32:31.168814 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_daily_summary"
[0m17:32:31.169815 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_daily_summary
[0m17:32:31.172224 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_daily_summary"
[0m17:32:31.173703 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_daily_summary"
[0m17:32:31.174072 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_daily_summary"} */
create or replace transient table lab2.analytics.bitcoin_daily_summary
         as
        (WITH historical_data AS (
    SELECT
        TIME_PERIOD_START::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_historical
),
realtime_data AS (
    SELECT
        TIME_OPEN::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    date,
    AVG(PRICE_OPEN) AS avg_open,
    AVG(PRICE_HIGH) AS avg_high,
    AVG(PRICE_LOW) AS avg_low,
    AVG(PRICE_CLOSE) AS avg_close,
    SUM(VOLUME_TRADED) AS total_volume,
    SUM(TRADES_COUNT) AS total_trades
FROM (
    SELECT * FROM historical_data
    UNION ALL
    SELECT * FROM realtime_data
) AS combined_data
GROUP BY date
ORDER BY date
        );
[0m17:32:31.174413 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:32:32.460680 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.286 seconds
[0m17:32:32.464427 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: Close
[0m17:32:32.688133 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e1dbabd-d614-4ecd-85a5-5153e2739452', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1638fc110>]}
[0m17:32:32.690300 [info ] [Thread-1 (]: 2 of 4 OK created sql table model analytics.bitcoin_daily_summary .............. [[32mSUCCESS 1[0m in 1.52s]
[0m17:32:32.691843 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_daily_summary
[0m17:32:32.692742 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_historical
[0m17:32:32.693712 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_daily_summary, now model.dw_project.bitcoin_historical)
[0m17:32:32.694373 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_historical
[0m17:32:32.699623 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_historical"
[0m17:32:32.702034 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_historical
[0m17:32:32.702536 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_realtime
[0m17:32:32.703114 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_historical, now model.dw_project.bitcoin_realtime)
[0m17:32:32.703499 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_realtime
[0m17:32:32.706119 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_realtime"
[0m17:32:32.707123 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_realtime
[0m17:32:32.707483 [debug] [Thread-1 (]: Began running node model.dw_project.percentage_change
[0m17:32:32.707960 [info ] [Thread-1 (]: 3 of 4 START sql table model analytics.percentage_change ....................... [RUN]
[0m17:32:32.708463 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_realtime, now model.dw_project.percentage_change)
[0m17:32:32.708772 [debug] [Thread-1 (]: Began compiling node model.dw_project.percentage_change
[0m17:32:32.716099 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.percentage_change"
[0m17:32:32.716581 [debug] [Thread-1 (]: Began executing node model.dw_project.percentage_change
[0m17:32:32.718642 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.percentage_change"
[0m17:32:32.719812 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.percentage_change"
[0m17:32:32.720082 [debug] [Thread-1 (]: On model.dw_project.percentage_change: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.percentage_change"} */
create or replace transient table lab2.analytics.percentage_change
         as
        (-- Calculate percentage change for PRICE_CLOSE and VOLUME_TRADED for historical data
WITH  __dbt__cte__bitcoin_historical as (
SELECT 
    time_period_start,
    time_period_end,
    time_open,
    time_close,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_historical
WHERE time_period_start IS NOT NULL
), historical_pct_change AS (
    SELECT
        DATE(TIME_PERIOD_START) AS DAY,
        PRICE_CLOSE,
        VOLUME_TRADED,
        LAG(PRICE_CLOSE) OVER (ORDER BY TIME_PERIOD_START) AS PREV_PRICE_CLOSE,
        LAG(VOLUME_TRADED) OVER (ORDER BY TIME_PERIOD_START) AS PREV_VOLUME_TRADED
    FROM __dbt__cte__bitcoin_historical
)

-- Select final result with percentage change
SELECT 
    DAY,
    PRICE_CLOSE,
    VOLUME_TRADED,
    CASE 
        WHEN PREV_PRICE_CLOSE IS NULL THEN NULL
        ELSE (PRICE_CLOSE - PREV_PRICE_CLOSE) / PREV_PRICE_CLOSE * 100
    END AS PERCENTAGE_CHANGE_PRICE,
    CASE 
        WHEN PREV_VOLUME_TRADED IS NULL THEN NULL
        ELSE (VOLUME_TRADED - PREV_VOLUME_TRADED) / PREV_VOLUME_TRADED * 100
    END AS PERCENTAGE_CHANGE_VOLUME
FROM historical_pct_change
        );
[0m17:32:32.720339 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:32:34.407496 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.687 seconds
[0m17:32:34.412014 [debug] [Thread-1 (]: On model.dw_project.percentage_change: Close
[0m17:32:34.594586 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e1dbabd-d614-4ecd-85a5-5153e2739452', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110639d30>]}
[0m17:32:34.596222 [info ] [Thread-1 (]: 3 of 4 OK created sql table model analytics.percentage_change .................. [[32mSUCCESS 1[0m in 1.89s]
[0m17:32:34.597490 [debug] [Thread-1 (]: Finished running node model.dw_project.percentage_change
[0m17:32:34.598403 [debug] [Thread-1 (]: Began running node model.dw_project.moving_avg_realtime
[0m17:32:34.599394 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics.moving_avg_realtime ..................... [RUN]
[0m17:32:34.600255 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.percentage_change, now model.dw_project.moving_avg_realtime)
[0m17:32:34.600889 [debug] [Thread-1 (]: Began compiling node model.dw_project.moving_avg_realtime
[0m17:32:34.611184 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.moving_avg_realtime"
[0m17:32:34.612192 [debug] [Thread-1 (]: Began executing node model.dw_project.moving_avg_realtime
[0m17:32:34.614843 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.moving_avg_realtime"
[0m17:32:34.616339 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.moving_avg_realtime"
[0m17:32:34.616698 [debug] [Thread-1 (]: On model.dw_project.moving_avg_realtime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.moving_avg_realtime"} */
create or replace transient table lab2.analytics.moving_avg_realtime
         as
        (-- Calculate moving averages (e.g., 7-day moving average) for real-time data
WITH  __dbt__cte__bitcoin_realtime as (
SELECT 
    time_open,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_realtime
WHERE price_close IS NOT NULL
), real_time_moving_avg AS (
    SELECT
        DATE(TIME_OPEN) AS DAY,
        PRICE_OPEN,
        VOLUME_TRADED,
        AVG(PRICE_OPEN) OVER (ORDER BY TIME_OPEN ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS PRICE_OPEN_7DAY_AVG,
        AVG(VOLUME_TRADED) OVER (ORDER BY TIME_OPEN ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS VOLUME_TRADED_7DAY_AVG
    FROM __dbt__cte__bitcoin_realtime
)

-- Select final result
SELECT 
    DAY,
    PRICE_OPEN,
    VOLUME_TRADED,
    PRICE_OPEN_7DAY_AVG,
    VOLUME_TRADED_7DAY_AVG
FROM real_time_moving_avg
        );
[0m17:32:34.617031 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:32:36.045093 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.428 seconds
[0m17:32:36.050534 [debug] [Thread-1 (]: On model.dw_project.moving_avg_realtime: Close
[0m17:32:36.224733 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e1dbabd-d614-4ecd-85a5-5153e2739452', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16386b0b0>]}
[0m17:32:36.226152 [info ] [Thread-1 (]: 4 of 4 OK created sql table model analytics.moving_avg_realtime ................ [[32mSUCCESS 1[0m in 1.62s]
[0m17:32:36.227045 [debug] [Thread-1 (]: Finished running node model.dw_project.moving_avg_realtime
[0m17:32:36.229088 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:32:36.229601 [debug] [MainThread]: Connection 'model.dw_project.moving_avg_realtime' was properly closed.
[0m17:32:36.230095 [info ] [MainThread]: 
[0m17:32:36.230483 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 8.48 seconds (8.48s).
[0m17:32:36.231602 [debug] [MainThread]: Command end result
[0m17:32:36.255052 [info ] [MainThread]: 
[0m17:32:36.255337 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:32:36.255520 [info ] [MainThread]: 
[0m17:32:36.255712 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m17:32:36.257608 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.486966, "process_user_time": 3.324284, "process_kernel_time": 1.285964, "process_mem_max_rss": "208519168", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:32:36.257914 [debug] [MainThread]: Command `dbt run` succeeded at 17:32:36.257860 after 9.49 seconds
[0m17:32:36.258122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106759370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073ea5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x165690c50>]}
[0m17:32:36.258319 [debug] [MainThread]: Flushing usage events
[0m17:33:45.036684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c66a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10645d490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10645d3a0>]}


============================== 17:33:45.038207 | fa7ba224-dcc6-4562-b5cd-cd01ac63bac6 ==============================
[0m17:33:45.038207 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:33:45.038506 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'write_json': 'True', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'no_print': 'None', 'static_parser': 'True', 'introspect': 'True', 'empty': 'False', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'warn_error': 'None', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'fail_fast': 'False', 'target_path': 'None', 'log_format': 'default', 'partial_parse': 'True', 'debug': 'False', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'use_colors': 'True'}
[0m17:33:46.001119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fa7ba224-dcc6-4562-b5cd-cd01ac63bac6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1255e2930>]}
[0m17:33:46.017905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fa7ba224-dcc6-4562-b5cd-cd01ac63bac6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15212b7d0>]}
[0m17:33:46.018377 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:33:46.026705 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:33:46.081670 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m17:33:46.081924 [debug] [MainThread]: Partial parsing: added file: dw_project://models/output/trades.sql
[0m17:33:46.082042 [debug] [MainThread]: Partial parsing: deleted file: dw_project://models/output/percentage_change.sql
[0m17:33:46.165330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fa7ba224-dcc6-4562-b5cd-cd01ac63bac6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1525e1370>]}
[0m17:33:46.199406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fa7ba224-dcc6-4562-b5cd-cd01ac63bac6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1525ead20>]}
[0m17:33:46.199628 [info ] [MainThread]: Found 6 models, 3 sources, 459 macros
[0m17:33:46.199772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa7ba224-dcc6-4562-b5cd-cd01ac63bac6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1525e2c60>]}
[0m17:33:46.200522 [info ] [MainThread]: 
[0m17:33:46.200762 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:33:46.202439 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m17:33:46.207117 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m17:33:46.207249 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m17:33:46.207348 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:33:46.914275 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.706 seconds
[0m17:33:46.917417 [debug] [ThreadPool]: On list_lab2: Close
[0m17:33:47.107421 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m17:33:47.121280 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m17:33:47.121692 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m17:33:47.121961 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:33:47.784630 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.663 seconds
[0m17:33:47.788886 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m17:33:47.967796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa7ba224-dcc6-4562-b5cd-cd01ac63bac6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bbbb00>]}
[0m17:33:47.968862 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m17:33:47.969364 [info ] [MainThread]: 
[0m17:33:47.973734 [debug] [Thread-1 (]: Began running node model.dw_project.avg_price_realtime
[0m17:33:47.974467 [info ] [Thread-1 (]: 1 of 4 START sql table model analytics.avg_price_realtime ...................... [RUN]
[0m17:33:47.975054 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now model.dw_project.avg_price_realtime)
[0m17:33:47.975451 [debug] [Thread-1 (]: Began compiling node model.dw_project.avg_price_realtime
[0m17:33:48.031960 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.avg_price_realtime"
[0m17:33:48.034006 [debug] [Thread-1 (]: Began executing node model.dw_project.avg_price_realtime
[0m17:33:48.046771 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.avg_price_realtime"
[0m17:33:48.047376 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.avg_price_realtime"
[0m17:33:48.047542 [debug] [Thread-1 (]: On model.dw_project.avg_price_realtime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.avg_price_realtime"} */
create or replace transient table lab2.analytics.avg_price_realtime
         as
        (WITH realtime AS (
    SELECT 
        time_open AS time_period_start,
        price_close
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    time_period_start,
    AVG(price_close) OVER (ORDER BY time_period_start ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) AS thirty_min_avg_price
FROM realtime
ORDER BY time_period_start
        );
[0m17:33:48.047690 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:33:49.773316 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.725 seconds
[0m17:33:49.797553 [debug] [Thread-1 (]: On model.dw_project.avg_price_realtime: Close
[0m17:33:50.016117 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa7ba224-dcc6-4562-b5cd-cd01ac63bac6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153020530>]}
[0m17:33:50.018036 [info ] [Thread-1 (]: 1 of 4 OK created sql table model analytics.avg_price_realtime ................. [[32mSUCCESS 1[0m in 2.04s]
[0m17:33:50.019200 [debug] [Thread-1 (]: Finished running node model.dw_project.avg_price_realtime
[0m17:33:50.019957 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_daily_summary
[0m17:33:50.020880 [info ] [Thread-1 (]: 2 of 4 START sql table model analytics.bitcoin_daily_summary ................... [RUN]
[0m17:33:50.021674 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.avg_price_realtime, now model.dw_project.bitcoin_daily_summary)
[0m17:33:50.022223 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_daily_summary
[0m17:33:50.026585 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_daily_summary"
[0m17:33:50.028711 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_daily_summary
[0m17:33:50.031071 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_daily_summary"
[0m17:33:50.032562 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_daily_summary"
[0m17:33:50.032934 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_daily_summary"} */
create or replace transient table lab2.analytics.bitcoin_daily_summary
         as
        (WITH historical_data AS (
    SELECT
        TIME_PERIOD_START::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_historical
),
realtime_data AS (
    SELECT
        TIME_OPEN::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    date,
    AVG(PRICE_OPEN) AS avg_open,
    AVG(PRICE_HIGH) AS avg_high,
    AVG(PRICE_LOW) AS avg_low,
    AVG(PRICE_CLOSE) AS avg_close,
    SUM(VOLUME_TRADED) AS total_volume,
    SUM(TRADES_COUNT) AS total_trades
FROM (
    SELECT * FROM historical_data
    UNION ALL
    SELECT * FROM realtime_data
) AS combined_data
GROUP BY date
ORDER BY date
        );
[0m17:33:50.033282 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:33:51.717192 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.683 seconds
[0m17:33:51.722202 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: Close
[0m17:33:51.914479 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa7ba224-dcc6-4562-b5cd-cd01ac63bac6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1524ac770>]}
[0m17:33:51.916160 [info ] [Thread-1 (]: 2 of 4 OK created sql table model analytics.bitcoin_daily_summary .............. [[32mSUCCESS 1[0m in 1.89s]
[0m17:33:51.917227 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_daily_summary
[0m17:33:51.917968 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_historical
[0m17:33:51.918798 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_daily_summary, now model.dw_project.bitcoin_historical)
[0m17:33:51.919398 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_historical
[0m17:33:51.923987 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_historical"
[0m17:33:51.926477 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_historical
[0m17:33:51.927051 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_realtime
[0m17:33:51.927631 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_historical, now model.dw_project.bitcoin_realtime)
[0m17:33:51.928197 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_realtime
[0m17:33:51.931146 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_realtime"
[0m17:33:51.932678 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_realtime
[0m17:33:51.933086 [debug] [Thread-1 (]: Began running node model.dw_project.trades
[0m17:33:51.933630 [info ] [Thread-1 (]: 3 of 4 START sql table model analytics.trades .................................. [RUN]
[0m17:33:51.934037 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_realtime, now model.dw_project.trades)
[0m17:33:51.934331 [debug] [Thread-1 (]: Began compiling node model.dw_project.trades
[0m17:33:51.939224 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.trades"
[0m17:33:51.939789 [debug] [Thread-1 (]: Began executing node model.dw_project.trades
[0m17:33:51.942123 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.trades"
[0m17:33:51.943214 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.trades"
[0m17:33:51.943479 [debug] [Thread-1 (]: On model.dw_project.trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.trades"} */
create or replace transient table lab2.analytics.trades
         as
        (-- Calculate total trading activity by hour for historical data
WITH  __dbt__cte__bitcoin_historical as (
SELECT 
    time_period_start,
    time_period_end,
    time_open,
    time_close,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_historical
WHERE time_period_start IS NOT NULL
), historical_hourly_activity AS (
    SELECT
        EXTRACT(HOUR FROM TIME_PERIOD_START) AS HOUR_OF_DAY,
        SUM(VOLUME_TRADED) AS TOTAL_VOLUME_TRADED,
        SUM(TRADES_COUNT) AS TOTAL_TRADES_COUNT
    FROM __dbt__cte__bitcoin_historical
    GROUP BY EXTRACT(HOUR FROM TIME_PERIOD_START)
)

-- Select final result
SELECT 
    HOUR_OF_DAY,
    TOTAL_VOLUME_TRADED,
    TOTAL_TRADES_COUNT
FROM historical_hourly_activity
        );
[0m17:33:51.943719 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:33:53.869178 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.925 seconds
[0m17:33:53.872979 [debug] [Thread-1 (]: On model.dw_project.trades: Close
[0m17:33:54.068208 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa7ba224-dcc6-4562-b5cd-cd01ac63bac6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10762b380>]}
[0m17:33:54.070011 [info ] [Thread-1 (]: 3 of 4 OK created sql table model analytics.trades ............................. [[32mSUCCESS 1[0m in 2.13s]
[0m17:33:54.071250 [debug] [Thread-1 (]: Finished running node model.dw_project.trades
[0m17:33:54.072105 [debug] [Thread-1 (]: Began running node model.dw_project.moving_avg_realtime
[0m17:33:54.073134 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics.moving_avg_realtime ..................... [RUN]
[0m17:33:54.074058 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.trades, now model.dw_project.moving_avg_realtime)
[0m17:33:54.074751 [debug] [Thread-1 (]: Began compiling node model.dw_project.moving_avg_realtime
[0m17:33:54.085420 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.moving_avg_realtime"
[0m17:33:54.086538 [debug] [Thread-1 (]: Began executing node model.dw_project.moving_avg_realtime
[0m17:33:54.089077 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.moving_avg_realtime"
[0m17:33:54.090580 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.moving_avg_realtime"
[0m17:33:54.090960 [debug] [Thread-1 (]: On model.dw_project.moving_avg_realtime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.moving_avg_realtime"} */
create or replace transient table lab2.analytics.moving_avg_realtime
         as
        (-- Calculate moving averages (e.g., 7-day moving average) for real-time data
WITH  __dbt__cte__bitcoin_realtime as (
SELECT 
    time_open,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_realtime
WHERE price_close IS NOT NULL
), real_time_moving_avg AS (
    SELECT
        DATE(TIME_OPEN) AS DAY,
        PRICE_OPEN,
        VOLUME_TRADED,
        AVG(PRICE_OPEN) OVER (ORDER BY TIME_OPEN ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS PRICE_OPEN_7DAY_AVG,
        AVG(VOLUME_TRADED) OVER (ORDER BY TIME_OPEN ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS VOLUME_TRADED_7DAY_AVG
    FROM __dbt__cte__bitcoin_realtime
)

-- Select final result
SELECT 
    DAY,
    PRICE_OPEN,
    VOLUME_TRADED,
    PRICE_OPEN_7DAY_AVG,
    VOLUME_TRADED_7DAY_AVG
FROM real_time_moving_avg
        );
[0m17:33:54.091315 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:33:56.019904 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.928 seconds
[0m17:33:56.024340 [debug] [Thread-1 (]: On model.dw_project.moving_avg_realtime: Close
[0m17:33:56.233081 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa7ba224-dcc6-4562-b5cd-cd01ac63bac6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1522afaa0>]}
[0m17:33:56.234839 [info ] [Thread-1 (]: 4 of 4 OK created sql table model analytics.moving_avg_realtime ................ [[32mSUCCESS 1[0m in 2.16s]
[0m17:33:56.236049 [debug] [Thread-1 (]: Finished running node model.dw_project.moving_avg_realtime
[0m17:33:56.238587 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:33:56.239150 [debug] [MainThread]: Connection 'model.dw_project.moving_avg_realtime' was properly closed.
[0m17:33:56.239811 [info ] [MainThread]: 
[0m17:33:56.240326 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 10.04 seconds (10.04s).
[0m17:33:56.241901 [debug] [MainThread]: Command end result
[0m17:33:56.270860 [info ] [MainThread]: 
[0m17:33:56.271308 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:33:56.271516 [info ] [MainThread]: 
[0m17:33:56.271719 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m17:33:56.273703 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.260808, "process_user_time": 2.473241, "process_kernel_time": 1.981002, "process_mem_max_rss": "208764928", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:33:56.274141 [debug] [MainThread]: Command `dbt run` succeeded at 17:33:56.274071 after 11.26 seconds
[0m17:33:56.274401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066d81a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1526b2b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1525ebb00>]}
[0m17:33:56.274631 [debug] [MainThread]: Flushing usage events
[0m17:35:05.639000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129caf60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118593a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111859430>]}


============================== 17:35:05.641112 | 07e4cc1d-69aa-4b39-97e1-1eb05695d98f ==============================
[0m17:35:05.641112 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:35:05.641418 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'warn_error': 'None', 'use_colors': 'True', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'quiet': 'False', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run', 'printer_width': '80', 'log_cache_events': 'False', 'fail_fast': 'False', 'log_format': 'default', 'target_path': 'None', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'version_check': 'True', 'empty': 'False', 'introspect': 'True', 'indirect_selection': 'eager'}
[0m17:35:06.382304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '07e4cc1d-69aa-4b39-97e1-1eb05695d98f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b47fe0>]}
[0m17:35:06.399461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '07e4cc1d-69aa-4b39-97e1-1eb05695d98f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11311aba0>]}
[0m17:35:06.400629 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:35:06.408605 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:35:06.462431 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:35:06.462719 [debug] [MainThread]: Partial parsing: updated file: dw_project://models/output/trades.sql
[0m17:35:06.547588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '07e4cc1d-69aa-4b39-97e1-1eb05695d98f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16f06e9c0>]}
[0m17:35:06.579588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '07e4cc1d-69aa-4b39-97e1-1eb05695d98f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16d85ea80>]}
[0m17:35:06.579813 [info ] [MainThread]: Found 6 models, 3 sources, 459 macros
[0m17:35:06.579978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07e4cc1d-69aa-4b39-97e1-1eb05695d98f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1681e6db0>]}
[0m17:35:06.580708 [info ] [MainThread]: 
[0m17:35:06.580955 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:35:06.582664 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m17:35:06.587352 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m17:35:06.587484 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m17:35:06.587586 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:35:07.327226 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.739 seconds
[0m17:35:07.330877 [debug] [ThreadPool]: On list_lab2: Close
[0m17:35:07.513003 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m17:35:07.529803 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m17:35:07.530349 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m17:35:07.530632 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:35:08.182113 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.651 seconds
[0m17:35:08.186750 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m17:35:08.415982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07e4cc1d-69aa-4b39-97e1-1eb05695d98f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16d5c0830>]}
[0m17:35:08.417081 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m17:35:08.417698 [info ] [MainThread]: 
[0m17:35:08.422010 [debug] [Thread-1 (]: Began running node model.dw_project.avg_price_realtime
[0m17:35:08.422769 [info ] [Thread-1 (]: 1 of 4 START sql table model analytics.avg_price_realtime ...................... [RUN]
[0m17:35:08.423312 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now model.dw_project.avg_price_realtime)
[0m17:35:08.423690 [debug] [Thread-1 (]: Began compiling node model.dw_project.avg_price_realtime
[0m17:35:08.479010 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.avg_price_realtime"
[0m17:35:08.479491 [debug] [Thread-1 (]: Began executing node model.dw_project.avg_price_realtime
[0m17:35:08.491218 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.avg_price_realtime"
[0m17:35:08.491778 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.avg_price_realtime"
[0m17:35:08.491937 [debug] [Thread-1 (]: On model.dw_project.avg_price_realtime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.avg_price_realtime"} */
create or replace transient table lab2.analytics.avg_price_realtime
         as
        (WITH realtime AS (
    SELECT 
        time_open AS time_period_start,
        price_close
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    time_period_start,
    AVG(price_close) OVER (ORDER BY time_period_start ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) AS thirty_min_avg_price
FROM realtime
ORDER BY time_period_start
        );
[0m17:35:08.492075 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:35:10.668635 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.176 seconds
[0m17:35:10.690660 [debug] [Thread-1 (]: On model.dw_project.avg_price_realtime: Close
[0m17:35:10.895348 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07e4cc1d-69aa-4b39-97e1-1eb05695d98f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16d68e600>]}
[0m17:35:10.896523 [info ] [Thread-1 (]: 1 of 4 OK created sql table model analytics.avg_price_realtime ................. [[32mSUCCESS 1[0m in 2.47s]
[0m17:35:10.897541 [debug] [Thread-1 (]: Finished running node model.dw_project.avg_price_realtime
[0m17:35:10.898213 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_daily_summary
[0m17:35:10.899058 [info ] [Thread-1 (]: 2 of 4 START sql table model analytics.bitcoin_daily_summary ................... [RUN]
[0m17:35:10.899780 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.avg_price_realtime, now model.dw_project.bitcoin_daily_summary)
[0m17:35:10.900336 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_daily_summary
[0m17:35:10.904217 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_daily_summary"
[0m17:35:10.905016 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_daily_summary
[0m17:35:10.907392 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_daily_summary"
[0m17:35:10.908817 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_daily_summary"
[0m17:35:10.909165 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_daily_summary"} */
create or replace transient table lab2.analytics.bitcoin_daily_summary
         as
        (WITH historical_data AS (
    SELECT
        TIME_PERIOD_START::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_historical
),
realtime_data AS (
    SELECT
        TIME_OPEN::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    date,
    AVG(PRICE_OPEN) AS avg_open,
    AVG(PRICE_HIGH) AS avg_high,
    AVG(PRICE_LOW) AS avg_low,
    AVG(PRICE_CLOSE) AS avg_close,
    SUM(VOLUME_TRADED) AS total_volume,
    SUM(TRADES_COUNT) AS total_trades
FROM (
    SELECT * FROM historical_data
    UNION ALL
    SELECT * FROM realtime_data
) AS combined_data
GROUP BY date
ORDER BY date
        );
[0m17:35:10.909353 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:35:12.924644 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.015 seconds
[0m17:35:12.930074 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: Close
[0m17:35:13.168317 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07e4cc1d-69aa-4b39-97e1-1eb05695d98f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16d832a80>]}
[0m17:35:13.169813 [info ] [Thread-1 (]: 2 of 4 OK created sql table model analytics.bitcoin_daily_summary .............. [[32mSUCCESS 1[0m in 2.27s]
[0m17:35:13.170773 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_daily_summary
[0m17:35:13.171377 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_historical
[0m17:35:13.172085 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_daily_summary, now model.dw_project.bitcoin_historical)
[0m17:35:13.172576 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_historical
[0m17:35:13.177154 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_historical"
[0m17:35:13.178545 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_historical
[0m17:35:13.178977 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_realtime
[0m17:35:13.179477 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_historical, now model.dw_project.bitcoin_realtime)
[0m17:35:13.179909 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_realtime
[0m17:35:13.182333 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_realtime"
[0m17:35:13.183163 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_realtime
[0m17:35:13.184111 [debug] [Thread-1 (]: Began running node model.dw_project.moving_avg_realtime
[0m17:35:13.184578 [info ] [Thread-1 (]: 3 of 4 START sql table model analytics.moving_avg_realtime ..................... [RUN]
[0m17:35:13.184937 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_realtime, now model.dw_project.moving_avg_realtime)
[0m17:35:13.185209 [debug] [Thread-1 (]: Began compiling node model.dw_project.moving_avg_realtime
[0m17:35:13.190834 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.moving_avg_realtime"
[0m17:35:13.191264 [debug] [Thread-1 (]: Began executing node model.dw_project.moving_avg_realtime
[0m17:35:13.193240 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.moving_avg_realtime"
[0m17:35:13.194254 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.moving_avg_realtime"
[0m17:35:13.194523 [debug] [Thread-1 (]: On model.dw_project.moving_avg_realtime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.moving_avg_realtime"} */
create or replace transient table lab2.analytics.moving_avg_realtime
         as
        (-- Calculate moving averages (e.g., 7-day moving average) for real-time data
WITH  __dbt__cte__bitcoin_realtime as (
SELECT 
    time_open,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_realtime
WHERE price_close IS NOT NULL
), real_time_moving_avg AS (
    SELECT
        DATE(TIME_OPEN) AS DAY,
        PRICE_OPEN,
        VOLUME_TRADED,
        AVG(PRICE_OPEN) OVER (ORDER BY TIME_OPEN ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS PRICE_OPEN_7DAY_AVG,
        AVG(VOLUME_TRADED) OVER (ORDER BY TIME_OPEN ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS VOLUME_TRADED_7DAY_AVG
    FROM __dbt__cte__bitcoin_realtime
)

-- Select final result
SELECT 
    DAY,
    PRICE_OPEN,
    VOLUME_TRADED,
    PRICE_OPEN_7DAY_AVG,
    VOLUME_TRADED_7DAY_AVG
FROM real_time_moving_avg
        );
[0m17:35:13.194774 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:35:14.867478 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.673 seconds
[0m17:35:14.870571 [debug] [Thread-1 (]: On model.dw_project.moving_avg_realtime: Close
[0m17:35:15.052785 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07e4cc1d-69aa-4b39-97e1-1eb05695d98f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x178e84a10>]}
[0m17:35:15.053924 [info ] [Thread-1 (]: 3 of 4 OK created sql table model analytics.moving_avg_realtime ................ [[32mSUCCESS 1[0m in 1.87s]
[0m17:35:15.054790 [debug] [Thread-1 (]: Finished running node model.dw_project.moving_avg_realtime
[0m17:35:15.055415 [debug] [Thread-1 (]: Began running node model.dw_project.trades
[0m17:35:15.056139 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics.trades .................................. [RUN]
[0m17:35:15.056745 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.moving_avg_realtime, now model.dw_project.trades)
[0m17:35:15.057331 [debug] [Thread-1 (]: Began compiling node model.dw_project.trades
[0m17:35:15.068391 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.trades"
[0m17:35:15.069117 [debug] [Thread-1 (]: Began executing node model.dw_project.trades
[0m17:35:15.070403 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.trades"
[0m17:35:15.071273 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.trades"
[0m17:35:15.071444 [debug] [Thread-1 (]: On model.dw_project.trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.trades"} */
create or replace transient table lab2.analytics.trades
         as
        (-- Calculate total trading activity by hour for historical data
WITH  __dbt__cte__bitcoin_historical as (
SELECT 
    time_period_start,
    time_period_end,
    time_open,
    time_close,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_historical
WHERE time_period_start IS NOT NULL
),  __dbt__cte__bitcoin_realtime as (
SELECT 
    time_open,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_realtime
WHERE price_close IS NOT NULL
), historical_hourly_activity AS (
    SELECT
        EXTRACT(HOUR FROM TIME_PERIOD_START) AS HOUR_OF_DAY,
        SUM(VOLUME_TRADED) AS TOTAL_VOLUME_TRADED,
        SUM(TRADES_COUNT) AS TOTAL_TRADES_COUNT
    FROM __dbt__cte__bitcoin_historical
    GROUP BY EXTRACT(HOUR FROM TIME_PERIOD_START)
)

-- Select final result
SELECT 
    HOUR_OF_DAY,
    TOTAL_VOLUME_TRADED,
    TOTAL_TRADES_COUNT
FROM historical_hourly_activity
-- Calculate total trading activity by hour for real-time data
WITH real_time_hourly_activity AS (
    SELECT
        EXTRACT(HOUR FROM TIME_OPEN) AS HOUR_OF_DAY,
        SUM(VOLUME_TRADED) AS TOTAL_VOLUME_TRADED,
        SUM(TRADES_COUNT) AS TOTAL_TRADES_COUNT
    FROM __dbt__cte__bitcoin_realtime
    GROUP BY EXTRACT(HOUR FROM TIME_OPEN)
)

-- Select final result
SELECT 
    HOUR_OF_DAY,
    TOTAL_VOLUME_TRADED,
    TOTAL_TRADES_COUNT
FROM real_time_hourly_activity;
[0m17:35:15.071611 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:35:15.897118 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8a41f-0003-624b-0003-437a001071ea
[0m17:35:15.897734 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 45 at position 0 unexpected 'WITH'.
syntax error line 47 at position 37 unexpected 'AS'.
[0m17:35:15.898270 [debug] [Thread-1 (]: On model.dw_project.trades: Close
[0m17:35:16.154490 [debug] [Thread-1 (]: Database Error in model trades (models/output/trades.sql)
  001003 (42000): SQL compilation error:
  syntax error line 45 at position 0 unexpected 'WITH'.
  syntax error line 47 at position 37 unexpected 'AS'.
  compiled code at target/run/dw_project/models/output/trades.sql
[0m17:35:16.156071 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07e4cc1d-69aa-4b39-97e1-1eb05695d98f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16f096210>]}
[0m17:35:16.157473 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model analytics.trades ......................... [[31mERROR[0m in 1.10s]
[0m17:35:16.158511 [debug] [Thread-1 (]: Finished running node model.dw_project.trades
[0m17:35:16.160552 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:35:16.161193 [debug] [MainThread]: Connection 'model.dw_project.trades' was properly closed.
[0m17:35:16.161762 [info ] [MainThread]: 
[0m17:35:16.162186 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 9.58 seconds (9.58s).
[0m17:35:16.163326 [debug] [MainThread]: Command end result
[0m17:35:16.186289 [info ] [MainThread]: 
[0m17:35:16.186666 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:35:16.186858 [info ] [MainThread]: 
[0m17:35:16.187087 [error] [MainThread]:   Database Error in model trades (models/output/trades.sql)
  001003 (42000): SQL compilation error:
  syntax error line 45 at position 0 unexpected 'WITH'.
  syntax error line 47 at position 37 unexpected 'AS'.
  compiled code at target/run/dw_project/models/output/trades.sql
[0m17:35:16.187275 [info ] [MainThread]: 
[0m17:35:16.187471 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m17:35:16.189362 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 10.578009, "process_user_time": 3.112405, "process_kernel_time": 1.41491, "process_mem_max_rss": "209223680", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:35:16.189687 [debug] [MainThread]: Command `dbt run` failed at 17:35:16.189635 after 10.58 seconds
[0m17:35:16.189905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b77b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16d5c14c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16d73c170>]}
[0m17:35:16.190107 [debug] [MainThread]: Flushing usage events
[0m17:36:29.860084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073d82f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11042b260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070593d0>]}


============================== 17:36:29.861573 | 65bf8ae6-a599-4ef0-a382-f6d0fc41242a ==============================
[0m17:36:29.861573 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:36:29.861847 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run', 'log_cache_events': 'False', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'no_print': 'None', 'debug': 'False', 'static_parser': 'True', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'partial_parse': 'True', 'empty': 'False', 'use_colors': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'warn_error': 'None', 'target_path': 'None', 'use_experimental_parser': 'False', 'introspect': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'fail_fast': 'False'}
[0m17:36:30.759837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '65bf8ae6-a599-4ef0-a382-f6d0fc41242a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15d823f80>]}
[0m17:36:30.776739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '65bf8ae6-a599-4ef0-a382-f6d0fc41242a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15d63b140>]}
[0m17:36:30.777238 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:36:30.788662 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:36:30.844975 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:36:30.845262 [debug] [MainThread]: Partial parsing: updated file: dw_project://models/output/trades.sql
[0m17:36:30.927617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '65bf8ae6-a599-4ef0-a382-f6d0fc41242a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15dded9d0>]}
[0m17:36:30.962854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '65bf8ae6-a599-4ef0-a382-f6d0fc41242a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15ddcf1d0>]}
[0m17:36:30.963083 [info ] [MainThread]: Found 6 models, 3 sources, 459 macros
[0m17:36:30.963239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65bf8ae6-a599-4ef0-a382-f6d0fc41242a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15d86e450>]}
[0m17:36:30.963944 [info ] [MainThread]: 
[0m17:36:30.964215 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:36:30.965872 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m17:36:30.970791 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m17:36:30.970938 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m17:36:30.971050 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:36:31.827953 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.856 seconds
[0m17:36:31.831762 [debug] [ThreadPool]: On list_lab2: Close
[0m17:36:32.045429 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m17:36:32.058970 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m17:36:32.059514 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m17:36:32.059801 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:36:32.675597 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.615 seconds
[0m17:36:32.679861 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m17:36:32.871520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65bf8ae6-a599-4ef0-a382-f6d0fc41242a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15d895730>]}
[0m17:36:32.873129 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m17:36:32.873783 [info ] [MainThread]: 
[0m17:36:32.879693 [debug] [Thread-1 (]: Began running node model.dw_project.avg_price_realtime
[0m17:36:32.880341 [info ] [Thread-1 (]: 1 of 4 START sql table model analytics.avg_price_realtime ...................... [RUN]
[0m17:36:32.880864 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now model.dw_project.avg_price_realtime)
[0m17:36:32.881226 [debug] [Thread-1 (]: Began compiling node model.dw_project.avg_price_realtime
[0m17:36:32.941814 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.avg_price_realtime"
[0m17:36:32.942747 [debug] [Thread-1 (]: Began executing node model.dw_project.avg_price_realtime
[0m17:36:32.954512 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.avg_price_realtime"
[0m17:36:32.955065 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.avg_price_realtime"
[0m17:36:32.955226 [debug] [Thread-1 (]: On model.dw_project.avg_price_realtime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.avg_price_realtime"} */
create or replace transient table lab2.analytics.avg_price_realtime
         as
        (WITH realtime AS (
    SELECT 
        time_open AS time_period_start,
        price_close
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    time_period_start,
    AVG(price_close) OVER (ORDER BY time_period_start ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) AS thirty_min_avg_price
FROM realtime
ORDER BY time_period_start
        );
[0m17:36:32.955372 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:36:34.843410 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.887 seconds
[0m17:36:34.871264 [debug] [Thread-1 (]: On model.dw_project.avg_price_realtime: Close
[0m17:36:35.061013 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65bf8ae6-a599-4ef0-a382-f6d0fc41242a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077adbb0>]}
[0m17:36:35.062857 [info ] [Thread-1 (]: 1 of 4 OK created sql table model analytics.avg_price_realtime ................. [[32mSUCCESS 1[0m in 2.18s]
[0m17:36:35.064179 [debug] [Thread-1 (]: Finished running node model.dw_project.avg_price_realtime
[0m17:36:35.065049 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_daily_summary
[0m17:36:35.066065 [info ] [Thread-1 (]: 2 of 4 START sql table model analytics.bitcoin_daily_summary ................... [RUN]
[0m17:36:35.066803 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.avg_price_realtime, now model.dw_project.bitcoin_daily_summary)
[0m17:36:35.067380 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_daily_summary
[0m17:36:35.072475 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_daily_summary"
[0m17:36:35.074420 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_daily_summary
[0m17:36:35.077175 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_daily_summary"
[0m17:36:35.078925 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_daily_summary"
[0m17:36:35.079398 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_daily_summary"} */
create or replace transient table lab2.analytics.bitcoin_daily_summary
         as
        (WITH historical_data AS (
    SELECT
        TIME_PERIOD_START::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_historical
),
realtime_data AS (
    SELECT
        TIME_OPEN::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    date,
    AVG(PRICE_OPEN) AS avg_open,
    AVG(PRICE_HIGH) AS avg_high,
    AVG(PRICE_LOW) AS avg_low,
    AVG(PRICE_CLOSE) AS avg_close,
    SUM(VOLUME_TRADED) AS total_volume,
    SUM(TRADES_COUNT) AS total_trades
FROM (
    SELECT * FROM historical_data
    UNION ALL
    SELECT * FROM realtime_data
) AS combined_data
GROUP BY date
ORDER BY date
        );
[0m17:36:35.079772 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:36:36.994027 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.914 seconds
[0m17:36:36.999679 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: Close
[0m17:36:37.236697 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65bf8ae6-a599-4ef0-a382-f6d0fc41242a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15d7dc440>]}
[0m17:36:37.238520 [info ] [Thread-1 (]: 2 of 4 OK created sql table model analytics.bitcoin_daily_summary .............. [[32mSUCCESS 1[0m in 2.17s]
[0m17:36:37.239826 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_daily_summary
[0m17:36:37.240814 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_historical
[0m17:36:37.242043 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_daily_summary, now model.dw_project.bitcoin_historical)
[0m17:36:37.242796 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_historical
[0m17:36:37.248757 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_historical"
[0m17:36:37.250270 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_historical
[0m17:36:37.250772 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_realtime
[0m17:36:37.251345 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_historical, now model.dw_project.bitcoin_realtime)
[0m17:36:37.251863 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_realtime
[0m17:36:37.254868 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_realtime"
[0m17:36:37.255714 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_realtime
[0m17:36:37.256716 [debug] [Thread-1 (]: Began running node model.dw_project.moving_avg_realtime
[0m17:36:37.257204 [info ] [Thread-1 (]: 3 of 4 START sql table model analytics.moving_avg_realtime ..................... [RUN]
[0m17:36:37.257590 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_realtime, now model.dw_project.moving_avg_realtime)
[0m17:36:37.257881 [debug] [Thread-1 (]: Began compiling node model.dw_project.moving_avg_realtime
[0m17:36:37.264122 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.moving_avg_realtime"
[0m17:36:37.264769 [debug] [Thread-1 (]: Began executing node model.dw_project.moving_avg_realtime
[0m17:36:37.267004 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.moving_avg_realtime"
[0m17:36:37.268063 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.moving_avg_realtime"
[0m17:36:37.268323 [debug] [Thread-1 (]: On model.dw_project.moving_avg_realtime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.moving_avg_realtime"} */
create or replace transient table lab2.analytics.moving_avg_realtime
         as
        (-- Calculate moving averages (e.g., 7-day moving average) for real-time data
WITH  __dbt__cte__bitcoin_realtime as (
SELECT 
    time_open,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_realtime
WHERE price_close IS NOT NULL
), real_time_moving_avg AS (
    SELECT
        DATE(TIME_OPEN) AS DAY,
        PRICE_OPEN,
        VOLUME_TRADED,
        AVG(PRICE_OPEN) OVER (ORDER BY TIME_OPEN ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS PRICE_OPEN_7DAY_AVG,
        AVG(VOLUME_TRADED) OVER (ORDER BY TIME_OPEN ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS VOLUME_TRADED_7DAY_AVG
    FROM __dbt__cte__bitcoin_realtime
)

-- Select final result
SELECT 
    DAY,
    PRICE_OPEN,
    VOLUME_TRADED,
    PRICE_OPEN_7DAY_AVG,
    VOLUME_TRADED_7DAY_AVG
FROM real_time_moving_avg
        );
[0m17:36:37.268571 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:36:39.348619 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.079 seconds
[0m17:36:39.353097 [debug] [Thread-1 (]: On model.dw_project.moving_avg_realtime: Close
[0m17:36:39.560745 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65bf8ae6-a599-4ef0-a382-f6d0fc41242a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15de2c560>]}
[0m17:36:39.562191 [info ] [Thread-1 (]: 3 of 4 OK created sql table model analytics.moving_avg_realtime ................ [[32mSUCCESS 1[0m in 2.30s]
[0m17:36:39.563161 [debug] [Thread-1 (]: Finished running node model.dw_project.moving_avg_realtime
[0m17:36:39.563809 [debug] [Thread-1 (]: Began running node model.dw_project.trades
[0m17:36:39.564558 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics.trades .................................. [RUN]
[0m17:36:39.565219 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.moving_avg_realtime, now model.dw_project.trades)
[0m17:36:39.565702 [debug] [Thread-1 (]: Began compiling node model.dw_project.trades
[0m17:36:39.577193 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.trades"
[0m17:36:39.579091 [debug] [Thread-1 (]: Began executing node model.dw_project.trades
[0m17:36:39.581153 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.trades"
[0m17:36:39.582912 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.trades"
[0m17:36:39.583265 [debug] [Thread-1 (]: On model.dw_project.trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.trades"} */
create or replace transient table lab2.analytics.trades
         as
        (-- Calculate total trading activity by hour for both real-time and historical data, and merge them into one table
WITH  __dbt__cte__bitcoin_realtime as (
SELECT 
    time_open,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_realtime
WHERE price_close IS NOT NULL
),  __dbt__cte__bitcoin_historical as (
SELECT 
    time_period_start,
    time_period_end,
    time_open,
    time_close,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_historical
WHERE time_period_start IS NOT NULL
), real_time_hourly_activity AS (
    SELECT
        EXTRACT(HOUR FROM TIME_OPEN) AS HOUR_OF_DAY,
        SUM(VOLUME_TRADED) AS TOTAL_VOLUME_TRADED,
        SUM(TRADES_COUNT) AS TOTAL_TRADES_COUNT,
        'Real-Time' AS DATA_SOURCE  -- Adding a column to distinguish between real-time and historical data
    FROM __dbt__cte__bitcoin_realtime
    GROUP BY EXTRACT(HOUR FROM TIME_OPEN)
),

historical_hourly_activity AS (
    SELECT
        EXTRACT(HOUR FROM TIME_PERIOD_START) AS HOUR_OF_DAY,
        SUM(VOLUME_TRADED) AS TOTAL_VOLUME_TRADED,
        SUM(TRADES_COUNT) AS TOTAL_TRADES_COUNT,
        'Historical' AS DATA_SOURCE  -- Adding a column to distinguish between real-time and historical data
    FROM __dbt__cte__bitcoin_historical
    GROUP BY EXTRACT(HOUR FROM TIME_PERIOD_START)
)

-- Combine real-time and historical data
SELECT 
    HOUR_OF_DAY,
    TOTAL_VOLUME_TRADED,
    TOTAL_TRADES_COUNT,
    DATA_SOURCE
FROM real_time_hourly_activity

UNION ALL

SELECT 
    HOUR_OF_DAY,
    TOTAL_VOLUME_TRADED,
    TOTAL_TRADES_COUNT,
    DATA_SOURCE
FROM historical_hourly_activity
ORDER BY HOUR_OF_DAY
        );
[0m17:36:39.583587 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:36:41.396905 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.813 seconds
[0m17:36:41.401546 [debug] [Thread-1 (]: On model.dw_project.trades: Close
[0m17:36:41.580796 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65bf8ae6-a599-4ef0-a382-f6d0fc41242a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15db9d610>]}
[0m17:36:41.582527 [info ] [Thread-1 (]: 4 of 4 OK created sql table model analytics.trades ............................. [[32mSUCCESS 1[0m in 2.02s]
[0m17:36:41.583663 [debug] [Thread-1 (]: Finished running node model.dw_project.trades
[0m17:36:41.585736 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:36:41.586234 [debug] [MainThread]: Connection 'model.dw_project.trades' was properly closed.
[0m17:36:41.586761 [info ] [MainThread]: 
[0m17:36:41.587270 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 10.62 seconds (10.62s).
[0m17:36:41.588516 [debug] [MainThread]: Command end result
[0m17:36:41.613908 [info ] [MainThread]: 
[0m17:36:41.614276 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:36:41.614485 [info ] [MainThread]: 
[0m17:36:41.614703 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m17:36:41.616906 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.782806, "process_user_time": 3.139314, "process_kernel_time": 1.483722, "process_mem_max_rss": "208568320", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:36:41.617322 [debug] [MainThread]: Command `dbt run` succeeded at 17:36:41.617255 after 11.78 seconds
[0m17:36:41.617570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110473dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b77200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15dbae060>]}
[0m17:36:41.617787 [debug] [MainThread]: Flushing usage events
[0m19:16:28.450347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081eaf30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c5d130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c5d1c0>]}


============================== 19:16:28.452299 | 4c95fada-5044-4c0e-8ff9-65d8ed958a80 ==============================
[0m19:16:28.452299 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:16:28.452619 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'write_json': 'True', 'indirect_selection': 'eager', 'empty': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'no_print': 'None', 'static_parser': 'True', 'use_colors': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'partial_parse': 'True', 'introspect': 'True', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'debug': 'False', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'printer_width': '80', 'fail_fast': 'False', 'target_path': 'None', 'use_experimental_parser': 'False'}
[0m19:16:29.432057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c95fada-5044-4c0e-8ff9-65d8ed958a80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14df234a0>]}
[0m19:16:29.448925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4c95fada-5044-4c0e-8ff9-65d8ed958a80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e0e1730>]}
[0m19:16:29.449397 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:16:29.457213 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:16:29.511633 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m19:16:29.511903 [debug] [MainThread]: Partial parsing: added file: dw_project://snapshots/snapshot_historical.sql
[0m19:16:29.512030 [debug] [MainThread]: Partial parsing: added file: dw_project://snapshots/snapshot_realtime.sql
[0m19:16:29.552735 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot snapshot_bitcoin_historical (snapshots/snapshot_historical.sql)
  invalid syntax for function call expression
    line 4
      config(
[0m19:16:29.554258 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 1.1303624, "process_user_time": 1.522944, "process_kernel_time": 2.512178, "process_mem_max_rss": "195919872", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:16:29.554543 [debug] [MainThread]: Command `dbt snapshot` failed at 19:16:29.554498 after 1.13 seconds
[0m19:16:29.554716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108877da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e9ad100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086f0770>]}
[0m19:16:29.554859 [debug] [MainThread]: Flushing usage events
[0m19:18:41.150041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b43e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106124320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106125310>]}


============================== 19:18:41.151590 | ff4cbce2-d25f-4cd9-afe1-520e4dfa8864 ==============================
[0m19:18:41.151590 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:18:41.151897 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'empty': 'None', 'static_parser': 'True', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_format': 'default', 'target_path': 'None', 'log_cache_events': 'False', 'invocation_command': 'dbt snapshot', 'write_json': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'printer_width': '80', 'version_check': 'True', 'partial_parse': 'True', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'debug': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'introspect': 'True', 'use_colors': 'True'}
[0m19:18:42.067841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ff4cbce2-d25f-4cd9-afe1-520e4dfa8864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f3bd250>]}
[0m19:18:42.084661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ff4cbce2-d25f-4cd9-afe1-520e4dfa8864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c7a5460>]}
[0m19:18:42.085143 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:18:42.095667 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:18:42.151071 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m19:18:42.151318 [debug] [MainThread]: Partial parsing: added file: dw_project://snapshots/snapshot_historical.sql
[0m19:18:42.151440 [debug] [MainThread]: Partial parsing: added file: dw_project://snapshots/snapshot_realtime.sql
[0m19:18:42.216324 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot snapshot_bitcoin_realtime (snapshots/snapshot_realtime.sql)
  invalid syntax for function call expression
    line 4
      config(
[0m19:18:42.218201 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 1.0919983, "process_user_time": 2.591706, "process_kernel_time": 1.3282, "process_mem_max_rss": "200327168", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:18:42.218439 [debug] [MainThread]: Command `dbt snapshot` failed at 19:18:42.218401 after 1.09 seconds
[0m19:18:42.218596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063a41a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f6a64e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f61f320>]}
[0m19:18:42.218732 [debug] [MainThread]: Flushing usage events
[0m19:19:49.131398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052c2b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ebfb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e5d430>]}


============================== 19:19:49.133176 | d902648c-af46-4e55-a39a-bbb4d56fd6fa ==============================
[0m19:19:49.133176 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:19:49.133453 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'invocation_command': 'dbt snapshot', 'warn_error': 'None', 'introspect': 'True', 'target_path': 'None', 'indirect_selection': 'eager', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_format': 'default', 'debug': 'False', 'use_colors': 'True', 'version_check': 'True', 'empty': 'None', 'write_json': 'True', 'quiet': 'False', 'fail_fast': 'False', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'cache_selected_only': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'static_parser': 'True'}
[0m19:19:50.065319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd902648c-af46-4e55-a39a-bbb4d56fd6fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16814ade0>]}
[0m19:19:50.082727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd902648c-af46-4e55-a39a-bbb4d56fd6fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071a5f70>]}
[0m19:19:50.083204 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:19:50.091716 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:19:50.148940 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m19:19:50.149213 [debug] [MainThread]: Partial parsing: added file: dw_project://snapshots/snapshot_realtime.sql
[0m19:19:50.149351 [debug] [MainThread]: Partial parsing: added file: dw_project://snapshots/snapshot_historical.sql
[0m19:19:50.250080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd902648c-af46-4e55-a39a-bbb4d56fd6fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16b662c60>]}
[0m19:19:50.289880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd902648c-af46-4e55-a39a-bbb4d56fd6fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16b4eb1a0>]}
[0m19:19:50.290111 [info ] [MainThread]: Found 6 models, 2 snapshots, 3 sources, 459 macros
[0m19:19:50.290261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd902648c-af46-4e55-a39a-bbb4d56fd6fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16b469e20>]}
[0m19:19:50.290948 [info ] [MainThread]: 
[0m19:19:50.291188 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:19:50.292810 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m19:19:50.297776 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m19:19:50.297915 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m19:19:50.298019 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:19:53.687241 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 3.389 seconds
[0m19:19:53.688123 [debug] [ThreadPool]: On list_lab2: Close
[0m19:19:53.854911 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_snapshot)
[0m19:19:53.867534 [debug] [ThreadPool]: Using snowflake connection "list_lab2_snapshot"
[0m19:19:53.867929 [debug] [ThreadPool]: On list_lab2_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_snapshot"} */
show objects in lab2.snapshot limit 10000
[0m19:19:53.868177 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:19:57.738043 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 3.870 seconds
[0m19:19:57.741594 [debug] [ThreadPool]: On list_lab2_snapshot: Close
[0m19:19:57.908283 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2_snapshot, now list_lab2_analytics)
[0m19:19:57.912095 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m19:19:57.912687 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m19:19:57.913184 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:20:00.754091 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.841 seconds
[0m19:20:00.758433 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m19:20:00.935636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd902648c-af46-4e55-a39a-bbb4d56fd6fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a09070>]}
[0m19:20:00.937150 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m19:20:00.937849 [info ] [MainThread]: 
[0m19:20:00.943368 [debug] [Thread-1 (]: Began running node snapshot.dw_project.snapshot_bitcoin_historical
[0m19:20:00.944264 [info ] [Thread-1 (]: 1 of 2 START snapshot snapshot.snapshot_bitcoin_historical ..................... [RUN]
[0m19:20:00.945008 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now snapshot.dw_project.snapshot_bitcoin_historical)
[0m19:20:00.945792 [debug] [Thread-1 (]: Began compiling node snapshot.dw_project.snapshot_bitcoin_historical
[0m19:20:00.956573 [debug] [Thread-1 (]: Writing injected SQL for node "snapshot.dw_project.snapshot_bitcoin_historical"
[0m19:20:00.959034 [debug] [Thread-1 (]: Began executing node snapshot.dw_project.snapshot_bitcoin_historical
[0m19:20:01.000156 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dw_project.snapshot_bitcoin_historical"
[0m19:20:01.000484 [debug] [Thread-1 (]: On snapshot.dw_project.snapshot_bitcoin_historical: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "snapshot.dw_project.snapshot_bitcoin_historical"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "snapshot.dw_project.snapshot_bitcoin_historical"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(TIME_PERIOD_START as varchar ), '')
         || '|' || coalesce(cast(TIMESTAMP as varchar ), '')
        ) as dbt_scd_id,
        TIMESTAMP as dbt_updated_at,
        TIMESTAMP as dbt_valid_from,
        
  
  coalesce(nullif(TIMESTAMP, TIMESTAMP), null)
  as dbt_valid_to

    from (
        


with __dbt__cte__bitcoin_historical as (
SELECT 
    time_period_start,
    time_period_end,
    time_open,
    time_close,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_historical
WHERE time_period_start IS NOT NULL
) SELECT 
  TIME_PERIOD_START,
  TIME_PERIOD_END,
  TIME_OPEN,
  TIME_CLOSE,
  PRICE_OPEN,
  PRICE_HIGH,
  PRICE_LOW,
  PRICE_CLOSE,
  VOLUME_TRADED,
  TRADES_COUNT,
  TIMESTAMP
FROM __dbt__cte__bitcoin_historical

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m19:20:01.000673 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:20:04.285375 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8a488-0003-65cc-0003-437a0010e202
[0m19:20:04.286541 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 45 at position 2
invalid identifier 'TIMESTAMP'
[0m19:20:04.287420 [debug] [Thread-1 (]: On snapshot.dw_project.snapshot_bitcoin_historical: Close
[0m19:20:04.477439 [debug] [Thread-1 (]: Database Error in snapshot snapshot_bitcoin_historical (snapshots/snapshot_historical.sql)
  000904 (42000): SQL compilation error: error line 45 at position 2
  invalid identifier 'TIMESTAMP'
[0m19:20:04.480270 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd902648c-af46-4e55-a39a-bbb4d56fd6fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117da7aa0>]}
[0m19:20:04.481652 [error] [Thread-1 (]: 1 of 2 ERROR snapshotting snapshot.snapshot_bitcoin_historical ................. [[31mERROR[0m in 3.53s]
[0m19:20:04.482430 [debug] [Thread-1 (]: Finished running node snapshot.dw_project.snapshot_bitcoin_historical
[0m19:20:04.482934 [debug] [Thread-1 (]: Began running node snapshot.dw_project.snapshot_bitcoin_realtime
[0m19:20:04.483635 [info ] [Thread-1 (]: 2 of 2 START snapshot snapshot.snapshot_bitcoin_realtime ....................... [RUN]
[0m19:20:04.484281 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dw_project.snapshot_bitcoin_historical, now snapshot.dw_project.snapshot_bitcoin_realtime)
[0m19:20:04.484688 [debug] [Thread-1 (]: Began compiling node snapshot.dw_project.snapshot_bitcoin_realtime
[0m19:20:04.490190 [debug] [Thread-1 (]: Writing injected SQL for node "snapshot.dw_project.snapshot_bitcoin_realtime"
[0m19:20:04.492658 [debug] [Thread-1 (]: Began executing node snapshot.dw_project.snapshot_bitcoin_realtime
[0m19:20:04.495891 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dw_project.snapshot_bitcoin_realtime"
[0m19:20:04.496240 [debug] [Thread-1 (]: On snapshot.dw_project.snapshot_bitcoin_realtime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "snapshot.dw_project.snapshot_bitcoin_realtime"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "snapshot.dw_project.snapshot_bitcoin_realtime"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(TIME_PERIOD_START as varchar ), '')
         || '|' || coalesce(cast(TIMESTAMP as varchar ), '')
        ) as dbt_scd_id,
        TIMESTAMP as dbt_updated_at,
        TIMESTAMP as dbt_valid_from,
        
  
  coalesce(nullif(TIMESTAMP, TIMESTAMP), null)
  as dbt_valid_to

    from (
        



with __dbt__cte__bitcoin_realtime as (
SELECT 
    time_open,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_realtime
WHERE price_close IS NOT NULL
) SELECT 
    TIME_PERIOD_START,
    TIME_PERIOD_END,
    TIME_OPEN,
    TIME_CLOSE,
    PRICE_OPEN,
    PRICE_HIGH,
    PRICE_LOW,
    PRICE_CLOSE,
    VOLUME_TRADED,
    TRADES_COUNT,
    TIMESTAMP
FROM __dbt__cte__bitcoin_realtime

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m19:20:04.496532 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:20:06.684489 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8a488-0003-65cc-0003-437a0010e206
[0m19:20:06.685630 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 33 at position 4
invalid identifier 'TIME_PERIOD_START'
[0m19:20:06.686601 [debug] [Thread-1 (]: On snapshot.dw_project.snapshot_bitcoin_realtime: Close
[0m19:20:06.930363 [debug] [Thread-1 (]: Database Error in snapshot snapshot_bitcoin_realtime (snapshots/snapshot_realtime.sql)
  000904 (42000): SQL compilation error: error line 33 at position 4
  invalid identifier 'TIME_PERIOD_START'
[0m19:20:06.932089 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd902648c-af46-4e55-a39a-bbb4d56fd6fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16b4e5910>]}
[0m19:20:06.933357 [error] [Thread-1 (]: 2 of 2 ERROR snapshotting snapshot.snapshot_bitcoin_realtime ................... [[31mERROR[0m in 2.45s]
[0m19:20:06.934094 [debug] [Thread-1 (]: Finished running node snapshot.dw_project.snapshot_bitcoin_realtime
[0m19:20:06.935444 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:20:06.935837 [debug] [MainThread]: Connection 'snapshot.dw_project.snapshot_bitcoin_realtime' was properly closed.
[0m19:20:06.936165 [info ] [MainThread]: 
[0m19:20:06.936471 [info ] [MainThread]: Finished running 2 snapshots in 0 hours 0 minutes and 16.65 seconds (16.65s).
[0m19:20:06.937180 [debug] [MainThread]: Command end result
[0m19:20:06.959904 [info ] [MainThread]: 
[0m19:20:06.960185 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m19:20:06.960362 [info ] [MainThread]: 
[0m19:20:06.960580 [error] [MainThread]:   Database Error in snapshot snapshot_bitcoin_historical (snapshots/snapshot_historical.sql)
  000904 (42000): SQL compilation error: error line 45 at position 2
  invalid identifier 'TIMESTAMP'
[0m19:20:06.960745 [info ] [MainThread]: 
[0m19:20:06.960925 [error] [MainThread]:   Database Error in snapshot snapshot_bitcoin_realtime (snapshots/snapshot_realtime.sql)
  000904 (42000): SQL compilation error: error line 33 at position 4
  invalid identifier 'TIME_PERIOD_START'
[0m19:20:06.961069 [info ] [MainThread]: 
[0m19:20:06.961236 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m19:20:06.963241 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 17.85625, "process_user_time": 2.435495, "process_kernel_time": 2.28195, "process_mem_max_rss": "209485824", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:20:06.963610 [debug] [MainThread]: Command `dbt snapshot` failed at 19:20:06.963548 after 17.86 seconds
[0m19:20:06.963838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d3e900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e5d340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1696e31a0>]}
[0m19:20:06.964036 [debug] [MainThread]: Flushing usage events
[0m19:21:00.485798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e72b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077afda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077afa40>]}


============================== 19:21:00.487387 | ab943d9d-0894-4453-8d66-d9fc9fd66ce0 ==============================
[0m19:21:00.487387 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:21:00.487697 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'target_path': 'None', 'log_format': 'default', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'printer_width': '80', 'indirect_selection': 'eager', 'no_print': 'None', 'empty': 'None', 'write_json': 'True', 'version_check': 'True', 'log_cache_events': 'False', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'introspect': 'True', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'fail_fast': 'False', 'static_parser': 'True', 'invocation_command': 'dbt snapshot'}
[0m19:21:01.539086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ab943d9d-0894-4453-8d66-d9fc9fd66ce0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10678cf80>]}
[0m19:21:01.555778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ab943d9d-0894-4453-8d66-d9fc9fd66ce0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071cbbc0>]}
[0m19:21:01.556260 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:21:01.564086 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:21:01.626422 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m19:21:01.626716 [debug] [MainThread]: Partial parsing: updated file: dw_project://snapshots/snapshot_historical.sql
[0m19:21:01.626864 [debug] [MainThread]: Partial parsing: updated file: dw_project://snapshots/snapshot_realtime.sql
[0m19:21:01.717207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ab943d9d-0894-4453-8d66-d9fc9fd66ce0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1565abb00>]}
[0m19:21:01.756946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ab943d9d-0894-4453-8d66-d9fc9fd66ce0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1563ad580>]}
[0m19:21:01.757167 [info ] [MainThread]: Found 6 models, 2 snapshots, 3 sources, 459 macros
[0m19:21:01.757305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab943d9d-0894-4453-8d66-d9fc9fd66ce0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1565abb60>]}
[0m19:21:01.757977 [info ] [MainThread]: 
[0m19:21:01.758218 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:21:01.759778 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m19:21:01.764831 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m19:21:01.764982 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m19:21:01.765090 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:21:06.857723 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 5.091 seconds
[0m19:21:06.861720 [debug] [ThreadPool]: On list_lab2: Close
[0m19:21:07.053349 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m19:21:07.066282 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m19:21:07.066888 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m19:21:07.067175 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:21:10.942840 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3.875 seconds
[0m19:21:10.947787 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m19:21:11.134652 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2_analytics, now list_lab2_snapshot)
[0m19:21:11.139766 [debug] [ThreadPool]: Using snowflake connection "list_lab2_snapshot"
[0m19:21:11.140273 [debug] [ThreadPool]: On list_lab2_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_snapshot"} */
show objects in lab2.snapshot limit 10000
[0m19:21:11.140600 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:21:14.043254 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 2.902 seconds
[0m19:21:14.046361 [debug] [ThreadPool]: On list_lab2_snapshot: Close
[0m19:21:14.229211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab943d9d-0894-4453-8d66-d9fc9fd66ce0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a356a0>]}
[0m19:21:14.230526 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m19:21:14.231017 [info ] [MainThread]: 
[0m19:21:14.235612 [debug] [Thread-1 (]: Began running node snapshot.dw_project.snapshot_bitcoin_historical
[0m19:21:14.236325 [info ] [Thread-1 (]: 1 of 2 START snapshot snapshot.snapshot_bitcoin_historical ..................... [RUN]
[0m19:21:14.236870 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_snapshot, now snapshot.dw_project.snapshot_bitcoin_historical)
[0m19:21:14.237568 [debug] [Thread-1 (]: Began compiling node snapshot.dw_project.snapshot_bitcoin_historical
[0m19:21:14.248131 [debug] [Thread-1 (]: Writing injected SQL for node "snapshot.dw_project.snapshot_bitcoin_historical"
[0m19:21:14.250374 [debug] [Thread-1 (]: Began executing node snapshot.dw_project.snapshot_bitcoin_historical
[0m19:21:14.289377 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dw_project.snapshot_bitcoin_historical"
[0m19:21:14.289674 [debug] [Thread-1 (]: On snapshot.dw_project.snapshot_bitcoin_historical: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "snapshot.dw_project.snapshot_bitcoin_historical"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "snapshot.dw_project.snapshot_bitcoin_historical"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(TIMESTAMP as varchar ), '')
         || '|' || coalesce(cast(TIMESTAMP as varchar ), '')
        ) as dbt_scd_id,
        TIMESTAMP as dbt_updated_at,
        TIMESTAMP as dbt_valid_from,
        
  
  coalesce(nullif(TIMESTAMP, TIMESTAMP), null)
  as dbt_valid_to

    from (
        


with __dbt__cte__bitcoin_historical as (
SELECT 
    time_period_start,
    time_period_end,
    time_open,
    time_close,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_historical
WHERE time_period_start IS NOT NULL
) SELECT 
  TIME_PERIOD_START,
  TIME_PERIOD_END,
  TIME_OPEN,
  TIME_CLOSE,
  PRICE_OPEN,
  PRICE_HIGH,
  PRICE_LOW,
  PRICE_CLOSE,
  VOLUME_TRADED,
  TRADES_COUNT,
  TIMESTAMP
FROM __dbt__cte__bitcoin_historical

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m19:21:14.289855 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:21:17.147168 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8a489-0003-6500-0003-437a0011021e
[0m19:21:17.147981 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 45 at position 2
invalid identifier 'TIMESTAMP'
[0m19:21:17.148495 [debug] [Thread-1 (]: On snapshot.dw_project.snapshot_bitcoin_historical: Close
[0m19:21:17.338829 [debug] [Thread-1 (]: Database Error in snapshot snapshot_bitcoin_historical (snapshots/snapshot_historical.sql)
  000904 (42000): SQL compilation error: error line 45 at position 2
  invalid identifier 'TIMESTAMP'
[0m19:21:17.341473 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab943d9d-0894-4453-8d66-d9fc9fd66ce0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106de1c40>]}
[0m19:21:17.342651 [error] [Thread-1 (]: 1 of 2 ERROR snapshotting snapshot.snapshot_bitcoin_historical ................. [[31mERROR[0m in 3.10s]
[0m19:21:17.343787 [debug] [Thread-1 (]: Finished running node snapshot.dw_project.snapshot_bitcoin_historical
[0m19:21:17.344668 [debug] [Thread-1 (]: Began running node snapshot.dw_project.snapshot_bitcoin_realtime
[0m19:21:17.345492 [info ] [Thread-1 (]: 2 of 2 START snapshot snapshot.snapshot_bitcoin_realtime ....................... [RUN]
[0m19:21:17.346209 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dw_project.snapshot_bitcoin_historical, now snapshot.dw_project.snapshot_bitcoin_realtime)
[0m19:21:17.346642 [debug] [Thread-1 (]: Began compiling node snapshot.dw_project.snapshot_bitcoin_realtime
[0m19:21:17.354011 [debug] [Thread-1 (]: Writing injected SQL for node "snapshot.dw_project.snapshot_bitcoin_realtime"
[0m19:21:17.356354 [debug] [Thread-1 (]: Began executing node snapshot.dw_project.snapshot_bitcoin_realtime
[0m19:21:17.359555 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dw_project.snapshot_bitcoin_realtime"
[0m19:21:17.359986 [debug] [Thread-1 (]: On snapshot.dw_project.snapshot_bitcoin_realtime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "snapshot.dw_project.snapshot_bitcoin_realtime"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "snapshot.dw_project.snapshot_bitcoin_realtime"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(TIMESTAMP as varchar ), '')
         || '|' || coalesce(cast(TIMESTAMP as varchar ), '')
        ) as dbt_scd_id,
        TIMESTAMP as dbt_updated_at,
        TIMESTAMP as dbt_valid_from,
        
  
  coalesce(nullif(TIMESTAMP, TIMESTAMP), null)
  as dbt_valid_to

    from (
        



with __dbt__cte__bitcoin_realtime as (
SELECT 
    time_open,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_realtime
WHERE price_close IS NOT NULL
) SELECT 
    TIME_PERIOD_START,
    TIME_PERIOD_END,
    TIME_OPEN,
    TIME_CLOSE,
    PRICE_OPEN,
    PRICE_HIGH,
    PRICE_LOW,
    PRICE_CLOSE,
    VOLUME_TRADED,
    TRADES_COUNT,
    TIMESTAMP
FROM __dbt__cte__bitcoin_realtime

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m19:21:17.360296 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:21:20.584899 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8a489-0003-65c7-0003-437a0010f1d6
[0m19:21:20.586189 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 33 at position 4
invalid identifier 'TIME_PERIOD_START'
[0m19:21:20.587205 [debug] [Thread-1 (]: On snapshot.dw_project.snapshot_bitcoin_realtime: Close
[0m19:21:20.770505 [debug] [Thread-1 (]: Database Error in snapshot snapshot_bitcoin_realtime (snapshots/snapshot_realtime.sql)
  000904 (42000): SQL compilation error: error line 33 at position 4
  invalid identifier 'TIME_PERIOD_START'
[0m19:21:20.771227 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab943d9d-0894-4453-8d66-d9fc9fd66ce0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15652cfb0>]}
[0m19:21:20.772237 [error] [Thread-1 (]: 2 of 2 ERROR snapshotting snapshot.snapshot_bitcoin_realtime ................... [[31mERROR[0m in 3.43s]
[0m19:21:20.773026 [debug] [Thread-1 (]: Finished running node snapshot.dw_project.snapshot_bitcoin_realtime
[0m19:21:20.774210 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:21:20.774503 [debug] [MainThread]: Connection 'snapshot.dw_project.snapshot_bitcoin_realtime' was properly closed.
[0m19:21:20.774776 [info ] [MainThread]: 
[0m19:21:20.775060 [info ] [MainThread]: Finished running 2 snapshots in 0 hours 0 minutes and 19.02 seconds (19.02s).
[0m19:21:20.775747 [debug] [MainThread]: Command end result
[0m19:21:20.792654 [info ] [MainThread]: 
[0m19:21:20.792963 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m19:21:20.793120 [info ] [MainThread]: 
[0m19:21:20.793308 [error] [MainThread]:   Database Error in snapshot snapshot_bitcoin_historical (snapshots/snapshot_historical.sql)
  000904 (42000): SQL compilation error: error line 45 at position 2
  invalid identifier 'TIMESTAMP'
[0m19:21:20.793441 [info ] [MainThread]: 
[0m19:21:20.793597 [error] [MainThread]:   Database Error in snapshot snapshot_bitcoin_realtime (snapshots/snapshot_realtime.sql)
  000904 (42000): SQL compilation error: error line 33 at position 4
  invalid identifier 'TIME_PERIOD_START'
[0m19:21:20.793723 [info ] [MainThread]: 
[0m19:21:20.793879 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m19:21:20.795536 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 20.334034, "process_user_time": 2.464216, "process_kernel_time": 2.28764, "process_mem_max_rss": "209223680", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:21:20.795797 [debug] [MainThread]: Command `dbt snapshot` failed at 19:21:20.795756 after 20.33 seconds
[0m19:21:20.795972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155eb98e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077afda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077afc80>]}
[0m19:21:20.796128 [debug] [MainThread]: Flushing usage events
[0m19:22:45.095242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105094200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e3bc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e3b920>]}


============================== 19:22:45.096895 | f9a592e3-c2e3-410d-8bee-1ccea6363b5e ==============================
[0m19:22:45.096895 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:22:45.097184 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'empty': 'None', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'log_format': 'default', 'fail_fast': 'False', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'target_path': 'None', 'printer_width': '80', 'introspect': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'write_json': 'True', 'no_print': 'None', 'debug': 'False', 'quiet': 'False', 'static_parser': 'True', 'version_check': 'True', 'use_colors': 'True', 'log_cache_events': 'False', 'partial_parse': 'True'}
[0m19:22:45.991208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f9a592e3-c2e3-410d-8bee-1ccea6363b5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14223b6b0>]}
[0m19:22:46.007835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f9a592e3-c2e3-410d-8bee-1ccea6363b5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142254bc0>]}
[0m19:22:46.008306 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:22:46.016826 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:22:46.077560 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m19:22:46.077848 [debug] [MainThread]: Partial parsing: updated file: dw_project://snapshots/snapshot_realtime.sql
[0m19:22:46.077998 [debug] [MainThread]: Partial parsing: updated file: dw_project://snapshots/snapshot_historical.sql
[0m19:22:46.174122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f9a592e3-c2e3-410d-8bee-1ccea6363b5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1522fb020>]}
[0m19:22:46.213021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f9a592e3-c2e3-410d-8bee-1ccea6363b5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1522a9160>]}
[0m19:22:46.213232 [info ] [MainThread]: Found 6 models, 2 snapshots, 3 sources, 459 macros
[0m19:22:46.213376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9a592e3-c2e3-410d-8bee-1ccea6363b5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e09430>]}
[0m19:22:46.214054 [info ] [MainThread]: 
[0m19:22:46.214294 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:22:46.215868 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m19:22:46.220851 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m19:22:46.220988 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m19:22:46.221092 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:22:51.311570 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 5.089 seconds
[0m19:22:51.315570 [debug] [ThreadPool]: On list_lab2: Close
[0m19:22:51.526803 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_snapshot)
[0m19:22:51.537555 [debug] [ThreadPool]: Using snowflake connection "list_lab2_snapshot"
[0m19:22:51.538052 [debug] [ThreadPool]: On list_lab2_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_snapshot"} */
show objects in lab2.snapshot limit 10000
[0m19:22:51.538324 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:22:55.567395 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 4.029 seconds
[0m19:22:55.571564 [debug] [ThreadPool]: On list_lab2_snapshot: Close
[0m19:22:55.764082 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2_snapshot, now list_lab2_analytics)
[0m19:22:55.768706 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m19:22:55.769460 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m19:22:55.769980 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:22:59.573141 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3.803 seconds
[0m19:22:59.577178 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m19:22:59.739439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9a592e3-c2e3-410d-8bee-1ccea6363b5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a7b860>]}
[0m19:22:59.740777 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m19:22:59.741369 [info ] [MainThread]: 
[0m19:22:59.747222 [debug] [Thread-1 (]: Began running node snapshot.dw_project.snapshot_bitcoin_historical
[0m19:22:59.748124 [info ] [Thread-1 (]: 1 of 2 START snapshot snapshot.snapshot_bitcoin_historical ..................... [RUN]
[0m19:22:59.748671 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now snapshot.dw_project.snapshot_bitcoin_historical)
[0m19:22:59.749047 [debug] [Thread-1 (]: Began compiling node snapshot.dw_project.snapshot_bitcoin_historical
[0m19:22:59.759136 [debug] [Thread-1 (]: Writing injected SQL for node "snapshot.dw_project.snapshot_bitcoin_historical"
[0m19:22:59.761263 [debug] [Thread-1 (]: Began executing node snapshot.dw_project.snapshot_bitcoin_historical
[0m19:22:59.800569 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dw_project.snapshot_bitcoin_historical"
[0m19:22:59.800910 [debug] [Thread-1 (]: On snapshot.dw_project.snapshot_bitcoin_historical: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "snapshot.dw_project.snapshot_bitcoin_historical"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "snapshot.dw_project.snapshot_bitcoin_historical"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(TIME_PERIOD_START as varchar ), '')
         || '|' || coalesce(cast(TIMESTAMP as varchar ), '')
        ) as dbt_scd_id,
        TIMESTAMP as dbt_updated_at,
        TIMESTAMP as dbt_valid_from,
        
  
  coalesce(nullif(TIMESTAMP, TIMESTAMP), null)
  as dbt_valid_to

    from (
        


with __dbt__cte__bitcoin_historical as (
SELECT 
    time_period_start,
    time_period_end,
    time_open,
    time_close,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_historical
WHERE time_period_start IS NOT NULL
) SELECT 
  TIME_PERIOD_START,
  TIME_PERIOD_END,
  TIME_OPEN,
  TIME_CLOSE,
  PRICE_OPEN,
  PRICE_HIGH,
  PRICE_LOW,
  PRICE_CLOSE,
  VOLUME_TRADED,
  TRADES_COUNT,
  TIMESTAMP
FROM __dbt__cte__bitcoin_historical

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m19:22:59.801105 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:23:02.117516 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8a48b-0003-65c7-0003-437a0010f1e2
[0m19:23:02.118313 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 45 at position 2
invalid identifier 'TIMESTAMP'
[0m19:23:02.118925 [debug] [Thread-1 (]: On snapshot.dw_project.snapshot_bitcoin_historical: Close
[0m19:23:02.303355 [debug] [Thread-1 (]: Database Error in snapshot snapshot_bitcoin_historical (snapshots/snapshot_historical.sql)
  000904 (42000): SQL compilation error: error line 45 at position 2
  invalid identifier 'TIMESTAMP'
[0m19:23:02.305206 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9a592e3-c2e3-410d-8bee-1ccea6363b5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1521a9730>]}
[0m19:23:02.306088 [error] [Thread-1 (]: 1 of 2 ERROR snapshotting snapshot.snapshot_bitcoin_historical ................. [[31mERROR[0m in 2.56s]
[0m19:23:02.306691 [debug] [Thread-1 (]: Finished running node snapshot.dw_project.snapshot_bitcoin_historical
[0m19:23:02.307099 [debug] [Thread-1 (]: Began running node snapshot.dw_project.snapshot_bitcoin_realtime
[0m19:23:02.307733 [info ] [Thread-1 (]: 2 of 2 START snapshot snapshot.snapshot_bitcoin_realtime ....................... [RUN]
[0m19:23:02.308286 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dw_project.snapshot_bitcoin_historical, now snapshot.dw_project.snapshot_bitcoin_realtime)
[0m19:23:02.308645 [debug] [Thread-1 (]: Began compiling node snapshot.dw_project.snapshot_bitcoin_realtime
[0m19:23:02.314845 [debug] [Thread-1 (]: Writing injected SQL for node "snapshot.dw_project.snapshot_bitcoin_realtime"
[0m19:23:02.316873 [debug] [Thread-1 (]: Began executing node snapshot.dw_project.snapshot_bitcoin_realtime
[0m19:23:02.319609 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dw_project.snapshot_bitcoin_realtime"
[0m19:23:02.319969 [debug] [Thread-1 (]: On snapshot.dw_project.snapshot_bitcoin_realtime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "snapshot.dw_project.snapshot_bitcoin_realtime"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "snapshot.dw_project.snapshot_bitcoin_realtime"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(TIME_OPEN as varchar ), '')
         || '|' || coalesce(cast(TIMESTAMP as varchar ), '')
        ) as dbt_scd_id,
        TIMESTAMP as dbt_updated_at,
        TIMESTAMP as dbt_valid_from,
        
  
  coalesce(nullif(TIMESTAMP, TIMESTAMP), null)
  as dbt_valid_to

    from (
        



with __dbt__cte__bitcoin_realtime as (
SELECT 
    time_open,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_realtime
WHERE price_close IS NOT NULL
) SELECT 
    TIME_PERIOD_START,
    TIME_PERIOD_END,
    TIME_OPEN,
    TIME_CLOSE,
    PRICE_OPEN,
    PRICE_HIGH,
    PRICE_LOW,
    PRICE_CLOSE,
    VOLUME_TRADED,
    TRADES_COUNT,
    TIMESTAMP
FROM __dbt__cte__bitcoin_realtime

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m19:23:02.320238 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:23:04.264840 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8a48b-0003-6460-0003-437a0010b282
[0m19:23:04.265395 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 33 at position 4
invalid identifier 'TIME_PERIOD_START'
[0m19:23:04.265927 [debug] [Thread-1 (]: On snapshot.dw_project.snapshot_bitcoin_realtime: Close
[0m19:23:04.439547 [debug] [Thread-1 (]: Database Error in snapshot snapshot_bitcoin_realtime (snapshots/snapshot_realtime.sql)
  000904 (42000): SQL compilation error: error line 33 at position 4
  invalid identifier 'TIME_PERIOD_START'
[0m19:23:04.440843 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9a592e3-c2e3-410d-8bee-1ccea6363b5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15224cce0>]}
[0m19:23:04.441868 [error] [Thread-1 (]: 2 of 2 ERROR snapshotting snapshot.snapshot_bitcoin_realtime ................... [[31mERROR[0m in 2.13s]
[0m19:23:04.442738 [debug] [Thread-1 (]: Finished running node snapshot.dw_project.snapshot_bitcoin_realtime
[0m19:23:04.444403 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:23:04.444851 [debug] [MainThread]: Connection 'snapshot.dw_project.snapshot_bitcoin_realtime' was properly closed.
[0m19:23:04.445209 [info ] [MainThread]: 
[0m19:23:04.445580 [info ] [MainThread]: Finished running 2 snapshots in 0 hours 0 minutes and 18.23 seconds (18.23s).
[0m19:23:04.446414 [debug] [MainThread]: Command end result
[0m19:23:04.469098 [info ] [MainThread]: 
[0m19:23:04.469474 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m19:23:04.469669 [info ] [MainThread]: 
[0m19:23:04.469886 [error] [MainThread]:   Database Error in snapshot snapshot_bitcoin_historical (snapshots/snapshot_historical.sql)
  000904 (42000): SQL compilation error: error line 45 at position 2
  invalid identifier 'TIMESTAMP'
[0m19:23:04.470056 [info ] [MainThread]: 
[0m19:23:04.470242 [error] [MainThread]:   Database Error in snapshot snapshot_bitcoin_realtime (snapshots/snapshot_realtime.sql)
  000904 (42000): SQL compilation error: error line 33 at position 4
  invalid identifier 'TIME_PERIOD_START'
[0m19:23:04.470400 [info ] [MainThread]: 
[0m19:23:04.470576 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m19:23:04.472404 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 19.40441, "process_user_time": 3.095879, "process_kernel_time": 1.564786, "process_mem_max_rss": "210468864", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:23:04.472707 [debug] [MainThread]: Command `dbt snapshot` failed at 19:23:04.472655 after 19.40 seconds
[0m19:23:04.472922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1522b1250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054d6ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057aae10>]}
[0m19:23:04.473113 [debug] [MainThread]: Flushing usage events
[0m19:25:34.112137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10978ede0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107555460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075554f0>]}


============================== 19:25:34.113846 | e8c1c76b-c840-4af0-9d69-b63e9c0fd0c8 ==============================
[0m19:25:34.113846 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:25:34.114152 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'introspect': 'True', 'printer_width': '80', 'quiet': 'False', 'log_cache_events': 'False', 'write_json': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'empty': 'None', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'debug': 'False', 'invocation_command': 'dbt snapshot', 'cache_selected_only': 'False', 'log_format': 'default', 'use_colors': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'no_print': 'None', 'fail_fast': 'False'}
[0m19:25:35.185744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e8c1c76b-c840-4af0-9d69-b63e9c0fd0c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3ea720>]}
[0m19:25:35.202608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e8c1c76b-c840-4af0-9d69-b63e9c0fd0c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16948ef00>]}
[0m19:25:35.203123 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:25:35.212361 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:25:35.272732 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m19:25:35.273010 [debug] [MainThread]: Partial parsing: updated file: dw_project://snapshots/snapshot_realtime.sql
[0m19:25:35.273151 [debug] [MainThread]: Partial parsing: updated file: dw_project://snapshots/snapshot_historical.sql
[0m19:25:35.325530 [error] [MainThread]: Encountered an error:
Parsing Error
  at path []: Snapshots must be configured with a 'strategy', 'unique_key', and 'target_schema'.
[0m19:25:35.327792 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 1.2396978, "process_user_time": 1.792682, "process_kernel_time": 2.235115, "process_mem_max_rss": "197640192", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:25:35.328077 [debug] [MainThread]: Command `dbt snapshot` failed at 19:25:35.328032 after 1.24 seconds
[0m19:25:35.328247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a739b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16d63fd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e84140>]}
[0m19:25:35.328390 [debug] [MainThread]: Flushing usage events
[0m19:28:17.327835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1029cedb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044cd3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044cd430>]}


============================== 19:28:17.329467 | cbc6a142-2d6a-4c8d-87a8-cf54abbd1ce7 ==============================
[0m19:28:17.329467 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:28:17.329754 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'quiet': 'False', 'write_json': 'True', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'partial_parse': 'True', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'no_print': 'None', 'printer_width': '80', 'use_experimental_parser': 'False', 'warn_error': 'None', 'empty': 'None', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'use_colors': 'True', 'fail_fast': 'False', 'cache_selected_only': 'False'}
[0m19:28:18.244009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cbc6a142-2d6a-4c8d-87a8-cf54abbd1ce7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15146ccb0>]}
[0m19:28:18.260439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cbc6a142-2d6a-4c8d-87a8-cf54abbd1ce7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12244bf20>]}
[0m19:28:18.260946 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:28:18.269011 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:28:18.329051 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:28:18.329327 [debug] [MainThread]: Partial parsing: updated file: dw_project://snapshots/snapshot_realtime.sql
[0m19:28:18.422907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cbc6a142-2d6a-4c8d-87a8-cf54abbd1ce7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153896270>]}
[0m19:28:18.461439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cbc6a142-2d6a-4c8d-87a8-cf54abbd1ce7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153bedb80>]}
[0m19:28:18.461651 [info ] [MainThread]: Found 6 models, 2 snapshots, 3 sources, 459 macros
[0m19:28:18.461789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cbc6a142-2d6a-4c8d-87a8-cf54abbd1ce7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153bc8140>]}
[0m19:28:18.462456 [info ] [MainThread]: 
[0m19:28:18.462688 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:28:18.464266 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m19:28:18.468968 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m19:28:18.469109 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m19:28:18.469215 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:28:19.435677 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.965 seconds
[0m19:28:19.439946 [debug] [ThreadPool]: On list_lab2: Close
[0m19:28:19.658524 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_snapshot)
[0m19:28:19.727064 [debug] [ThreadPool]: Using snowflake connection "list_lab2_snapshot"
[0m19:28:19.727374 [debug] [ThreadPool]: On list_lab2_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_snapshot"} */
show objects in lab2.snapshot limit 10000
[0m19:28:19.727527 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:28:20.413915 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.686 seconds
[0m19:28:20.417603 [debug] [ThreadPool]: On list_lab2_snapshot: Close
[0m19:28:20.621628 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2_snapshot, now list_lab2_analytics)
[0m19:28:20.627205 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m19:28:20.627879 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m19:28:20.628330 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:28:21.326772 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.698 seconds
[0m19:28:21.331059 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m19:28:21.556838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cbc6a142-2d6a-4c8d-87a8-cf54abbd1ce7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057a8aa0>]}
[0m19:28:21.558057 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m19:28:21.558562 [info ] [MainThread]: 
[0m19:28:21.562620 [debug] [Thread-1 (]: Began running node snapshot.dw_project.snapshot_bitcoin_historical
[0m19:28:21.563141 [info ] [Thread-1 (]: 1 of 2 START snapshot snapshot.snapshot_bitcoin_historical ..................... [RUN]
[0m19:28:21.563553 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now snapshot.dw_project.snapshot_bitcoin_historical)
[0m19:28:21.563870 [debug] [Thread-1 (]: Began compiling node snapshot.dw_project.snapshot_bitcoin_historical
[0m19:28:21.572826 [debug] [Thread-1 (]: Writing injected SQL for node "snapshot.dw_project.snapshot_bitcoin_historical"
[0m19:28:21.575118 [debug] [Thread-1 (]: Began executing node snapshot.dw_project.snapshot_bitcoin_historical
[0m19:28:21.613247 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dw_project.snapshot_bitcoin_historical"
[0m19:28:21.613534 [debug] [Thread-1 (]: On snapshot.dw_project.snapshot_bitcoin_historical: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "snapshot.dw_project.snapshot_bitcoin_historical"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "snapshot.dw_project.snapshot_bitcoin_historical"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(TIME_PERIOD_START as varchar ), '')
         || '|' || coalesce(cast(TIMESTAMP as varchar ), '')
        ) as dbt_scd_id,
        TIMESTAMP as dbt_updated_at,
        TIMESTAMP as dbt_valid_from,
        
  
  coalesce(nullif(TIMESTAMP, TIMESTAMP), null)
  as dbt_valid_to

    from (
        


with __dbt__cte__bitcoin_historical as (
SELECT 
    time_period_start,
    time_period_end,
    time_open,
    time_close,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_historical
WHERE time_period_start IS NOT NULL
) SELECT 
  TIME_PERIOD_START,
  TIME_PERIOD_END,
  TIME_OPEN,
  TIME_CLOSE,
  PRICE_OPEN,
  PRICE_HIGH,
  PRICE_LOW,
  PRICE_CLOSE,
  VOLUME_TRADED,
  TRADES_COUNT,
  TIMESTAMP
FROM __dbt__cte__bitcoin_historical

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m19:28:21.613711 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:28:22.268756 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8a490-0003-65c7-0003-437a0010f1f2
[0m19:28:22.269273 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 45 at position 2
invalid identifier 'TIMESTAMP'
[0m19:28:22.269777 [debug] [Thread-1 (]: On snapshot.dw_project.snapshot_bitcoin_historical: Close
[0m19:28:22.461679 [debug] [Thread-1 (]: Database Error in snapshot snapshot_bitcoin_historical (snapshots/snapshot_historical.sql)
  000904 (42000): SQL compilation error: error line 45 at position 2
  invalid identifier 'TIMESTAMP'
[0m19:28:22.464374 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbc6a142-2d6a-4c8d-87a8-cf54abbd1ce7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b219a0>]}
[0m19:28:22.465573 [error] [Thread-1 (]: 1 of 2 ERROR snapshotting snapshot.snapshot_bitcoin_historical ................. [[31mERROR[0m in 0.90s]
[0m19:28:22.466352 [debug] [Thread-1 (]: Finished running node snapshot.dw_project.snapshot_bitcoin_historical
[0m19:28:22.466823 [debug] [Thread-1 (]: Began running node snapshot.dw_project.snapshot_bitcoin_realtime
[0m19:28:22.467507 [info ] [Thread-1 (]: 2 of 2 START snapshot snapshot.snapshot_bitcoin_realtime ....................... [RUN]
[0m19:28:22.468163 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dw_project.snapshot_bitcoin_historical, now snapshot.dw_project.snapshot_bitcoin_realtime)
[0m19:28:22.468578 [debug] [Thread-1 (]: Began compiling node snapshot.dw_project.snapshot_bitcoin_realtime
[0m19:28:22.474259 [debug] [Thread-1 (]: Writing injected SQL for node "snapshot.dw_project.snapshot_bitcoin_realtime"
[0m19:28:22.478608 [debug] [Thread-1 (]: Began executing node snapshot.dw_project.snapshot_bitcoin_realtime
[0m19:28:22.481813 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dw_project.snapshot_bitcoin_realtime"
[0m19:28:22.482137 [debug] [Thread-1 (]: On snapshot.dw_project.snapshot_bitcoin_realtime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "snapshot.dw_project.snapshot_bitcoin_realtime"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "snapshot.dw_project.snapshot_bitcoin_realtime"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(TIME_PERIOD_START as varchar ), '')
         || '|' || coalesce(cast(TIMESTAMP as varchar ), '')
        ) as dbt_scd_id,
        TIMESTAMP as dbt_updated_at,
        TIMESTAMP as dbt_valid_from,
        
  
  coalesce(nullif(TIMESTAMP, TIMESTAMP), null)
  as dbt_valid_to

    from (
        



with __dbt__cte__bitcoin_realtime as (
SELECT 
    time_open,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_realtime
WHERE price_close IS NOT NULL
) SELECT 
    TIME_PERIOD_START,
    TIME_PERIOD_END,
    TIME_OPEN,
    TIME_CLOSE,
    PRICE_OPEN,
    PRICE_HIGH,
    PRICE_LOW,
    PRICE_CLOSE,
    VOLUME_TRADED,
    TRADES_COUNT,
    TIMESTAMP
FROM __dbt__cte__bitcoin_realtime

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m19:28:22.482437 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:28:23.143508 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8a490-0003-62ff-0003-437a001034c2
[0m19:28:23.144340 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 33 at position 4
invalid identifier 'TIME_PERIOD_START'
[0m19:28:23.145071 [debug] [Thread-1 (]: On snapshot.dw_project.snapshot_bitcoin_realtime: Close
[0m19:28:23.345771 [debug] [Thread-1 (]: Database Error in snapshot snapshot_bitcoin_realtime (snapshots/snapshot_realtime.sql)
  000904 (42000): SQL compilation error: error line 33 at position 4
  invalid identifier 'TIME_PERIOD_START'
[0m19:28:23.346623 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbc6a142-2d6a-4c8d-87a8-cf54abbd1ce7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153821f40>]}
[0m19:28:23.347611 [error] [Thread-1 (]: 2 of 2 ERROR snapshotting snapshot.snapshot_bitcoin_realtime ................... [[31mERROR[0m in 0.88s]
[0m19:28:23.348314 [debug] [Thread-1 (]: Finished running node snapshot.dw_project.snapshot_bitcoin_realtime
[0m19:28:23.349653 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:28:23.350050 [debug] [MainThread]: Connection 'snapshot.dw_project.snapshot_bitcoin_realtime' was properly closed.
[0m19:28:23.350478 [info ] [MainThread]: 
[0m19:28:23.350931 [info ] [MainThread]: Finished running 2 snapshots in 0 hours 0 minutes and 4.89 seconds (4.89s).
[0m19:28:23.351800 [debug] [MainThread]: Command end result
[0m19:28:23.366581 [info ] [MainThread]: 
[0m19:28:23.366891 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m19:28:23.367030 [info ] [MainThread]: 
[0m19:28:23.367202 [error] [MainThread]:   Database Error in snapshot snapshot_bitcoin_historical (snapshots/snapshot_historical.sql)
  000904 (42000): SQL compilation error: error line 45 at position 2
  invalid identifier 'TIMESTAMP'
[0m19:28:23.367322 [info ] [MainThread]: 
[0m19:28:23.367451 [error] [MainThread]:   Database Error in snapshot snapshot_bitcoin_realtime (snapshots/snapshot_realtime.sql)
  000904 (42000): SQL compilation error: error line 33 at position 4
  invalid identifier 'TIME_PERIOD_START'
[0m19:28:23.367557 [info ] [MainThread]: 
[0m19:28:23.367676 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m19:28:23.369225 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 6.066439, "process_user_time": 2.837673, "process_kernel_time": 1.666178, "process_mem_max_rss": "209108992", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:28:23.369460 [debug] [MainThread]: Command `dbt snapshot` failed at 19:28:23.369424 after 6.07 seconds
[0m19:28:23.369621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054ebd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10447e0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10447cad0>]}
[0m19:28:23.369756 [debug] [MainThread]: Flushing usage events
[0m19:29:55.875310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aaa6b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b659340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b659250>]}


============================== 19:29:55.876833 | f55eb7d5-a154-416d-aa14-6b2c2263941b ==============================
[0m19:29:55.876833 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:29:55.877110 [debug] [MainThread]: running dbt with arguments {'empty': 'None', 'static_parser': 'True', 'warn_error': 'None', 'target_path': 'None', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'partial_parse': 'True', 'fail_fast': 'False', 'log_cache_events': 'False', 'debug': 'False', 'quiet': 'False', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'use_colors': 'True', 'introspect': 'True', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'write_json': 'True', 'printer_width': '80'}
[0m19:29:56.859365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f55eb7d5-a154-416d-aa14-6b2c2263941b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af84200>]}
[0m19:29:56.877403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f55eb7d5-a154-416d-aa14-6b2c2263941b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c137680>]}
[0m19:29:56.878000 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:29:56.887295 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:29:56.952487 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:29:56.952722 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:29:56.969091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f55eb7d5-a154-416d-aa14-6b2c2263941b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ff6eb40>]}
[0m19:29:57.012152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f55eb7d5-a154-416d-aa14-6b2c2263941b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c28b950>]}
[0m19:29:57.012443 [info ] [MainThread]: Found 6 models, 2 snapshots, 3 sources, 459 macros
[0m19:29:57.012607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f55eb7d5-a154-416d-aa14-6b2c2263941b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c1dd220>]}
[0m19:29:57.013494 [info ] [MainThread]: 
[0m19:29:57.013784 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:29:57.015666 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m19:29:57.021442 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m19:29:57.021618 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m19:29:57.021726 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:29:57.722230 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.699 seconds
[0m19:29:57.726446 [debug] [ThreadPool]: On list_lab2: Close
[0m19:29:57.949990 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m19:29:57.963000 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m19:29:57.963462 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m19:29:57.963742 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:29:58.585571 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.621 seconds
[0m19:29:58.590218 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m19:29:58.837724 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2_analytics, now list_lab2_snapshot)
[0m19:29:58.844737 [debug] [ThreadPool]: Using snowflake connection "list_lab2_snapshot"
[0m19:29:58.845336 [debug] [ThreadPool]: On list_lab2_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_snapshot"} */
show objects in lab2.snapshot limit 10000
[0m19:29:58.845791 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:29:59.620438 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.774 seconds
[0m19:29:59.623271 [debug] [ThreadPool]: On list_lab2_snapshot: Close
[0m19:29:59.813530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f55eb7d5-a154-416d-aa14-6b2c2263941b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ff23ef0>]}
[0m19:29:59.815123 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m19:29:59.815858 [info ] [MainThread]: 
[0m19:29:59.821913 [debug] [Thread-1 (]: Began running node snapshot.dw_project.snapshot_bitcoin_historical
[0m19:29:59.822741 [info ] [Thread-1 (]: 1 of 2 START snapshot snapshot.snapshot_bitcoin_historical ..................... [RUN]
[0m19:29:59.823360 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_snapshot, now snapshot.dw_project.snapshot_bitcoin_historical)
[0m19:29:59.823845 [debug] [Thread-1 (]: Began compiling node snapshot.dw_project.snapshot_bitcoin_historical
[0m19:29:59.835564 [debug] [Thread-1 (]: Writing injected SQL for node "snapshot.dw_project.snapshot_bitcoin_historical"
[0m19:29:59.838071 [debug] [Thread-1 (]: Began executing node snapshot.dw_project.snapshot_bitcoin_historical
[0m19:29:59.879120 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dw_project.snapshot_bitcoin_historical"
[0m19:29:59.879427 [debug] [Thread-1 (]: On snapshot.dw_project.snapshot_bitcoin_historical: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "snapshot.dw_project.snapshot_bitcoin_historical"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "snapshot.dw_project.snapshot_bitcoin_historical"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(TIME_PERIOD_START as varchar ), '')
         || '|' || coalesce(cast(TIMESTAMP as varchar ), '')
        ) as dbt_scd_id,
        TIMESTAMP as dbt_updated_at,
        TIMESTAMP as dbt_valid_from,
        
  
  coalesce(nullif(TIMESTAMP, TIMESTAMP), null)
  as dbt_valid_to

    from (
        


with __dbt__cte__bitcoin_historical as (
SELECT 
    time_period_start,
    time_period_end,
    time_open,
    time_close,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_historical
WHERE time_period_start IS NOT NULL
) SELECT 
  TIME_PERIOD_START,
  TIME_PERIOD_END,
  TIME_OPEN,
  TIME_CLOSE,
  PRICE_OPEN,
  PRICE_HIGH,
  PRICE_LOW,
  PRICE_CLOSE,
  VOLUME_TRADED,
  TRADES_COUNT,
  TIMESTAMP
FROM __dbt__cte__bitcoin_historical

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m19:29:59.879605 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:30:00.684132 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8a492-0003-62f2-0003-437a000eb782
[0m19:30:00.684777 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 45 at position 2
invalid identifier 'TIMESTAMP'
[0m19:30:00.685322 [debug] [Thread-1 (]: On snapshot.dw_project.snapshot_bitcoin_historical: Close
[0m19:30:00.867313 [debug] [Thread-1 (]: Database Error in snapshot snapshot_bitcoin_historical (snapshots/snapshot_historical.sql)
  000904 (42000): SQL compilation error: error line 45 at position 2
  invalid identifier 'TIMESTAMP'
[0m19:30:00.869260 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f55eb7d5-a154-416d-aa14-6b2c2263941b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bea9cd0>]}
[0m19:30:00.870233 [error] [Thread-1 (]: 1 of 2 ERROR snapshotting snapshot.snapshot_bitcoin_historical ................. [[31mERROR[0m in 1.04s]
[0m19:30:00.870913 [debug] [Thread-1 (]: Finished running node snapshot.dw_project.snapshot_bitcoin_historical
[0m19:30:00.871359 [debug] [Thread-1 (]: Began running node snapshot.dw_project.snapshot_bitcoin_realtime
[0m19:30:00.872010 [info ] [Thread-1 (]: 2 of 2 START snapshot snapshot.snapshot_bitcoin_realtime ....................... [RUN]
[0m19:30:00.872572 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dw_project.snapshot_bitcoin_historical, now snapshot.dw_project.snapshot_bitcoin_realtime)
[0m19:30:00.872948 [debug] [Thread-1 (]: Began compiling node snapshot.dw_project.snapshot_bitcoin_realtime
[0m19:30:00.878361 [debug] [Thread-1 (]: Writing injected SQL for node "snapshot.dw_project.snapshot_bitcoin_realtime"
[0m19:30:00.880753 [debug] [Thread-1 (]: Began executing node snapshot.dw_project.snapshot_bitcoin_realtime
[0m19:30:00.884248 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dw_project.snapshot_bitcoin_realtime"
[0m19:30:00.884603 [debug] [Thread-1 (]: On snapshot.dw_project.snapshot_bitcoin_realtime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "snapshot.dw_project.snapshot_bitcoin_realtime"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "snapshot.dw_project.snapshot_bitcoin_realtime"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(TIME_PERIOD_START as varchar ), '')
         || '|' || coalesce(cast(TIMESTAMP as varchar ), '')
        ) as dbt_scd_id,
        TIMESTAMP as dbt_updated_at,
        TIMESTAMP as dbt_valid_from,
        
  
  coalesce(nullif(TIMESTAMP, TIMESTAMP), null)
  as dbt_valid_to

    from (
        



with __dbt__cte__bitcoin_realtime as (
SELECT 
    time_open,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_realtime
WHERE price_close IS NOT NULL
) SELECT 
    TIME_PERIOD_START,
    TIME_PERIOD_END,
    TIME_OPEN,
    TIME_CLOSE,
    PRICE_OPEN,
    PRICE_HIGH,
    PRICE_LOW,
    PRICE_CLOSE,
    VOLUME_TRADED,
    TRADES_COUNT,
    TIMESTAMP
FROM __dbt__cte__bitcoin_realtime

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m19:30:00.884911 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:30:01.492510 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8a492-0003-6500-0003-437a0011023a
[0m19:30:01.493547 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 33 at position 4
invalid identifier 'TIME_PERIOD_START'
[0m19:30:01.494392 [debug] [Thread-1 (]: On snapshot.dw_project.snapshot_bitcoin_realtime: Close
[0m19:30:01.745142 [debug] [Thread-1 (]: Database Error in snapshot snapshot_bitcoin_realtime (snapshots/snapshot_realtime.sql)
  000904 (42000): SQL compilation error: error line 33 at position 4
  invalid identifier 'TIME_PERIOD_START'
[0m19:30:01.746014 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f55eb7d5-a154-416d-aa14-6b2c2263941b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c4aede0>]}
[0m19:30:01.746949 [error] [Thread-1 (]: 2 of 2 ERROR snapshotting snapshot.snapshot_bitcoin_realtime ................... [[31mERROR[0m in 0.87s]
[0m19:30:01.747703 [debug] [Thread-1 (]: Finished running node snapshot.dw_project.snapshot_bitcoin_realtime
[0m19:30:01.748955 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:30:01.749350 [debug] [MainThread]: Connection 'snapshot.dw_project.snapshot_bitcoin_realtime' was properly closed.
[0m19:30:01.749697 [info ] [MainThread]: 
[0m19:30:01.750026 [info ] [MainThread]: Finished running 2 snapshots in 0 hours 0 minutes and 4.74 seconds (4.74s).
[0m19:30:01.750762 [debug] [MainThread]: Command end result
[0m19:30:01.799436 [info ] [MainThread]: 
[0m19:30:01.799702 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m19:30:01.799830 [info ] [MainThread]: 
[0m19:30:01.799987 [error] [MainThread]:   Database Error in snapshot snapshot_bitcoin_historical (snapshots/snapshot_historical.sql)
  000904 (42000): SQL compilation error: error line 45 at position 2
  invalid identifier 'TIMESTAMP'
[0m19:30:01.800099 [info ] [MainThread]: 
[0m19:30:01.800227 [error] [MainThread]:   Database Error in snapshot snapshot_bitcoin_realtime (snapshots/snapshot_realtime.sql)
  000904 (42000): SQL compilation error: error line 33 at position 4
  invalid identifier 'TIME_PERIOD_START'
[0m19:30:01.800331 [info ] [MainThread]: 
[0m19:30:01.800449 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m19:30:01.801880 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 5.95042, "process_user_time": 2.331796, "process_kernel_time": 2.138476, "process_mem_max_rss": "208945152", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:30:01.802091 [debug] [MainThread]: Command `dbt snapshot` failed at 19:30:01.802056 after 5.95 seconds
[0m19:30:01.802244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c27d100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fa86720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c2300b0>]}
[0m19:30:01.802381 [debug] [MainThread]: Flushing usage events
[0m19:30:50.144470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f3fe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10435d430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10435d3a0>]}


============================== 19:30:50.146045 | 6d76915a-1efd-4b6b-aaf2-84787055eff7 ==============================
[0m19:30:50.146045 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:30:50.146331 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'use_colors': 'True', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'fail_fast': 'False', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'printer_width': '80', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'empty': 'None', 'debug': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'write_json': 'True', 'log_cache_events': 'False', 'introspect': 'True', 'warn_error': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'version_check': 'True'}
[0m19:30:50.849340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d76915a-1efd-4b6b-aaf2-84787055eff7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x160047770>]}
[0m19:30:50.866218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6d76915a-1efd-4b6b-aaf2-84787055eff7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1613970e0>]}
[0m19:30:50.866707 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:30:50.874637 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:30:50.934812 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:30:50.935010 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:30:50.950015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d76915a-1efd-4b6b-aaf2-84787055eff7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1616aa090>]}
[0m19:30:50.987158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d76915a-1efd-4b6b-aaf2-84787055eff7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1616aa660>]}
[0m19:30:50.987396 [info ] [MainThread]: Found 6 models, 2 snapshots, 3 sources, 459 macros
[0m19:30:50.987541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d76915a-1efd-4b6b-aaf2-84787055eff7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x161697680>]}
[0m19:30:50.988227 [info ] [MainThread]: 
[0m19:30:50.988468 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:30:50.990089 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m19:30:50.995650 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m19:30:50.995796 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m19:30:50.995904 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:30:51.773291 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.776 seconds
[0m19:30:51.775572 [debug] [ThreadPool]: On list_lab2: Close
[0m19:30:51.995733 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_snapshot)
[0m19:30:52.008021 [debug] [ThreadPool]: Using snowflake connection "list_lab2_snapshot"
[0m19:30:52.008476 [debug] [ThreadPool]: On list_lab2_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_snapshot"} */
show objects in lab2.snapshot limit 10000
[0m19:30:52.008756 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:30:52.709056 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.700 seconds
[0m19:30:52.712575 [debug] [ThreadPool]: On list_lab2_snapshot: Close
[0m19:30:52.916181 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2_snapshot, now list_lab2_analytics)
[0m19:30:52.920833 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m19:30:52.921449 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m19:30:52.921915 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:30:53.591209 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.669 seconds
[0m19:30:53.594457 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m19:30:53.796514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d76915a-1efd-4b6b-aaf2-84787055eff7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b13c80>]}
[0m19:30:53.797752 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m19:30:53.798279 [info ] [MainThread]: 
[0m19:30:53.802615 [debug] [Thread-1 (]: Began running node snapshot.dw_project.snapshot_bitcoin_historical
[0m19:30:53.803251 [info ] [Thread-1 (]: 1 of 2 START snapshot snapshot.snapshot_bitcoin_historical ..................... [RUN]
[0m19:30:53.803730 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now snapshot.dw_project.snapshot_bitcoin_historical)
[0m19:30:53.804068 [debug] [Thread-1 (]: Began compiling node snapshot.dw_project.snapshot_bitcoin_historical
[0m19:30:53.813393 [debug] [Thread-1 (]: Writing injected SQL for node "snapshot.dw_project.snapshot_bitcoin_historical"
[0m19:30:53.815703 [debug] [Thread-1 (]: Began executing node snapshot.dw_project.snapshot_bitcoin_historical
[0m19:30:53.854548 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dw_project.snapshot_bitcoin_historical"
[0m19:30:53.854860 [debug] [Thread-1 (]: On snapshot.dw_project.snapshot_bitcoin_historical: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "snapshot.dw_project.snapshot_bitcoin_historical"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "snapshot.dw_project.snapshot_bitcoin_historical"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(TIME_PERIOD_START as varchar ), '')
         || '|' || coalesce(cast(TIMESTAMP as varchar ), '')
        ) as dbt_scd_id,
        TIMESTAMP as dbt_updated_at,
        TIMESTAMP as dbt_valid_from,
        
  
  coalesce(nullif(TIMESTAMP, TIMESTAMP), null)
  as dbt_valid_to

    from (
        


with __dbt__cte__bitcoin_historical as (
SELECT 
    time_period_start,
    time_period_end,
    time_open,
    time_close,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_historical
WHERE time_period_start IS NOT NULL
) SELECT 
  TIME_PERIOD_START,
  TIME_PERIOD_END,
  TIME_OPEN,
  TIME_CLOSE,
  PRICE_OPEN,
  PRICE_HIGH,
  PRICE_LOW,
  PRICE_CLOSE,
  VOLUME_TRADED,
  TRADES_COUNT,
  TIMESTAMP
FROM __dbt__cte__bitcoin_historical

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m19:30:53.855041 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:30:54.450015 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8a492-0003-6500-0003-437a0011023e
[0m19:30:54.450708 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 45 at position 2
invalid identifier 'TIMESTAMP'
[0m19:30:54.451249 [debug] [Thread-1 (]: On snapshot.dw_project.snapshot_bitcoin_historical: Close
[0m19:30:54.657103 [debug] [Thread-1 (]: Database Error in snapshot snapshot_bitcoin_historical (snapshots/snapshot_historical.sql)
  000904 (42000): SQL compilation error: error line 45 at position 2
  invalid identifier 'TIMESTAMP'
[0m19:30:54.659887 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d76915a-1efd-4b6b-aaf2-84787055eff7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104badac0>]}
[0m19:30:54.661292 [error] [Thread-1 (]: 1 of 2 ERROR snapshotting snapshot.snapshot_bitcoin_historical ................. [[31mERROR[0m in 0.85s]
[0m19:30:54.662297 [debug] [Thread-1 (]: Finished running node snapshot.dw_project.snapshot_bitcoin_historical
[0m19:30:54.662833 [debug] [Thread-1 (]: Began running node snapshot.dw_project.snapshot_bitcoin_realtime
[0m19:30:54.663667 [info ] [Thread-1 (]: 2 of 2 START snapshot snapshot.snapshot_bitcoin_realtime ....................... [RUN]
[0m19:30:54.664277 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dw_project.snapshot_bitcoin_historical, now snapshot.dw_project.snapshot_bitcoin_realtime)
[0m19:30:54.664754 [debug] [Thread-1 (]: Began compiling node snapshot.dw_project.snapshot_bitcoin_realtime
[0m19:30:54.670311 [debug] [Thread-1 (]: Writing injected SQL for node "snapshot.dw_project.snapshot_bitcoin_realtime"
[0m19:30:54.671901 [debug] [Thread-1 (]: Began executing node snapshot.dw_project.snapshot_bitcoin_realtime
[0m19:30:54.675254 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dw_project.snapshot_bitcoin_realtime"
[0m19:30:54.675500 [debug] [Thread-1 (]: On snapshot.dw_project.snapshot_bitcoin_realtime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "snapshot.dw_project.snapshot_bitcoin_realtime"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "snapshot.dw_project.snapshot_bitcoin_realtime"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(TIME_PERIOD_START as varchar ), '')
         || '|' || coalesce(cast(TIMESTAMP as varchar ), '')
        ) as dbt_scd_id,
        TIMESTAMP as dbt_updated_at,
        TIMESTAMP as dbt_valid_from,
        
  
  coalesce(nullif(TIMESTAMP, TIMESTAMP), null)
  as dbt_valid_to

    from (
        



with __dbt__cte__bitcoin_realtime as (
SELECT 
    time_open,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_realtime
WHERE price_close IS NOT NULL
) SELECT 
    TIME_PERIOD_START,
    TIME_PERIOD_END,
    TIME_OPEN,
    TIME_CLOSE,
    PRICE_OPEN,
    PRICE_HIGH,
    PRICE_LOW,
    PRICE_CLOSE,
    VOLUME_TRADED,
    TRADES_COUNT,
    TIMESTAMP
FROM __dbt__cte__bitcoin_realtime

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m19:30:54.675717 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:30:55.196923 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8a492-0003-62ff-0003-437a001034d2
[0m19:30:55.198246 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 33 at position 4
invalid identifier 'TIME_PERIOD_START'
[0m19:30:55.199192 [debug] [Thread-1 (]: On snapshot.dw_project.snapshot_bitcoin_realtime: Close
[0m19:30:55.436777 [debug] [Thread-1 (]: Database Error in snapshot snapshot_bitcoin_realtime (snapshots/snapshot_realtime.sql)
  000904 (42000): SQL compilation error: error line 33 at position 4
  invalid identifier 'TIME_PERIOD_START'
[0m19:30:55.437650 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d76915a-1efd-4b6b-aaf2-84787055eff7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x164a0b950>]}
[0m19:30:55.439003 [error] [Thread-1 (]: 2 of 2 ERROR snapshotting snapshot.snapshot_bitcoin_realtime ................... [[31mERROR[0m in 0.77s]
[0m19:30:55.439919 [debug] [Thread-1 (]: Finished running node snapshot.dw_project.snapshot_bitcoin_realtime
[0m19:30:55.441532 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:30:55.441981 [debug] [MainThread]: Connection 'snapshot.dw_project.snapshot_bitcoin_realtime' was properly closed.
[0m19:30:55.442361 [info ] [MainThread]: 
[0m19:30:55.442755 [info ] [MainThread]: Finished running 2 snapshots in 0 hours 0 minutes and 4.45 seconds (4.45s).
[0m19:30:55.443695 [debug] [MainThread]: Command end result
[0m19:30:55.507090 [info ] [MainThread]: 
[0m19:30:55.507396 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m19:30:55.507537 [info ] [MainThread]: 
[0m19:30:55.507714 [error] [MainThread]:   Database Error in snapshot snapshot_bitcoin_historical (snapshots/snapshot_historical.sql)
  000904 (42000): SQL compilation error: error line 45 at position 2
  invalid identifier 'TIMESTAMP'
[0m19:30:55.507836 [info ] [MainThread]: 
[0m19:30:55.507987 [error] [MainThread]:   Database Error in snapshot snapshot_bitcoin_realtime (snapshots/snapshot_realtime.sql)
  000904 (42000): SQL compilation error: error line 33 at position 4
  invalid identifier 'TIME_PERIOD_START'
[0m19:30:55.508099 [info ] [MainThread]: 
[0m19:30:55.508229 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m19:30:55.509946 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 5.386896, "process_user_time": 2.504389, "process_kernel_time": 1.89934, "process_mem_max_rss": "208781312", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:30:55.510266 [debug] [MainThread]: Command `dbt snapshot` failed at 19:30:55.510215 after 5.39 seconds
[0m19:30:55.510462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f95e480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104871fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1617fcdd0>]}
[0m19:30:55.510615 [debug] [MainThread]: Flushing usage events
[0m19:33:55.137511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065cb0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10550edb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10703b9b0>]}


============================== 19:33:55.139767 | f13546be-02cd-4d86-88d9-7b40e6365cdf ==============================
[0m19:33:55.139767 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:33:55.140117 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'no_print': 'None', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'static_parser': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'use_colors': 'True', 'partial_parse': 'True', 'log_cache_events': 'False', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'write_json': 'True', 'invocation_command': 'dbt snapshot', 'empty': 'None', 'debug': 'False', 'printer_width': '80', 'version_check': 'True', 'target_path': 'None', 'introspect': 'True'}
[0m19:33:56.071558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f13546be-02cd-4d86-88d9-7b40e6365cdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16b896210>]}
[0m19:33:56.089493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f13546be-02cd-4d86-88d9-7b40e6365cdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16a09f7a0>]}
[0m19:33:56.099669 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:33:56.111347 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:33:56.175684 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m19:33:56.175962 [debug] [MainThread]: Partial parsing: updated file: dw_project://snapshots/snapshot_historical.sql
[0m19:33:56.176126 [debug] [MainThread]: Partial parsing: updated file: dw_project://snapshots/snapshot_realtime.sql
[0m19:33:56.275905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f13546be-02cd-4d86-88d9-7b40e6365cdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16bfabdd0>]}
[0m19:33:56.315565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f13546be-02cd-4d86-88d9-7b40e6365cdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16bdad700>]}
[0m19:33:56.315818 [info ] [MainThread]: Found 6 models, 2 snapshots, 3 sources, 459 macros
[0m19:33:56.315969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f13546be-02cd-4d86-88d9-7b40e6365cdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16baaf5f0>]}
[0m19:33:56.316658 [info ] [MainThread]: 
[0m19:33:56.316907 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:33:56.318530 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m19:33:56.323650 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m19:33:56.323804 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m19:33:56.323925 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:33:57.215505 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.891 seconds
[0m19:33:57.218994 [debug] [ThreadPool]: On list_lab2: Close
[0m19:33:57.938349 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_SNAPSHOT)
[0m19:33:57.951056 [debug] [ThreadPool]: Using snowflake connection "list_lab2_SNAPSHOT"
[0m19:33:57.951497 [debug] [ThreadPool]: On list_lab2_SNAPSHOT: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_SNAPSHOT"} */
show objects in lab2.SNAPSHOT limit 10000
[0m19:33:57.951773 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:33:58.857143 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.905 seconds
[0m19:33:58.860695 [debug] [ThreadPool]: On list_lab2_SNAPSHOT: Close
[0m19:33:59.088986 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2_SNAPSHOT, now list_lab2_analytics)
[0m19:33:59.093874 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m19:33:59.094364 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m19:33:59.094703 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:33:59.758426 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.664 seconds
[0m19:33:59.762533 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m19:33:59.946507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f13546be-02cd-4d86-88d9-7b40e6365cdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111032f0>]}
[0m19:33:59.947956 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m19:33:59.948926 [info ] [MainThread]: 
[0m19:33:59.955658 [debug] [Thread-1 (]: Began running node snapshot.dw_project.snapshot_bitcoin_historical
[0m19:33:59.956817 [info ] [Thread-1 (]: 1 of 2 START snapshot SNAPSHOT.snapshot_bitcoin_historical ..................... [RUN]
[0m19:33:59.957546 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now snapshot.dw_project.snapshot_bitcoin_historical)
[0m19:33:59.957976 [debug] [Thread-1 (]: Began compiling node snapshot.dw_project.snapshot_bitcoin_historical
[0m19:33:59.968574 [debug] [Thread-1 (]: Writing injected SQL for node "snapshot.dw_project.snapshot_bitcoin_historical"
[0m19:33:59.970752 [debug] [Thread-1 (]: Began executing node snapshot.dw_project.snapshot_bitcoin_historical
[0m19:34:00.010627 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dw_project.snapshot_bitcoin_historical"
[0m19:34:00.010920 [debug] [Thread-1 (]: On snapshot.dw_project.snapshot_bitcoin_historical: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "snapshot.dw_project.snapshot_bitcoin_historical"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "snapshot.dw_project.snapshot_bitcoin_historical"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(TIME_PERIOD_START as varchar ), '')
         || '|' || coalesce(cast("TIMESTAMP" as varchar ), '')
        ) as dbt_scd_id,
        "TIMESTAMP" as dbt_updated_at,
        "TIMESTAMP" as dbt_valid_from,
        
  
  coalesce(nullif("TIMESTAMP", "TIMESTAMP"), null)
  as dbt_valid_to

    from (
        


with __dbt__cte__bitcoin_historical as (
SELECT 
    time_period_start,
    time_period_end,
    time_open,
    time_close,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_historical
WHERE time_period_start IS NOT NULL
) SELECT 
  TIME_PERIOD_START,
  TIME_PERIOD_END,
  TIME_OPEN,
  TIME_CLOSE,
  PRICE_OPEN,
  PRICE_HIGH,
  PRICE_LOW,
  PRICE_CLOSE,
  VOLUME_TRADED,
  TRADES_COUNT,
  TIMESTAMP
FROM __dbt__cte__bitcoin_historical

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m19:34:00.011098 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:34:01.023690 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8a496-0003-6460-0003-437a0010b2b2
[0m19:34:01.024381 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 45 at position 2
invalid identifier 'TIMESTAMP'
[0m19:34:01.024942 [debug] [Thread-1 (]: On snapshot.dw_project.snapshot_bitcoin_historical: Close
[0m19:34:01.238637 [debug] [Thread-1 (]: Database Error in snapshot snapshot_bitcoin_historical (snapshots/snapshot_historical.sql)
  000904 (42000): SQL compilation error: error line 45 at position 2
  invalid identifier 'TIMESTAMP'
[0m19:34:01.240893 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f13546be-02cd-4d86-88d9-7b40e6365cdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16be90680>]}
[0m19:34:01.241995 [error] [Thread-1 (]: 1 of 2 ERROR snapshotting SNAPSHOT.snapshot_bitcoin_historical ................. [[31mERROR[0m in 1.28s]
[0m19:34:01.242677 [debug] [Thread-1 (]: Finished running node snapshot.dw_project.snapshot_bitcoin_historical
[0m19:34:01.243126 [debug] [Thread-1 (]: Began running node snapshot.dw_project.snapshot_bitcoin_realtime
[0m19:34:01.243877 [info ] [Thread-1 (]: 2 of 2 START snapshot SNAPSHOT.snapshot_bitcoin_realtime ....................... [RUN]
[0m19:34:01.244778 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dw_project.snapshot_bitcoin_historical, now snapshot.dw_project.snapshot_bitcoin_realtime)
[0m19:34:01.245246 [debug] [Thread-1 (]: Began compiling node snapshot.dw_project.snapshot_bitcoin_realtime
[0m19:34:01.251983 [debug] [Thread-1 (]: Writing injected SQL for node "snapshot.dw_project.snapshot_bitcoin_realtime"
[0m19:34:01.254000 [debug] [Thread-1 (]: Began executing node snapshot.dw_project.snapshot_bitcoin_realtime
[0m19:34:01.257238 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dw_project.snapshot_bitcoin_realtime"
[0m19:34:01.257566 [debug] [Thread-1 (]: On snapshot.dw_project.snapshot_bitcoin_realtime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "snapshot.dw_project.snapshot_bitcoin_realtime"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "snapshot.dw_project.snapshot_bitcoin_realtime"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(TIME_PERIOD_START as varchar ), '')
         || '|' || coalesce(cast("TIMESTAMP" as varchar ), '')
        ) as dbt_scd_id,
        "TIMESTAMP" as dbt_updated_at,
        "TIMESTAMP" as dbt_valid_from,
        
  
  coalesce(nullif("TIMESTAMP", "TIMESTAMP"), null)
  as dbt_valid_to

    from (
        



with __dbt__cte__bitcoin_realtime as (
SELECT 
    time_open,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_realtime
WHERE price_close IS NOT NULL
) SELECT 
    TIME_PERIOD_START,
    TIME_PERIOD_END,
    TIME_OPEN,
    TIME_CLOSE,
    PRICE_OPEN,
    PRICE_HIGH,
    PRICE_LOW,
    PRICE_CLOSE,
    VOLUME_TRADED,
    TRADES_COUNT,
    TIMESTAMP
FROM __dbt__cte__bitcoin_realtime

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m19:34:01.257807 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:34:02.421714 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8a496-0003-62ff-0003-437a001034d6
[0m19:34:02.423101 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 33 at position 4
invalid identifier 'TIME_PERIOD_START'
[0m19:34:02.424363 [debug] [Thread-1 (]: On snapshot.dw_project.snapshot_bitcoin_realtime: Close
[0m19:34:02.659253 [debug] [Thread-1 (]: Database Error in snapshot snapshot_bitcoin_realtime (snapshots/snapshot_realtime.sql)
  000904 (42000): SQL compilation error: error line 33 at position 4
  invalid identifier 'TIME_PERIOD_START'
[0m19:34:02.660400 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f13546be-02cd-4d86-88d9-7b40e6365cdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16bf1a2a0>]}
[0m19:34:02.661618 [error] [Thread-1 (]: 2 of 2 ERROR snapshotting SNAPSHOT.snapshot_bitcoin_realtime ................... [[31mERROR[0m in 1.42s]
[0m19:34:02.662598 [debug] [Thread-1 (]: Finished running node snapshot.dw_project.snapshot_bitcoin_realtime
[0m19:34:02.664557 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:34:02.665149 [debug] [MainThread]: Connection 'snapshot.dw_project.snapshot_bitcoin_realtime' was properly closed.
[0m19:34:02.665791 [info ] [MainThread]: 
[0m19:34:02.666218 [info ] [MainThread]: Finished running 2 snapshots in 0 hours 0 minutes and 6.35 seconds (6.35s).
[0m19:34:02.667091 [debug] [MainThread]: Command end result
[0m19:34:02.690609 [info ] [MainThread]: 
[0m19:34:02.690967 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m19:34:02.691161 [info ] [MainThread]: 
[0m19:34:02.691384 [error] [MainThread]:   Database Error in snapshot snapshot_bitcoin_historical (snapshots/snapshot_historical.sql)
  000904 (42000): SQL compilation error: error line 45 at position 2
  invalid identifier 'TIMESTAMP'
[0m19:34:02.691556 [info ] [MainThread]: 
[0m19:34:02.691744 [error] [MainThread]:   Database Error in snapshot snapshot_bitcoin_realtime (snapshots/snapshot_realtime.sql)
  000904 (42000): SQL compilation error: error line 33 at position 4
  invalid identifier 'TIME_PERIOD_START'
[0m19:34:02.691902 [info ] [MainThread]: 
[0m19:34:02.692079 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m19:34:02.693919 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 7.583906, "process_user_time": 2.889479, "process_kernel_time": 1.642635, "process_mem_max_rss": "208732160", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:34:02.694303 [debug] [MainThread]: Command `dbt snapshot` failed at 19:34:02.694240 after 7.58 seconds
[0m19:34:02.694534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10703bda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16bde1df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16bff1760>]}
[0m19:34:02.694738 [debug] [MainThread]: Flushing usage events
[0m19:36:26.665865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ccaf60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a033890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a033470>]}


============================== 19:36:26.667426 | 964efaf3-1a26-45d8-b6ad-38fa139b01fe ==============================
[0m19:36:26.667426 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:36:26.667739 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'introspect': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'quiet': 'False', 'printer_width': '80', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'log_format': 'default', 'no_print': 'None', 'version_check': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'debug': 'False', 'empty': 'None', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'write_json': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'invocation_command': 'dbt clean'}
[0m19:36:26.772563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '964efaf3-1a26-45d8-b6ad-38fa139b01fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cfa1b0>]}
[0m19:36:26.788791 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.14513612, "process_user_time": 0.583316, "process_kernel_time": 0.114797, "process_mem_max_rss": "110379008", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:36:26.789128 [debug] [MainThread]: Command `dbt clean` succeeded at 19:36:26.789084 after 0.15 seconds
[0m19:36:26.789286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10909c170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a033080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cfa1b0>]}
[0m19:36:26.789421 [debug] [MainThread]: Flushing usage events
[0m19:36:27.844993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10870aa80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5ef410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b604440>]}


============================== 19:36:27.846218 | bb668149-485d-4fa5-a60a-bc3ff2992a2d ==============================
[0m19:36:27.846218 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:36:27.846484 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'cache_selected_only': 'False', 'log_format': 'default', 'write_json': 'True', 'static_parser': 'True', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'version_check': 'True', 'no_print': 'None', 'use_experimental_parser': 'False', 'empty': 'None', 'warn_error': 'None', 'printer_width': '80', 'introspect': 'True', 'partial_parse': 'True', 'invocation_command': 'dbt deps', 'fail_fast': 'False', 'log_cache_events': 'False', 'quiet': 'False', 'indirect_selection': 'eager'}
[0m19:36:27.894669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb668149-485d-4fa5-a60a-bc3ff2992a2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a58ec0>]}
[0m19:36:27.901040 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m19:36:27.901386 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m19:36:27.902027 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.079700544, "process_user_time": 0.526412, "process_kernel_time": 0.083457, "process_mem_max_rss": "108544000", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:36:27.902283 [debug] [MainThread]: Command `dbt deps` succeeded at 19:36:27.902230 after 0.08 seconds
[0m19:36:27.902417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b637980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b166030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d2c5c0>]}
[0m19:36:27.902537 [debug] [MainThread]: Flushing usage events
[0m19:37:43.839538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cac0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b592e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b59250>]}


============================== 19:37:43.841857 | d581637a-c9f0-4de4-b663-0c36e0830ee4 ==============================
[0m19:37:43.841857 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:37:43.842182 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'introspect': 'True', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'indirect_selection': 'eager', 'no_print': 'None', 'write_json': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'printer_width': '80', 'partial_parse': 'True', 'log_cache_events': 'False', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'log_format': 'default', 'empty': 'None', 'fail_fast': 'False', 'static_parser': 'True', 'quiet': 'False', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'warn_error': 'None'}
[0m19:37:44.695800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd581637a-c9f0-4de4-b663-0c36e0830ee4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ce2720>]}
[0m19:37:44.713512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd581637a-c9f0-4de4-b663-0c36e0830ee4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1272e3050>]}
[0m19:37:44.713988 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:37:44.723196 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:37:44.723635 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:37:44.723796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd581637a-c9f0-4de4-b663-0c36e0830ee4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15be23dd0>]}
[0m19:37:45.235663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd581637a-c9f0-4de4-b663-0c36e0830ee4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15c1aa1e0>]}
[0m19:37:45.274091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd581637a-c9f0-4de4-b663-0c36e0830ee4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15c1a8800>]}
[0m19:37:45.274304 [info ] [MainThread]: Found 6 models, 2 snapshots, 3 sources, 459 macros
[0m19:37:45.274445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd581637a-c9f0-4de4-b663-0c36e0830ee4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12524a510>]}
[0m19:37:45.275104 [info ] [MainThread]: 
[0m19:37:45.275336 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:37:45.276974 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m19:37:45.281736 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m19:37:45.281883 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m19:37:45.281992 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:37:46.069150 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.787 seconds
[0m19:37:46.072600 [debug] [ThreadPool]: On list_lab2: Close
[0m19:37:46.530762 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_SNAPSHOT)
[0m19:37:46.544904 [debug] [ThreadPool]: Using snowflake connection "list_lab2_SNAPSHOT"
[0m19:37:46.545509 [debug] [ThreadPool]: On list_lab2_SNAPSHOT: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_SNAPSHOT"} */
show objects in lab2.SNAPSHOT limit 10000
[0m19:37:46.545852 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:37:47.255751 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.710 seconds
[0m19:37:47.258945 [debug] [ThreadPool]: On list_lab2_SNAPSHOT: Close
[0m19:37:47.465559 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2_SNAPSHOT, now list_lab2_analytics)
[0m19:37:47.471894 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m19:37:47.472603 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m19:37:47.473030 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:37:48.436126 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.963 seconds
[0m19:37:48.441205 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m19:37:48.951558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd581637a-c9f0-4de4-b663-0c36e0830ee4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043bbb00>]}
[0m19:37:48.952930 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m19:37:48.953649 [info ] [MainThread]: 
[0m19:37:48.958301 [debug] [Thread-1 (]: Began running node snapshot.dw_project.snapshot_bitcoin_historical
[0m19:37:48.958978 [info ] [Thread-1 (]: 1 of 2 START snapshot SNAPSHOT.snapshot_bitcoin_historical ..................... [RUN]
[0m19:37:48.959452 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_analytics, now snapshot.dw_project.snapshot_bitcoin_historical)
[0m19:37:48.959869 [debug] [Thread-1 (]: Began compiling node snapshot.dw_project.snapshot_bitcoin_historical
[0m19:37:48.971408 [debug] [Thread-1 (]: Writing injected SQL for node "snapshot.dw_project.snapshot_bitcoin_historical"
[0m19:37:48.973145 [debug] [Thread-1 (]: Began executing node snapshot.dw_project.snapshot_bitcoin_historical
[0m19:37:49.014793 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dw_project.snapshot_bitcoin_historical"
[0m19:37:49.015094 [debug] [Thread-1 (]: On snapshot.dw_project.snapshot_bitcoin_historical: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "snapshot.dw_project.snapshot_bitcoin_historical"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "snapshot.dw_project.snapshot_bitcoin_historical"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(TIME_PERIOD_START as varchar ), '')
         || '|' || coalesce(cast("TIMESTAMP" as varchar ), '')
        ) as dbt_scd_id,
        "TIMESTAMP" as dbt_updated_at,
        "TIMESTAMP" as dbt_valid_from,
        
  
  coalesce(nullif("TIMESTAMP", "TIMESTAMP"), null)
  as dbt_valid_to

    from (
        



with __dbt__cte__bitcoin_historical as (
SELECT 
    time_period_start,
    time_period_end,
    time_open,
    time_close,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_historical
WHERE time_period_start IS NOT NULL
) SELECT * FROM __dbt__cte__bitcoin_historical

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m19:37:49.015278 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:37:49.695451 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8a499-0003-65cc-0003-437a0010e22e
[0m19:37:49.696541 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 7 at position 33
invalid identifier 'TIMESTAMP'
[0m19:37:49.697553 [debug] [Thread-1 (]: On snapshot.dw_project.snapshot_bitcoin_historical: Close
[0m19:37:49.889011 [debug] [Thread-1 (]: Database Error in snapshot snapshot_bitcoin_historical (snapshots/snapshot_historical.sql)
  000904 (42000): SQL compilation error: error line 7 at position 33
  invalid identifier 'TIMESTAMP'
[0m19:37:49.890591 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd581637a-c9f0-4de4-b663-0c36e0830ee4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15c5b38c0>]}
[0m19:37:49.891406 [error] [Thread-1 (]: 1 of 2 ERROR snapshotting SNAPSHOT.snapshot_bitcoin_historical ................. [[31mERROR[0m in 0.93s]
[0m19:37:49.892002 [debug] [Thread-1 (]: Finished running node snapshot.dw_project.snapshot_bitcoin_historical
[0m19:37:49.892393 [debug] [Thread-1 (]: Began running node snapshot.dw_project.snapshot_bitcoin_realtime
[0m19:37:49.892958 [info ] [Thread-1 (]: 2 of 2 START snapshot SNAPSHOT.snapshot_bitcoin_realtime ....................... [RUN]
[0m19:37:49.893471 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dw_project.snapshot_bitcoin_historical, now snapshot.dw_project.snapshot_bitcoin_realtime)
[0m19:37:49.893810 [debug] [Thread-1 (]: Began compiling node snapshot.dw_project.snapshot_bitcoin_realtime
[0m19:37:49.898620 [debug] [Thread-1 (]: Writing injected SQL for node "snapshot.dw_project.snapshot_bitcoin_realtime"
[0m19:37:49.899651 [debug] [Thread-1 (]: Began executing node snapshot.dw_project.snapshot_bitcoin_realtime
[0m19:37:49.902496 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dw_project.snapshot_bitcoin_realtime"
[0m19:37:49.902783 [debug] [Thread-1 (]: On snapshot.dw_project.snapshot_bitcoin_realtime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "snapshot.dw_project.snapshot_bitcoin_realtime"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "snapshot.dw_project.snapshot_bitcoin_realtime"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(TIME_PERIOD_START as varchar ), '')
         || '|' || coalesce(cast("TIMESTAMP" as varchar ), '')
        ) as dbt_scd_id,
        "TIMESTAMP" as dbt_updated_at,
        "TIMESTAMP" as dbt_valid_from,
        
  
  coalesce(nullif("TIMESTAMP", "TIMESTAMP"), null)
  as dbt_valid_to

    from (
        



with __dbt__cte__bitcoin_realtime as (
SELECT 
    time_open,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_realtime
WHERE price_close IS NOT NULL
) SELECT * FROM __dbt__cte__bitcoin_realtime

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m19:37:49.903032 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:37:50.924863 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8a499-0003-645f-0003-437a0010c2c6
[0m19:37:50.926598 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 6 at position 26
invalid identifier 'TIME_PERIOD_START'
[0m19:37:50.928036 [debug] [Thread-1 (]: On snapshot.dw_project.snapshot_bitcoin_realtime: Close
[0m19:37:51.139773 [debug] [Thread-1 (]: Database Error in snapshot snapshot_bitcoin_realtime (snapshots/snapshot_realtime.sql)
  000904 (42000): SQL compilation error: error line 6 at position 26
  invalid identifier 'TIME_PERIOD_START'
[0m19:37:51.141020 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd581637a-c9f0-4de4-b663-0c36e0830ee4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15c6f6780>]}
[0m19:37:51.142424 [error] [Thread-1 (]: 2 of 2 ERROR snapshotting SNAPSHOT.snapshot_bitcoin_realtime ................... [[31mERROR[0m in 1.25s]
[0m19:37:51.143338 [debug] [Thread-1 (]: Finished running node snapshot.dw_project.snapshot_bitcoin_realtime
[0m19:37:51.144949 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:37:51.145307 [debug] [MainThread]: Connection 'snapshot.dw_project.snapshot_bitcoin_realtime' was properly closed.
[0m19:37:51.145638 [info ] [MainThread]: 
[0m19:37:51.145966 [info ] [MainThread]: Finished running 2 snapshots in 0 hours 0 minutes and 5.87 seconds (5.87s).
[0m19:37:51.146799 [debug] [MainThread]: Command end result
[0m19:37:51.170793 [info ] [MainThread]: 
[0m19:37:51.171097 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m19:37:51.171280 [info ] [MainThread]: 
[0m19:37:51.171492 [error] [MainThread]:   Database Error in snapshot snapshot_bitcoin_historical (snapshots/snapshot_historical.sql)
  000904 (42000): SQL compilation error: error line 7 at position 33
  invalid identifier 'TIMESTAMP'
[0m19:37:51.171653 [info ] [MainThread]: 
[0m19:37:51.171838 [error] [MainThread]:   Database Error in snapshot snapshot_bitcoin_realtime (snapshots/snapshot_realtime.sql)
  000904 (42000): SQL compilation error: error line 6 at position 26
  invalid identifier 'TIME_PERIOD_START'
[0m19:37:51.171993 [info ] [MainThread]: 
[0m19:37:51.172164 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m19:37:51.173755 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 7.3633847, "process_user_time": 3.594098, "process_kernel_time": 1.293723, "process_mem_max_rss": "212189184", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:37:51.174035 [debug] [MainThread]: Command `dbt snapshot` failed at 19:37:51.173985 after 7.36 seconds
[0m19:37:51.174229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c3b2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f666c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15be21850>]}
[0m19:37:51.174406 [debug] [MainThread]: Flushing usage events
[0m19:40:22.094313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e41010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109eef60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10765d460>]}


============================== 19:40:22.096248 | baa15fe6-b64f-4ae9-8e44-78ac31e68145 ==============================
[0m19:40:22.096248 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:40:22.096559 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'printer_width': '80', 'debug': 'False', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'empty': 'None', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt clean', 'quiet': 'False', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'use_colors': 'True', 'write_json': 'True', 'version_check': 'True', 'static_parser': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'log_format': 'default', 'partial_parse': 'True'}
[0m19:40:22.204058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'baa15fe6-b64f-4ae9-8e44-78ac31e68145', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a09f10>]}
[0m19:40:22.214775 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.14892904, "process_user_time": 0.557081, "process_kernel_time": 0.117456, "process_mem_max_rss": "108527616", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:40:22.215075 [debug] [MainThread]: Command `dbt clean` succeeded at 19:40:22.215036 after 0.15 seconds
[0m19:40:22.215215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072a8170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109ef080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078d8080>]}
[0m19:40:22.215341 [debug] [MainThread]: Flushing usage events
[0m19:40:23.253457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109486ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108721490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108721520>]}


============================== 19:40:23.254832 | cb9aec5f-b99b-4885-b3a7-368a283e07aa ==============================
[0m19:40:23.254832 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:40:23.255142 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'fail_fast': 'False', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'empty': 'None', 'version_check': 'True', 'no_print': 'None', 'printer_width': '80', 'debug': 'False', 'use_experimental_parser': 'False', 'write_json': 'True', 'use_colors': 'True', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'log_cache_events': 'False', 'introspect': 'True', 'warn_error': 'None', 'target_path': 'None', 'log_format': 'default', 'partial_parse': 'True'}
[0m19:40:23.305663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb9aec5f-b99b-4885-b3a7-368a283e07aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109486ed0>]}
[0m19:40:23.311491 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m19:40:23.311851 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m19:40:23.312472 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.079738624, "process_user_time": 0.540494, "process_kernel_time": 0.082905, "process_mem_max_rss": "108904448", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:40:23.312699 [debug] [MainThread]: Command `dbt deps` succeeded at 19:40:23.312656 after 0.08 seconds
[0m19:40:23.312835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10973b320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109486ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097ea450>]}
[0m19:40:23.312957 [debug] [MainThread]: Flushing usage events
[0m19:40:35.561920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071661e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107473c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107473920>]}


============================== 19:40:35.563701 | a34a64a8-3216-432b-bc1e-316e07b71318 ==============================
[0m19:40:35.563701 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:40:35.564012 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'static_parser': 'True', 'log_cache_events': 'False', 'empty': 'None', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'indirect_selection': 'eager', 'quiet': 'False', 'introspect': 'True', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'no_print': 'None', 'use_experimental_parser': 'False', 'use_colors': 'True', 'invocation_command': 'dbt debug', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'cache_selected_only': 'False', 'write_json': 'True', 'warn_error': 'None', 'printer_width': '80', 'version_check': 'True', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])'}
[0m19:40:35.570898 [info ] [MainThread]: dbt version: 1.8.7
[0m19:40:35.571148 [info ] [MainThread]: python version: 3.12.4
[0m19:40:35.571273 [info ] [MainThread]: python path: /opt/anaconda3/bin/python
[0m19:40:35.571390 [info ] [MainThread]: os info: macOS-14.4-arm64-arm-64bit
[0m19:40:36.383948 [info ] [MainThread]: Using profiles dir at /Users/drashtibhingradiya/Desktop/dw_project
[0m19:40:36.384186 [info ] [MainThread]: Using profiles.yml file at /Users/drashtibhingradiya/Desktop/dw_project/profiles.yml
[0m19:40:36.384311 [info ] [MainThread]: Using dbt_project.yml file at /Users/drashtibhingradiya/Desktop/dw_project/dbt_project.yml
[0m19:40:36.384630 [info ] [MainThread]: adapter type: snowflake
[0m19:40:36.384796 [info ] [MainThread]: adapter version: 1.8.4
[0m19:40:36.412104 [info ] [MainThread]: Configuration:
[0m19:40:36.412281 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:40:36.412403 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:40:36.412525 [info ] [MainThread]: Required dependencies:
[0m19:40:36.412670 [debug] [MainThread]: Executing "git --help"
[0m19:40:36.422446 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:40:36.422847 [debug] [MainThread]: STDERR: "b''"
[0m19:40:36.422969 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:40:36.423103 [info ] [MainThread]: Connection:
[0m19:40:36.423237 [info ] [MainThread]:   account: MWXXFJX-HP43653
[0m19:40:36.423339 [info ] [MainThread]:   user: drashti27
[0m19:40:36.423440 [info ] [MainThread]:   database: lab2
[0m19:40:36.423532 [info ] [MainThread]:   warehouse: dw
[0m19:40:36.423629 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m19:40:36.423721 [info ] [MainThread]:   schema: analytics
[0m19:40:36.423818 [info ] [MainThread]:   authenticator: None
[0m19:40:36.423909 [info ] [MainThread]:   oauth_client_id: None
[0m19:40:36.424000 [info ] [MainThread]:   query_tag: None
[0m19:40:36.424098 [info ] [MainThread]:   client_session_keep_alive: False
[0m19:40:36.424187 [info ] [MainThread]:   host: None
[0m19:40:36.424281 [info ] [MainThread]:   port: None
[0m19:40:36.424370 [info ] [MainThread]:   proxy_host: None
[0m19:40:36.424462 [info ] [MainThread]:   proxy_port: None
[0m19:40:36.424555 [info ] [MainThread]:   protocol: None
[0m19:40:36.424645 [info ] [MainThread]:   connect_retries: 1
[0m19:40:36.424736 [info ] [MainThread]:   connect_timeout: None
[0m19:40:36.424826 [info ] [MainThread]:   retry_on_database_errors: False
[0m19:40:36.424920 [info ] [MainThread]:   retry_all: False
[0m19:40:36.425013 [info ] [MainThread]:   insecure_mode: False
[0m19:40:36.425101 [info ] [MainThread]:   reuse_connections: None
[0m19:40:36.425362 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:40:36.429429 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m19:40:36.430188 [debug] [MainThread]: Using snowflake connection "debug"
[0m19:40:36.430317 [debug] [MainThread]: On debug: select 1 as id
[0m19:40:36.430418 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:40:37.198036 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.767 seconds
[0m19:40:37.200482 [debug] [MainThread]: On debug: Close
[0m19:40:37.375948 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:40:37.377525 [info ] [MainThread]: [32mAll checks passed![0m
[0m19:40:37.383590 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.8483037, "process_user_time": 2.597937, "process_kernel_time": 1.296123, "process_mem_max_rss": "198508544", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:40:37.384761 [debug] [MainThread]: Command `dbt debug` succeeded at 19:40:37.384584 after 1.85 seconds
[0m19:40:37.385389 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:40:37.385993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13fd32f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085998e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13fc17b00>]}
[0m19:40:37.386648 [debug] [MainThread]: Flushing usage events
[0m19:41:21.840171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e2bad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e73c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e73920>]}


============================== 19:41:21.841672 | 786597c9-9b49-4dda-b5fb-f49f9d3e6d12 ==============================
[0m19:41:21.841672 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:41:21.841941 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'no_print': 'None', 'indirect_selection': 'eager', 'log_format': 'default', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'write_json': 'True', 'use_colors': 'True', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'empty': 'None', 'printer_width': '80'}
[0m19:41:22.556286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '786597c9-9b49-4dda-b5fb-f49f9d3e6d12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e2bad0>]}
[0m19:41:22.573850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '786597c9-9b49-4dda-b5fb-f49f9d3e6d12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1fd730>]}
[0m19:41:22.574365 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:41:22.582123 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:41:22.582541 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:41:22.582700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '786597c9-9b49-4dda-b5fb-f49f9d3e6d12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ccae40>]}
[0m19:41:23.001925 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot snapshot_bitcoin_historical (snapshots/snapshot_historical.sql)
  invalid syntax for function call expression
    line 4
      config(
[0m19:41:23.003789 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 1.1861897, "process_user_time": 2.778721, "process_kernel_time": 1.431422, "process_mem_max_rss": "201670656", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:41:23.004036 [debug] [MainThread]: Command `dbt snapshot` failed at 19:41:23.003996 after 1.19 seconds
[0m19:41:23.004184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ca2900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142808260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f6708f0>]}
[0m19:41:23.004312 [debug] [MainThread]: Flushing usage events
[0m19:43:06.748579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b36120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10603bf80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10603bd10>]}


============================== 19:43:06.750238 | db56b17b-4e6b-4fb1-9fc4-ca7c7fe4102c ==============================
[0m19:43:06.750238 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:43:06.750526 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'no_print': 'None', 'fail_fast': 'False', 'partial_parse': 'True', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'printer_width': '80', 'target_path': 'None', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'warn_error': 'None', 'empty': 'False', 'indirect_selection': 'eager', 'introspect': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'static_parser': 'True', 'quiet': 'False', 'write_json': 'True', 'log_format': 'default', 'invocation_command': 'dbt compile', 'version_check': 'True'}
[0m19:43:07.656986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'db56b17b-4e6b-4fb1-9fc4-ca7c7fe4102c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f4e43b0>]}
[0m19:43:07.673720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'db56b17b-4e6b-4fb1-9fc4-ca7c7fe4102c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e2ce00>]}
[0m19:43:07.674218 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:43:07.684236 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:43:07.685108 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:43:07.685272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'db56b17b-4e6b-4fb1-9fc4-ca7c7fe4102c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e498cb0>]}
[0m19:43:08.123722 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot snapshot_bitcoin_realtime (snapshots/snapshot_realtime.sql)
  invalid syntax for function call expression
    line 4
      config(
[0m19:43:08.125392 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 1.401482, "process_user_time": 2.807987, "process_kernel_time": 1.449992, "process_mem_max_rss": "197804032", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:43:08.125629 [debug] [MainThread]: Command `dbt compile` failed at 19:43:08.125587 after 1.40 seconds
[0m19:43:08.125778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105feedb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15bea6360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15bb27710>]}
[0m19:43:08.125911 [debug] [MainThread]: Flushing usage events
[0m19:43:54.711609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e380b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a59370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a592e0>]}


============================== 19:43:54.713114 | 2ecb6ff7-da37-4a2c-abc3-0b0cbde8a0e1 ==============================
[0m19:43:54.713114 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:43:54.713392 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'cache_selected_only': 'False', 'write_json': 'True', 'log_cache_events': 'False', 'debug': 'False', 'version_check': 'True', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'indirect_selection': 'eager', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'use_colors': 'True', 'empty': 'False', 'warn_error': 'None', 'invocation_command': 'dbt compile', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'fail_fast': 'False', 'quiet': 'False', 'static_parser': 'True', 'printer_width': '80', 'introspect': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True'}
[0m19:43:55.444262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ecb6ff7-da37-4a2c-abc3-0b0cbde8a0e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11270ffb0>]}
[0m19:43:55.461035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2ecb6ff7-da37-4a2c-abc3-0b0cbde8a0e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112769fd0>]}
[0m19:43:55.461495 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:43:55.469700 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:43:55.470135 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:43:55.470292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2ecb6ff7-da37-4a2c-abc3-0b0cbde8a0e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16baba630>]}
[0m19:43:55.914236 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot snapshot_bitcoin_realtime (snapshots/snapshot_realtime.sql)
  invalid syntax for function call expression
    line 4
      config(
[0m19:43:55.915920 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 1.2273691, "process_user_time": 2.565343, "process_kernel_time": 1.621196, "process_mem_max_rss": "200556544", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:43:55.916151 [debug] [MainThread]: Command `dbt compile` failed at 19:43:55.916112 after 1.23 seconds
[0m19:43:55.916309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c2f380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16bf6c200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16c0a97f0>]}
[0m19:43:55.916445 [debug] [MainThread]: Flushing usage events
[0m19:44:33.062460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110828cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11392b410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113977a40>]}


============================== 19:44:33.064003 | 1cf7a682-2d04-45bb-ba77-d2cb7613b522 ==============================
[0m19:44:33.064003 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:44:33.064281 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'write_json': 'True', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False', 'partial_parse': 'True', 'static_parser': 'True', 'indirect_selection': 'eager', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'printer_width': '80', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'use_colors': 'True', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'invocation_command': 'dbt compile', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'empty': 'False', 'cache_selected_only': 'False'}
[0m19:44:34.119992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1cf7a682-2d04-45bb-ba77-d2cb7613b522', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1573c0d10>]}
[0m19:44:34.137665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1cf7a682-2d04-45bb-ba77-d2cb7613b522', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d30b30>]}
[0m19:44:34.138174 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:44:34.146997 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:44:34.147427 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:44:34.147580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1cf7a682-2d04-45bb-ba77-d2cb7613b522', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1573c1070>]}
[0m19:44:34.579377 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot snapshot_bitcoin_realtime (snapshots/snapshot_realtime.sql)
  invalid syntax for function call expression
    line 4
      config(
[0m19:44:34.581337 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 1.542188, "process_user_time": 2.122647, "process_kernel_time": 1.535546, "process_mem_max_rss": "199639040", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:44:34.581646 [debug] [MainThread]: Command `dbt compile` failed at 19:44:34.581596 after 1.54 seconds
[0m19:44:34.581803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15778bcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1137f4b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113868860>]}
[0m19:44:34.581936 [debug] [MainThread]: Flushing usage events
[0m19:44:42.010940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105722de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049eb0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049e94f0>]}


============================== 19:44:42.012249 | 7b1f0a8a-1b24-4b41-8b1d-34e0f1adb364 ==============================
[0m19:44:42.012249 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:44:42.012528 [debug] [MainThread]: running dbt with arguments {'empty': 'None', 'no_print': 'None', 'invocation_command': 'dbt snapshot', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'printer_width': '80', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'log_format': 'default', 'version_check': 'True', 'indirect_selection': 'eager', 'partial_parse': 'True', 'target_path': 'None', 'quiet': 'False', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'introspect': 'True', 'debug': 'False'}
[0m19:44:42.539674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7b1f0a8a-1b24-4b41-8b1d-34e0f1adb364', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127fae420>]}
[0m19:44:42.557370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7b1f0a8a-1b24-4b41-8b1d-34e0f1adb364', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ba6c30>]}
[0m19:44:42.558623 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:44:42.566198 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:44:42.566614 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:44:42.566766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7b1f0a8a-1b24-4b41-8b1d-34e0f1adb364', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144193d40>]}
[0m19:44:43.003902 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot snapshot_bitcoin_realtime (snapshots/snapshot_realtime.sql)
  invalid syntax for function call expression
    line 4
      config(
[0m19:44:43.005336 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 1.0182174, "process_user_time": 2.035992, "process_kernel_time": 2.076387, "process_mem_max_rss": "198197248", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:44:43.005578 [debug] [MainThread]: Command `dbt snapshot` failed at 19:44:43.005539 after 1.02 seconds
[0m19:44:43.005732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14445a1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1443f2c60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1443c1940>]}
[0m19:44:43.005869 [debug] [MainThread]: Flushing usage events
[0m19:45:04.753323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082459a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082451f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d77b30>]}


============================== 19:45:04.754720 | ef0142a5-67f2-464e-8f0b-d1d16c4df944 ==============================
[0m19:45:04.754720 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:45:04.755002 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'quiet': 'False', 'printer_width': '80', 'log_format': 'default', 'introspect': 'True', 'no_print': 'None', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'debug': 'False', 'use_colors': 'True', 'invocation_command': 'dbt snapshot', 'indirect_selection': 'eager', 'static_parser': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'empty': 'None', 'warn_error': 'None', 'partial_parse': 'True'}
[0m19:45:05.458236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef0142a5-67f2-464e-8f0b-d1d16c4df944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10774bfe0>]}
[0m19:45:05.475168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ef0142a5-67f2-464e-8f0b-d1d16c4df944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b8f8f0>]}
[0m19:45:05.476334 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:45:05.485188 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:45:05.485702 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:45:05.485886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ef0142a5-67f2-464e-8f0b-d1d16c4df944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ae1e180>]}
[0m19:45:06.054237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef0142a5-67f2-464e-8f0b-d1d16c4df944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b2a6900>]}
[0m19:45:06.093523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef0142a5-67f2-464e-8f0b-d1d16c4df944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b84f8f0>]}
[0m19:45:06.093743 [info ] [MainThread]: Found 6 models, 2 snapshots, 3 sources, 459 macros
[0m19:45:06.093896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef0142a5-67f2-464e-8f0b-d1d16c4df944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072bba10>]}
[0m19:45:06.094580 [info ] [MainThread]: 
[0m19:45:06.094829 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:45:06.096340 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m19:45:06.101117 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m19:45:06.101258 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m19:45:06.101364 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:45:07.172091 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.071 seconds
[0m19:45:07.174858 [debug] [ThreadPool]: On list_lab2: Close
[0m19:45:07.356355 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m19:45:07.368235 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m19:45:07.368708 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m19:45:07.368953 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:45:08.295341 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.926 seconds
[0m19:45:08.299706 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m19:45:08.596239 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2_analytics, now list_lab2_SNAPSHOT)
[0m19:45:08.602396 [debug] [ThreadPool]: Using snowflake connection "list_lab2_SNAPSHOT"
[0m19:45:08.603253 [debug] [ThreadPool]: On list_lab2_SNAPSHOT: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_SNAPSHOT"} */
show objects in lab2.SNAPSHOT limit 10000
[0m19:45:08.603710 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:45:09.462819 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.859 seconds
[0m19:45:09.467868 [debug] [ThreadPool]: On list_lab2_SNAPSHOT: Close
[0m19:45:09.643758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef0142a5-67f2-464e-8f0b-d1d16c4df944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b3a0a40>]}
[0m19:45:09.645548 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m19:45:09.646322 [info ] [MainThread]: 
[0m19:45:09.650316 [debug] [Thread-1 (]: Began running node snapshot.dw_project.snapshot_bitcoin_historical
[0m19:45:09.651184 [info ] [Thread-1 (]: 1 of 2 START snapshot SNAPSHOT.snapshot_bitcoin_historical ..................... [RUN]
[0m19:45:09.651739 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_SNAPSHOT, now snapshot.dw_project.snapshot_bitcoin_historical)
[0m19:45:09.652176 [debug] [Thread-1 (]: Began compiling node snapshot.dw_project.snapshot_bitcoin_historical
[0m19:45:09.663545 [debug] [Thread-1 (]: Writing injected SQL for node "snapshot.dw_project.snapshot_bitcoin_historical"
[0m19:45:09.665191 [debug] [Thread-1 (]: Began executing node snapshot.dw_project.snapshot_bitcoin_historical
[0m19:45:09.706091 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dw_project.snapshot_bitcoin_historical"
[0m19:45:09.706397 [debug] [Thread-1 (]: On snapshot.dw_project.snapshot_bitcoin_historical: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "snapshot.dw_project.snapshot_bitcoin_historical"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "snapshot.dw_project.snapshot_bitcoin_historical"} */
select * from (
        
    

    select *,
        md5(coalesce(cast("TIME_PERIOD_START" as varchar ), '')
         || '|' || coalesce(cast("TIMESTAMP" as varchar ), '')
        ) as dbt_scd_id,
        "TIMESTAMP" as dbt_updated_at,
        "TIMESTAMP" as dbt_valid_from,
        
  
  coalesce(nullif("TIMESTAMP", "TIMESTAMP"), null)
  as dbt_valid_to

    from (
        



with __dbt__cte__bitcoin_historical as (
SELECT 
    time_period_start,
    time_period_end,
    time_open,
    time_close,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_historical
WHERE time_period_start IS NOT NULL
) SELECT * FROM __dbt__cte__bitcoin_historical

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m19:45:09.706580 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:45:10.367251 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8a4a1-0003-645f-0003-437a0010c2de
[0m19:45:10.367839 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 7 at position 33
invalid identifier 'TIMESTAMP'
[0m19:45:10.368375 [debug] [Thread-1 (]: On snapshot.dw_project.snapshot_bitcoin_historical: Close
[0m19:45:10.561672 [debug] [Thread-1 (]: Database Error in snapshot snapshot_bitcoin_historical (snapshots/snapshot_historical.sql)
  000904 (42000): SQL compilation error: error line 7 at position 33
  invalid identifier 'TIMESTAMP'
[0m19:45:10.564355 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef0142a5-67f2-464e-8f0b-d1d16c4df944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ba9f440>]}
[0m19:45:10.565538 [error] [Thread-1 (]: 1 of 2 ERROR snapshotting SNAPSHOT.snapshot_bitcoin_historical ................. [[31mERROR[0m in 0.91s]
[0m19:45:10.566291 [debug] [Thread-1 (]: Finished running node snapshot.dw_project.snapshot_bitcoin_historical
[0m19:45:10.566766 [debug] [Thread-1 (]: Began running node snapshot.dw_project.test_snapshot
[0m19:45:10.567437 [info ] [Thread-1 (]: 2 of 2 START snapshot SNAPSHOT.test_snapshot ................................... [RUN]
[0m19:45:10.567973 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dw_project.snapshot_bitcoin_historical, now snapshot.dw_project.test_snapshot)
[0m19:45:10.568351 [debug] [Thread-1 (]: Began compiling node snapshot.dw_project.test_snapshot
[0m19:45:10.573313 [debug] [Thread-1 (]: Writing injected SQL for node "snapshot.dw_project.test_snapshot"
[0m19:45:10.574387 [debug] [Thread-1 (]: Began executing node snapshot.dw_project.test_snapshot
[0m19:45:10.577365 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dw_project.test_snapshot"
[0m19:45:10.577669 [debug] [Thread-1 (]: On snapshot.dw_project.test_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "snapshot.dw_project.test_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "snapshot.dw_project.test_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(TIME_PERIOD_START as varchar ), '')
         || '|' || coalesce(cast(TIMESTAMP as varchar ), '')
        ) as dbt_scd_id,
        TIMESTAMP as dbt_updated_at,
        TIMESTAMP as dbt_valid_from,
        
  
  coalesce(nullif(TIMESTAMP, TIMESTAMP), null)
  as dbt_valid_to

    from (
        



with __dbt__cte__bitcoin_realtime as (
SELECT 
    time_open,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_realtime
WHERE price_close IS NOT NULL
) SELECT * FROM __dbt__cte__bitcoin_realtime

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m19:45:10.577939 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:45:11.390548 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8a4a1-0003-645f-0003-437a0010c2e2
[0m19:45:11.392204 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 6 at position 26
invalid identifier 'TIME_PERIOD_START'
[0m19:45:11.392886 [debug] [Thread-1 (]: On snapshot.dw_project.test_snapshot: Close
[0m19:45:11.618784 [debug] [Thread-1 (]: Database Error in snapshot test_snapshot (snapshots/snapshot_realtime.sql)
  000904 (42000): SQL compilation error: error line 6 at position 26
  invalid identifier 'TIME_PERIOD_START'
[0m19:45:11.620105 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef0142a5-67f2-464e-8f0b-d1d16c4df944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12bbf5df0>]}
[0m19:45:11.621476 [error] [Thread-1 (]: 2 of 2 ERROR snapshotting SNAPSHOT.test_snapshot ............................... [[31mERROR[0m in 1.05s]
[0m19:45:11.622345 [debug] [Thread-1 (]: Finished running node snapshot.dw_project.test_snapshot
[0m19:45:11.624045 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:45:11.624460 [debug] [MainThread]: Connection 'snapshot.dw_project.test_snapshot' was properly closed.
[0m19:45:11.624828 [info ] [MainThread]: 
[0m19:45:11.625175 [info ] [MainThread]: Finished running 2 snapshots in 0 hours 0 minutes and 5.53 seconds (5.53s).
[0m19:45:11.625982 [debug] [MainThread]: Command end result
[0m19:45:11.649190 [info ] [MainThread]: 
[0m19:45:11.649541 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m19:45:11.649735 [info ] [MainThread]: 
[0m19:45:11.649959 [error] [MainThread]:   Database Error in snapshot snapshot_bitcoin_historical (snapshots/snapshot_historical.sql)
  000904 (42000): SQL compilation error: error line 7 at position 33
  invalid identifier 'TIMESTAMP'
[0m19:45:11.650129 [info ] [MainThread]: 
[0m19:45:11.650317 [error] [MainThread]:   Database Error in snapshot test_snapshot (snapshots/snapshot_realtime.sql)
  000904 (42000): SQL compilation error: error line 6 at position 26
  invalid identifier 'TIME_PERIOD_START'
[0m19:45:11.650473 [info ] [MainThread]: 
[0m19:45:11.650649 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m19:45:11.652792 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 6.92128, "process_user_time": 3.328651, "process_kernel_time": 1.5456, "process_mem_max_rss": "212172800", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:45:11.653088 [debug] [MainThread]: Command `dbt snapshot` failed at 19:45:11.653039 after 6.92 seconds
[0m19:45:11.653288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b45ffe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b59580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d77590>]}
[0m19:45:11.653472 [debug] [MainThread]: Flushing usage events
[0m19:47:24.367662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f37110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081fd400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081fd4f0>]}


============================== 19:47:24.369217 | e1c58d2c-2f40-4390-8ba5-29208634dcff ==============================
[0m19:47:24.369217 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:47:24.369509 [debug] [MainThread]: running dbt with arguments {'empty': 'None', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'target_path': 'None', 'introspect': 'True', 'quiet': 'False', 'cache_selected_only': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'invocation_command': 'dbt snapshot', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'warn_error': 'None', 'version_check': 'True', 'static_parser': 'True', 'printer_width': '80', 'debug': 'False', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'log_format': 'default', 'write_json': 'True', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs'}
[0m19:47:25.282966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e1c58d2c-2f40-4390-8ba5-29208634dcff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091d3e60>]}
[0m19:47:25.300607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e1c58d2c-2f40-4390-8ba5-29208634dcff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c3a570>]}
[0m19:47:25.301126 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:47:25.309800 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:47:25.370300 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m19:47:25.370565 [debug] [MainThread]: Partial parsing: updated file: dw_project://snapshots/snapshot_realtime.sql
[0m19:47:25.370707 [debug] [MainThread]: Partial parsing: updated file: dw_project://snapshots/snapshot_historical.sql
[0m19:47:25.462274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e1c58d2c-2f40-4390-8ba5-29208634dcff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146dfe990>]}
[0m19:47:25.502307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e1c58d2c-2f40-4390-8ba5-29208634dcff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146bad100>]}
[0m19:47:25.502524 [info ] [MainThread]: Found 6 models, 2 snapshots, 3 sources, 459 macros
[0m19:47:25.502665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1c58d2c-2f40-4390-8ba5-29208634dcff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145ef65a0>]}
[0m19:47:25.503334 [info ] [MainThread]: 
[0m19:47:25.503571 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:47:25.505177 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m19:47:25.510267 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m19:47:25.510418 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m19:47:25.510524 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:47:26.335926 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.824 seconds
[0m19:47:26.338032 [debug] [ThreadPool]: On list_lab2: Close
[0m19:47:26.543735 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m19:47:26.558298 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m19:47:26.558808 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m19:47:26.559135 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:47:27.510867 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.951 seconds
[0m19:47:27.516285 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m19:47:27.767153 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2_analytics, now list_lab2_SNAPSHOT)
[0m19:47:27.773388 [debug] [ThreadPool]: Using snowflake connection "list_lab2_SNAPSHOT"
[0m19:47:27.774032 [debug] [ThreadPool]: On list_lab2_SNAPSHOT: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_SNAPSHOT"} */
show objects in lab2.SNAPSHOT limit 10000
[0m19:47:27.774502 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:47:28.211902 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.437 seconds
[0m19:47:28.215503 [debug] [ThreadPool]: On list_lab2_SNAPSHOT: Close
[0m19:47:28.434244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1c58d2c-2f40-4390-8ba5-29208634dcff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f61130>]}
[0m19:47:28.435885 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m19:47:28.436673 [info ] [MainThread]: 
[0m19:47:28.442575 [debug] [Thread-1 (]: Began running node snapshot.dw_project.snapshot_bitcoin_historical
[0m19:47:28.443368 [info ] [Thread-1 (]: 1 of 2 START snapshot SNAPSHOT.snapshot_bitcoin_historical ..................... [RUN]
[0m19:47:28.443950 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_SNAPSHOT, now snapshot.dw_project.snapshot_bitcoin_historical)
[0m19:47:28.444384 [debug] [Thread-1 (]: Began compiling node snapshot.dw_project.snapshot_bitcoin_historical
[0m19:47:28.455403 [debug] [Thread-1 (]: Writing injected SQL for node "snapshot.dw_project.snapshot_bitcoin_historical"
[0m19:47:28.457309 [debug] [Thread-1 (]: Began executing node snapshot.dw_project.snapshot_bitcoin_historical
[0m19:47:28.497803 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dw_project.snapshot_bitcoin_historical"
[0m19:47:28.498108 [debug] [Thread-1 (]: On snapshot.dw_project.snapshot_bitcoin_historical: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "snapshot.dw_project.snapshot_bitcoin_historical"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "snapshot.dw_project.snapshot_bitcoin_historical"} */
select * from (
        
    

    select *,
        md5(coalesce(cast("TIME_PERIOD_START" as varchar ), '')
         || '|' || coalesce(cast("timestamp" as varchar ), '')
        ) as dbt_scd_id,
        "timestamp" as dbt_updated_at,
        "timestamp" as dbt_valid_from,
        
  
  coalesce(nullif("timestamp", "timestamp"), null)
  as dbt_valid_to

    from (
        



with __dbt__cte__bitcoin_historical as (
SELECT 
    time_period_start,
    time_period_end,
    time_open,
    time_close,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_historical
WHERE time_period_start IS NOT NULL
) SELECT * FROM __dbt__cte__bitcoin_historical

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m19:47:28.498291 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:47:29.127308 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8a4a3-0003-62f2-0003-437a000eb7aa
[0m19:47:29.128017 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 7 at position 33
invalid identifier '"timestamp"'
[0m19:47:29.128573 [debug] [Thread-1 (]: On snapshot.dw_project.snapshot_bitcoin_historical: Close
[0m19:47:29.321234 [debug] [Thread-1 (]: Database Error in snapshot snapshot_bitcoin_historical (snapshots/snapshot_historical.sql)
  000904 (42000): SQL compilation error: error line 7 at position 33
  invalid identifier '"timestamp"'
[0m19:47:29.323924 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1c58d2c-2f40-4390-8ba5-29208634dcff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146e71c70>]}
[0m19:47:29.325270 [error] [Thread-1 (]: 1 of 2 ERROR snapshotting SNAPSHOT.snapshot_bitcoin_historical ................. [[31mERROR[0m in 0.88s]
[0m19:47:29.326005 [debug] [Thread-1 (]: Finished running node snapshot.dw_project.snapshot_bitcoin_historical
[0m19:47:29.326487 [debug] [Thread-1 (]: Began running node snapshot.dw_project.test_snapshot
[0m19:47:29.327201 [info ] [Thread-1 (]: 2 of 2 START snapshot SNAPSHOT.test_snapshot ................................... [RUN]
[0m19:47:29.327814 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dw_project.snapshot_bitcoin_historical, now snapshot.dw_project.test_snapshot)
[0m19:47:29.328220 [debug] [Thread-1 (]: Began compiling node snapshot.dw_project.test_snapshot
[0m19:47:29.335137 [debug] [Thread-1 (]: Writing injected SQL for node "snapshot.dw_project.test_snapshot"
[0m19:47:29.336159 [debug] [Thread-1 (]: Began executing node snapshot.dw_project.test_snapshot
[0m19:47:29.339212 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dw_project.test_snapshot"
[0m19:47:29.339538 [debug] [Thread-1 (]: On snapshot.dw_project.test_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "snapshot.dw_project.test_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "snapshot.dw_project.test_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(TIME_PERIOD_START as varchar ), '')
         || '|' || coalesce(cast(timnestamp as varchar ), '')
        ) as dbt_scd_id,
        timnestamp as dbt_updated_at,
        timnestamp as dbt_valid_from,
        
  
  coalesce(nullif(timnestamp, timnestamp), null)
  as dbt_valid_to

    from (
        



with __dbt__cte__bitcoin_realtime as (
SELECT 
    time_open,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_realtime
WHERE price_close IS NOT NULL
) SELECT * FROM __dbt__cte__bitcoin_realtime

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m19:47:29.339828 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:47:30.052533 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8a4a3-0003-62f2-0003-437a000eb7ae
[0m19:47:30.053663 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 6 at position 26
invalid identifier 'TIME_PERIOD_START'
[0m19:47:30.054499 [debug] [Thread-1 (]: On snapshot.dw_project.test_snapshot: Close
[0m19:47:30.239207 [debug] [Thread-1 (]: Database Error in snapshot test_snapshot (snapshots/snapshot_realtime.sql)
  000904 (42000): SQL compilation error: error line 6 at position 26
  invalid identifier 'TIME_PERIOD_START'
[0m19:47:30.240393 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1c58d2c-2f40-4390-8ba5-29208634dcff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146856900>]}
[0m19:47:30.241877 [error] [Thread-1 (]: 2 of 2 ERROR snapshotting SNAPSHOT.test_snapshot ............................... [[31mERROR[0m in 0.91s]
[0m19:47:30.242998 [debug] [Thread-1 (]: Finished running node snapshot.dw_project.test_snapshot
[0m19:47:30.245204 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:47:30.245899 [debug] [MainThread]: Connection 'snapshot.dw_project.test_snapshot' was properly closed.
[0m19:47:30.246334 [info ] [MainThread]: 
[0m19:47:30.246702 [info ] [MainThread]: Finished running 2 snapshots in 0 hours 0 minutes and 4.74 seconds (4.74s).
[0m19:47:30.247518 [debug] [MainThread]: Command end result
[0m19:47:30.270846 [info ] [MainThread]: 
[0m19:47:30.271125 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m19:47:30.271304 [info ] [MainThread]: 
[0m19:47:30.271523 [error] [MainThread]:   Database Error in snapshot snapshot_bitcoin_historical (snapshots/snapshot_historical.sql)
  000904 (42000): SQL compilation error: error line 7 at position 33
  invalid identifier '"timestamp"'
[0m19:47:30.271687 [info ] [MainThread]: 
[0m19:47:30.271874 [error] [MainThread]:   Database Error in snapshot test_snapshot (snapshots/snapshot_realtime.sql)
  000904 (42000): SQL compilation error: error line 6 at position 26
  invalid identifier 'TIME_PERIOD_START'
[0m19:47:30.272029 [info ] [MainThread]: 
[0m19:47:30.272202 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m19:47:30.274090 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 5.9303956, "process_user_time": 2.829516, "process_kernel_time": 1.692578, "process_mem_max_rss": "207552512", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:47:30.274391 [debug] [MainThread]: Command `dbt snapshot` failed at 19:47:30.274339 after 5.93 seconds
[0m19:47:30.274599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142d43320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10921bad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10921bb90>]}
[0m19:47:30.274792 [debug] [MainThread]: Flushing usage events
[0m19:49:59.693199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f38d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067d1400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067d1310>]}


============================== 19:49:59.694875 | 2d953059-7406-4203-9d52-5acfaf3838ce ==============================
[0m19:49:59.694875 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:49:59.695157 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'introspect': 'True', 'empty': 'None', 'debug': 'False', 'printer_width': '80', 'quiet': 'False', 'version_check': 'True', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'use_colors': 'True', 'no_print': 'None', 'write_json': 'True', 'target_path': 'None', 'partial_parse': 'True', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'log_cache_events': 'False'}
[0m19:50:00.618032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d953059-7406-4203-9d52-5acfaf3838ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1444bd0d0>]}
[0m19:50:00.635821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2d953059-7406-4203-9d52-5acfaf3838ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12efe06e0>]}
[0m19:50:00.636311 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:50:00.645770 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:50:00.707140 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m19:50:00.707426 [debug] [MainThread]: Partial parsing: updated file: dw_project://snapshots/snapshot_historical.sql
[0m19:50:00.707578 [debug] [MainThread]: Partial parsing: updated file: dw_project://snapshots/snapshot_realtime.sql
[0m19:50:00.800920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d953059-7406-4203-9d52-5acfaf3838ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14525b7d0>]}
[0m19:50:00.840904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d953059-7406-4203-9d52-5acfaf3838ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1451c3d10>]}
[0m19:50:00.841133 [info ] [MainThread]: Found 6 models, 2 snapshots, 3 sources, 459 macros
[0m19:50:00.841289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d953059-7406-4203-9d52-5acfaf3838ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10635b9b0>]}
[0m19:50:00.842011 [info ] [MainThread]: 
[0m19:50:00.842255 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:50:00.843892 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m19:50:00.848944 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m19:50:00.849088 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m19:50:00.849201 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:50:01.888908 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.039 seconds
[0m19:50:01.891704 [debug] [ThreadPool]: On list_lab2: Close
[0m19:50:02.108626 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m19:50:02.122134 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m19:50:02.122688 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m19:50:02.123015 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:50:02.958190 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.835 seconds
[0m19:50:02.962369 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m19:50:03.159783 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2_analytics, now list_lab2_snapshot)
[0m19:50:03.165325 [debug] [ThreadPool]: Using snowflake connection "list_lab2_snapshot"
[0m19:50:03.165903 [debug] [ThreadPool]: On list_lab2_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_snapshot"} */
show objects in lab2.snapshot limit 10000
[0m19:50:03.166250 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:50:03.594228 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.428 seconds
[0m19:50:03.597617 [debug] [ThreadPool]: On list_lab2_snapshot: Close
[0m19:50:03.814386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d953059-7406-4203-9d52-5acfaf3838ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1453d4c20>]}
[0m19:50:03.815885 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m19:50:03.816518 [info ] [MainThread]: 
[0m19:50:03.822214 [debug] [Thread-1 (]: Began running node snapshot.dw_project.snapshot_bitcoin_historical
[0m19:50:03.822928 [info ] [Thread-1 (]: 1 of 2 START snapshot snapshot.snapshot_bitcoin_historical ..................... [RUN]
[0m19:50:03.823461 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_snapshot, now snapshot.dw_project.snapshot_bitcoin_historical)
[0m19:50:03.823843 [debug] [Thread-1 (]: Began compiling node snapshot.dw_project.snapshot_bitcoin_historical
[0m19:50:03.832003 [debug] [Thread-1 (]: Began executing node snapshot.dw_project.snapshot_bitcoin_historical
[0m19:50:03.872956 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dw_project.snapshot_bitcoin_historical"
[0m19:50:03.873237 [debug] [Thread-1 (]: On snapshot.dw_project.snapshot_bitcoin_historical: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "snapshot.dw_project.snapshot_bitcoin_historical"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "snapshot.dw_project.snapshot_bitcoin_historical"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(TIME_PERIOD_START as varchar ), '')
         || '|' || coalesce(cast(TIME_PERIOD_START as varchar ), '')
        ) as dbt_scd_id,
        TIME_PERIOD_START as dbt_updated_at,
        TIME_PERIOD_START as dbt_valid_from,
        
  
  coalesce(nullif(TIME_PERIOD_START, TIME_PERIOD_START), null)
  as dbt_valid_to

    from (
        



select * from lab2.raw_data.bitcoin_historical

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m19:50:03.873413 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:50:05.411921 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.538 seconds
[0m19:50:05.420231 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dw_project.snapshot_bitcoin_historical"
[0m19:50:05.420733 [debug] [Thread-1 (]: On snapshot.dw_project.snapshot_bitcoin_historical: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "snapshot.dw_project.snapshot_bitcoin_historical"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "snapshot.dw_project.snapshot_bitcoin_historical"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m19:50:05.536030 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.115 seconds
[0m19:50:05.537441 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dw_project.snapshot_bitcoin_historical"
[0m19:50:05.540361 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dw_project.snapshot_bitcoin_historical"
[0m19:50:05.541018 [debug] [Thread-1 (]: On snapshot.dw_project.snapshot_bitcoin_historical: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "snapshot.dw_project.snapshot_bitcoin_historical"} */
create or replace transient table lab2.snapshot.snapshot_bitcoin_historical
         as
        (
    

    select *,
        md5(coalesce(cast(TIME_PERIOD_START as varchar ), '')
         || '|' || coalesce(cast(TIME_PERIOD_START as varchar ), '')
        ) as dbt_scd_id,
        TIME_PERIOD_START as dbt_updated_at,
        TIME_PERIOD_START as dbt_valid_from,
        
  
  coalesce(nullif(TIME_PERIOD_START, TIME_PERIOD_START), null)
  as dbt_valid_to

    from (
        



select * from lab2.raw_data.bitcoin_historical

    ) sbq



        );
[0m19:50:07.360444 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.819 seconds
[0m19:50:07.388212 [debug] [Thread-1 (]: On snapshot.dw_project.snapshot_bitcoin_historical: Close
[0m19:50:07.583255 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d953059-7406-4203-9d52-5acfaf3838ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e25a60>]}
[0m19:50:07.585165 [info ] [Thread-1 (]: 1 of 2 OK snapshotted snapshot.snapshot_bitcoin_historical ..................... [[32mSUCCESS 1[0m in 3.76s]
[0m19:50:07.586345 [debug] [Thread-1 (]: Finished running node snapshot.dw_project.snapshot_bitcoin_historical
[0m19:50:07.587029 [debug] [Thread-1 (]: Began running node snapshot.dw_project.test_snapshot
[0m19:50:07.587907 [info ] [Thread-1 (]: 2 of 2 START snapshot snapshot.test_snapshot ................................... [RUN]
[0m19:50:07.588581 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dw_project.snapshot_bitcoin_historical, now snapshot.dw_project.test_snapshot)
[0m19:50:07.589039 [debug] [Thread-1 (]: Began compiling node snapshot.dw_project.test_snapshot
[0m19:50:07.594410 [debug] [Thread-1 (]: Began executing node snapshot.dw_project.test_snapshot
[0m19:50:07.598106 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dw_project.test_snapshot"
[0m19:50:07.598514 [debug] [Thread-1 (]: On snapshot.dw_project.test_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "snapshot.dw_project.test_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "snapshot.dw_project.test_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(TIME_PERIOD_START as varchar ), '')
         || '|' || coalesce(cast(TIME_PERIOD_START as varchar ), '')
        ) as dbt_scd_id,
        TIME_PERIOD_START as dbt_updated_at,
        TIME_PERIOD_START as dbt_valid_from,
        
  
  coalesce(nullif(TIME_PERIOD_START, TIME_PERIOD_START), null)
  as dbt_valid_to

    from (
        



select * from lab2.raw_data.bitcoin_realtime

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m19:50:07.598850 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:50:08.893532 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.294 seconds
[0m19:50:08.897374 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dw_project.test_snapshot"
[0m19:50:08.898248 [debug] [Thread-1 (]: On snapshot.dw_project.test_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "snapshot.dw_project.test_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "snapshot.dw_project.test_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m19:50:09.065269 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.166 seconds
[0m19:50:09.067020 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dw_project.test_snapshot"
[0m19:50:09.069875 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dw_project.test_snapshot"
[0m19:50:09.070598 [debug] [Thread-1 (]: On snapshot.dw_project.test_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "snapshot.dw_project.test_snapshot"} */
create or replace transient table lab2.snapshot.test_snapshot
         as
        (
    

    select *,
        md5(coalesce(cast(TIME_PERIOD_START as varchar ), '')
         || '|' || coalesce(cast(TIME_PERIOD_START as varchar ), '')
        ) as dbt_scd_id,
        TIME_PERIOD_START as dbt_updated_at,
        TIME_PERIOD_START as dbt_valid_from,
        
  
  coalesce(nullif(TIME_PERIOD_START, TIME_PERIOD_START), null)
  as dbt_valid_to

    from (
        



select * from lab2.raw_data.bitcoin_realtime

    ) sbq



        );
[0m19:50:10.121027 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.050 seconds
[0m19:50:10.123832 [debug] [Thread-1 (]: On snapshot.dw_project.test_snapshot: Close
[0m19:50:10.293564 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d953059-7406-4203-9d52-5acfaf3838ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14531c920>]}
[0m19:50:10.294967 [info ] [Thread-1 (]: 2 of 2 OK snapshotted snapshot.test_snapshot ................................... [[32mSUCCESS 1[0m in 2.70s]
[0m19:50:10.295908 [debug] [Thread-1 (]: Finished running node snapshot.dw_project.test_snapshot
[0m19:50:10.297460 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:50:10.297958 [debug] [MainThread]: Connection 'snapshot.dw_project.test_snapshot' was properly closed.
[0m19:50:10.298476 [info ] [MainThread]: 
[0m19:50:10.298975 [info ] [MainThread]: Finished running 2 snapshots in 0 hours 0 minutes and 9.46 seconds (9.46s).
[0m19:50:10.300182 [debug] [MainThread]: Command end result
[0m19:50:10.319720 [info ] [MainThread]: 
[0m19:50:10.319990 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:50:10.320126 [info ] [MainThread]: 
[0m19:50:10.320259 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m19:50:10.322163 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 10.660073, "process_user_time": 2.919015, "process_kernel_time": 1.668247, "process_mem_max_rss": "209420288", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:50:10.322434 [debug] [MainThread]: Command `dbt snapshot` succeeded at 19:50:10.322394 after 10.66 seconds
[0m19:50:10.322606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1440e68d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145198740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145198770>]}
[0m19:50:10.322742 [debug] [MainThread]: Flushing usage events
[0m19:53:31.930901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1032f1e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103be1400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103be1490>]}


============================== 19:53:31.932454 | a8fb3ccb-f440-4b11-aadf-ae33eddcbccf ==============================
[0m19:53:31.932454 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:53:31.932772 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'printer_width': '80', 'empty': 'None', 'introspect': 'True', 'fail_fast': 'False', 'log_cache_events': 'False', 'invocation_command': 'dbt test', 'version_check': 'True', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'partial_parse': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'no_print': 'None', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'use_colors': 'True', 'static_parser': 'True', 'target_path': 'None', 'quiet': 'False', 'write_json': 'True', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_format': 'default'}
[0m19:53:32.824208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a8fb3ccb-f440-4b11-aadf-ae33eddcbccf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11485aa20>]}
[0m19:53:32.841142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a8fb3ccb-f440-4b11-aadf-ae33eddcbccf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15a58e660>]}
[0m19:53:32.841647 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:53:32.849847 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:53:32.911359 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m19:53:32.911663 [debug] [MainThread]: Partial parsing: added file: dw_project://models/schema.yml
[0m19:53:33.016953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a8fb3ccb-f440-4b11-aadf-ae33eddcbccf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15c0d0e60>]}
[0m19:53:33.068921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a8fb3ccb-f440-4b11-aadf-ae33eddcbccf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15c32e1e0>]}
[0m19:53:33.069146 [info ] [MainThread]: Found 6 models, 2 snapshots, 8 data tests, 3 sources, 459 macros
[0m19:53:33.069291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8fb3ccb-f440-4b11-aadf-ae33eddcbccf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15c08b8c0>]}
[0m19:53:33.070057 [info ] [MainThread]: 
[0m19:53:33.070307 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:53:33.071982 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2_analytics'
[0m19:53:33.077599 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m19:53:33.077740 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m19:53:33.077845 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:53:33.789054 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.711 seconds
[0m19:53:33.791992 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m19:53:33.966791 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2_analytics, now list_lab2_snapshot)
[0m19:53:33.971587 [debug] [ThreadPool]: Using snowflake connection "list_lab2_snapshot"
[0m19:53:33.972186 [debug] [ThreadPool]: On list_lab2_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_snapshot"} */
show objects in lab2.snapshot limit 10000
[0m19:53:33.972680 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:53:34.654490 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.682 seconds
[0m19:53:34.657563 [debug] [ThreadPool]: On list_lab2_snapshot: Close
[0m19:53:34.825329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8fb3ccb-f440-4b11-aadf-ae33eddcbccf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15c00c6e0>]}
[0m19:53:34.826203 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m19:53:34.826714 [info ] [MainThread]: 
[0m19:53:34.831108 [debug] [Thread-1 (]: Began running node test.dw_project.not_null_bitcoin_historical_PRICE_HIGH.e2e4ab4d25
[0m19:53:34.831732 [info ] [Thread-1 (]: 1 of 8 START test not_null_bitcoin_historical_PRICE_HIGH ....................... [RUN]
[0m19:53:34.832256 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_snapshot, now test.dw_project.not_null_bitcoin_historical_PRICE_HIGH.e2e4ab4d25)
[0m19:53:34.832657 [debug] [Thread-1 (]: Began compiling node test.dw_project.not_null_bitcoin_historical_PRICE_HIGH.e2e4ab4d25
[0m19:53:34.844865 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_project.not_null_bitcoin_historical_PRICE_HIGH.e2e4ab4d25"
[0m19:53:34.845756 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_project.not_null_bitcoin_historical_PRICE_HIGH.e2e4ab4d25"
[0m19:53:34.846429 [debug] [Thread-1 (]: Began executing node test.dw_project.not_null_bitcoin_historical_PRICE_HIGH.e2e4ab4d25
[0m19:53:34.854462 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_project.not_null_bitcoin_historical_PRICE_HIGH.e2e4ab4d25"
[0m19:53:34.855348 [debug] [Thread-1 (]: Using snowflake connection "test.dw_project.not_null_bitcoin_historical_PRICE_HIGH.e2e4ab4d25"
[0m19:53:34.855558 [debug] [Thread-1 (]: On test.dw_project.not_null_bitcoin_historical_PRICE_HIGH.e2e4ab4d25: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "test.dw_project.not_null_bitcoin_historical_PRICE_HIGH.e2e4ab4d25"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__bitcoin_historical as (
SELECT 
    time_period_start,
    time_period_end,
    time_open,
    time_close,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_historical
WHERE time_period_start IS NOT NULL
) select PRICE_HIGH
from __dbt__cte__bitcoin_historical
where PRICE_HIGH is null



      
    ) dbt_internal_test
[0m19:53:34.855727 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:53:35.847148 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.991 seconds
[0m19:53:35.861239 [debug] [Thread-1 (]: On test.dw_project.not_null_bitcoin_historical_PRICE_HIGH.e2e4ab4d25: Close
[0m19:53:36.032663 [info ] [Thread-1 (]: 1 of 8 PASS not_null_bitcoin_historical_PRICE_HIGH ............................. [[32mPASS[0m in 1.20s]
[0m19:53:36.034223 [debug] [Thread-1 (]: Finished running node test.dw_project.not_null_bitcoin_historical_PRICE_HIGH.e2e4ab4d25
[0m19:53:36.035018 [debug] [Thread-1 (]: Began running node test.dw_project.not_null_bitcoin_historical_PRICE_LOW.0c9f1946ec
[0m19:53:36.035831 [info ] [Thread-1 (]: 2 of 8 START test not_null_bitcoin_historical_PRICE_LOW ........................ [RUN]
[0m19:53:36.036639 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_project.not_null_bitcoin_historical_PRICE_HIGH.e2e4ab4d25, now test.dw_project.not_null_bitcoin_historical_PRICE_LOW.0c9f1946ec)
[0m19:53:36.037349 [debug] [Thread-1 (]: Began compiling node test.dw_project.not_null_bitcoin_historical_PRICE_LOW.0c9f1946ec
[0m19:53:36.045033 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_project.not_null_bitcoin_historical_PRICE_LOW.0c9f1946ec"
[0m19:53:36.046105 [debug] [Thread-1 (]: Began executing node test.dw_project.not_null_bitcoin_historical_PRICE_LOW.0c9f1946ec
[0m19:53:36.049144 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_project.not_null_bitcoin_historical_PRICE_LOW.0c9f1946ec"
[0m19:53:36.050613 [debug] [Thread-1 (]: Using snowflake connection "test.dw_project.not_null_bitcoin_historical_PRICE_LOW.0c9f1946ec"
[0m19:53:36.050996 [debug] [Thread-1 (]: On test.dw_project.not_null_bitcoin_historical_PRICE_LOW.0c9f1946ec: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "test.dw_project.not_null_bitcoin_historical_PRICE_LOW.0c9f1946ec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__bitcoin_historical as (
SELECT 
    time_period_start,
    time_period_end,
    time_open,
    time_close,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_historical
WHERE time_period_start IS NOT NULL
) select PRICE_LOW
from __dbt__cte__bitcoin_historical
where PRICE_LOW is null



      
    ) dbt_internal_test
[0m19:53:36.051337 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:53:36.869758 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.818 seconds
[0m19:53:36.873967 [debug] [Thread-1 (]: On test.dw_project.not_null_bitcoin_historical_PRICE_LOW.0c9f1946ec: Close
[0m19:53:37.123749 [info ] [Thread-1 (]: 2 of 8 PASS not_null_bitcoin_historical_PRICE_LOW .............................. [[32mPASS[0m in 1.09s]
[0m19:53:37.125071 [debug] [Thread-1 (]: Finished running node test.dw_project.not_null_bitcoin_historical_PRICE_LOW.0c9f1946ec
[0m19:53:37.125710 [debug] [Thread-1 (]: Began running node test.dw_project.not_null_bitcoin_historical_PRICE_OPEN.3b75490c6c
[0m19:53:37.126609 [info ] [Thread-1 (]: 3 of 8 START test not_null_bitcoin_historical_PRICE_OPEN ....................... [RUN]
[0m19:53:37.127441 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_project.not_null_bitcoin_historical_PRICE_LOW.0c9f1946ec, now test.dw_project.not_null_bitcoin_historical_PRICE_OPEN.3b75490c6c)
[0m19:53:37.127860 [debug] [Thread-1 (]: Began compiling node test.dw_project.not_null_bitcoin_historical_PRICE_OPEN.3b75490c6c
[0m19:53:37.135278 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_project.not_null_bitcoin_historical_PRICE_OPEN.3b75490c6c"
[0m19:53:37.136148 [debug] [Thread-1 (]: Began executing node test.dw_project.not_null_bitcoin_historical_PRICE_OPEN.3b75490c6c
[0m19:53:37.138181 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_project.not_null_bitcoin_historical_PRICE_OPEN.3b75490c6c"
[0m19:53:37.139183 [debug] [Thread-1 (]: Using snowflake connection "test.dw_project.not_null_bitcoin_historical_PRICE_OPEN.3b75490c6c"
[0m19:53:37.139481 [debug] [Thread-1 (]: On test.dw_project.not_null_bitcoin_historical_PRICE_OPEN.3b75490c6c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "test.dw_project.not_null_bitcoin_historical_PRICE_OPEN.3b75490c6c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__bitcoin_historical as (
SELECT 
    time_period_start,
    time_period_end,
    time_open,
    time_close,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_historical
WHERE time_period_start IS NOT NULL
) select PRICE_OPEN
from __dbt__cte__bitcoin_historical
where PRICE_OPEN is null



      
    ) dbt_internal_test
[0m19:53:37.139756 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:53:37.893191 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.753 seconds
[0m19:53:37.897915 [debug] [Thread-1 (]: On test.dw_project.not_null_bitcoin_historical_PRICE_OPEN.3b75490c6c: Close
[0m19:53:38.096285 [info ] [Thread-1 (]: 3 of 8 PASS not_null_bitcoin_historical_PRICE_OPEN ............................. [[32mPASS[0m in 0.97s]
[0m19:53:38.097858 [debug] [Thread-1 (]: Finished running node test.dw_project.not_null_bitcoin_historical_PRICE_OPEN.3b75490c6c
[0m19:53:38.098924 [debug] [Thread-1 (]: Began running node test.dw_project.not_null_bitcoin_historical_TIME_CLOSE.5bec988be4
[0m19:53:38.099951 [info ] [Thread-1 (]: 4 of 8 START test not_null_bitcoin_historical_TIME_CLOSE ....................... [RUN]
[0m19:53:38.100934 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_project.not_null_bitcoin_historical_PRICE_OPEN.3b75490c6c, now test.dw_project.not_null_bitcoin_historical_TIME_CLOSE.5bec988be4)
[0m19:53:38.101698 [debug] [Thread-1 (]: Began compiling node test.dw_project.not_null_bitcoin_historical_TIME_CLOSE.5bec988be4
[0m19:53:38.109076 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_project.not_null_bitcoin_historical_TIME_CLOSE.5bec988be4"
[0m19:53:38.110110 [debug] [Thread-1 (]: Began executing node test.dw_project.not_null_bitcoin_historical_TIME_CLOSE.5bec988be4
[0m19:53:38.112777 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_project.not_null_bitcoin_historical_TIME_CLOSE.5bec988be4"
[0m19:53:38.114097 [debug] [Thread-1 (]: Using snowflake connection "test.dw_project.not_null_bitcoin_historical_TIME_CLOSE.5bec988be4"
[0m19:53:38.114446 [debug] [Thread-1 (]: On test.dw_project.not_null_bitcoin_historical_TIME_CLOSE.5bec988be4: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "test.dw_project.not_null_bitcoin_historical_TIME_CLOSE.5bec988be4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__bitcoin_historical as (
SELECT 
    time_period_start,
    time_period_end,
    time_open,
    time_close,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_historical
WHERE time_period_start IS NOT NULL
) select TIME_CLOSE
from __dbt__cte__bitcoin_historical
where TIME_CLOSE is null



      
    ) dbt_internal_test
[0m19:53:38.114769 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:53:38.792687 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.677 seconds
[0m19:53:38.796542 [debug] [Thread-1 (]: On test.dw_project.not_null_bitcoin_historical_TIME_CLOSE.5bec988be4: Close
[0m19:53:38.961138 [info ] [Thread-1 (]: 4 of 8 PASS not_null_bitcoin_historical_TIME_CLOSE ............................. [[32mPASS[0m in 0.86s]
[0m19:53:38.962685 [debug] [Thread-1 (]: Finished running node test.dw_project.not_null_bitcoin_historical_TIME_CLOSE.5bec988be4
[0m19:53:38.963462 [debug] [Thread-1 (]: Began running node test.dw_project.not_null_bitcoin_historical_TIME_OPEN.48c11c5598
[0m19:53:38.964147 [info ] [Thread-1 (]: 5 of 8 START test not_null_bitcoin_historical_TIME_OPEN ........................ [RUN]
[0m19:53:38.964827 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_project.not_null_bitcoin_historical_TIME_CLOSE.5bec988be4, now test.dw_project.not_null_bitcoin_historical_TIME_OPEN.48c11c5598)
[0m19:53:38.965361 [debug] [Thread-1 (]: Began compiling node test.dw_project.not_null_bitcoin_historical_TIME_OPEN.48c11c5598
[0m19:53:38.972768 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_project.not_null_bitcoin_historical_TIME_OPEN.48c11c5598"
[0m19:53:38.973680 [debug] [Thread-1 (]: Began executing node test.dw_project.not_null_bitcoin_historical_TIME_OPEN.48c11c5598
[0m19:53:38.975825 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_project.not_null_bitcoin_historical_TIME_OPEN.48c11c5598"
[0m19:53:38.977026 [debug] [Thread-1 (]: Using snowflake connection "test.dw_project.not_null_bitcoin_historical_TIME_OPEN.48c11c5598"
[0m19:53:38.977386 [debug] [Thread-1 (]: On test.dw_project.not_null_bitcoin_historical_TIME_OPEN.48c11c5598: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "test.dw_project.not_null_bitcoin_historical_TIME_OPEN.48c11c5598"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__bitcoin_historical as (
SELECT 
    time_period_start,
    time_period_end,
    time_open,
    time_close,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_historical
WHERE time_period_start IS NOT NULL
) select TIME_OPEN
from __dbt__cte__bitcoin_historical
where TIME_OPEN is null



      
    ) dbt_internal_test
[0m19:53:38.977717 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:53:39.942191 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.964 seconds
[0m19:53:39.947443 [debug] [Thread-1 (]: On test.dw_project.not_null_bitcoin_historical_TIME_OPEN.48c11c5598: Close
[0m19:53:40.141498 [info ] [Thread-1 (]: 5 of 8 PASS not_null_bitcoin_historical_TIME_OPEN .............................. [[32mPASS[0m in 1.18s]
[0m19:53:40.143091 [debug] [Thread-1 (]: Finished running node test.dw_project.not_null_bitcoin_historical_TIME_OPEN.48c11c5598
[0m19:53:40.143925 [debug] [Thread-1 (]: Began running node test.dw_project.not_null_bitcoin_historical_TIME_PERIOD_END.bd1f3c98cc
[0m19:53:40.144789 [info ] [Thread-1 (]: 6 of 8 START test not_null_bitcoin_historical_TIME_PERIOD_END .................. [RUN]
[0m19:53:40.145633 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_project.not_null_bitcoin_historical_TIME_OPEN.48c11c5598, now test.dw_project.not_null_bitcoin_historical_TIME_PERIOD_END.bd1f3c98cc)
[0m19:53:40.146292 [debug] [Thread-1 (]: Began compiling node test.dw_project.not_null_bitcoin_historical_TIME_PERIOD_END.bd1f3c98cc
[0m19:53:40.153963 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_project.not_null_bitcoin_historical_TIME_PERIOD_END.bd1f3c98cc"
[0m19:53:40.155175 [debug] [Thread-1 (]: Began executing node test.dw_project.not_null_bitcoin_historical_TIME_PERIOD_END.bd1f3c98cc
[0m19:53:40.157914 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_project.not_null_bitcoin_historical_TIME_PERIOD_END.bd1f3c98cc"
[0m19:53:40.159202 [debug] [Thread-1 (]: Using snowflake connection "test.dw_project.not_null_bitcoin_historical_TIME_PERIOD_END.bd1f3c98cc"
[0m19:53:40.159573 [debug] [Thread-1 (]: On test.dw_project.not_null_bitcoin_historical_TIME_PERIOD_END.bd1f3c98cc: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "test.dw_project.not_null_bitcoin_historical_TIME_PERIOD_END.bd1f3c98cc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__bitcoin_historical as (
SELECT 
    time_period_start,
    time_period_end,
    time_open,
    time_close,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_historical
WHERE time_period_start IS NOT NULL
) select TIME_PERIOD_END
from __dbt__cte__bitcoin_historical
where TIME_PERIOD_END is null



      
    ) dbt_internal_test
[0m19:53:40.159908 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:53:40.618656 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.458 seconds
[0m19:53:40.623196 [debug] [Thread-1 (]: On test.dw_project.not_null_bitcoin_historical_TIME_PERIOD_END.bd1f3c98cc: Close
[0m19:53:41.265926 [info ] [Thread-1 (]: 6 of 8 PASS not_null_bitcoin_historical_TIME_PERIOD_END ........................ [[32mPASS[0m in 1.12s]
[0m19:53:41.267391 [debug] [Thread-1 (]: Finished running node test.dw_project.not_null_bitcoin_historical_TIME_PERIOD_END.bd1f3c98cc
[0m19:53:41.268108 [debug] [Thread-1 (]: Began running node test.dw_project.not_null_bitcoin_historical_TIME_PERIOD_START.54a7e2ced0
[0m19:53:41.268744 [info ] [Thread-1 (]: 7 of 8 START test not_null_bitcoin_historical_TIME_PERIOD_START ................ [RUN]
[0m19:53:41.269423 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_project.not_null_bitcoin_historical_TIME_PERIOD_END.bd1f3c98cc, now test.dw_project.not_null_bitcoin_historical_TIME_PERIOD_START.54a7e2ced0)
[0m19:53:41.269922 [debug] [Thread-1 (]: Began compiling node test.dw_project.not_null_bitcoin_historical_TIME_PERIOD_START.54a7e2ced0
[0m19:53:41.278709 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_project.not_null_bitcoin_historical_TIME_PERIOD_START.54a7e2ced0"
[0m19:53:41.279622 [debug] [Thread-1 (]: Began executing node test.dw_project.not_null_bitcoin_historical_TIME_PERIOD_START.54a7e2ced0
[0m19:53:41.281733 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_project.not_null_bitcoin_historical_TIME_PERIOD_START.54a7e2ced0"
[0m19:53:41.282938 [debug] [Thread-1 (]: Using snowflake connection "test.dw_project.not_null_bitcoin_historical_TIME_PERIOD_START.54a7e2ced0"
[0m19:53:41.283295 [debug] [Thread-1 (]: On test.dw_project.not_null_bitcoin_historical_TIME_PERIOD_START.54a7e2ced0: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "test.dw_project.not_null_bitcoin_historical_TIME_PERIOD_START.54a7e2ced0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__bitcoin_historical as (
SELECT 
    time_period_start,
    time_period_end,
    time_open,
    time_close,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_historical
WHERE time_period_start IS NOT NULL
) select TIME_PERIOD_START
from __dbt__cte__bitcoin_historical
where TIME_PERIOD_START is null



      
    ) dbt_internal_test
[0m19:53:41.283634 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:53:41.721175 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.437 seconds
[0m19:53:41.725480 [debug] [Thread-1 (]: On test.dw_project.not_null_bitcoin_historical_TIME_PERIOD_START.54a7e2ced0: Close
[0m19:53:41.901239 [info ] [Thread-1 (]: 7 of 8 PASS not_null_bitcoin_historical_TIME_PERIOD_START ...................... [[32mPASS[0m in 0.63s]
[0m19:53:41.902897 [debug] [Thread-1 (]: Finished running node test.dw_project.not_null_bitcoin_historical_TIME_PERIOD_START.54a7e2ced0
[0m19:53:41.903743 [debug] [Thread-1 (]: Began running node test.dw_project.unique_bitcoin_historical_TIME_PERIOD_START.031b152f75
[0m19:53:41.904588 [info ] [Thread-1 (]: 8 of 8 START test unique_bitcoin_historical_TIME_PERIOD_START .................. [RUN]
[0m19:53:41.905441 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_project.not_null_bitcoin_historical_TIME_PERIOD_START.54a7e2ced0, now test.dw_project.unique_bitcoin_historical_TIME_PERIOD_START.031b152f75)
[0m19:53:41.906201 [debug] [Thread-1 (]: Began compiling node test.dw_project.unique_bitcoin_historical_TIME_PERIOD_START.031b152f75
[0m19:53:41.917822 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_project.unique_bitcoin_historical_TIME_PERIOD_START.031b152f75"
[0m19:53:41.918824 [debug] [Thread-1 (]: Began executing node test.dw_project.unique_bitcoin_historical_TIME_PERIOD_START.031b152f75
[0m19:53:41.921110 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_project.unique_bitcoin_historical_TIME_PERIOD_START.031b152f75"
[0m19:53:41.922401 [debug] [Thread-1 (]: Using snowflake connection "test.dw_project.unique_bitcoin_historical_TIME_PERIOD_START.031b152f75"
[0m19:53:41.922776 [debug] [Thread-1 (]: On test.dw_project.unique_bitcoin_historical_TIME_PERIOD_START.031b152f75: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "test.dw_project.unique_bitcoin_historical_TIME_PERIOD_START.031b152f75"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with __dbt__cte__bitcoin_historical as (
SELECT 
    time_period_start,
    time_period_end,
    time_open,
    time_close,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_historical
WHERE time_period_start IS NOT NULL
) select
    TIME_PERIOD_START as unique_field,
    count(*) as n_records

from __dbt__cte__bitcoin_historical
where TIME_PERIOD_START is not null
group by TIME_PERIOD_START
having count(*) > 1



      
    ) dbt_internal_test
[0m19:53:41.923106 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:53:43.012604 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.089 seconds
[0m19:53:43.017264 [debug] [Thread-1 (]: On test.dw_project.unique_bitcoin_historical_TIME_PERIOD_START.031b152f75: Close
[0m19:53:43.191298 [info ] [Thread-1 (]: 8 of 8 PASS unique_bitcoin_historical_TIME_PERIOD_START ........................ [[32mPASS[0m in 1.29s]
[0m19:53:43.192134 [debug] [Thread-1 (]: Finished running node test.dw_project.unique_bitcoin_historical_TIME_PERIOD_START.031b152f75
[0m19:53:43.193200 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:53:43.193491 [debug] [MainThread]: Connection 'test.dw_project.unique_bitcoin_historical_TIME_PERIOD_START.031b152f75' was properly closed.
[0m19:53:43.193822 [info ] [MainThread]: 
[0m19:53:43.194309 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 10.12 seconds (10.12s).
[0m19:53:43.196139 [debug] [MainThread]: Command end result
[0m19:53:43.224880 [info ] [MainThread]: 
[0m19:53:43.225255 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:53:43.225473 [info ] [MainThread]: 
[0m19:53:43.225695 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m19:53:43.228140 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 11.321792, "process_user_time": 3.452905, "process_kernel_time": 1.43355, "process_mem_max_rss": "210927616", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:53:43.228599 [debug] [MainThread]: Command `dbt test` succeeded at 19:53:43.228523 after 11.32 seconds
[0m19:53:43.228861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104766900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1032f1e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103be1490>]}
[0m19:53:43.229104 [debug] [MainThread]: Flushing usage events
[0m12:08:47.583760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f86b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068a9310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068a9280>]}


============================== 12:08:47.585738 | 65b1d5c8-5804-4999-936e-e3671890c842 ==============================
[0m12:08:47.585738 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:08:47.586047 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'introspect': 'True', 'warn_error': 'None', 'target_path': 'None', 'log_format': 'default', 'static_parser': 'True', 'quiet': 'False', 'profiles_dir': '/Users/drashtibhingradiya/Desktop/dw_project', 'empty': 'False', 'debug': 'False', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'version_check': 'True', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'printer_width': '80', 'no_print': 'None', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'fail_fast': 'False', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'write_json': 'True'}
[0m12:08:49.085848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '65b1d5c8-5804-4999-936e-e3671890c842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1522bc410>]}
[0m12:08:49.103421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '65b1d5c8-5804-4999-936e-e3671890c842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1522bfc20>]}
[0m12:08:49.104017 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:08:49.115852 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m12:08:49.188108 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:08:49.188323 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:08:49.207487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '65b1d5c8-5804-4999-936e-e3671890c842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1523e45f0>]}
[0m12:08:49.255829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '65b1d5c8-5804-4999-936e-e3671890c842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1525d3ef0>]}
[0m12:08:49.256109 [info ] [MainThread]: Found 6 models, 2 snapshots, 8 data tests, 3 sources, 459 macros
[0m12:08:49.256255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65b1d5c8-5804-4999-936e-e3671890c842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1524131a0>]}
[0m12:08:49.257080 [info ] [MainThread]: 
[0m12:08:49.257339 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:08:49.259085 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2'
[0m12:08:49.264626 [debug] [ThreadPool]: Using snowflake connection "list_lab2"
[0m12:08:49.264787 [debug] [ThreadPool]: On list_lab2: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2"} */
show terse schemas in database lab2
    limit 10000
[0m12:08:49.264891 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:08:50.288765 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.023 seconds
[0m12:08:50.290764 [debug] [ThreadPool]: On list_lab2: Close
[0m12:08:50.468175 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2, now list_lab2_analytics)
[0m12:08:50.480407 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m12:08:50.480855 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m12:08:50.481090 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:08:51.045735 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.565 seconds
[0m12:08:51.048820 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m12:08:51.223441 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2_analytics, now list_lab2_snapshot)
[0m12:08:51.228407 [debug] [ThreadPool]: Using snowflake connection "list_lab2_snapshot"
[0m12:08:51.229124 [debug] [ThreadPool]: On list_lab2_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "connection_name": "list_lab2_snapshot"} */
show objects in lab2.snapshot limit 10000
[0m12:08:51.229487 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:08:52.031160 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.802 seconds
[0m12:08:52.033049 [debug] [ThreadPool]: On list_lab2_snapshot: Close
[0m12:08:52.179151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65b1d5c8-5804-4999-936e-e3671890c842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1239c03e0>]}
[0m12:08:52.180074 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m12:08:52.180425 [info ] [MainThread]: 
[0m12:08:52.185121 [debug] [Thread-1 (]: Began running node model.dw_project.avg_price_realtime
[0m12:08:52.185735 [info ] [Thread-1 (]: 1 of 4 START sql table model analytics.avg_price_realtime ...................... [RUN]
[0m12:08:52.186138 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_snapshot, now model.dw_project.avg_price_realtime)
[0m12:08:52.186405 [debug] [Thread-1 (]: Began compiling node model.dw_project.avg_price_realtime
[0m12:08:52.193630 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.avg_price_realtime"
[0m12:08:52.194727 [debug] [Thread-1 (]: Began executing node model.dw_project.avg_price_realtime
[0m12:08:52.212514 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.avg_price_realtime"
[0m12:08:52.213972 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.avg_price_realtime"
[0m12:08:52.214271 [debug] [Thread-1 (]: On model.dw_project.avg_price_realtime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.avg_price_realtime"} */
create or replace transient table lab2.analytics.avg_price_realtime
         as
        (WITH realtime AS (
    SELECT 
        time_open AS time_period_start,
        price_close
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    time_period_start,
    AVG(price_close) OVER (ORDER BY time_period_start ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) AS thirty_min_avg_price
FROM realtime
ORDER BY time_period_start
        );
[0m12:08:52.214470 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:08:54.387385 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.172 seconds
[0m12:08:54.411530 [debug] [Thread-1 (]: On model.dw_project.avg_price_realtime: Close
[0m12:08:54.613114 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65b1d5c8-5804-4999-936e-e3671890c842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1522291c0>]}
[0m12:08:54.615015 [info ] [Thread-1 (]: 1 of 4 OK created sql table model analytics.avg_price_realtime ................. [[32mSUCCESS 1[0m in 2.42s]
[0m12:08:54.616297 [debug] [Thread-1 (]: Finished running node model.dw_project.avg_price_realtime
[0m12:08:54.617199 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_daily_summary
[0m12:08:54.618231 [info ] [Thread-1 (]: 2 of 4 START sql table model analytics.bitcoin_daily_summary ................... [RUN]
[0m12:08:54.619027 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.avg_price_realtime, now model.dw_project.bitcoin_daily_summary)
[0m12:08:54.619688 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_daily_summary
[0m12:08:54.624928 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_daily_summary"
[0m12:08:54.626488 [debug] [Thread-1 (]: Began executing node model.dw_project.bitcoin_daily_summary
[0m12:08:54.629637 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.bitcoin_daily_summary"
[0m12:08:54.631171 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.bitcoin_daily_summary"
[0m12:08:54.631543 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.bitcoin_daily_summary"} */
create or replace transient table lab2.analytics.bitcoin_daily_summary
         as
        (WITH historical_data AS (
    SELECT
        TIME_PERIOD_START::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_historical
),
realtime_data AS (
    SELECT
        TIME_OPEN::DATE AS date,
        PRICE_OPEN,
        PRICE_HIGH,
        PRICE_LOW,
        PRICE_CLOSE,
        VOLUME_TRADED,
        TRADES_COUNT
    FROM lab2.raw_data.bitcoin_realtime
)

SELECT
    date,
    AVG(PRICE_OPEN) AS avg_open,
    AVG(PRICE_HIGH) AS avg_high,
    AVG(PRICE_LOW) AS avg_low,
    AVG(PRICE_CLOSE) AS avg_close,
    SUM(VOLUME_TRADED) AS total_volume,
    SUM(TRADES_COUNT) AS total_trades
FROM (
    SELECT * FROM historical_data
    UNION ALL
    SELECT * FROM realtime_data
) AS combined_data
GROUP BY date
ORDER BY date
        );
[0m12:08:54.631881 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:08:56.946761 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.314 seconds
[0m12:08:56.954132 [debug] [Thread-1 (]: On model.dw_project.bitcoin_daily_summary: Close
[0m12:08:57.109804 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65b1d5c8-5804-4999-936e-e3671890c842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15297abd0>]}
[0m12:08:57.111510 [info ] [Thread-1 (]: 2 of 4 OK created sql table model analytics.bitcoin_daily_summary .............. [[32mSUCCESS 1[0m in 2.49s]
[0m12:08:57.112635 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_daily_summary
[0m12:08:57.113425 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_historical
[0m12:08:57.114230 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_daily_summary, now model.dw_project.bitcoin_historical)
[0m12:08:57.114815 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_historical
[0m12:08:57.119654 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_historical"
[0m12:08:57.121188 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_historical
[0m12:08:57.121655 [debug] [Thread-1 (]: Began running node model.dw_project.bitcoin_realtime
[0m12:08:57.122208 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_historical, now model.dw_project.bitcoin_realtime)
[0m12:08:57.122675 [debug] [Thread-1 (]: Began compiling node model.dw_project.bitcoin_realtime
[0m12:08:57.126644 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.bitcoin_realtime"
[0m12:08:57.127528 [debug] [Thread-1 (]: Finished running node model.dw_project.bitcoin_realtime
[0m12:08:57.128242 [debug] [Thread-1 (]: Began running node model.dw_project.moving_avg_realtime
[0m12:08:57.128787 [info ] [Thread-1 (]: 3 of 4 START sql table model analytics.moving_avg_realtime ..................... [RUN]
[0m12:08:57.129138 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.bitcoin_realtime, now model.dw_project.moving_avg_realtime)
[0m12:08:57.129397 [debug] [Thread-1 (]: Began compiling node model.dw_project.moving_avg_realtime
[0m12:08:57.179509 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.moving_avg_realtime"
[0m12:08:57.180036 [debug] [Thread-1 (]: Began executing node model.dw_project.moving_avg_realtime
[0m12:08:57.181413 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.moving_avg_realtime"
[0m12:08:57.182135 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.moving_avg_realtime"
[0m12:08:57.182308 [debug] [Thread-1 (]: On model.dw_project.moving_avg_realtime: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.moving_avg_realtime"} */
create or replace transient table lab2.analytics.moving_avg_realtime
         as
        (-- Calculate moving averages (e.g., 7-day moving average) for real-time data
WITH  __dbt__cte__bitcoin_realtime as (
SELECT 
    time_open,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_realtime
WHERE price_close IS NOT NULL
), real_time_moving_avg AS (
    SELECT
        DATE(TIME_OPEN) AS DAY,
        PRICE_OPEN,
        VOLUME_TRADED,
        AVG(PRICE_OPEN) OVER (ORDER BY TIME_OPEN ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS PRICE_OPEN_7DAY_AVG,
        AVG(VOLUME_TRADED) OVER (ORDER BY TIME_OPEN ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS VOLUME_TRADED_7DAY_AVG
    FROM __dbt__cte__bitcoin_realtime
)

-- Select final result
SELECT 
    DAY,
    PRICE_OPEN,
    VOLUME_TRADED,
    PRICE_OPEN_7DAY_AVG,
    VOLUME_TRADED_7DAY_AVG
FROM real_time_moving_avg
        );
[0m12:08:57.182460 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:08:58.996874 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.814 seconds
[0m12:08:59.001348 [debug] [Thread-1 (]: On model.dw_project.moving_avg_realtime: Close
[0m12:08:59.182151 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65b1d5c8-5804-4999-936e-e3671890c842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152878cb0>]}
[0m12:08:59.183901 [info ] [Thread-1 (]: 3 of 4 OK created sql table model analytics.moving_avg_realtime ................ [[32mSUCCESS 1[0m in 2.05s]
[0m12:08:59.185126 [debug] [Thread-1 (]: Finished running node model.dw_project.moving_avg_realtime
[0m12:08:59.185931 [debug] [Thread-1 (]: Began running node model.dw_project.trades
[0m12:08:59.186840 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics.trades .................................. [RUN]
[0m12:08:59.187505 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dw_project.moving_avg_realtime, now model.dw_project.trades)
[0m12:08:59.188009 [debug] [Thread-1 (]: Began compiling node model.dw_project.trades
[0m12:08:59.200593 [debug] [Thread-1 (]: Writing injected SQL for node "model.dw_project.trades"
[0m12:08:59.201614 [debug] [Thread-1 (]: Began executing node model.dw_project.trades
[0m12:08:59.204082 [debug] [Thread-1 (]: Writing runtime sql for node "model.dw_project.trades"
[0m12:08:59.206004 [debug] [Thread-1 (]: Using snowflake connection "model.dw_project.trades"
[0m12:08:59.206346 [debug] [Thread-1 (]: On model.dw_project.trades: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "default", "node_id": "model.dw_project.trades"} */
create or replace transient table lab2.analytics.trades
         as
        (-- Calculate total trading activity by hour for both real-time and historical data, and merge them into one table
WITH  __dbt__cte__bitcoin_realtime as (
SELECT 
    time_open,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_realtime
WHERE price_close IS NOT NULL
),  __dbt__cte__bitcoin_historical as (
SELECT 
    time_period_start,
    time_period_end,
    time_open,
    time_close,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_historical
WHERE time_period_start IS NOT NULL
), real_time_hourly_activity AS (
    SELECT
        EXTRACT(HOUR FROM TIME_OPEN) AS HOUR_OF_DAY,
        SUM(VOLUME_TRADED) AS TOTAL_VOLUME_TRADED,
        SUM(TRADES_COUNT) AS TOTAL_TRADES_COUNT,
        'Real-Time' AS DATA_SOURCE  -- Adding a column to distinguish between real-time and historical data
    FROM __dbt__cte__bitcoin_realtime
    GROUP BY EXTRACT(HOUR FROM TIME_OPEN)
),

historical_hourly_activity AS (
    SELECT
        EXTRACT(HOUR FROM TIME_PERIOD_START) AS HOUR_OF_DAY,
        SUM(VOLUME_TRADED) AS TOTAL_VOLUME_TRADED,
        SUM(TRADES_COUNT) AS TOTAL_TRADES_COUNT,
        'Historical' AS DATA_SOURCE  -- Adding a column to distinguish between real-time and historical data
    FROM __dbt__cte__bitcoin_historical
    GROUP BY EXTRACT(HOUR FROM TIME_PERIOD_START)
)

-- Combine real-time and historical data
SELECT 
    HOUR_OF_DAY,
    TOTAL_VOLUME_TRADED,
    TOTAL_TRADES_COUNT,
    DATA_SOURCE
FROM real_time_hourly_activity

UNION ALL

SELECT 
    HOUR_OF_DAY,
    TOTAL_VOLUME_TRADED,
    TOTAL_TRADES_COUNT,
    DATA_SOURCE
FROM historical_hourly_activity
ORDER BY HOUR_OF_DAY
        );
[0m12:08:59.206671 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:01.144622 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.938 seconds
[0m12:09:01.147005 [debug] [Thread-1 (]: On model.dw_project.trades: Close
[0m12:09:01.471780 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65b1d5c8-5804-4999-936e-e3671890c842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152927080>]}
[0m12:09:01.473409 [info ] [Thread-1 (]: 4 of 4 OK created sql table model analytics.trades ............................. [[32mSUCCESS 1[0m in 2.28s]
[0m12:09:01.474522 [debug] [Thread-1 (]: Finished running node model.dw_project.trades
[0m12:09:01.476674 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:09:01.477219 [debug] [MainThread]: Connection 'model.dw_project.trades' was properly closed.
[0m12:09:01.477961 [info ] [MainThread]: 
[0m12:09:01.478512 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 12.22 seconds (12.22s).
[0m12:09:01.479963 [debug] [MainThread]: Command end result
[0m12:09:01.510011 [info ] [MainThread]: 
[0m12:09:01.510350 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:09:01.510541 [info ] [MainThread]: 
[0m12:09:01.510735 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m12:09:01.518217 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.964125, "process_user_time": 3.052922, "process_kernel_time": 1.760978, "process_mem_max_rss": "207257600", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:09:01.518548 [debug] [MainThread]: Command `dbt run` succeeded at 12:09:01.518496 after 13.96 seconds
[0m12:09:01.518753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10349a870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15290f020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15290e030>]}
[0m12:09:01.518940 [debug] [MainThread]: Flushing usage events
[0m12:53:28.447508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043001a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102abce90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043594f0>]}


============================== 12:53:28.449358 | d6c3a1fd-3b14-4225-a882-21115d0eb0f1 ==============================
[0m12:53:28.449358 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:53:28.449637 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'log_format': 'default', 'profiles_dir': '/Users/drashtibhingradiya/.dbt', 'debug': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'log_path': '/Users/drashtibhingradiya/Desktop/dw_project/logs', 'quiet': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'write_json': 'True', 'warn_error': 'None', 'empty': 'None', 'printer_width': '80', 'version_check': 'True', 'target_path': 'None', 'no_print': 'None', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt test'}
[0m12:53:29.439052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd6c3a1fd-3b14-4225-a882-21115d0eb0f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143a0d160>]}
[0m12:53:29.456353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd6c3a1fd-3b14-4225-a882-21115d0eb0f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1408fe870>]}
[0m12:53:29.456857 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:53:29.466400 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m12:53:29.517319 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m12:53:29.517579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd6c3a1fd-3b14-4225-a882-21115d0eb0f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049a8aa0>]}
[0m12:53:30.049611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd6c3a1fd-3b14-4225-a882-21115d0eb0f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1441befc0>]}
[0m12:53:30.100590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd6c3a1fd-3b14-4225-a882-21115d0eb0f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1444a3bc0>]}
[0m12:53:30.100823 [info ] [MainThread]: Found 6 models, 2 snapshots, 8 data tests, 3 sources, 459 macros
[0m12:53:30.100962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6c3a1fd-3b14-4225-a882-21115d0eb0f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142880c20>]}
[0m12:53:30.101702 [info ] [MainThread]: 
[0m12:53:30.101937 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:53:30.103591 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2_analytics'
[0m12:53:30.109367 [debug] [ThreadPool]: Using snowflake connection "list_lab2_analytics"
[0m12:53:30.109512 [debug] [ThreadPool]: On list_lab2_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "dev", "connection_name": "list_lab2_analytics"} */
show objects in lab2.analytics limit 10000
[0m12:53:30.109616 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:53:30.903749 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.794 seconds
[0m12:53:30.905283 [debug] [ThreadPool]: On list_lab2_analytics: Close
[0m12:53:31.092009 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2_analytics, now list_lab2_snapshot)
[0m12:53:31.098540 [debug] [ThreadPool]: Using snowflake connection "list_lab2_snapshot"
[0m12:53:31.099095 [debug] [ThreadPool]: On list_lab2_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "dev", "connection_name": "list_lab2_snapshot"} */
show objects in lab2.snapshot limit 10000
[0m12:53:31.099472 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:53:31.823829 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.724 seconds
[0m12:53:31.827788 [debug] [ThreadPool]: On list_lab2_snapshot: Close
[0m12:53:32.021437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6c3a1fd-3b14-4225-a882-21115d0eb0f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143de5580>]}
[0m12:53:32.022971 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:53:32.023664 [info ] [MainThread]: 
[0m12:53:32.029275 [debug] [Thread-1 (]: Began running node test.dw_project.not_null_bitcoin_historical_PRICE_HIGH.e2e4ab4d25
[0m12:53:32.029972 [info ] [Thread-1 (]: 1 of 8 START test not_null_bitcoin_historical_PRICE_HIGH ....................... [RUN]
[0m12:53:32.030533 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lab2_snapshot, now test.dw_project.not_null_bitcoin_historical_PRICE_HIGH.e2e4ab4d25)
[0m12:53:32.030913 [debug] [Thread-1 (]: Began compiling node test.dw_project.not_null_bitcoin_historical_PRICE_HIGH.e2e4ab4d25
[0m12:53:32.047544 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_project.not_null_bitcoin_historical_PRICE_HIGH.e2e4ab4d25"
[0m12:53:32.049100 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_project.not_null_bitcoin_historical_PRICE_HIGH.e2e4ab4d25"
[0m12:53:32.050368 [debug] [Thread-1 (]: Began executing node test.dw_project.not_null_bitcoin_historical_PRICE_HIGH.e2e4ab4d25
[0m12:53:32.062821 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_project.not_null_bitcoin_historical_PRICE_HIGH.e2e4ab4d25"
[0m12:53:32.063980 [debug] [Thread-1 (]: Using snowflake connection "test.dw_project.not_null_bitcoin_historical_PRICE_HIGH.e2e4ab4d25"
[0m12:53:32.064213 [debug] [Thread-1 (]: On test.dw_project.not_null_bitcoin_historical_PRICE_HIGH.e2e4ab4d25: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "dev", "node_id": "test.dw_project.not_null_bitcoin_historical_PRICE_HIGH.e2e4ab4d25"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__bitcoin_historical as (
SELECT 
    time_period_start,
    time_period_end,
    time_open,
    time_close,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_historical
WHERE time_period_start IS NOT NULL
) select PRICE_HIGH
from __dbt__cte__bitcoin_historical
where PRICE_HIGH is null



      
    ) dbt_internal_test
[0m12:53:32.064404 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:53:33.205439 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.141 seconds
[0m12:53:33.220524 [debug] [Thread-1 (]: On test.dw_project.not_null_bitcoin_historical_PRICE_HIGH.e2e4ab4d25: Close
[0m12:53:33.397453 [info ] [Thread-1 (]: 1 of 8 PASS not_null_bitcoin_historical_PRICE_HIGH ............................. [[32mPASS[0m in 1.37s]
[0m12:53:33.399332 [debug] [Thread-1 (]: Finished running node test.dw_project.not_null_bitcoin_historical_PRICE_HIGH.e2e4ab4d25
[0m12:53:33.400269 [debug] [Thread-1 (]: Began running node test.dw_project.not_null_bitcoin_historical_PRICE_LOW.0c9f1946ec
[0m12:53:33.401150 [info ] [Thread-1 (]: 2 of 8 START test not_null_bitcoin_historical_PRICE_LOW ........................ [RUN]
[0m12:53:33.401962 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_project.not_null_bitcoin_historical_PRICE_HIGH.e2e4ab4d25, now test.dw_project.not_null_bitcoin_historical_PRICE_LOW.0c9f1946ec)
[0m12:53:33.402549 [debug] [Thread-1 (]: Began compiling node test.dw_project.not_null_bitcoin_historical_PRICE_LOW.0c9f1946ec
[0m12:53:33.410273 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_project.not_null_bitcoin_historical_PRICE_LOW.0c9f1946ec"
[0m12:53:33.411200 [debug] [Thread-1 (]: Began executing node test.dw_project.not_null_bitcoin_historical_PRICE_LOW.0c9f1946ec
[0m12:53:33.413388 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_project.not_null_bitcoin_historical_PRICE_LOW.0c9f1946ec"
[0m12:53:33.414561 [debug] [Thread-1 (]: Using snowflake connection "test.dw_project.not_null_bitcoin_historical_PRICE_LOW.0c9f1946ec"
[0m12:53:33.414910 [debug] [Thread-1 (]: On test.dw_project.not_null_bitcoin_historical_PRICE_LOW.0c9f1946ec: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "dev", "node_id": "test.dw_project.not_null_bitcoin_historical_PRICE_LOW.0c9f1946ec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__bitcoin_historical as (
SELECT 
    time_period_start,
    time_period_end,
    time_open,
    time_close,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_historical
WHERE time_period_start IS NOT NULL
) select PRICE_LOW
from __dbt__cte__bitcoin_historical
where PRICE_LOW is null



      
    ) dbt_internal_test
[0m12:53:33.415348 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:53:34.127894 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.712 seconds
[0m12:53:34.132455 [debug] [Thread-1 (]: On test.dw_project.not_null_bitcoin_historical_PRICE_LOW.0c9f1946ec: Close
[0m12:53:34.289931 [info ] [Thread-1 (]: 2 of 8 PASS not_null_bitcoin_historical_PRICE_LOW .............................. [[32mPASS[0m in 0.89s]
[0m12:53:34.291353 [debug] [Thread-1 (]: Finished running node test.dw_project.not_null_bitcoin_historical_PRICE_LOW.0c9f1946ec
[0m12:53:34.292162 [debug] [Thread-1 (]: Began running node test.dw_project.not_null_bitcoin_historical_PRICE_OPEN.3b75490c6c
[0m12:53:34.292884 [info ] [Thread-1 (]: 3 of 8 START test not_null_bitcoin_historical_PRICE_OPEN ....................... [RUN]
[0m12:53:34.293522 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_project.not_null_bitcoin_historical_PRICE_LOW.0c9f1946ec, now test.dw_project.not_null_bitcoin_historical_PRICE_OPEN.3b75490c6c)
[0m12:53:34.293873 [debug] [Thread-1 (]: Began compiling node test.dw_project.not_null_bitcoin_historical_PRICE_OPEN.3b75490c6c
[0m12:53:34.299781 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_project.not_null_bitcoin_historical_PRICE_OPEN.3b75490c6c"
[0m12:53:34.300667 [debug] [Thread-1 (]: Began executing node test.dw_project.not_null_bitcoin_historical_PRICE_OPEN.3b75490c6c
[0m12:53:34.302959 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_project.not_null_bitcoin_historical_PRICE_OPEN.3b75490c6c"
[0m12:53:34.304192 [debug] [Thread-1 (]: Using snowflake connection "test.dw_project.not_null_bitcoin_historical_PRICE_OPEN.3b75490c6c"
[0m12:53:34.304540 [debug] [Thread-1 (]: On test.dw_project.not_null_bitcoin_historical_PRICE_OPEN.3b75490c6c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "dev", "node_id": "test.dw_project.not_null_bitcoin_historical_PRICE_OPEN.3b75490c6c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__bitcoin_historical as (
SELECT 
    time_period_start,
    time_period_end,
    time_open,
    time_close,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_historical
WHERE time_period_start IS NOT NULL
) select PRICE_OPEN
from __dbt__cte__bitcoin_historical
where PRICE_OPEN is null



      
    ) dbt_internal_test
[0m12:53:34.304915 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:53:35.150866 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.846 seconds
[0m12:53:35.155187 [debug] [Thread-1 (]: On test.dw_project.not_null_bitcoin_historical_PRICE_OPEN.3b75490c6c: Close
[0m12:53:35.344549 [info ] [Thread-1 (]: 3 of 8 PASS not_null_bitcoin_historical_PRICE_OPEN ............................. [[32mPASS[0m in 1.05s]
[0m12:53:35.345896 [debug] [Thread-1 (]: Finished running node test.dw_project.not_null_bitcoin_historical_PRICE_OPEN.3b75490c6c
[0m12:53:35.346587 [debug] [Thread-1 (]: Began running node test.dw_project.not_null_bitcoin_historical_TIME_CLOSE.5bec988be4
[0m12:53:35.347396 [info ] [Thread-1 (]: 4 of 8 START test not_null_bitcoin_historical_TIME_CLOSE ....................... [RUN]
[0m12:53:35.348576 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_project.not_null_bitcoin_historical_PRICE_OPEN.3b75490c6c, now test.dw_project.not_null_bitcoin_historical_TIME_CLOSE.5bec988be4)
[0m12:53:35.349464 [debug] [Thread-1 (]: Began compiling node test.dw_project.not_null_bitcoin_historical_TIME_CLOSE.5bec988be4
[0m12:53:35.355207 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_project.not_null_bitcoin_historical_TIME_CLOSE.5bec988be4"
[0m12:53:35.356138 [debug] [Thread-1 (]: Began executing node test.dw_project.not_null_bitcoin_historical_TIME_CLOSE.5bec988be4
[0m12:53:35.358236 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_project.not_null_bitcoin_historical_TIME_CLOSE.5bec988be4"
[0m12:53:35.359697 [debug] [Thread-1 (]: Using snowflake connection "test.dw_project.not_null_bitcoin_historical_TIME_CLOSE.5bec988be4"
[0m12:53:35.360092 [debug] [Thread-1 (]: On test.dw_project.not_null_bitcoin_historical_TIME_CLOSE.5bec988be4: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "dev", "node_id": "test.dw_project.not_null_bitcoin_historical_TIME_CLOSE.5bec988be4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__bitcoin_historical as (
SELECT 
    time_period_start,
    time_period_end,
    time_open,
    time_close,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_historical
WHERE time_period_start IS NOT NULL
) select TIME_CLOSE
from __dbt__cte__bitcoin_historical
where TIME_CLOSE is null



      
    ) dbt_internal_test
[0m12:53:35.360390 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:53:35.785684 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.425 seconds
[0m12:53:35.790523 [debug] [Thread-1 (]: On test.dw_project.not_null_bitcoin_historical_TIME_CLOSE.5bec988be4: Close
[0m12:53:35.968880 [info ] [Thread-1 (]: 4 of 8 PASS not_null_bitcoin_historical_TIME_CLOSE ............................. [[32mPASS[0m in 0.62s]
[0m12:53:35.970355 [debug] [Thread-1 (]: Finished running node test.dw_project.not_null_bitcoin_historical_TIME_CLOSE.5bec988be4
[0m12:53:35.971042 [debug] [Thread-1 (]: Began running node test.dw_project.not_null_bitcoin_historical_TIME_OPEN.48c11c5598
[0m12:53:35.971724 [info ] [Thread-1 (]: 5 of 8 START test not_null_bitcoin_historical_TIME_OPEN ........................ [RUN]
[0m12:53:35.972376 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_project.not_null_bitcoin_historical_TIME_CLOSE.5bec988be4, now test.dw_project.not_null_bitcoin_historical_TIME_OPEN.48c11c5598)
[0m12:53:35.972863 [debug] [Thread-1 (]: Began compiling node test.dw_project.not_null_bitcoin_historical_TIME_OPEN.48c11c5598
[0m12:53:35.980418 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_project.not_null_bitcoin_historical_TIME_OPEN.48c11c5598"
[0m12:53:35.981188 [debug] [Thread-1 (]: Began executing node test.dw_project.not_null_bitcoin_historical_TIME_OPEN.48c11c5598
[0m12:53:35.983150 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_project.not_null_bitcoin_historical_TIME_OPEN.48c11c5598"
[0m12:53:35.984309 [debug] [Thread-1 (]: Using snowflake connection "test.dw_project.not_null_bitcoin_historical_TIME_OPEN.48c11c5598"
[0m12:53:35.984655 [debug] [Thread-1 (]: On test.dw_project.not_null_bitcoin_historical_TIME_OPEN.48c11c5598: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "dev", "node_id": "test.dw_project.not_null_bitcoin_historical_TIME_OPEN.48c11c5598"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__bitcoin_historical as (
SELECT 
    time_period_start,
    time_period_end,
    time_open,
    time_close,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_historical
WHERE time_period_start IS NOT NULL
) select TIME_OPEN
from __dbt__cte__bitcoin_historical
where TIME_OPEN is null



      
    ) dbt_internal_test
[0m12:53:35.984974 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:53:36.803468 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.818 seconds
[0m12:53:36.807624 [debug] [Thread-1 (]: On test.dw_project.not_null_bitcoin_historical_TIME_OPEN.48c11c5598: Close
[0m12:53:37.100910 [info ] [Thread-1 (]: 5 of 8 PASS not_null_bitcoin_historical_TIME_OPEN .............................. [[32mPASS[0m in 1.13s]
[0m12:53:37.102603 [debug] [Thread-1 (]: Finished running node test.dw_project.not_null_bitcoin_historical_TIME_OPEN.48c11c5598
[0m12:53:37.103470 [debug] [Thread-1 (]: Began running node test.dw_project.not_null_bitcoin_historical_TIME_PERIOD_END.bd1f3c98cc
[0m12:53:37.104348 [info ] [Thread-1 (]: 6 of 8 START test not_null_bitcoin_historical_TIME_PERIOD_END .................. [RUN]
[0m12:53:37.105230 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_project.not_null_bitcoin_historical_TIME_OPEN.48c11c5598, now test.dw_project.not_null_bitcoin_historical_TIME_PERIOD_END.bd1f3c98cc)
[0m12:53:37.105809 [debug] [Thread-1 (]: Began compiling node test.dw_project.not_null_bitcoin_historical_TIME_PERIOD_END.bd1f3c98cc
[0m12:53:37.113742 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_project.not_null_bitcoin_historical_TIME_PERIOD_END.bd1f3c98cc"
[0m12:53:37.115018 [debug] [Thread-1 (]: Began executing node test.dw_project.not_null_bitcoin_historical_TIME_PERIOD_END.bd1f3c98cc
[0m12:53:37.117601 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_project.not_null_bitcoin_historical_TIME_PERIOD_END.bd1f3c98cc"
[0m12:53:37.118862 [debug] [Thread-1 (]: Using snowflake connection "test.dw_project.not_null_bitcoin_historical_TIME_PERIOD_END.bd1f3c98cc"
[0m12:53:37.119238 [debug] [Thread-1 (]: On test.dw_project.not_null_bitcoin_historical_TIME_PERIOD_END.bd1f3c98cc: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "dev", "node_id": "test.dw_project.not_null_bitcoin_historical_TIME_PERIOD_END.bd1f3c98cc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__bitcoin_historical as (
SELECT 
    time_period_start,
    time_period_end,
    time_open,
    time_close,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_historical
WHERE time_period_start IS NOT NULL
) select TIME_PERIOD_END
from __dbt__cte__bitcoin_historical
where TIME_PERIOD_END is null



      
    ) dbt_internal_test
[0m12:53:37.119563 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:53:37.914789 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.795 seconds
[0m12:53:37.918241 [debug] [Thread-1 (]: On test.dw_project.not_null_bitcoin_historical_TIME_PERIOD_END.bd1f3c98cc: Close
[0m12:53:38.098309 [info ] [Thread-1 (]: 6 of 8 PASS not_null_bitcoin_historical_TIME_PERIOD_END ........................ [[32mPASS[0m in 0.99s]
[0m12:53:38.099588 [debug] [Thread-1 (]: Finished running node test.dw_project.not_null_bitcoin_historical_TIME_PERIOD_END.bd1f3c98cc
[0m12:53:38.100383 [debug] [Thread-1 (]: Began running node test.dw_project.not_null_bitcoin_historical_TIME_PERIOD_START.54a7e2ced0
[0m12:53:38.100959 [info ] [Thread-1 (]: 7 of 8 START test not_null_bitcoin_historical_TIME_PERIOD_START ................ [RUN]
[0m12:53:38.101598 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_project.not_null_bitcoin_historical_TIME_PERIOD_END.bd1f3c98cc, now test.dw_project.not_null_bitcoin_historical_TIME_PERIOD_START.54a7e2ced0)
[0m12:53:38.102010 [debug] [Thread-1 (]: Began compiling node test.dw_project.not_null_bitcoin_historical_TIME_PERIOD_START.54a7e2ced0
[0m12:53:38.107488 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_project.not_null_bitcoin_historical_TIME_PERIOD_START.54a7e2ced0"
[0m12:53:38.109604 [debug] [Thread-1 (]: Began executing node test.dw_project.not_null_bitcoin_historical_TIME_PERIOD_START.54a7e2ced0
[0m12:53:38.111630 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_project.not_null_bitcoin_historical_TIME_PERIOD_START.54a7e2ced0"
[0m12:53:38.113223 [debug] [Thread-1 (]: Using snowflake connection "test.dw_project.not_null_bitcoin_historical_TIME_PERIOD_START.54a7e2ced0"
[0m12:53:38.113532 [debug] [Thread-1 (]: On test.dw_project.not_null_bitcoin_historical_TIME_PERIOD_START.54a7e2ced0: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "dev", "node_id": "test.dw_project.not_null_bitcoin_historical_TIME_PERIOD_START.54a7e2ced0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__bitcoin_historical as (
SELECT 
    time_period_start,
    time_period_end,
    time_open,
    time_close,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_historical
WHERE time_period_start IS NOT NULL
) select TIME_PERIOD_START
from __dbt__cte__bitcoin_historical
where TIME_PERIOD_START is null



      
    ) dbt_internal_test
[0m12:53:38.113807 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:53:39.050853 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.937 seconds
[0m12:53:39.054936 [debug] [Thread-1 (]: On test.dw_project.not_null_bitcoin_historical_TIME_PERIOD_START.54a7e2ced0: Close
[0m12:53:39.214329 [info ] [Thread-1 (]: 7 of 8 PASS not_null_bitcoin_historical_TIME_PERIOD_START ...................... [[32mPASS[0m in 1.11s]
[0m12:53:39.215796 [debug] [Thread-1 (]: Finished running node test.dw_project.not_null_bitcoin_historical_TIME_PERIOD_START.54a7e2ced0
[0m12:53:39.216546 [debug] [Thread-1 (]: Began running node test.dw_project.unique_bitcoin_historical_TIME_PERIOD_START.031b152f75
[0m12:53:39.217226 [info ] [Thread-1 (]: 8 of 8 START test unique_bitcoin_historical_TIME_PERIOD_START .................. [RUN]
[0m12:53:39.217913 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dw_project.not_null_bitcoin_historical_TIME_PERIOD_START.54a7e2ced0, now test.dw_project.unique_bitcoin_historical_TIME_PERIOD_START.031b152f75)
[0m12:53:39.218410 [debug] [Thread-1 (]: Began compiling node test.dw_project.unique_bitcoin_historical_TIME_PERIOD_START.031b152f75
[0m12:53:39.228344 [debug] [Thread-1 (]: Writing injected SQL for node "test.dw_project.unique_bitcoin_historical_TIME_PERIOD_START.031b152f75"
[0m12:53:39.230698 [debug] [Thread-1 (]: Began executing node test.dw_project.unique_bitcoin_historical_TIME_PERIOD_START.031b152f75
[0m12:53:39.232550 [debug] [Thread-1 (]: Writing runtime sql for node "test.dw_project.unique_bitcoin_historical_TIME_PERIOD_START.031b152f75"
[0m12:53:39.233616 [debug] [Thread-1 (]: Using snowflake connection "test.dw_project.unique_bitcoin_historical_TIME_PERIOD_START.031b152f75"
[0m12:53:39.233913 [debug] [Thread-1 (]: On test.dw_project.unique_bitcoin_historical_TIME_PERIOD_START.031b152f75: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dw_project", "target_name": "dev", "node_id": "test.dw_project.unique_bitcoin_historical_TIME_PERIOD_START.031b152f75"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with __dbt__cte__bitcoin_historical as (
SELECT 
    time_period_start,
    time_period_end,
    time_open,
    time_close,
    price_open,
    price_high,
    price_low,
    price_close,
    volume_traded,
    trades_count
FROM lab2.raw_data.bitcoin_historical
WHERE time_period_start IS NOT NULL
) select
    TIME_PERIOD_START as unique_field,
    count(*) as n_records

from __dbt__cte__bitcoin_historical
where TIME_PERIOD_START is not null
group by TIME_PERIOD_START
having count(*) > 1



      
    ) dbt_internal_test
[0m12:53:39.234190 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:53:39.866180 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.632 seconds
[0m12:53:39.870787 [debug] [Thread-1 (]: On test.dw_project.unique_bitcoin_historical_TIME_PERIOD_START.031b152f75: Close
[0m12:53:40.066845 [error] [Thread-1 (]: 8 of 8 FAIL 100 unique_bitcoin_historical_TIME_PERIOD_START .................... [[31mFAIL 100[0m in 0.85s]
[0m12:53:40.068341 [debug] [Thread-1 (]: Finished running node test.dw_project.unique_bitcoin_historical_TIME_PERIOD_START.031b152f75
[0m12:53:40.070542 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:53:40.071070 [debug] [MainThread]: Connection 'test.dw_project.unique_bitcoin_historical_TIME_PERIOD_START.031b152f75' was properly closed.
[0m12:53:40.071569 [info ] [MainThread]: 
[0m12:53:40.072038 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 9.97 seconds (9.97s).
[0m12:53:40.073797 [debug] [MainThread]: Command end result
[0m12:53:40.100625 [info ] [MainThread]: 
[0m12:53:40.100959 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:53:40.101147 [info ] [MainThread]: 
[0m12:53:40.101372 [error] [MainThread]: [31mFailure in test unique_bitcoin_historical_TIME_PERIOD_START (models/schema.yml)[0m
[0m12:53:40.101568 [error] [MainThread]:   Got 100 results, configured to fail if != 0
[0m12:53:40.101724 [info ] [MainThread]: 
[0m12:53:40.101899 [info ] [MainThread]:   compiled code at target/compiled/dw_project/models/schema.yml/unique_bitcoin_historical_TIME_PERIOD_START.sql
[0m12:53:40.102059 [info ] [MainThread]: 
[0m12:53:40.102239 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m12:53:40.104215 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 11.681788, "process_user_time": 2.802868, "process_kernel_time": 2.355746, "process_mem_max_rss": "217661440", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:53:40.104585 [debug] [MainThread]: Command `dbt test` failed at 12:53:40.104522 after 11.68 seconds
[0m12:53:40.104818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050fe870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10508cbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144b63dd0>]}
[0m12:53:40.105013 [debug] [MainThread]: Flushing usage events
